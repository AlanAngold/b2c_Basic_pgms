# NOTE: Type forced to be:
# trs2 - TRS-80 Level II BASIC tokenized file
   10 CLS 
   20 PRINT @284,"SALVO"
   30 PRINT @409,"COPYRIGHT BY"
   40 PRINT @534,"CREATIVE COMPUTING"
   50 PRINT @657,"MORRISTOWN, NEW JERSEY 07960"
   60 FOR II = 1 TO 1500 : NEXT 
   70 CLS 
   80 PRINT : PRINT 
   90 PRINT TAB 6)"WHILE I AM PLANNING MY BOARD, YOU CAN BE THINKING OF"
  100 PRINT 
  110 PRINT TAB 8)"THE LAY OUT FOR YOUR SHIPS. YOUR SHIPS INCLUDE : "
  120 PRINT 
  130 PRINT TAB 15)"A BATTLESHIP, (FIVE CO-ORDINATES LONG)"
  140 PRINT 
  150 PRINT TAB 15)"A CRUISER, (THREE CO-ORDINATES LONG)"
  160 PRINT 
  170 PRINT TAB 15)"DESTROYER <A>"
  180 PRINT 
  200 : REM ' 
  210 DIM A(10,10),B(10,10),C(7),D(7),E(12),F(12),G(12),H(12),K(10,10)
  220 Z8 = 0
  230 FOR W = 1 TO 12
  240 E(W) = - 1
  250 H(W) = - 1
  260 NEXT W
  270 FOR X = 1 TO 10
  280 FOR Y = 1 TO 10
  290 B(X,Y) = 0
  300 NEXT Y
  310 NEXT X
  320 FOR X = 1 TO 12
  330 F(X) = 0
  340 G(X) = 0
  350 NEXT X
  360 FOR X = 1 TO 10
  370 FOR Y = 1 TO 10
  380 A(X,Y) = 0
  390 NEXT Y
  400 NEXT X
  410 FOR K = 4 TO 1 STEP - 1
  420 U6 = 0
  430 GOSUB 1920
  440 IF V + V2 + V * V2 = 0 THEN 430
  450 GOSUB 3290 : IF Y + V * PU > 10 THEN 430
  460 GOSUB 3290 : IF Y + V * PU < 1 THEN 430
  470 GOSUB 3290 : IF X + V2 * PU > 10 THEN 430
  480 GOSUB 3290 : IF X + V2 * PU < 1 THEN 430
  490 U6 = U6 + 1
  500 IF U6 > 25 THEN 360
  510 GOSUB 3290 : FOR Z = 0 TO PU
  520 GOSUB 3270 : F(Z + PU) = X + V2 * Z
  530 GOSUB 3270 : G(Z + PU) = Y + V * Z
  540 NEXT Z
  550 GOSUB 3270 : U8 = PU
  560 GOSUB 3290 : IF U8 > U8 + PU THEN 630
  570 GOSUB 3290 : FOR Z2 = U8 TO U8 + PU
  580 IF U8 < 2 THEN 620
  590 FOR Z3 = 1 TO U8 - 1
  600 IF SQR ((F(Z3) - F(Z2)) ^ 2 + (G(Z3) - G(Z2)) ^ 2) < 3.59 THEN 430
  610 NEXT Z3
  620 NEXT Z2
  630 GOSUB 3290 : FOR Z = 0 TO PU
  640 A(F(Z + U8),G(Z + U8)) = .5 + SGN (K - 1) * (K - 1.5)
  650 NEXT Z
  660 NEXT K
  670 CLS 
  680 PRINT "ENTER COORDINATES FOR ..."
  690 PRINT "BATTLESHIP"
  700 FOR X = 1 TO 5
  710 INPUT Y,Z
  720 B(Y,Z) = 3
  730 NEXT X
  740 PRINT "CRUISER"
  750 FOR X = 1 TO 3
  760 INPUT Y,Z
  770 B(Y,Z) = 2
  780 NEXT X
  790 PRINT "DESTROYER <A>"
  800 FOR X = 1 TO 2
  810 INPUT Y,Z
  820 B(Y,Z) = 1
  830 NEXT X
  840 CLS 
  850 PRINT "DESTROYER <B>"
  860 FOR X = 1 TO 2
  870 INPUT Y,Z
  880 B(Y,Z) = .5
  890 NEXT X
  900 PRINT "DO YOU WANT TO SEE MY SHOTS";
  910 INPUT K$
  920 PRINT 
  930 IF J$ < > "YES" THEN 1630
  940 : REM ' ****START
  950 IF J$ < > "YES" THEN 1000
  960 C = C + 1
  970 PRINT 
  980 GOSUB 3310
  990 PRINT "TURN";C
 1000 A = 0
 1010 FOR W = .5 TO 3 STEP .5
 1020 FOR X = 1 TO 10
 1030 FOR Y = 1 TO 10
 1040 IF B(X,Y) = W THEN 1080
 1050 NEXT Y
 1060 NEXT X
 1070 GOTO 1090
 1080 A = A + INT (W + .5)
 1090 NEXT W
 1100 FOR W = 1 TO 7
 1110 C(W) = 0
 1120 D(W) = 0
 1130 F(W) = 0
 1140 G(W) = 0
 1150 NEXT W
 1160 P3 = 0
 1170 FOR X = 1 TO 10
 1180 FOR Y = 1 TO 10
 1190 IF A(X,Y) > 10 THEN 1210
 1200 P3 = P3 + 1
 1210 NEXT Y
 1220 NEXT X
 1230 CLS : PRINT "YOU HAVE";A;"SHOTS."
 1240 IF P3 > A THEN 1270
 1250 PRINT "YOU HAVE MORE SHOTS THAN THERE ARE BLANK SQUARES."
 1260 GOTO 1900
 1270 IF A < > 0 THEN 1300
 1280 PRINT "I HAVE WON."
 1290 PRINT : PRINT : END 
 1300 FOR W = 1 TO A
 1310 INPUT X,Y
 1320 IF X < > INT (X) THEN 1380
 1330 IF X > 10 THEN 1380
 1340 IF X < 1 THEN 1380
 1350 IF Y < > INT (Y) THEN 1380
 1360 IF Y > 10 THEN 1380
 1370 IF Y > = 1 THEN 1400
 1380 PRINT "ILLEGAL, ENTER AGAIN."
 1390 GOTO 1310
 1400 IF A(X,Y) > 10 THEN 1450
 1410 C(W) = X
 1420 D(W) = Y
 1430 NEXT W
 1440 GOTO 1470
 1450 PRINT "YOU SHOT THERE BEFORE ON TURN";A(X,Y) - 10
 1460 GOTO 1310
 1470 FOR W = 1 TO A
 1480 IF A(C(W),D(W)) = 3 THEN 1550
 1490 IF A(C(W),D(W)) = 2 THEN 1570
 1500 IF A(C(W),D(W)) = 1 THEN 1590
 1510 IF A(C(W),D(W)) = .5 THEN 1610
 1520 A(C(W),D(W)) = 10 + C
 1530 NEXT W
 1540 GOTO 1630
 1550 PRINT "YOU HIT MY BATTLESHIP."
 1560 GOTO 1520
 1570 PRINT "YOU HIT MY CRUISER."
 1580 GOTO 1520
 1590 PRINT "YOU HIT MY DESTROYER <A>."
 1600 GOTO 1520
 1610 PRINT "YOU HIT MY DESTROYER <B>."
 1620 GOTO 1520
 1630 A = 0
 1640 IF J$ = "YES" THEN 1680
 1650 C = C + 1
 1660 PRINT : GOSUB 3310
 1670 PRINT "TURN";C
 1680 A = 0
 1690 FOR W = .5 TO 3 STEP .5
 1700 FOR X = 1 TO 10
 1710 FOR Y = 1 TO 10
 1720 IF A(X,Y) = W THEN 1760
 1730 NEXT Y
 1740 NEXT X
 1750 GOTO 1770
 1760 A = A + INT (W + .5)
 1770 NEXT W
 1780 P3 = 0
 1790 FOR X = 1 TO 10
 1800 FOR Y = 1 TO 10
 1810 IF A(X,Y) > 10 THEN 1830
 1820 P3 = P3 + 1
 1830 NEXT Y
 1840 NEXT X
 1850 PRINT "I HAVE";A;"SHOTS"
 1860 IF P3 > A THEN 1890
 1870 PRINT "I HAVE MORE SHOTS THAN BLANK SQUARES."
 1880 GOTO 1280
 1890 IF A < > 0 THEN 1970
 1900 PRINT "YOU HAVE WON."
 1910 GOTO 3340
 1920 X = INT ( RND (0) * 10 + 1)
 1930 Y = INT ( RND (0) * 10 + 1)
 1940 V = INT (3 * RND (0) - 1)
 1950 V2 = INT (3 * RND (0) - 1)
 1960 RETURN 
 1970 FOR W = 1 TO 12
 1980 IF H(W) > 0 THEN 2810
 1990 NEXT W
 2000 : REM ' *****RANDOM
 2010 W = 0
 2020 R3 = 0
 2030 GOSUB 1920
 2040 RESTO 
 2050 R2 = 0
 2060 R3 = R3 + 1
 2070 IF R3 > 100 THEN 2020
 2080 IF X > 10 THEN 2120
 2090 IF X > 0 THEN 2130
 2100 X = 1 + INT ( RND (0) * 2.5)
 2110 GOTO 2130
 2120 X = 10 - INT ( RND (0) * 2.5)
 2130 IF Y > 10 THEN 2170
 2140 IF Y > 0 THEN 2280
 2150 Y = 1 + INT ( RND (0) * 2.5)
 2160 GOTO 2280
 2170 Y = 10 - INT ( RND (0) * 2.5)
 2180 GOTO 2280
 2190 F(W) = X
 2200 G(W) = Y
 2210 IF W = A THEN 2390
 2220 IF R2 = 6 THEN 2040
 2230 READ X1,Y1
 2240 R2 = R2 + 1
 2250 DATA 1,1,-1,1,1,-3,1,1,0,2,-1,1
 2260 X = X + X1
 2270 Y = Y + Y1
 2280 IF X > 10 THEN 2220
 2290 IF X < 1 THEN 2220
 2300 IF Y > 10 THEN 2220
 2310 IF Y < 1 THEN 2220
 2320 IF B(X,Y) > 10 THEN 2220
 2330 FOR Q9 = 1 TO W
 2340 IF F(Q9) < > X THEN 2360
 2350 IF G(Q9) = Y THEN 2220
 2360 NEXT Q9
 2370 W = W + 1
 2380 GOTO 2190
 2390 IF LEFT$ (K$,1) < > "Y" THEN 2430
 2400 FOR Z5 = 1 TO A
 2410 PRINT F(Z5);G(Z5)
 2420 NEXT Z5
 2430 FOR W = 1 TO A
 2440 IF B(F(W),G(W)) = 3 THEN 2510
 2450 IF B(F(W),G(W)) = 2 THEN 2530
 2460 IF B(F(W),G(W)) = 1 THEN 2570
 2470 IF B(F(W),G(W)) = .5 THEN 2550
 2480 B(F(W),G(W)) = 10 + C
 2490 NEXT W
 2500 GOTO 950
 2510 PRINT "I HIT YOUR BATTLESHIP"
 2520 GOTO 2580
 2530 PRINT "I HIT YOUR CRUISER"
 2540 GOTO 2580
 2550 PRINT "I HIT YOUR DESTROYER<B>"
 2560 GOTO 2580
 2570 PRINT "I HIT YOUR DESTROYER<A>"
 2580 FOR Q = 1 TO 12
 2590 IF E(Q) < > - 1 THEN 2740
 2600 E(Q) = 10 + C
 2610 H(Q) = B(F(W),G(W))
 2620 M3 = 0
 2630 FOR M2 = 1 TO 12
 2640 IF H(M2) < > H(Q) THEN 2660
 2650 M3 = M3 + 1
 2660 NEXT M2
 2670 IF M3 < > INT (H(Q) + .5) + 1 + INT ( INT (H(Q) + .5) / 3) THEN 2480
 2680 FOR M2 = 1 TO 12
 2690 IF H(M2) < > H(Q) THEN 2720
 2700 E(M2) = - 1
 2710 H(M2) = - 1
 2720 NEXT M2
 2730 GOTO 2480
 2740 NEXT Q
 2750 PRINT "PROGRAM ABORT : "
 2760 FOR Q = 1 TO 12
 2770 PRINT "E(";Q;")=";E(Q)
 2780 PRINT "H(";Q;")=";H(Q)
 2790 NEXT Q
 2800 GOTO 3310
 2810 : REM ' ********USINGEARRAY
 2820 FOR R = 1 TO 10
 2830 FOR S = 1 TO 10
 2840 K(R,S) = 0
 2850 NEXT S
 2860 NEXT R
 2870 FOR U = 1 TO 12
 2880 IF E(U) < 10 THEN 3030
 2890 FOR R = 1 TO 10
 2900 FOR S = 1 TO 10
 2910 IF B(R,S) < 10 THEN 2940
 2920 K(R,S) = - 10000000
 2930 GOTO 3010
 2940 FOR M = SGN (1 - R) TO SGN (10 - R)
 2950 FOR N = SGN (1 - 2) TO SGN (10 - S)
 2960 IF N + M + N * M = 0 THEN 2990
 2970 IF B(R + M,S + N) < > E(U) THEN 2990
 2980 K(R,S) = K(R,S) + E(U) - S * INT (H(U) + .5)
 2990 NEXT N
 3000 NEXT M
 3010 NEXT S
 3020 NEXT R
 3030 NEXT U
 3040 FOR R = 1 TO A
 3050 F(R) = R
 3060 G(R) = R
 3070 NEXT R
 3080 FOR R = 1 TO 10
 3090 FOR S = 1 TO 10
 3100 Q9 = 1
 3110 FOR M = 1 TO A
 3120 IF K(F(M),G(M)) > = K(F(Q9),G(Q9)) THEN 3140
 3130 Q9 = M
 3140 NEXT M
 3150 IF R > A THEN 3170
 3160 IF R = S THEN 3240
 3170 IF K(R,S) < K(F(Q9),G(Q9)) THEN 3240
 3180 FOR M = 1 TO A
 3190 IF F(M) < > R THEN 3220
 3200 IF G(M) = S THEN 3240
 3210 NEXT M
 3220 F(Q9) = R
 3230 G(Q9) = S
 3240 NEXT S
 3250 NEXT R
 3260 GOTO 2390
 3270 PU = (5 - K) * 3 - 2 * INT (K / 4) + SGN (K - 1) - 1
 3280 RETURN 
 3290 PU = K + INT (K / 4) - SGN (K - 1)
 3300 RETURN 
 3310 PRINT "TO CONTINUE, HIT ANY KEY"
 3320 A$ = INKEY$ : IF A$ = ""THEN 3320
 3330 CLS : RETURN 
 3340 PRINT : PRINT : END 

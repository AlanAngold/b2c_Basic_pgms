# NOTE: Type forced to be:
# trs2 - TRS-80 Level II BASIC tokenized file
    5 INPUT "WOULD YOU LIKE INSTRUCTIONS";A$
    6 IF LEFT$ (A$,1) < > "N" THEN 3300
   10 CLEAR 900 : DEFINT I,J : RANDOM 
   20 Z$ = "    ": Q$ = "": FOR I = 1 TO 48 : Q$ = Q$ + Z$ : NEXT I
   30 DIM G(8,8),C(9,2),K(3,3),N(3),Z(8,8),D(8)
   40 T = ( RND (0) * 20 + 20) * 100 : T0 = T : T9 = 30 : D0 = 0 : E0 = 3000 : E = E0 : P = 10 : P0 = P
   50 S9 = 200 : S = 0 : Q1 = RND (8) : Q2 = RND (8) : S1 = RND (8) : S2 = RND (8)
   60 FOR I = 1 TO 9 : FOR J = 1 TO 2 : C(I,J) = 0 : NEXT J,I
   70 C(3,1) = - 1 : C(2,1) = - 1 : C(4,1) = - 1 : C(4,2) = - 1 : C(5,2) = - 1 : C(6,2) = - 1
   80 C(1,2) = 1 : C(2,2) = 1 : C(6,1) = 1 : C(7,1) = 1 : C(8,1) = 1 : C(8,2) = 1 : C(9,2) = 1
   90 FOR I = 1 TO 8 : D(I) = 0 : NEXT : A1$ = "NSLPTSDCX"
  100 D$ = "WARP ENGINESS.R. SENSORSL.R. SENSORSPHASER CNTRL"
  110 D$ = D$ + "PHOTON TUBESDAMAGE CNTRLSHIELD CNTRLCOMPUTER"
  120 G4$ = "III"
  130 G1$ = "ANTERES.SIRIUS.RIGEL.DENEB.PROCYON.CAPELLA.VEGA."
  140 G1$ = G1$ + "BETELGEUSSE.CANOPUS.ALDEBARAN.ALTAIR.REGULUS."
  150 G1$ = G1$ + "SAGITTARIUS.ARCTURUS.POLLUX.SPICA."
  160 B9 = 0 : K9 = 0
  170 FOR I = 1 TO 8 : FOR J = 1 TO 8 : R1 = RND (0) : IF R1 < = .8K3 = 0 : GOTO 200 
  180 IF R1 < = .95K3 = 1 : K9 = K9 + 1 : GOTO 200 
  190 IF R1 < = .98K3 = 2 : K9 = K9 + 2 : GOTO 200 : : ELSE K3 = 3 : K9 = K9 + 3
  200 IF RND (0) < = .96B3 = 0 : GOTO 210 : : ELSE B3 = 1 : B9 = B9 + 1
  210 S3 = RND (8) : G(I,J) = K3 * 100 + B3 * 10 + S3 : Z(I,J) = 0 : NEXT J,I
  220 K7 = K9 : X$ = "": X0$ = " IS ": IF B9 < > 0 THEN 250 
  230 B9 = 1 : IF G(6,3) < 200G(6,3) = G(6,3) + 100 : K9 = K9 + 1
  240 G(6,3) = G(6,3) + 10
  250 IF B9 < > 1X$ = "S" : X0$ = " ARE "
  260 PRINT "YOUR ORDERS ARE AS FOLLOWS : "
  270 PRINT "  DESTROY THE"K9"KLINGON WARSHIPS WHICH HAVE INVADED"
  280 PRINT " THE GALAXY BEFORE THEY CAN ATTACK FEDERATION HEADQUARTERS"
  290 PRINT " ON STARDATE"T0 + T9"THIS GIVES YOU"T9"DAYS.  THERE"X0$
  300 PRINT " "B9" STARBASE"X$" IN THE GALAXY FOR RESUPPLYING." : PRINT 
  310 INPUT "HIT 'ENTER' WHEN YOU ARE READY TO RESUME COMMAND---";A$
  320 Z4 = Q1 : Z5 = Q2 : K3 = 0 : B3 = 0 : S3 = 0 : G5 = 0 : D4 = .5 * RND (0)
  330 IF Q1 < 1 OR Q1 > 8 OR Q2 < 1 OR Q2 > 8 THEN 430 : ELSE GOSUB 3180 : PRINT 
  340 IF T < > T0 THEN 370 
  350 PRINT "YOUR MISSION BEGINS WITH YOUR STARSHIP LOCATED"
  360 PRINT "IN THE GALACTIC QUADRANT, "G2$ : GOTO 380 
  370 PRINT "NOW ENTERING "G2$" QUADRANT..."
  380 PRINT : X = G(Q1,Q2) * .01 : K3 = INT (X) : B3 = INT ((X - K3) * 10)
  390 S3 = G(Q1,Q2) - INT (G(Q1,Q2) * .1) * 10 : IF K3 = 0 THEN 420 
  400 PRINT "COMBAT AREA       CONDITION RED"
  410 IF S < = 200 PRINT "   SHIELDS DANGEROUSLY LOW"
  420 FOR I = 1 TO 3 : FOR J = 1 TO 3 : K(I,J) = 0 : NEXT J,I
  430 FOR I = 1 TO 3 : K(I,3) = 0 : NEXT : Q$ = "": FOR I = 1 TO 48 : Q$ = Q$ + Z$ : NEXT 
  440 A$ = "<*>" : Z1 = S1 : Z2 = S2 : GOSUB 3110 : IF K3 = 0 THEN 470 
  450 FOR I = 1 TO K3 : GOSUB 3090 : A$ = "+++" : Z1 = R1 : Z2 = R2 : GOSUB 3110 
  460 K(I,1) = R1 : K(I,2) = R2 : K(I,3) = S9 : NEXT I
  470 IF B3 = 0 THEN 500 
  480 FOR I = 1 TO B3 : GOSUB 3090 : A$ = ">!<" : Z1 = R1 : Z2 = R2 : GOSUB 3110 
  490 B4 = Z1 : B5 = Z2 : NEXT I
  500 IF S3 = 0 THEN 520 
  510 FOR I = 1 TO S3 : GOSUB 3090 : A$ = " * ": Z1 = R1 : Z2 = R2 : GOSUB 3110 : NEXT I
  520 GOSUB 2310 
  530 IF S + E < = 10 THEN 540 : : ELSE IF E > 10 OR D(7) > = 0 THEN 580 
  540 PRINT "**FATAL ERROR** YOU'VE JUST STRANDED YOUR SHIP"
  550 PRINT "IN SPACE!!  YOU HAVE INSUFFICIENT MANEUVERING ENERGY,"
  560 PRINT "AND SHIELD CONTROL IS PRESENTLY INCAPABLE OF"
  570 PRINT "CROSS-CICUITING TO ENGINE ROOM!" : GOTO 2210 
  580 INPUT "COMMAND";A$ : FOR I = 1 TO 9
  590 IF LEFT$ (A$,1) < > MID$ (A1$,I,1) THEN 620 : ELSE IF I < > 2 THEN 610 
  600 IF LEN (A$) < 2 THEN 610 : ELSE IF MID$ (A$,2,1) < > "R"I = 6
  610 ON I GOTO 690 , 520 , 1310 , 1390 , 1640 , 1920 , 1970 , 2550 , 2220 
  620 NEXT I : PRINT "ENTER ONE OF THE FOLLOWING : "
  630 PRINT "NAV (TO SET COURSE)" : PRINT "SRS (SHORT RANGE SENSOR SCAN)"
  640 PRINT "LRS (LONG RANGE SENSOR SCAN)" : PRINT "PHA (FIRES PHASERS)"
  650 PRINT "TOR (TO FIRE PHOTON TORPEDOES)"
  660 PRINT "SHE (TO RAISE OR LOWER SHIELDS)"
  670 PRINT "DAM (DAMAGE CONTROL REPORT)" : PRINT "COM (CALLS LIBRARY-COMPUTER)"
  680 PRINT "XXX (TO RESIGN YOUR COMMAND)" : PRINT : GOTO 530 
  690 INPUT "COURSE (1-9)";C1 : IF C1 > = 1 THEN 710 
  700 PRINT " LT. SULU REPORTS, 'INCORRECT COURSE DATA, SIR!'" : GOTO 530 
  710 IF C1 > = 9 IF C1 > 9 THEN 700 : ELSE C1 = 1
  720 INPUT "WARP FACTOR (0-8)";W1
  730 IF W1 > 0 IF W1 < = 8 THEN 760 
  740 PRINT " CHIEF ENGINEER SCOTT REPORTS 'THE ENGINES WON'T"
  750 PRINT "    TAKE WARP"W1"!'" : GOTO 530 
  760 IF D(1) > = 0 OR W1 < = .2 THEN 780 
  770 PRINT "WARP ENGINES DAMAGED.  MAXIMUM SPEED = WARP 0.2" : GOTO 690 
  780 N = INT (W1 * 8 + .5) : IF E - N > = 0 THEN 840 
  790 PRINT "ENGINEERING REPORTS 'INSUFFICIENT ENERGY AVAILABLE"
  800 PRINT "  FOR MANEUVERING AT WARP"W1"!'"
  810 IF S < N - E OR D(7) < 0 THEN 530 
  820 PRINT "DEFLECTOR CONTROL ROOM ACKNOLEGES"S" UNITS"
  830 PRINT "  OF ENERGY PRESENTLY DEPLOYED TO SHIELDS" : GOTO 1920 
  840 FOR I = 1 TO K3 : IF K(I,3) < = 0 THEN 870 
  850 A$ = "   ": Z1 = K(I,1) : Z2 = K(I,2) : GOSUB 3110 : GOSUB 3090 
  860 K(I,1) = Z1 : K(I,2) = Z2 : A$ = "+++" : GOSUB 3110 
  870 NEXT I : GOSUB 2090 : D1 = 0 : D6 = W1 : IF W1 > = 1D6 = 1
  880 FOR I = 1 TO 8 : IF D(I) > = 0 THEN 910 : ELSE D(I) = D(I) + D6
  890 IF D(I) < 0 THEN 910 : ELSE IF D1 < > 1D1 = 1 : PRINT "DAMAGE CONTROL REPORT : "
  900 PRINT TAB 8); : R1 = I : GOSUB 3140 : PRINT "REPAIR COMPLETED"
  910 NEXT I : IF RND (0) > .2 THEN 970 : ELSE R1 = RND (8)
  920 IF RND (0) > = .6 THEN 950 : ELSE D(R1) = D(R1) - RND (0) * 5 - 1
  930 PRINT : PRINT "DAMAGE CONTROL REPORT : "; : GOSUB 3140 : PRINT " DAMAGED" : PRINT 
  940 GOTO 970 
  950 D(R1) = D(R1) + RND (0) * 3 + 1 : PRINT : PRINT "DAMAGE CONTROL REPORT : ";
  960 GOSUB 3140 : PRINT "STATE OF REPAIR IMPROVED" : PRINT 
  970 A$ = "   ": Z1 = INT (S1) : Z2 = INT (S2) : GOSUB 3110 
  980 X1 = C(C1,1) + (C(C1 + 1,1) - C(C1,1)) * (C1 - INT (C1))
  990 X = S1 : Y = S2 : X2 = C(C1,2) + (C(C1 + 1,2) - C(C1,2)) * (C1 - INT (C1))
 1000 Q4 = Q1 : Q5 = Q2
 1010 FOR I = 1 TO N : S1 = S1 + X1 : S2 = S2 + X2
 1020 IF S1 < 1 OR S1 > = 9 OR S2 < 1 OR S2 > = 9 THEN 1110 
 1030 S8 = INT (S1) * 24 + INT (S2) * 3 - 26
 1040 IF MID$ (Q$,S8,3) = "   "THEN 1070 
 1050 S1 = INT (S1 - X1) : S2 = INT (S2 - X2) : PRINT "WARP ENGINES SHUT DOWN AT SECTOR"S1","S2
 1060 PRINT "DUE TO BAD NAVIGATION." : GOTO 1080 
 1070 NEXT I
 1080 A$ = "<*>" : Z1 = INT (S1) : Z2 = INT (S2) : GOSUB 3110 : GOSUB 1270 : T8 = 1
 1090 IF W1 < 1T8 = .1 * INT (10 * W1)
 1100 T = T + T8 : IF T > T0 + T9 THEN 2210 : ELSE GOTO 520 
 1110 X = 8 * Q1 + X + N * X1 : Y = 8 * Q2 + Y + N * X2 : Q1 = INT (X / 8) : Q2 = INT (Y / 8)
 1120 S1 = INT (X - Q1 * 8) : S2 = INT (Y - Q2 * 8) : IF S1 = 0Q1 = Q1 - 1 : S1 = 8
 1130 IF S2 = 0Q2 = Q2 - 1 : S2 = 8
 1140 X5 = 0 : IF Q1 < 1X5 = 1 : Q1 = 1 : S1 = 1
 1150 IF Q1 > 8X5 = 1 : Q1 = 8 : S1 = 8
 1160 IF Q2 < 1X5 = 1 : Q2 = 1 : S2 = 1
 1170 IF Q2 > 8X5 = 1 : Q2 = 8 : S2 = 8
 1180 IF X5 = 0 THEN 1250 
 1190 PRINT "LT. UHURA REPORTS MESSAGE FROM STARFLEET COMMAND : "
 1200 PRINT " 'PERMISSION TO ATTEMPT CROSSING OF GALACTIC PERIMETER"
 1210 PRINT " IS HERBY *DENIED*.  SHUT DOWN YOUR ENGINES.'"
 1220 PRINT "CHIEF ENGINEER SCOTT REPORTS 'WARP ENGINES SHUT DOWN"
 1230 PRINT "   AT SECTOR"S1","S2" OF QUADRANT "Q1","Q2;".'"
 1240 IF T > T0 + T9 THEN 2210 
 1250 IF 8 * Q1 + Q2 = 8 * Q4 + Q5 THEN 1080 
 1260 T = T + 1 : GOSUB 1270 : GOTO 320 
 1270 E = E - N - 10 : IF E > = 0 THEN 1300 
 1280 PRINT "SHIELD CONTROL SUPPLIED ENERGY TO COMPLETE THE MANEUVER."
 1290 S = S + E : E = 0 : IF S < 0S = 0
 1300 RETURN 
 1310 IF D(3) < 0 PRINT "LONG RANGE SENSORS ARE INOPERABLE" : GOTO 530 
 1320 PRINT "LONG RANGE SENSOR SCAN FOR QUADRANT"Q1","Q2
 1330 O1$ = "......................." : PRINT O1$ : FOR I = Q1 - 1 TO Q1 + 1
 1340 FOR I1 = 1 TO 3 : N(I1) = 0 : NEXT I1 : FOR J = Q2 - 1 TO Q2 + 1
 1350 IF I < 1 OR I > 8 OR J < 1 OR J > 8 THEN 1370 
 1360 N(J - Q2 + 2) = G(I,J) : Z(I,J) = G(I,J)
 1370 NEXT J : PRINT LLIST " :  ###  :  ###  :  ###  : ";N(1),N(2),N(3)
 1380 PRINT O1$ : NEXT I : GOTO 530 
 1390 IF K3 > 0 THEN 1420 
 1400 PRINT "SCIENCE OFFICER SPOCK REPORTS 'SENSORS SHOW"
 1410 PRINT "  NO ENEMY SHIPS IN THIS QUADRANT.'" : GOTO 530 
 1420 IF D(4) < 0 PRINT "PHASERS INOPERATIVE" : GOTO 530 
 1430 IF D(8) < 0 PRINT "COMPUTER FAILURE HAMPERS ACCUARCY"
 1440 PRINT "PHASERS LOCKED ON TARGET"
 1450 PRINT "ENERGY AVAILABLE ="E
 1460 FOR I = 1 TO 3 : IF K(I,3) < = 0 THEN 1480 
 1470 GOSUB 3290 : PRINT I" ENERGY NEED"K(I,3) * ZZ / 3" TO"K(I,3) * ZZ / 2
 1480 NEXT I
 1490 INPUT "NUMBER OF UNITS TO FIRE : ";X : IF X < = 0 THEN 530 
 1500 IF E - X < 0 THEN 1450 : ELSE E = E - X : GOSUB 2090 
 1510 IF D(7) < 0X = X * RND (0)
 1520 H1 = INT (X / K3) : FOR I = 1 TO 3 : IF K(I,3) < = 0 THEN 1630 
 1530 GOSUB 3290 : H = INT ((H1 / ZZ) * ( RND (0) + 2))
 1540 IF H > .15 * K(I,3) THEN 1560 : ELSE PRINT "SENSORS SHOW NO DAMAGE"
 1550 PRINT "   TO ENEMY AT"K(I,1)","K(I,2) : GOTO 1630 
 1560 K(I,3) = K(I,3) - H
 1570 PRINT H"UNIT HIT ON KLINGON AT SECTOR"K(I,1)","K(I,2)
 1580 IF K(I,3) < = 0 THEN 1600 
 1590 PRINT "   (SENSORS SHOW"K(I,3)"UNITS REMAINING)" : GOTO 1630 
 1600 PRINT "***KLINGON DESTROYED***"
 1610 K3 = K3 - 1 : K9 = K9 - 1 : A$ = "   ": Z1 = K(I,1) : Z2 = K(I,2)
 1620 GOSUB 3110 : G(Q1,Q2) = K3 * 100 + B3 * 10 + S3 : Z(Q1,Q2) = G(Q1,Q2) : IF K9 < = 0 THEN 2280 
 1630 NEXT I : GOTO 530 
 1640 IF D(5) < 0 PRINT "PHOTON TUBES ARE NOT OPERATING" : GOTO 530 
 1650 IF P < = 0 PRINT "ALL PHOTON TORPEDOES EXPENDED" : GOTO 530 
 1660 INPUT "TORPODO COURSE (1-9)";C1 : IF C1 > = 1 THEN 1680 
 1670 PRINT "ENSIGN CHEKOV REPORTS--INCORRECT COURSE DATA SIR" : GOTO 530 
 1680 IF C1 > 9 THEN 1670 : ELSE IF C1 < 9 THEN 1690 : ELSE IF C1 > = 9 THEN 1660 : ELSE C1 = 1
 1690 X1 = C(C1,1) + (C(C1 + 1,1) - C(C1,1)) * (C1 - INT (C1))
 1700 X2 = C(C1,2) + (C(C1 + 1,2) - C(C1,2)) * (C1 - INT (C1))
 1710 E = E - 2 : X = S1 : Y = S2 : P = P - 1 : PRINT "TORPEDO TRACK : "
 1720 X = X + X1 : Y = Y + X2 : X3 = INT (X + .5) : Y3 = INT (Y + .5)
 1730 IF X3 < 1 OR X3 > = 9 OR Y3 < 1 OR Y3 > = 9 THEN 1900 
 1740 PRINT TAB 15)X3","Y3 : A$ = "   ": Z1 = X : Z2 = Y : GOSUB 3150 : IF Z3 < > 0 THEN 1720 
 1750 A$ = "+++" : Z1 = X : Z2 = Y : GOSUB 3150 : IF Z3 = 0 THEN 1800 
 1760 PRINT "*** KLINGON DESTROYED ***" : K3 = K3 - 1 : K9 = K9 - 1 : IF K9 < = 0 THEN 2280 
 1770 FOR I = 1 TO 3 : IF X3 = K(I,1) IF Y3 = K(I,2) THEN 1790 
 1780 NEXT I
 1790 K(I,3) = 0 : GOTO 1890 
 1800 A$ = " * ": Z1 = X : Z2 = Y : GOSUB 3150 : IF Z3 = 0 THEN 1820 
 1810 PRINT "STAR AT"X3","Y3" ABSORBED TORPEDO ENERGY." : GOTO 1910 
 1820 A$ = ">!<" : Z1 = X : Z2 = Y : GOSUB 3150 : IF Z3 = 0 THEN 1660 
 1830 PRINT "*** STARBASE DESTROYED***" : B3 = B3 - 1 : B9 = B9 - 1 : IF B9 > 0 THEN 1870 
 1840 PRINT "THAT DOES IT CAPTAIN!!  YOU ARE HEREBY RELIEVED OF COMMAND"
 1850 PRINT "  AND SENTENCED TO 99 STARDATES AT HARD LABOR ON CYGNUS 12"
 1860 GOTO 2220 
 1870 PRINT "STARFLEET COMMAND IS REVIEWING YOU RECORD"
 1880 PRINT "   TO CONSIDER COURT MARTIAL" : D0 = 0
 1890 A$ = "   ": Z1 = X : Z2 = Y : GOSUB 3110 : G(Q1,Q2) = K3 * 100 + B3 * 10 + S3 : Z(Q1,Q2) = G(Q1,Q2) : GOTO 1910 
 1900 PRINT "TORPEDO MISSED"
 1910 GOSUB 2090 : GOTO 530 
 1920 IF D(7) < 0 PRINT "SHIELD CONTROL INOPERABLE" : GOTO 530 
 1930 PRINT "ENERGY AVAILABLE ="E + S".  NUMBER OF UNITS TO SHIELDS";
 1940 INPUT X : IF X < 0 IF S = X PRINT "(SHIELDS UNCHANGED)" : GOTO 530 
 1950 IF E + S - X < 0 THEN 1930 : ELSE E = E + S - X : S = X : PRINT "DEFLECTOR CONTROL ROOM REPORT : "
 1960 PRINT "  'SHIELDS NOW AT"S" PER YOUR COMMAND'" : GOTO 530 
 1970 IF D(6) > = 0 THEN 2070 
 1980 PRINT "DAMAGE CONTROL REPORT NOT AVAILABLE"
 1990 IF D0 = 0 THEN 530 
 2000 D3 = 0 : FOR I = 1 TO 8 : IF D(I) < 0 THEN D3 = D3 + .1
 2010 NEXT I : IF D3 = 0 THEN 530 : ELSE D3 = D3 + D4 : IF D3 > = 1D3 = .9
 2020 PRINT "TECHNITIANS STANDING BY TO EFFECT REPAIRS TO YOUR SHIP;"
 2030 PRINT "ESTIMATED TIME TO REPAIR : ";
 2040 PRINT LLIST ".# STARDATES";D3 : INPUT "WILL YOU AUTHORIZE REPAIR (Y/N)";A$
 2050 IF LEFT$ (A$,1) < > "Y" THEN 530 
 2060 FOR I = 1 TO 8 : D(I) = 0 : NEXT I : T = T + D3 + .1
 2070 PRINT : PRINT "DEVICE      STATE OF REPAIR" : FOR R1 = 1 TO 8 : GOSUB 3140 
 2080 PRINT LLIST "  ##.##";D(R1) : NEXT R1 : PRINT : GOTO 1990 
 2090 IF K3 < = 0 THEN 2190 : ELSE IF D0 < > 0 PRINT "STAR BASE SHIELDS PROTECT YOU" : GOTO 2190 
 2100 FOR I = 1 TO 3 : IF K(I,3) < = 0 THEN 2180 : ELSE GOSUB 3290 
 2110 H = INT ((K(I,3) / ZZ) * (2 + RND (0))) : S = S - H
 2120 PRINT H"UNIT HIT ON THE ENTERPRISE FROM SECTOR"K(I,1)","K(I,2)
 2130 IF S < 0 THEN 2200 : ELSE PRINT "     (SHIELDS DOWN TO"S" UNITS)"
 2140 IF H < 20 OR RND (0) > .6 OR H / S < = .02 THEN 2180 
 2150 D2 = H / S + .5 * RND (0) : R1 = RND (8) : D(R1) = D(R1) - D2
 2160 PRINT "DAMAGE CONTROL REPORTS '"; : GOSUB 3140 
 2170 PRINT "DAMAGED BY THE HIT!'"
 2180 NEXT I
 2190 RETURN 
 2200 PRINT : PRINT "THE ENTERPRISE HAS BEEN DESTROYED.  THE FEDERATION WILL BE CONQUERED"
 2210 PRINT "IT IS STARDATE"T"."
 2220 PRINT "THERE WERE"K9" KLINGON BATTLE CRUISERS LEFT"
 2230 PRINT "AT THE END OF YOUR MISSION"
 2240 PRINT : PRINT : PRINT "THE FEDERATION IS IN NEED OF A NEW STARSHIP COMMANDER"
 2250 PRINT "FOR A SIMILAR MISSION -- IF THERE IS A VOLUNTEER,"
 2260 PRINT "LET HIM STEP FORWARD AND ENTER 'AYE'.";
 2270 INPUT A$ : IF A$ = "AYE" THEN RUN : ELSE GOTO 3270 
 2280 PRINT "CONGRATULATIONS, CAPTAIN!  THE LAST KLINGON BATTLE"
 2290 PRINT "  CRUISER MENACING THE FEDERATION HAS BEEN DESTROYED."
 2300 PRINT : PRINT "YOUR EFFICIENCY RATING IS"((K7 / (T - T0)) * 1000) : GOTO 2240 
 2310 FOR XI = S1 - 1 TO S1 + 1 : I = XI + .5 : FOR XJ = S2 - 1 TO S2 + 1 : J = XJ + .5
 2320 IF I < 1 OR I > 8 OR J < 1 OR J > 8 THEN 2340 
 2330 A$ = ">!<" : Z1 = XI : Z2 = XJ : GOSUB 3150 : IF Z3 = 1 THEN 2350 
 2340 NEXT XJ,XI : D0 = 0 : GOTO 2370 
 2350 D0 = 1 : C$ = "DOCKED" : E = 3000 : P = 10
 2360 PRINT "SHIELDS DROPPED FOR DOCKING PURPOSES" : S = 0 : GOTO 2400 
 2370 IF K3 > 0C$ = "**RED**" : GOTO 2400 
 2380 IF E < E0 * .1C$ = "YELLOW" : GOTO 2400 
 2390 C$ = "GREEN"
 2400 IF D(2) > = 0 THEN 2420 
 2410 PRINT : PRINT "*** SHORT RANGE SENSORS ARE OUT ***" : PRINT : GOTO 2540 
 2420 O1$ = "--1--2--3--4--5--6--7--8----------" : PRINT O1$
 2430 N5$ = "####" : PRINT "1"; MID$ (Q$,1,24) : PRINT "2"; MID$ (Q$,25,24);
 2440 PRINT "        STARDATE      "; : PRINT LLIST "####.# ##.#";T,T0 + T9 - T
 2450 PRINT "3" MID$ (Q$,49,24); : PRINT "        CONDITION      ";C$;K9"K"
 2460 PRINT "4" MID$ (Q$,73,24); : PRINT "        QUADRANT      "Q1","Q2
 2470 PRINT "5" MID$ (Q$,97,24)"        SECTOR        "S1","S2
 2480 PRINT "6" MID$ (Q$,121,24)"        TOTAL ENERGY    ";
 2490 PRINT LLIST N5$;E + S; : PRINT " 4  3  2"
 2500 PRINT "7" MID$ (Q$,145,24)"        PHOTON TORPEDOES";
 2510 PRINT LLIST N5$;P; : PRINT " 5  X  1"
 2520 PRINT "8" MID$ (Q$,169,24)"        SHIELDS         ";
 2530 PRINT LLIST N5$;S; : PRINT " 6  7  8" : PRINT O1$
 2540 RETURN 
 2550 IF D(8) < 0 PRINT "COMPUTER DISABLED" : GOTO 530 
 2560 INPUT "COMPUTER ACTIVE AND AWAITING COMMAND : ";A : IF A < 0 THEN 530 
 2570 PRINT : H8 = 1
 2580 ON A + 1 GOTO 2670 , 2780 , 2850 , 3060 , 2870 , 2600 
 2590 GOTO 2610 
 2600 H8 = 0 : G5 = 1 : PRINT TAB 15)"THE GALAXY" : GOTO 2680 
 2610 PRINT "FUNCTIONS AVAILABLE FROM LIBRARY-COMPUTER : "
 2620 PRINT "  0-CUMULATIVE GALACTIC RECORD"
 2630 PRINT "  1-STATUS REPORT" : PRINT "  2-PHOTON TORPEDO DATA"
 2640 PRINT "  3-STARBASE NAV DATA"
 2650 PRINT "  4-DIRECTION/DISTANCE CALCULATOR"
 2660 PRINT "  5-GALAXY 'REGION NAME' MAP" : GOTO 2560 
 2670 PRINT "COMPUTER RECORD OF GALAXY FOR QUADRANT"Q1","Q2" : "
 2680 PRINT "     1     2     3     4     5     6     7     8"
 2690 O3$ = "   ----- ----- ----- ----- ----- ----- ----- -----"
 2700 PRINT O3$ : N1$ = "#" : FOR I = 1 TO 8 : PRINT LLIST N1$;I;
 2710 IF H8 = 0 THEN 2740 : ELSE FOR J = 1 TO 8 : N$ = "": N2$ = "   ###" : IF I < > Q1 OR J < > Q2 THEN 2730 
 2720 N$ = "	<" : N2$ = "  ###"
 2730 PRINT LLIST N2$;Z(I,J), : PRINT N$; : NEXT J : GOTO 2770 
 2740 Z4 = I : Z5 = 1 : GOSUB 3180 : J0 = INT (15 - .5 * LEN (G2$))
 2750 PRINT TAB J0)G2$; : Z5 = 5 : GOSUB 3180 : J0 = INT (39 - .5 * LEN (G2$))
 2760 PRINT TAB J0)G2$;
 2770 PRINT : NEXT I : GOTO 530 
 2780 PRINT "  STATUS REPORT : ": X$ = "": IF K9 < > 1X$ = "S"
 2790 PRINT K9" KLINGON"X$" LEFT" : V5 = (T0 + T9) - T
 2800 PRINT LLIST "MISSION MUST BE COMPLETED IN ##.# STARDATES";V5
 2810 X$ = "": IF B9 = 1 THEN 2840 : ELSE X$ = "S" : IF B9 < > 0 THEN 2840 
 2820 PRINT "YOUR STUPIDITY HAS LEFT YOU ON YOUR OWN IN"
 2830 PRINT "  THE GALAXY -- YOU HAVE NO STARBASES LEFT : ": GOTO 1970 
 2840 PRINT "THE FEDERATION IS MAINTAINING"B9" STARBASE"X$ : GOTO 1970 
 2850 H8 = 0 : FOR I = 1 TO 3 : IF K(I,3) < = 0 THEN 3050 : ELSE W1 = K(I,1) : X = K(I,2)
 2860 C1 = S1 : A = S2 : GOTO 2910 
 2870 PRINT "DIRECTION/DISTANCE CALCULATOR : "
 2880 PRINT "YOU ARE AT QUADRANT("Q1","Q2") SECTOR ("S1","S2")"
 2890 PRINT "PLEASE ENTER --" : INPUT " INTIAL COORDINATES (X,Y)";C1,A
 2900 INPUT " FINAL COORDINATES (X,Y)";W1,X
 2910 X = X - A : A = C1 - W1 : IF X < 0 THEN 2970 : ELSE IF A < 0 THEN 3000 
 2920 IF X > 0 THEN 2930 : ELSE IF A = 0 THEN 2980 
 2930 C1 = 1
 2940 IF ABS (A) < = ABS (X) THEN 2960 
 2950 V5 = C1 + ((( ABS (A) - ABS (X)) + ABS (A)) / ABS (A)) : PRINT "DIRECTION="V5 : GOTO 3040 
 2960 PRINT "DIRECTION="C1 + ABS (A) / ABS (X) : GOTO 3040 
 2970 IF A > 0 THEN 2990 : ELSE IF X = 0 THEN 3000 
 2980 C1 = 5 : GOTO 2940 
 2990 C1 = 3 : GOTO 3010 
 3000 C1 = 7
 3010 IF ABS (A) > = ABS (X) THEN 3030 
 3020 PRINT "DIRECTION="C1 + ((( ABS (X) - ABS (A)) + ABS (X)) / ABS (X)) : GOTO 3040 
 3030 PRINT "DIRECTION="C1 + ( ABS (X) / ABS (A))
 3040 PRINT "DISTANCE=" SQR (A ^ 2 + X ^ 2) : IF H8 = 1 THEN 530 
 3050 NEXT I : GOTO 530 
 3060 IF B3 < > 0 THEN 3080 
 3070 PRINT "MR. SPOCK REPORTS, 'SENSORS SHOW NO STARBASES IN THIS QUADRANT"
 3080 PRINT "FROM ENTERPRISE TO STARBASE : ": W1 = B4 : X = B5 : GOTO 2860 
 3090 R1 = RND (8) : R2 = RND (8) : A$ = "   ": Z1 = R1 : Z2 = R2 : GOSUB 3150 
 3100 IF Z3 = 0 THEN 3090 : ELSE RETURN 
 3110 S8 = INT (Z1 + .5) * 24 + INT (Z2 + .5) * 3 - 26
 3120 Q$ = LEFT$ (Q$,S8 - 1) + A$ + RIGHT$ (Q$,190 - S8)
 3130 RETURN 
 3140 S8 = R1 * 12 - 11 : PRINT MID$ (D$,S8,12), : RETURN 
 3150 Z1 = INT (Z1 + .5) : Z2 = INT (Z2 + .5) : S8 = Z1 * 24 + Z2 * 3 - 26 : Z3 = 0
 3160 IF MID$ (Q$,S8,3) = A$Z3 = 1
 3170 RETURN 
 3180 L2 = 2 : IF Z5 < 5L2 = 1
 3190 L3 = 2 * (Z4 - 1) + L2 : I3 = 1 : I0 = 1 : FOR L = 1 TO LEN (G1$)
 3200 IF MID$ (G1$,L,1) = "." IF I3 = L3 THEN 3220 : ELSE I0 = L + 1 : I3 = I3 + 1
 3210 NEXT L
 3220 G2$ = MID$ (G1$,I0,L - I0) : IF G5 = 1 THEN 3260 
 3230 L3 = Z5 : IF Z5 > 4L3 = Z5 - 4
 3240 G3$ = "IV" : IF L3 < > 4G3$ = LEFT$ (G4$,L3)
 3250 G2$ = G2$ + " "+ G3$
 3260 RETURN 
 3270 STOP 
 3280 END 
 3290 ZZ = SQR ((K(I,1) - S1) ^ 2 + (K(I,2) - S2) ^ 2) : RETURN 

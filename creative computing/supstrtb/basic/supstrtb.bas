# NOTE: Type forced to be:
# trs2 - TRS-80 Level II BASIC tokenized file
   10 REM SUPER STAR TREK
   20 CLS 
   30 PRINT @210,"S U P E R  S T A R  T R E K"
   40 PRINT : PRINT 
   50 CLEAR 600
   60 Z$ = "                      "
   70 DIM G(8,8),C(9,2),K(3,3),N(3),Z(8,8),D(8) : RANDOM 
   80 T = INT ( RND (0) * 20 + 20) * 100 : T0 = T : T9 = 25 + INT ( RND (0) * 10) : D0 = 0 : E = 3000 : E0 = E
   90 P = 10 : P0 = P : S9 = 200 : S = 0 : B9 = 0 : K9 = 0 : X$ = " ": X0$ = " IS "
  100 Q1 = RND (8) : Q2 = RND (8) : S1 = RND (8) : S2 = RND (8)
  110 FOR I = 1 TO 9 : C(I,1) = 0 : C(I,2) = 0 : NEXT I
  120 C(3,1) = - 1 : C(2,1) = - 1 : C(4,1) = - 1 : C(4,2) = - 1 : C(5,2) = - 1 : C(6,2) = - 1
  130 C(1,2) = 1 : C(2,2) = 1 : C(6,1) = 1 : C(7,1) = 1 : C(8,1) = 1 : C(8,2) = 1 : C(9,2) = 1
  140 FOR I = 1 TO 8 : D(I) = 0 : NEXT I
  150 A1$ = "NAVSRSLRSPHATORSHEDAMCOMXXX"
  160 FOR I = 1 TO 8 : FOR J = 1 TO 8 : K3 = 0 : Z(I,J) = 0 : R1 = RND (0)
  170 IF R1 > .98 THEN K3 = 3 : K9 = K9 + 3 : GOTO 200
  180 IF R1 > .95 THEN K3 = 2 : K9 = K9 + 2 : GOTO 200
  190 IF R1 > .8 THEN K3 = 1 : K9 = K9 + 1
  200 B3 = 0 : IF RND (0) > .96 THEN B3 = 1 : B9 = B9 + 1
  210 G(I,J) = K3 * 100 + B3 * 10 + RND (8) : NEXT J : NEXT I : IF K9 > T9 THEN T9 = K9 + 1
  220 IF B9 < > 0 THEN 250
  230 IF G(Q1,Q2) < 200 THEN G(Q1,Q2) = G(Q1,Q2) + 100 : K9 = K9 + 1
  240 B9 = 1 : G(Q1,Q2) = G(Q1,Q2) + 10 : Q1 = RND (8) : Q2 = RND (8)
  250 K7 = K9 : IF B9 < > 1 THEN X$ = "S" : X0$ = " ARE "
  260 PRINT "YOUR ORDERS ARE AS FOLLOWS : "
  270 PRINT "   DESTROY THE";K9;"KLINGON WARSHIPS WHICH HAVE INVADED"
  280 PRINT "   THE GALAXY BEFORE THEY CAN ATTACK FEDERATION HEADQUARTERS"
  290 PRINT "   ON STARDATE";T0 + T9;"  THIS GIVES YOU";T9;"DAYS.   THERE";X0$
  300 PRINT "  ";B9;"STARBASE";X$;" IN THE GALAXY FOR RESUPPLYING YOUR SHIP"
  310 PRINT : INPUT "ENTER YOUR NAME IN THE CAPTAIN'S LOG";NA$
  320 Z4 = Q1 : Z5 = Q2 : K3 = 0 : B3 = 0 : S3 = 0 : G5 = 0 : D4 = .5 * RND (0) : Z(Q1,Q2) = G(Q1,Q2)
  330 IF Q1 < 1 OR Q1 > 8 OR Q2 < 1 OR Q2 > 8 THEN 400
  340 REM 
  350 FOR I = 1 TO 1500 : NEXT I : K3 = INT (G(Q1,Q2) * .01) : B3 = INT (G(Q1,Q2) * .1) - 10 * K3
  360 S3 = G(Q1,Q2) - 100 * K3 - 10 * B3 : IF K3 = 0 THEN 390
  370 CLS : PRINT @396,"COMBAT AREA      CONDITION RED" : IF S > 200 THEN 390
  380 PRINT @463,"SHIELDS DANGEROUSLY LOW"
  390 FOR I = 1 TO 3 : K(I,1) = 0 : K(I,2) = 0 : NEXT I
  400 FOR I = 1 TO 3 : K(I,3) = 0 : NEXT I : Q$ = Z$ + Z$ + Z$ + Z$ + Z$ + Z$ + Z$ + LEFT$ (Z$,17)
  410 A$ = "<*>" : Z1 = S1 : Z2 = S2 : GOSUB 3390 : IF K3 < 1 THEN 440
  420 FOR I = 1 TO K3 : GOSUB 3370 : A$ = "+K+" : Z1 = R1 : Z2 = R2
  430 GOSUB 3390 : K(I,1) = R1 : K(I,2) = R2 : K(I,3) = S9 * (.5 + RND (0)) : NEXT I
  440 IF B3 < 1 THEN 460
  450 GOSUB 3370 : A$ = ">!<" : Z1 = R1 : B4 = R1 : Z2 = R2 : B5 = R2 : GOSUB 3390
  460 FOR I = 1 TO S3 : GOSUB 3370
  470 A$ = " * "
  480 Z1 = R1
  490 Z2 = R2
  500 GOSUB 3390
  510 NEXT I
  520 GOSUB 2490
  530 IF S + E > 10 THEN IF E > 10 OR D(7) = 0 THEN 580
  540 CLS : PRINT @320,"CAPTIAN ";NA$;"!. YOU'VE JUST STRANDED YOUR SHIP IN SPACE!"
  550 PRINT "YOU HAVE INSUFFICIENT MANEUVERING ENERGY,";
  560 PRINT " AND SHIELD CONTROL" : PRINT "IS PRESENTLY INCAPABLE OF CROSS";
  570 PRINT "-CURCUITING TO ENGINE ROOM!!" : GOTO 2340
  580 PRINT "YOUR ORDERS, CAPTAIN ";NA$; : INPUT A$
  590 FOR I = 1 TO 9 : IF LEFT$ (A$,3) < > MID$ (A1$,3 * I - 2,3) THEN 610
  600 ON I GOTO 710,520,1340,1420,1620,1970,2060,2720,2370
  610 NEXT I : CLS : PRINT "ENTER ONE OF THE FOLLOWING : "
  620 PRINT " NAV  (TO SET COURSE)"
  630 PRINT " SRS  (FOR SHORT RANGE SENSOR SCAN)"
  640 PRINT " LRS  (FOR LONG RANGE SENSOR SCAN)"
  650 PRINT " PHA  (TO FIRE PHASERS)"
  660 PRINT " TOR  (TO FIRE PHOTON TORPEDOES)"
  670 PRINT " SHE  (TO RAISE OR LOWER SHIELDS)"
  680 PRINT " DAM  (FOR DAMAGE CONTROL REPORTS)"
  690 PRINT " COM  (TO CALL ON LIBRARY-COMPUTER)"
  700 PRINT " XXX  (TO RESIGN YOUR COMMAND)" : PRINT : GOTO 530
  710 INPUT "COURSE (0-9)";C1 : IF C1 = 9 THEN C1 = 1
  720 IF C1 > = 1 AND C1 < 9 THEN 740
  730 PRINT "  LT. SULU REPORTS, 'INCORRECT COURSE DATA, SIR!'" : GOTO 530
  740 X$ = "8" : IF D(1) < 0 THEN X$ = "0.2"
  750 PRINT "WARP FACTOR (0-";X$;")"; : INPUT W1 : IF D(1) < 0 AND W1 > .2 THEN 790
  760 IF W1 > 0 AND W1 < = 8 THEN 800
  770 IF W1 = 0 THEN 530
  780 PRINT "  CHIEF ENGINEER SCOTT REPORTS 'THE ENGINES WON'T TAKE WARP;""W1;" : REM ' " : GOTO590
  790 PRINT "WARP ENGINES ARE DAMAGED.  MAXIMUM SPEED = WARP 0.2" : GOTO 530
  800 N = INT (W1 * 8 + .5) : IF E - N > = 0 THEN 870
  810 PRINT "ENGINEERING REPORTS  'INSUFFICIENT ENERGY AVAILABLE"
  820 PRINT TAB 23)"FOR MANEUVERING AT WARP";W1;"'"
  830 IF S < N - E OR D(7) < 0 THEN 530
  840 PRINT "DEFLECTOR CONTROL ROOM ACKNOWLEDGES";S;"UNITS OF ENERGY"
  850 PRINT TAB 23)"PRESENTLY DEPLOYED TO SHIELDS."
  860 GOTO 530
  870 FOR I = 1 TO K3 : IF K(I,3) = 0 THEN 900
  880 A$ = "   ": Z1 = K(I,1) : Z2 = K(I,2) : GOSUB 3390 : GOSUB 3370
  890 K(I,1) = Z1 : K(I,2) = Z2 : A$ = "+K+" : GOSUB 3390
  900 NEXT I : GOSUB 2210 : D1 = 0 : D6 = W1 : IF W1 > = 1 THEN D6 = 1
  910 FOR I = 1 TO 8 : IF D(I) > = 0 THEN 960
  920 D(I) = D(I) + D6 : IF D(1) > - .1 AND D(I) < 0 THEN D(I) = - .1 : GOTO 960
  930 IF D(I) < 0 THEN 960
  940 IF D1 < > 1 THEN D1 = 1 : PRINT "DAMAGE CONTROL REPORT : "
  950 PRINT TAB 8); : R1 = I : GOSUB 3440 : PRINT G2$;" REPAIR COMPLETED."
  960 NEXT I : IF RND (0) > .2 THEN 1020
  970 R1 = RND (8) : IF RND (0) > = .6 THEN 1000
  980 D(R1) = D(R1) - ( RND (0) * 5 + 1) : PRINT "DAMAGE CONTROL REPORT : ";
  990 GOSUB 3440 : PRINT G2$;"DAMAGED" : PRINT : GOTO 1020
 1000 D(R1) = D(R1) + RND (0) * 3 + 1 : PRINT "DAMAGE CONTROL REPORT"
 1010 GOSUB 3440 : PRINT G2$;" STATE OF REPAIR IMPROVED" : PRINT 
 1020 A$ = "   ": Z1 = INT (S1) : Z2 = INT (S2) : GOSUB 3390
 1030 X1 = C(C1,1) + (C(C1 + 1,1) - C(C1,1)) * (C1 - INT (C1)) : X = S1 : Y = S2
 1040 X2 = C(C1,2) + (C(C1 + 1,2) - C(C1,2)) * (C1 - INT (C1)) : Q4 = Q1 : Q5 = Q2
 1050 FOR I = 1 TO N : S1 = S1 + X1 : S2 = S2 + X2 : IF S1 < 1 OR S1 > = 9 OR S2 < 1 OR S2 > = 9 THEN 1140
 1060 S8 = INT (S1) * 24 + INT (S2) * 3 - 26 : IF MID$ (Q$,S8,2) = "  "THEN 1090
 1070 S1 = INT (S1 - X1) : S2 = INT (S2 - X2) : PRINT "WARP ENGINE SHUTDOWN AT";
 1080 PRINT "SECTOR";S1;", ";S2;"DO TO BAD NAVIGATION" : GOTO 1100
 1090 NEXT I : S1 = INT (S1) : S2 = INT (S2)
 1100 A$ = "<*>" : Z1 = INT (S1) : Z2 = INT (S2) : GOSUB 3390 : GOSUB 1300 : T8 = 1
 1110 IF W1 < 1 THEN T8 = .1 * INT (10 * W1)
 1120 T = T + T8 : IF T > T0 + T9 THEN 2340
 1130 GOTO 520
 1140 X = 8 * Q1 + X + N * X1 : Y = 8 * Q2 + Y + N * X2 : Q1 = INT (X / 8) : Q2 = INT (Y / 8) : S1 = INT (X - Q1 * 8)
 1150 S2 = INT (Y - Q2 * 8) : IF S1 = 0 THEN Q1 = Q1 - 1 : S1 = 8
 1160 IF S2 = 0 THEN Q2 = Q2 - 1 : S2 = 8
 1170 X5 = 0 : IF Q1 < 1 THEN X5 = 1 : Q1 = 1 : S1 = 1
 1180 IF Q1 > 8 THEN X5 = 1 : Q1 = 8 : S1 = 8
 1190 IF Q2 < 1 THEN X5 = 1 : Q2 = 1 : S2 = 1
 1200 IF Q2 > 8 THEN X5 = 1 : Q2 = 8 : S2 = 8
 1210 IF X5 = 0 THEN 1280
 1220 PRINT "LT. UHURA REPORTS MESSAGE FROM STARFLEET COMMAND : "
 1230 PRINT "PERMISSION TO ATTEMPT CROSSING OF GALACTIC PERIMETER"
 1240 PRINT "  IS HEREBY *DENIED*. SHUTDOWN YOUR ENGINES"
 1250 PRINT "CHIEF ENGINEER SCOTT REPORTS, WARP ENGINES SHUT DOWN"
 1260 PRINT "AT SECTOR";S1;",";S2;"OF QUADRANT";Q1;",";Q2;"."
 1270 IF T > T0 + T9 THEN 2340
 1280 IF 8 + Q1 + Q2 = 8 + Q4 + Q5 THEN 1100
 1290 T = T + 1 : GOSUB 1300 : GOTO 320
 1300 E = E - N - 10 : IF E > 0 THEN RETURN 
 1310 PRINT "SHIELD CONTROL SUPPLIES ENERGY TO COMPLETE THE MANEUVER"
 1320 S = S + E : E = 0 : IF S < 0 THEN S = 0
 1330 RETURN 
 1340 IF D(3) < 0 THEN PRINT "LONG RANGE SENSORS ARE INOPERABLE" : GOTO 530
 1350 IF D < 3 > < 0 THEN PRINT "LONG RANGE FOR QUADRANT" ;Q1;",";Q2
 1360 O1$ = "--------------------" : PRINT O1$
 1370 FOR I = Q1 - 1 TO Q1 + 1 : N(1) = - 1 : N(2) = - 2 : N(3) = - 3 : FOR J = Q2 - 1 TO Q2 + 1
 1380 IF I > 0 AND I < 9 AND J > 0 AND J < 9 THEN N(J - Q2 + 2) = G(I,J) : Z(I,J) = G(I,J)
 1390 NEXT J : FOR L = 1 TO 3 : PRINT " :  "; : IF N(L) < 0 THEN PRINT "*** "; : GOTO 1410
 1400 PRINT RIGHT$ ( STR$ (N(L) + 1000),3);" ";
 1410 NEXT L : PRINT " : ": PRINT O1$ : NEXT I : GOTO 530
 1420 CLS : PRINT : IF D(4) < 0 THEN PRINT "PHASERS INOPERATIVE" : GOTO 530
 1430 IF K3 > 0 THEN 1460
 1440 PRINT "SCIENCE OFFICER SPOCK REPORTS ' SENSORS SHOW NO ENEMY SHIPS"
 1450 PRINT TAB 32)"IN THIS QUADRANT '" : GOTO 530
 1460 IF D(8) < 0 THEN PRINT "COMPUTER FAILURE HAMPERS ACCURACY"
 1470 PRINT "PHASERS LOCKED ON TARGET;  ";
 1480 PRINT "ENERGY AVAILABLE =";E;"UNITS"
 1490 INPUT "NUMBER OF UNITS TO FIRE";X : IF X < = 0 THEN 530
 1500 IF E - X < 0 THEN 1480
 1510 E = E - X : IF D(7) < 0 THEN X = X * RND (0)
 1520 H1 = INT (X / K3) : FOR I = 1 TO 3 : IF K(I,3) < = 0 THEN 1610
 1530 JH = SQR ((K(I,1) - S1) ^ 2 + (K(I,2) - S2) ^ 2)
 1540 H = INT ((H1 / JH) * ( RND (0) + 2)) : IF H > .15 * K(I,3) THEN 1560
 1550 PRINT "SENSORS SHOW NO DAMAGE TO ENEMY AT";K(I,1);",";K(I,2) : GOTO 1610
 1560 K(I,3) = K(I,3) - H : PRINT H;"UNIT HIT ON KLINGON AT SECTOR";K(I,1);",";
 1570 PRINT K(I,2) : IF K(I,3) < = 0 THEN PRINT "*** KLINGON DESTROYED ***" : GOTO 1590
 1580 PRINT "   (SENSORS SHOW";K(I,3);"UNITS REMAINING)" : GOTO 1610
 1590 K3 = K3 - 1 : K9 = K9 - 1 : Z1 = K(I,1) : Z2 = K(I,2) : A$ = "   ": GOSUB 3390
 1600 K(I,3) = 0 : G(Q1,Q2) = G(Q1,Q2) - 100 : Z(Q1,Q2) = G(Q1,Q2) : IF K9 < = 0 THEN 2450
 1610 NEXT I : GOSUB 2210 : GOTO 530
 1620 FOR X = 1 TO 10 : NEXT X
 1630 IF P < 0 PRINT "ALL PHOTON TORPEDOES EXPENDED" : GOTO 530
 1640 IF D(5) < 0 THEN PRINT "PHOTON TUBES ARE NOT OPERATIONAL" : GOTO 530
 1650 INPUT "PHOTON TORPEDOE COURSE (1-9)";C1 : IF C1 = 9 THEN C1 = 1
 1660 IF C1 > = 1 AND C1 < 9 THEN 1690
 1670 PRINT "ENSIGN CHEKOV REPORTS, 'INCORECT COURSE DATA, SIR!'"
 1680 GOTO 530
 1690 X1 = C(C1,1) + (C(C1 + 1,1) - C(C1,1)) * (C1 - INT (C1)) : E = E - 2 : P = P - 1
 1700 X2 = C(C1,2) + (C(C1 + 1,2) - C(C1,2)) * (C1 - INT (C1)) : X = S1 : Y = S2
 1710 X = X + X1 : Y = Y + X2 : X3 = INT (X + .5) : Y3 = INT (Y + .5)
 1720 IF X3 < 1 OR X3 > 8 OR Y3 < 1 OR Y3 > 8 THEN 1960
 1730 PRINT @832, STRING$ (63," ")
 1740 PRINT @832,"TRACKING TORPEDOE : ";X3;",";Y3; : A$ = "   ": Z1 = X : Z2 = Y : GOSUB 3530
 1750 IF Z3 < > 0 THEN 1710
 1760 PRINT 
 1770 A$ = "+K+" : Z1 = X : Z2 = Y : GOSUB 3530 : IF Z3 = 0 THEN 1820
 1780 PRINT "*** KLINGON DESTROYED ***" : K3 = K3 - 1 : K9 = K9 - 1 : IF K9 < = 0 THEN 2450
 1790 FOR I = 1 TO 3 : IF X3 = K(I,1) AND Y3 = K(I,2) THEN 1810
 1800 NEXT I : I = 3
 1810 K(I,3) = 0 : GOTO 1940
 1820 A$ = " * ": Z1 = X : Z2 = Y : GOSUB 3530 : IF Z3 = 0 THEN 1840
 1830 PRINT "STAR AT";X3;",";Y3;"ABSORBED TORPEDO ENERGY." : GOSUB 2210 : GOTO 530
 1840 A$ = ">!<" : Z1 = X : Z2 = Y : GOSUB 3530 : IF Z3 = 0 THEN 1650
 1850 PRINT "*** STARBASE DESTROYED ***" : B3 = B3 - 1 : B9 = B9 - 1
 1860 IF B9 > 0 OR K9 > T - T0 - T9 THEN 1920
 1870 NA$ = "WALDO"
 1880 PRINT "CAPTAIN ";NA$;", YOU ARE HEREBY RELIEVED OF COMMAND"
 1890 PRINT "AND SENTENCED TO 99 STARDATES AT HARD LABOR ON CYGNUS 12!!"
 1900 FOR II = 1 TO 2500 : NEXT 
 1910 GOTO 2370
 1920 PRINT "STARFLEET COMMAND REVIEWING YOUR RECORD TO CONSIDER"
 1930 PRINT "COURT MARTIAL!" : D0 = 0
 1940 Z1 = X : Z2 = Y : A$ = "   ": GOSUB 3390
 1950 G(Q1,Q2) = K3 * 100 + B3 * 10 + S3 : Z(Q1,Q2) = G(Q1,Q2) : GOSUB 2210 : GOTO 530
 1960 PRINT : PRINT "TORPEDO MISSED" : GOSUB 2210 : GOTO 530
 1970 IF D(7) < 0 THEN PRINT "SHIELD CONTROL INOPERABLE" : GOTO 530
 1980 PRINT "ENERGY AVAILABLE=";E + S : INPUT "NUMBER OF UNITS TO SHIELDS";X
 1990 IF X < 0 OR S = X THEN PRINT "(SHIELDS UNCHANGED)" : GOTO 530
 2000 IF X < = E + S THEN 2030
 2010 PRINT "CAPTAIN"NA$"!   THIS IS NOT THE FEDERATION TREASURY."
 2020 PRINT "(SHIELDS UNCHANGED)" : GOTO 530
 2030 E = E + S - X : S = X : PRINT "DEFLECTOR CONTROL ROOM REPORT : "<ERROR>
 2040 PRINT "  'SHIELDS NOW AT"; INT (S);"UNITS PER YOUR COMMAND.'"
 2050 FOR II = 1 TO 1500 : NEXT : CLS : GOSUB 2490 : GOTO 530
 2060 IF D(6) > = 0 THEN 2170
 2070 PRINT "DAMAGE CONTROL REPORT NOT AVAILABLE" : IF D0 = 0 THEN 530
 2080 D3 = 0 : FOR I = 1 TO 8 : IF D(I) < 0 THEN D3 = D3 + .1
 2090 NEXT I : IF D3 = 0 THEN 530
 2100 PRINT : D3 = D3 + D4 : IF D3 > = 1 THEN D3 = .9
 2110 PRINT "TECHNICIANS STANDING BY TO EFFECT REPAIRS TO YOUR SHIP;"
 2120 PRINT "ESTIMATED TIME TO REPAIR : ";.01 * INT (100 * D3);"STARDATES"
 2130 INPUT "WILL YOU AUTHORIZE THE REPAIR ORDER (Y/N)";A$
 2140 IF A$ < > "Y" THEN 530
 2150 FOR I = 1 TO 8 : IF D(I) < 0 THEN D(I) = 0
 2160 NEXT I : T = T + D3 + .1
 2170 CLS : PRINT : PRINT "DEVICE            STATE OF REPAIR" : FOR R1 = 1 TO 8
 2180 GOSUB 3440 : PRINT G2$; LEFT$ (Z$,25 - LEN (G2$)); INT (D(R1) * 100) * .01
 2190 NEXT R1 : PRINT : IF D0 < > 0 THEN 2080
 2200 GOTO 530
 2210 IF K3 < = 0 THEN RETURN 
 2220 IF D0 < > 0 THEN PRINT "STARBASE SHIELDS PROTECT THE ENTERPRISE" : RETURN 
 2230 FOR I = 1 TO 3 : IF K(I,3) < = 0 THEN 2330
 2240 JH = SQR ((K(I,1) - S1) ^ 2 + (K(I,2) - S2) ^ 2)
 2250 H = INT ((K(I,3) / JH) * (2 + RND (0))) : S = S - H : K(I,3) = K(I,3) / (3 + RND (O))
 2260 PRINT H;"UNIT HIT ON ENTERPRISE FROM SECTOR";K(I,1);,;;K(I,2)
 2270 FOR IX = 1 TO 1000 : NEXT IX
 2280 IF S < = 0 THEN 2350
 2290 PRINT "      (SHIELDS DOWN TO";S;"UNITS)" : IF 8 < 20 THEN 2330
 2300 IF RND (0) > .6 OR H / S < = .02 THEN 2330
 2310 R1 = RND (8) : D(R1) = D(R1) - H / S - .5 * RND (0) : GOSUB 3440
 2320 PRINT "DAMAGE CONTROL REPORTS '";G2$;" DAMAGED BY THE HIT'"
 2330 NEXT I : RETURN 
 2340 PRINT "IT IS STARDATE";T : FOR I = 1 TO 1500 : NEXT I : GOTO 2370
 2350 CLS : PRINT : PRINT "THE ENTERPRISE HAS BEEN DESTROYED." : : PRINT "THE FEDERATION";
 2360 PRINT "WILL BE CONQUERED" : GOTO 2340
 2370 CLS : PRINT "THERE WERE";K9;"KLINGON BATTLE CRUISERS LEFT AT"
 2380 PRINT "THE END OF YOUR MISSION."
 2390 PRINT : PRINT : IF B9 = 0 THEN 2430
 2400 PRINT "THE FEDERATION IS IN NEED OF A NEW STAR SHIP COMMANDER"
 2410 PRINT "FOR A SIMILER MISSION -- IF THERE IS A VOLUNTEER."
 2420 INPUT "LET HIM STEP FORWARD AND ENTER 'AYE'";A$ : IF A$ = "AYE" THEN 20
 2430 END 
 2440 T = 100 : B9 = 1
 2450 FOR II = 1 TO 1500 : NEXT : CLS 
 2460 PRINT @192,"CONGRATULATIONS, MON CAPITAN "NA$"!  THE LAST KLINGON BATTLE"
 2470 PRINT TAB 5)"CRUISER MENACING THE FEDERATION HAS BEEN DESTROYED!" : PRINT 
 2480 PRINT TAB 10)"YOUR EFFICIENCY RATING IS";1000 * (K7 / (T - T0)) ^ 2 : GOTO 2390
 2490 FOR I = S1 - 1 TO S1 + 1 : FOR J = S2 - 1 TO S2 + 1
 2500 IF INT (I + .5) < 1 OR INT (I + .5) > 8 OR INT (J + .5) < 1 OR INT (J + .5) > 8 THEN 2520
 2510 A$ = ">!<" : Z1 = I : Z2 = J : GOSUB 3530 : IF Z3 = 1 THEN 2530
 2520 NEXT J : NEXT I : D0 = 0 : GOTO 2550
 2530 D0 = 1 : C$ = "DOCKED" : E = E0 : P = P0
 2540 PRINT "SHIELDS DROPPED FOR DOCKING PURPOSES" : FOR IX = 1 TO 1500 : NEXT IX : S = 0 : GOTO 2570
 2550 IF K3 > 0 THEN C$ = "*RED*" : GOTO 2570
 2560 C$ = "GREEN" : IF E < E0 * .1 THEN C$ = "YELLOW"
 2570 IF D(2) > = 0 THEN 2600
 2580 IF ( PEEK (16000) < > 32) OR ( PEEK (16064) < > 32) THEN CLS : PRINT 
 2590 PRINT "*** SHORT RANGE SENSORS ARE OUT ***" : PRINT : RETURN 
 2600 CLS : O1$ = "---------------------------------" : PRINT O1$ : FOR I = 1 TO 8
 2610 FOR J = (I - 1) * 24 + 1 TO (I - 1) * 24 + 22 STEP 3 : PRINT " "; MID$ (Q$,J,3); : NEXT J
 2620 ON I GOTO 2630,2640,2650,2660,2670,2680,2690,2700
 2630 PRINT "   STARDATE          "; INT (T * 10) * .1 : GOTO 2710
 2640 PRINT "   CONDITION          ";C$ : GOTO 2710
 2650 PRINT "   QUADRANT          ";Q1;",";Q2 : GOTO 2710
 2660 PRINT "   SECTOR            ";S1;",";S2 : GOTO 2710
 2670 PRINT "   pHOTON TORPEDOES  "; INT (P) : GOTO 2710
 2680 PRINT "   TOTAL ENERGY      "; INT (E + S) : GOTO 2710
 2690 PRINT "   SHIELDS           "; INT (S) : GOTO 2710
 2700 PRINT "   KLINGONS REMAINING"; INT (K9)
 2710 NEXT I : PRINT O1$ : RETURN 
 2720 IF D(8) < 0 THEN PRINT "COMPUTER DISABLED" : GOTO 530
 2730 INPUT "COMPUTER ACTIVE AND AWAITING COMMAND";A : IF A < 0 OR A > 4 THEN 2750
 2740 H8 = 1 ELSE A + 1 GOTO 2830,2950,3050,3340,3110,
 2750 CLS : PRINT "FUNCTIONS AVAILABLE FROM LIBRARY-COMPUTER."
 2760 PRINT "   0 = CUMULATIVE GALACTIC RECORD"
 2770 PRINT "   1 = STATUS REPORT"
 2780 PRINT "   2 = PHOTON TORPEDO DATA"
 2790 PRINT "   3 = STARBASE NAV DATA"
 2800 PRINT "   4 = DIRECTION/DISTANCE CACULATOR"
 2810 PRINT : GOTO 2730
 2820 H8 = 0 : G5 = 1 : CLS : PRINT TAB 24)"THE GALAXY" : GOTO 2860
 2830 PRINT : PRINT "        ";
 2840 CLS : PRINT "COMPUTER RECORD OF GALAXY FOR QUADRANT";Q1;",";Q2
 2850 PRINT 
 2860 PRINT "       1     2     3     4     5     6     7     8"
 2870 O1$ = "     ----- ----- ----- ----- ----- ----- ----- -----"
 2880 PRINT O1$ : FOR I = 1 TO 8 : PRINT I; : IF H8 = 0 THEN 2920
 2890 FOR J = 1 TO 8 : PRINT "   "; : IF Z(I,J) = 0 THEN PRINT "***"; : GOTO 2910
 2900 PRINT RIGHT$ ( STR$ (Z(I,J) + 1000),3);
 2910 NEXT J : GOTO 2940
 2920 Z4 = I : Z5 = 1 : GOSUB 3560 : J0 = INT (15 - .5 * LEN (G2$)) : PRINT TAB J0);G2$;
 2930 Z5 = 5 : GOSUB 3560 : J0 = INT (39 - .5 * LEN (G2$)) : PRINT TAB J0);G2$;
 2940 PRINT : NEXT I : PRINT : GOTO 530
 2950 CLS : PRINT "   STATUS REPORT : ": X$ = "": IF K9 > 1 THEN X$ = "S"
 2960 PRINT "KLINGON";X$;" LEFT :  ";K9
 2970 PRINT "MISSION MUST BE COMPLETED IN";.1 * INT ((T0 + T9 - T) * 10),"STARDATES"
 2980 X$ = "S" : IF B9 < 2 THEN X$ = "": IF B9 < 1 THEN 3020
 2990 PRINT "THE FEDERATION IS MANTAINING";B9;"STARBASE";X$;" IN THE GALAXY"
 3000 FOR IX = 1 TO 1500 : NEXT IX
 3010 GOTO 2060
 3020 PRINT "CAPTAIN "NA$"!  YOUR STUPIDITY HAS LEFT YOU ON YOUR OWN"
 3030 PRINT "IN THE GALAXY -- YOU HAVE NO STARBASES LEFT!"
 3040 FOR II = 1 TO 2000 : NEXT : GOTO 2060
 3050 IF K3 < = 0 THEN 1440
 3060 X$ = "": IF K3 > 1 THEN X$ = "S"
 3070 PRINT "FROM ENTERPRISE TO KLINGON";X$
 3080 H8 = 0 : FOR I = 1 TO 3 : IF K(I,3) < = 0 THEN 3330
 3090 W1 = K(I,1) : X = K(I,2)
 3100 C1 = S1 : A = S2 : GOTO 3150
 3110 CLS : PRINT "DIRECTION/DISTANCE CALCULATOR : "
 3120 PRINT "YOU ARE AT QUADRANT ";Q1;",";Q2;" SECTOR ";S1;".";S2
 3130 PRINT "PLEASE ENTER" : C1 = Q1 : A = Q2
 3140 INPUT "  DESTINATION COORDINATES (X,Y)";W1,X
 3150 X = X - A : A = C1 - W1 : IF X < 0 THEN 3230
 3160 IF A < 0 THEN 3250
 3170 IF X > 0 THEN 3190
 3180 IF A = 0 THEN C1 = 5 : GOTO 3200
 3190 C1 = 1
 3200 IF ABS (A) < = ABS (X) THEN 3220
 3210 PRINT "DIRECTION =";C1 + ((( ABS (A) - ABS (X)) + ABS (A)) / ABS (A)); : GOTO 3290
 3220 PRINT "DIRECTION =";C1 + ( ABS (A) / ( ABS (X) + .001)); : GOTO 3290
 3230 IF A > 0 THEN C1 = 3 : GOTO 3260
 3240 IF X < > 0 THEN C1 = 5 : GOTO 3200
 3250 C1 = 7
 3260 IF ABS (A) > = ABS (X) THEN 3280
 3270 PRINT "DIRECTION =";C1 + ((( ABS (X) - ABS (A)) + ABS (X)) / ABS (X)); : GOTO 3290
 3280 PRINT "DIRECTION =";C1 + ( ABS (X) / ABS (A));
 3290 PRINT "DISTANCE =";
 3300 IF W1 = B4 PRINT SQR (X ^ 2 + .9 ^ 2) / 10 : GOTO 3320
 3310 PRINT SQR (X ^ 2 + A ^ 2)
 3320 IF H8 = 1 THEN 530
 3330 NEXT I : GOTO 530
 3340 IF B3 < > 0 THEN PRINT "FROM ENTERPRISE TO STARBASE : ": W1 = P4 : X = B5 : GOTO 3100
 3350 PRINT "MR SPOCK REPORTS, 'SENSORS SHOW NO STARBASES IN THIS";
 3360 PRINT " QUADRANT.'" : GOTO 530
 3370 R1 = RND (8) : R2 = RND (8) : A$ = "   ": Z1 = R1 : Z2 = R2 : GOSUB 3530 : IF Z3 = 0 THEN 3370 : PRINT Z3
 3380 RETURN 
 3390 S8 = INT (Z2 - .5) * 3 + INT (Z1 - .5) * 24 + 1
 3400 IF LEN (A$) < > 3 THEN PRINT "ERROR" : STOP 
 3410 IF S8 = 1 THEN Q$ = A$ + RIGHT$ (Q$,189) : RETURN 
 3420 IF S8 = 190 THEN Q$ = LEFT$ (Q$,189) + A$ : RETURN 
 3430 Q$ = LEFT$ (Q$,S8 - 1) + A$ + RIGHT$ (Q$,190 - S8) : RETURN 
 3440 ON R1 GOTO 3450,3460,3470,3480,3490,3500,3510,3520
 3450 G2$ = "WARP ENGINES" : RETURN 
 3460 G2$ = "SHORT RANGE SENSORS" : RETURN 
 3470 G2$ = "LONG RANGE SENSORS" : RETURN 
 3480 G2$ = "PHASER CONTROL" : RETURN 
 3490 G2$ = "PHOTON TUBES" : RETURN 
 3500 G2$ = "DAMAGE CONTROL" : RETURN 
 3510 G2$ = "SHIELD COTROL" : RETURN 
 3520 G2$ = "LIBRARY-COMPUTER" : RETURN 
 3530 Z1 = INT (Z1 + .5) : Z2 = INT (Z2 + .5) : S8 = (Z2 - 1) * 3 + (Z1 - 1) * 24 + 1 : Z3 = 0
 3540 IF MID$ (Q$,S8,3) < > A$ THEN RETURN 
 3550 Z3 = 1 : RETURN 
 3560 PRINT "GOSUB3490" : RETURN 

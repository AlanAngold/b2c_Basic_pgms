# NOTE: Type forced to be:
# trs2 - TRS-80 Level II BASIC tokenized file
   10 CLS : PRINT @411,"BLACK BOX"
   20 PRINT : PRINT TAB 7) "COPYRIGHT 1979 CREATIVE COMPUTING MORRISTOWN, NJ"
   30 PRINT @960, ""; : INPUT "HIT ENTER TO START";I$
   40 CLS : PRINT "NUMBER OF ATOMS"; : INPUT N : CLS : GOSUB 560
   50 FOR J = 0 TO 9 : FOR I = 0 TO 9 : B(I,J) = 0 : NEXT I,J
   60 FOR I = 1 TO N
   70 X = RND (8) : Y = RND (8) : IF B(X,Y) < > 0 THEN 70
   80 B(X,Y) = 1 : NEXT I
   90 S = 0 : C = 0
  100 PO = PO + 8 : IF PO = 960 THEN PO = 11 * 64
  110 PRINT @PO,"RAY"; CHR$ (30); : PO = PO + 8 : INPUT R : IF R < 1 THEN 380
  120 ON (R - 1) / 8 + 1 GOTO 140,150,160,170
  130 PRINT "ERROR" : GOTO 100
  140 X = 0 : Y = R : U = 1 : V = 0 : GOTO 180
  150 X = R - 8 : Y = 9 : U = 0 : V = - 1 : GOTO 180
  160 X = 9 : Y = 25 - R : U = - 1 : V = 0 : GOTO 180
  170 X = 33 - R : Y = 0 : U = 0 : V = 1
  180 X1 = X + U : Y1 = Y + V
  190 IF U = 0 THEN X2 = X1 - 1 : X3 = X1 + 1 : Y2 = Y1 : Y3 = Y1 : GOTO 210
  200 Y2 = Y1 - 1 : Y3 = Y1 + 1 : X2 = X1 : X3 = X1
  210 GOSUB 640 ELSE 8 * B(X1,Y1) + B(X2,Y2) + 2 * B(X3,Y3) + 1 GOTO 230,240,250,240
  220 PRINT @PO,"ABSRBD." : S = S + 1 : GOTO 100
  230 X = X1 : Y = Y1 : GOTO 280
  240 Z = 1 : GOTO 260
  250 Z = - 1
  260 IF U = 0 THEN U = Z : V = 0 : GOTO 280
  270 U = 0 : V = Z
  280 ON (X + 15) / 8 GOTO 320,300,330
  290 STOP 
  300 ON (Y + 15) / 8 GOTO 340,180,350
  310 STOP 
  320 Z = Y : GOTO 360
  330 Z = 25 - Y : GOTO 360
  340 Z = 33 - X : GOTO 360
  350 Z = 8 + X
  360 IF Z = R THEN PRINT @PO,"RFLCTD." : S = S + 1 : GOTO 100
  370 PRINT @PO,"TO";Z : S = S + 2 : GOTO 100
  380 CLS : PRINT "NOW TELL ME WHERE YOU THINK THE ATOMS ARE?"
  390 PRINT "(IN ROW, COLUMN FORMAT PLEASE)"
  400 FOR Q = 1 TO N
  410 PRINT "ATOM#";Q;
  420 INPUT I,J
  430 IF B(I,J) = 0 THEN S = S + 5 : GOTO 450
  440 C = C + 1
  450 NEXT Q
  460 CLS : GOSUB 560 : FOR J = 1 TO 8 : FOR I = 1 TO 8 : FL = - 1
  470 IF B(I,J) = 0 THEN 490
  480 X1 = I : Y1 = J : GOSUB 640
  490 NEXT I : NEXT J
  500 PRINT @11 * 64,"YOU GUESSED";C;"OUT OF";N;"ATOMS CORRECTLY!!"
  510 PRINT "YOUR SCORE FOR THIS ROUND WAS";S;"POINTS."
  520 PRINT 
  530 INPUT "CARE TO TRY AGAIN";A$
  540 IF LEFT$ (A$,1) = "Y" THEN CLEAR : GOTO 40
  550 END 
  560 PRINT : A$ = "01240223032204210520061907180817"
  570 FOR LO = 0 TO 7 : FR$ = MID$ (A$,LO * 4 + 1,2) : LN$ = MID$ (A$,LO * 4 + 3,2)
  580 PRINT FR$;" "; CHR$ (191); STRING$ (23,32); CHR$ (191);" ";LN$ : NEXT 
  590 PRINT @580, CHR$ (27); STRING$ (23,176)
  600 PRINT "   09 10 11 12 13 14 15 16";
  610 PRINT @68, STRING$ (23,131);
  620 PRINT @0,"   32 31 30 29 28 27 26 25";
  630 PRINT @292, CHR$ (93);"----THE BLACK BOX"; : PO = 11 * 64 - 8 : RETURN 
  640 IF X1 = 0 OR X1 = 9 OR Y1 = 0 OR Y1 = 9 THEN RETURN 
  650 PR = PEEK (Y1 * 64 + X1 * 3 + 1 + 15360) : IF PR < > 32 THEN CR = 12 + PR : ELSE CR = 140
  660 PRINT @Y1 * 64 + X1 * 3 + 1, CHR$ (CR); : IF FL THEN RETURN 
  670 PRINT @Y1 * 64 + X1 * 3 + 1, CHR$ (PR); : RETURN 

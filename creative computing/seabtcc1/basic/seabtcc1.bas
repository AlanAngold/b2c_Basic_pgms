# NOTE: Type forced to be:
# trs2 - TRS-80 Level II BASIC tokenized file
   10 CLS 
   20 PRINT @411,"SEA BATTLE"
   30 PRINT TAB 7)"COPYRIGHT 1979 CREATIVE COMPUTING MORRISTOWN, NJ"
   40 PRINT @968,""; : INPUT "WHAT IS YOUR NAME";N$ : N$ = "CAPTAIN "+ N$
   60 DD$ = "####" : DIM A(15,20),D(9) : CLS 
   70 PRINT "SETTING UP BOARD...."
   80 FOR I = 1 TO 15 : FOR J = 1 TO 20 : A(I,J) = 0 : NEXT J,I
   90 RESTO : FOR JK = 1 TO 25 : READ JK$ : NEXT JK
  100 FOR X = 7 TO 13 : FOR Y = 5 TO 10 : READ A(X,Y) : NEXT Y,X
  110 S1 = 10 : S2 = 10 : A(S1,S2) = 2 : S = INT ( RND (16)) + 7
  120 RESTO : FOR JK = 1 TO 9 : READ JK$ : NEXT JK
  130 FOR X = 1 TO ( INT ( RND (0) * 4) + 1) * 2 - 1
  140 READ D8,D9
  150 NEXT X
  160 FOR X = 1 TO S
  170 X1 = INT ( RND (0) * 15) + 1
  180 X2 = INT ( RND (0) * 20) + 1
  190 IF A(X1,X2) < > 0 THEN 170
  200 A(X1,X2) = 3
  210 NEXT X
  220 PRINT "YOU MUST DESTROY";S;"ENEMY SHIPS TO WIN, ";N$;"."
  230 S3 = INT ( RND (0) * 15) + 1
  240 S4 = INT ( RND (0) * 20) + 1
  250 IF A(S3,S4) < > 0 THEN 230
  260 A(S3,S4) = 4
  270 FOR X = 1 TO INT ( RND (0) * 8) + 8
  280 X1 = INT ( RND (0) * 15) + 1
  290 X2 = INT ( RND (0) * 20) + 1
  300 IF A(X1,X2) < > 0 THEN 280
  310 A(X1,X2) = 5
  320 NEXT X
  330 FOR X = 1 TO 4
  340 X1 = INT ( RND (0) * 14) + 2
  350 X2 = INT ( RND (0) * 18) + 2
  360 IF A(X1,X2) < > 0 THEN 340
  370 A(X1,X2) = 6
  380 RESTO 
  390 FOR JK = 1 TO 9
  400 READ JK$
  410 NEXT JK
  420 FOR Y = 1 TO INT ( RND (0) * 8) + 1
  430 READ M1,M2
  440 NEXT Y
  450 NEXT X
  460 FOR I = 1 TO 9
  470 D(I) = 0
  480 NEXT I
  490 C = 30
  500 P = 6000
  510 F = 2500
  520 T = 10
  530 M = 3
  540 D = 100
  550 D2 = 2
  560 PRINT 
  570 PRINT "WHAT ARE YOUR ORDERS, ";N$;
  580 INPUT O
  585 IF O = 1 OR O = 0 THEN 600
  590 CLS 
  600 ON INT (O + 1) GOTO 740,1350,1920,2390,3000,3150,3540,3710,4240,4470
  610 CLS 
  620 PRINT "THE COMMANDS ARE : "
  630 PRINT "     #0 :  NAVIGATION"
  640 PRINT "     #1 :  SONAR"
  650 PRINT "     #2 :  TORPEDO CONTROL"
  660 PRINT "     #3 :  POLARIS MISSILE CONTROL"
  670 PRINT "     #4 :  MANOUVERING"
  680 PRINT "     #5 :  STATUS/DAMAGE REPORT"
  690 PRINT "     #6 :  HEADQUARTERS"
  700 PRINT "     #7 :  SABOTAGE"
  710 PRINT "     #8 :  POWER CONVERSION"
  720 PRINT "     #9 :  SURRENDER"
  730 GOTO 560
  740 IF D(1) > = 0 THEN 770
  750 PRINT "ENGINES ARE UNDER REPAIR, ";N$;"."
  760 GOTO 560
  770 IF C > 8 THEN 800
  780 PRINT "NOT ENOUGH CREW TO MAN THE ENGINES, ";N$;"."
  790 GOTO 560
  800 D1 = 1 - ((.23 + RND (0) / 10) * ( - (D < = 50)))
  810 GOSUB 5990
  820 PRINT "POWER AVAILABLE=";P; CHR$ (8);". POWER TO USE";
  830 INPUT P1
  840 IF P1 < 0 OR P1 > P THEN 820
  850 IF P1 < = 1000 THEN 900
  860 IF RND (0) < .43 THEN 900
  870 PRINT "ATOMIC PILE GOES SUPERCRITICAL, ";N$;"!!! HEADQUARTERS"
  880 PRINT "WILL WARN ALL SUBS TO STAY FROM RADIOACTIVE AREA!!!!"
  890 GOTO 6110
  900 X = S1
  910 Y = S2
  920 Q1 = 1
  930 FOR X2 = 1 TO INT ( INT (P1 / 100 + .5) * D1 + .5)
  940 IF X + X1 > 0 AND X + X1 < 16 AND Y + Y1 > 0 AND Y + Y1 < 21 THEN 970
  950 PRINT "YOU CAN'T LEAVE THE AREA, ";N$;"!!!"
  960 GOTO 1030
  970 ON A(X + X1,Y + Y1) + 1 GOTO 980,1020,1300,1080,1130,1160,1180
  980 X = X + X1
  990 Y = Y + Y1
 1000 P = P - 100
 1010 GOTO 1200
 1020 PRINT "YOU ALMOST RAN AGROUND, ";N$;"!!"
 1030 A(X,Y) = 2
 1040 A(S1,S2) = 0
 1050 S1 = X
 1060 S2 = Y
 1070 GOTO 4490
 1080 IF D > 50 THEN 980
 1090 PRINT "YOU RAMMED A SHIP!!!YOU'RE BOTH SUNK, ";N$;"!!"
 1100 S = S - 1
 1110 IF S = 0 THEN 6180
 1120 GOTO 6110
 1130 IF D > 50 THEN 980
 1140 PRINT "YOU RAMMED YOUR HEADQUARTERS!! YOU'RE SUNK!!"
 1150 GOTO 6110
 1160 PRINT "YOU'VE BEEN BLOWN UP BY A MINE, ";N$;"!!"
 1170 GOTO 6110
 1180 IF RND (0) < .21 THEN 1300
 1190 GOTO 6110
 1200 FOR X3 = X - 2 TO X + 2
 1210 FOR Y3 = Y - 2 TO Y + 2
 1220 IF X3 < 1 OR X3 > 15 OR Y3 < 1 OR Y3 > 20 THEN 1280
 1230 IF A(X,Y) < > 6 THEN 1280
 1240 IF RND (0) < .25 THEN 1270
 1250 IF Q1 = 0 THEN 1280
 1260 PRINT "YOU JUST HAD A NARROW ESCAPE WITH A SEA MONSTER, ";N$;"!!"
 1270 Q1 = 0
 1280 NEXT Y3
 1290 NEXT X3
 1300 NEXT X2
 1310 PRINT "NAVIGATION COMPLETE. POWER LEFT=";P; CHR$ (8);"."
 1320 IF P > 0 THEN 1030
 1330 PRINT "ATOMIC PILE HAS GONE DEAD!!!SUB SINKS, CREW SUFFOCATES!"
 1340 GOTO 6110
 1350 IF D(2) > = 0 THEN 1380
 1360 PRINT "SONAR IS UNDER REPAIR, ";N$;"."
 1370 GOTO 560
 1380 IF C > 5 THEN 1410
 1390 PRINT "NOT ENOUGH CREW TO WORK SONAR, ";N$;"."
 1400 GOTO 560
 1410 PRINT "OPTION #";
 1420 INPUT O
 1430 ON INT (O + 1) GOTO 1450,1660
 1440 GOTO 1410
 1450 CLS 
 1460 FOR X = 1 TO 15
 1470 FOR Y = 1 TO 20
 1480 QW$ = "   ***(X)<S>!H! $ -#-"
 1490 IF A(X,Y) < > 0 THEN 1530
 1500 IF X < > 1 AND X < > 15 AND Y < > 1 AND Y < > 20 THEN 1530
 1510 PRINT " . ";
 1520 GOTO 1570
 1530 A$ = MID$ (QW$,A(X,Y) * 3 + 1,3)
 1540 IF D < 50 AND RND (1) < .23 AND A(X,Y) < > 1 AND A(X,Y) < > 2 THEN 1510
 1550 IF RND (0) < .15 AND A(X,Y) > 2 THEN 1510
 1560 PRINT A$;
 1570 NEXT Y
 1580 PRINT 
 1590 NEXT X
 1600 P = P - 50
 1610 PRINT @979,"PRESS ANY KEY TO CONTINUE";
 1620 IF INKEY$ = ""THEN 1620
 1630 CLS 
 1640 IF P > 0 THEN 560
 1650 GOTO 1330
 1660 FOR I = 1 TO 5
 1670 B(I) = 0
 1680 NEXT I
 1690 PRINT "DIRECTION   # OF SHIPS   DISTANCES"
 1700 PRINT "---------   ----------   ---------"
 1710 RESTO 
 1720 FOR JK = 1 TO 9
 1730 READ JK$
 1740 NEXT JK
 1750 FOR X = 1 TO 8
 1760 READ X1,Y1
 1770 X3 = 0
 1780 FOR X4 = 1 TO 20
 1790 IF S1 + X1 * X4 < 1 OR S1 + X1 * X4 > 15 OR S2 + Y1 * X4 < 1 OR S2 + Y1 * X4 > 20 THEN 1840
 1800 IF A(S1 + X1 * X4,S2 + Y1 * X4) < > 3 THEN 1830
 1810 X3 = X3 + 1
 1820 B(X3) = X4
 1830 NEXT X4
 1840 IF X3 = 0 THEN 1900
 1850 PRINT "   ";X,X3,
 1860 FOR X4 = 1 TO X3
 1870 PRINT B(X4);
 1880 NEXT X4
 1890 PRINT 
 1900 NEXT X
 1910 GOTO 1600
 1920 IF D(3) > = 0 THEN 1950
 1930 PRINT "TORPEDO TUBES ARE UNDER REPAIR, ";N$;"."
 1940 GOTO 560
 1950 IF C > = 10 THEN 1980
 1960 PRINT "NOT ENOUGH CREW TO FIRE TORPEDO, ";N$;"."
 1970 GOTO 560
 1980 IF T THEN 2010
 1990 PRINT "NO TORPEDOS LEFT, ";N$;"."
 2000 GOTO 560
 2010 IF D < 2000 THEN 2050
 2020 IF RND (0) > .5 THEN 2050
 2030 PRINT "PRESSURE IMPLODES SUB UPON FIRING..YOU'RE CRUSHED!!"
 2040 GOTO 6110
 2050 GOSUB 5990
 2060 X = S1
 2070 Y = S2
 2080 FOR X2 = 1 TO INT (7 + 5 * ( - (D > 50)) - RND (0) * 4 + .5)
 2090 IF X + X1 > 0 AND X + X1 < 16 AND Y + Y1 > 0 AND Y + Y1 < 21 THEN 2150
 2100 PRINT "TORPEDO OUT OF SONAR RANGE...INEFFECTUAL, ";N$;"."
 2110 T = T - 1
 2120 P = P - 150
 2130 IF P > 0 THEN 4490
 2140 GOTO 1330
 2150 ON A(X + X1,Y + Y1) + 1 GOTO 2160,2200,2360,2230,2270,2320,2340
 2160 X = X + X1
 2170 Y = Y + Y1
 2180 PRINT "..!..";
 2190 GOTO 2360
 2200 PRINT "YOU TOOK OUT SOME ISLAND, ";N$;"!"
 2210 A(X + X1,Y + Y1) = 0
 2220 GOTO 2110
 2230 PRINT "OUCH!!!! YOU GOT ONE, ";N$;"!!"
 2240 S = S - 1
 2250 IF S < > 0 THEN 2210
 2260 GOTO 6180
 2270 PRINT "YOU BLEW UP YOUR HEADQUARTERS, ";N$;"!!!"
 2280 S3 = 0
 2290 S4 = 0
 2300 D2 = 0
 2310 GOTO 2110
 2320 PRINT "BLAM!! SHOT WASTED ON A MINE, ";N$;"!!"
 2330 GOTO 2110
 2340 PRINT "A SEA MONSTER HAD A TORPEDO FOR LUNCH, ";N$;"!!"
 2350 GOTO 2110
 2360 NEXT X2
 2370 PRINT "DUD."
 2380 GOTO 2110
 2390 IF D(4) > = 0 THEN 2420
 2400 PRINT "MISSILE SILOS ARE UNDER REPAIR ";N$;"."
 2410 GOTO 560
 2420 IF C > 23 THEN 2450
 2430 PRINT "NOT ENOUGH CREW TO LAUNCH A MISSILE, ";N$;"."
 2440 GOTO 560
 2450 IF M < > 0 THEN 2480
 2460 PRINT "NO MISSILES LEFT, ";N$;"."
 2470 GOTO 560
 2480 IF D > 50 AND D < 2000 THEN 2550
 2490 PRINT "RECOMMENDED THAT YOU DO NOT FIRE AT THIS DEPTH...PROCEED";
 2500 INPUT A$
 2510 IF LEFT$ (A$,1) = "N" THEN 560
 2520 IF RND (0) < .5 THEN 2550
 2530 PRINT "MISSILE EXPLODES UPON FIRING, ";N$;"!! YOU'RE DEAD!!"
 2540 GOTO 6110
 2550 GOSUB 5990
 2560 PRINT "FUEL (LBS.)";
 2570 INPUT F1
 2580 IF F1 > 0 AND F1 < = F THEN 2610
 2590 PRINT "YOU HAVE";F;"LBS. LEFT, ";N$;"."
 2600 GOTO 2560
 2610 F2 = INT (F1 / 75 + .5)
 2620 IF S1 + X1 * F2 > 0 AND S1 + X1 * F2 < 16 AND S2 + Y1 * F2 > 0 AND S2 + Y1 * F2 < 21 THEN 2680
 2630 PRINT "MISSILE OUT OF SONAR TRACKING, ";N$;". MISSILE LOST."
 2640 M = M - 1
 2650 F = F - F1
 2660 P = P - 300
 2670 GOTO 2130
 2680 D3 = 0
 2690 D4 = 0
 2700 D5 = 0
 2710 D6 = 0
 2720 FOR X = S1 + X1 * F2 - 1 TO S1 + X1 * F2 + 1
 2730 FOR Y = S2 + Y1 * F2 - 1 TO S2 + Y1 * F2 + 1
 2740 IF X < 1 OR X > 15 OR Y < 1 OR Y > 20 THEN 2890
 2750 D3 = D3 - (A(X,Y) = 3)
 2760 D4 = D4 - (A(X,Y) = 6)
 2770 D5 = D5 - (A(X,Y) = 5)
 2780 D6 = D6 - (A(X,Y) = 1)
 2790 IF A(X,Y) < > 4 THEN 2850
 2795 STOP 
 2800 PRINT "YOU'VE DESTROYED YOUR HEADQUARTERS, ";N$;"!!!"
 2810 D3 = 0
 2820 S4 = 0
 2830 D2 = 0
 2840 GOTO 2880
 2850 IF A(X,Y) < > 2 THEN 2880
 2860 PRINT "YOU'VE JUST DESTROYED YOURSELF, ";N$;"!!! DUMMY!!"
 2870 GOTO 6110
 2880 A(X,Y) = 0
 2890 NEXT Y
 2900 NEXT X
 2910 IF D6 = 0 THEN 2930
 2920 PRINT "YOU BLEW OUT SOME ISLAND, ";N$;"."
 2930 IF D5 = 0 THEN 2950
 2940 PRINT "YOU DESTROYED";D5;"MINES, ";N$;"."
 2950 IF D4 = 0 THEN 2970
 2960 PRINT "YOU GOT";D4;"SEA MONSTERS, ";N$;"!!! GOOD WORK!!"
 2970 PRINT "YOU DESTROYED";D3;"ENEMY SHIPS, ";N$;"!!!"
 2980 S = S - D3
 2985 IF S < = 0 THEN 6180
 2990 GOTO 2640
 3000 IF D(5) > = 0 THEN 3030
 3010 PRINT "BALLAST CONTROLS ARE BEING REPAIRED, ";N$;"."
 3020 GOTO 560
 3030 IF C > 12 THEN 3060
 3040 PRINT "THERE ARE NOT ENOUGH CREW TO WORK THE CONTROLS, ";N$;"."
 3050 GOTO 560
 3060 PRINT "NEW DEPTH";
 3070 INPUT D1
 3080 IF D1 > = 0 AND D1 < 3000 THEN 3110
 3090 PRINT "HULL CRUSHED BY PRESSURE, ";N$;"!!"
 3100 GOTO 6110
 3110 P = P - INT ( ABS ((D - D1) / 2 + .5))
 3120 PRINT "MANOUVER COMPLETE. POWER LOSS="; INT ( ABS ((D - D1) / 2 + .5))
 3130 D = D1
 3140 GOTO 4490
 3150 IF D(6) > = 0 THEN 3180
 3160 PRINT "NO REPORTS ARE ABLE TO GET THROUGH, ";N$;"."
 3170 GOTO 560
 3180 IF C > 3 THEN 3210
 3190 PRINT "NO ONE LEFT TO GIVE THE REPORT, ";N$;"."
 3200 GOTO 560
 3210 PRINT 
 3220 PRINT 
 3230 PRINT "# OF ENEMY SHIPS LEFT....";
 3240 PRINT LLIST DD$;S
 3250 PRINT "# OF POWER UNITS LEFT....";
 3260 PRINT LLIST "###,###";P
 3270 PRINT "# OF TORPEDOS LEFT.......";
 3280 PRINT LLIST DD$;T
 3290 PRINT "# OF MISSILES LEFT.......";
 3300 PRINT LLIST DD$;M
 3310 PRINT "# OF CREWMEN LEFT........";
 3320 PRINT LLIST DD$;C
 3330 PRINT "LBS. OF FUEL LEFT........";
 3340 PRINT LLIST "###,###";F
 3350 PRINT 
 3360 PRINT "WANT DAMAGE REPORT";
 3370 INPUT A$
 3380 IF LEFT$ (A$,1) = "N" THEN 3510
 3390 CLS 
 3400 PRINT "   ITEM          DAMAGE  (+ GOOD, 0 NEUTRAL, - BAD)"
 3410 PRINT "   ----          ------"
 3420 DATA "ENGINES","SONAR","TORPEDOS","MISSILES","MANOUVERING"
 3430 DATA "STATUS","HEADQUARTERS","SABOTAGE","CONVERTER"
 3440 RESTO 
 3450 FOR X = 1 TO 9
 3460 READ A$
 3470 PRINT A$;
 3480 PRINT LLIST "###.###";D(X)
 3490 NEXT X
 3500 PRINT 
 3510 PRINT "YOU ARE AT LOCATION (";S1;",";S2;")."
 3520 PRINT 
 3530 GOTO 560
 3540 IF D(7) > = 0 THEN 3570
 3550 PRINT "HEADQUARTERS IS DAMAGED. UNABLE TO HELP, ";N$;"."
 3560 GOTO 560
 3570 IF D2 < > 0 THEN 3600
 3580 PRINT "HEADQUARTERS IS DESERTED, ";N$;"."
 3590 GOTO 560
 3600 IF SQR ((S1 - S3) ^ 2 + (S2 - S4) ^ 2) < = 2 AND D < 51 THEN 3630
 3610 PRINT "UNABLE TO COMPLY WITH DOCKING ORDERS, ";N$;"."
 3620 GOTO 560
 3630 PRINT "DIVERS FROM HEADQUARTERS BRING OUR SUPPLIES AND MEN."
 3640 P = 4000
 3650 T = 8
 3660 M = 2
 3670 F = 1500
 3680 C = 25
 3690 D2 = D2 - 1
 3700 GOTO 4490
 3710 IF D(8) > = 0 THEN 3740
 3720 PRINT "HATCHES INACCESSABLE, ";N$;". NO SABOTAGES POSSIBLE."
 3730 GOTO 560
 3740 IF C > 10 THEN 3770
 3750 PRINT "NOT ENOUGH CREW TO GO ON A MISSION, ";N$;"."
 3760 GOTO 560
 3770 D3 = 0
 3780 D4 = 0
 3790 FOR X = S1 - 2 TO S1 + 2
 3800 FOR Y = S2 - 2 TO S2 + 2
 3810 IF X < 1 OR X > 15 OR Y < 1 OR Y > 20 THEN 3840
 3820 D3 = D3 - (A(X,Y) = 3)
 3830 D4 = D4 - (A(X,Y) = 6)
 3840 NEXT Y
 3850 NEXT X
 3860 IF D3 < > 0 THEN 3890
 3870 PRINT "NO SHIPS IN RANGE, ";N$;"."
 3880 GOTO 560
 3890 PRINT "THERE ARE";D3;"SHIPS IN RANGE, ";N$;"."
 3900 PRINT "HOW MANY MEN ARE GOING, ";N$;
 3910 INPUT Q1
 3920 IF C - Q1 > = 10 THEN 3950
 3930 PRINT "YOU MUST LEAVE AT LEAST 10 MEN ON BOARD, ";N$;"."
 3940 GOTO 3900
 3950 D5 = INT (D3 / Q1 + .5)
 3960 D6 = 0
 3970 FOR X = S1 - 2 TO S1 + 2
 3980 FOR Y = S2 - 2 TO S2 + 2
 3990 IF D3 / Q1 > 1 - RND (0) AND RND (0) + D3 / Q1 < .9 THEN 4050
 4000 IF A(X,Y) < > 3 THEN 4050
 4010 D6 = D6 + 1
 4020 A(X,Y) = 0
 4030 S = S - 1
 4040 IF S = 0 THEN GOTO 6180
 4050 NEXT Y
 4060 NEXT X
 4070 PRINT D6;"SHIPS WERE DESTROYED, ";N$;"."
 4080 D6 = 0
 4090 D7 = 0
 4100 FOR X = 1 TO Q1
 4110 D7 = D7 - ( RND (0) > .6)
 4120 NEXT X
 4130 FOR X = 1 TO Q1 - D7
 4140 D6 = D6 - ( RND (0) < .15)
 4150 NEXT X
 4160 IF D4 = 0 THEN 4200
 4170 PRINT "A SEA MONSTER SMELLS THE MEN ON THE WAY BACK!!!"
 4180 PRINT D7;"MEN WERE EATEN, ";N$;"!!"
 4190 C = C - D7
 4200 PRINT D6;"MEN WERE LOST THROUGH ACCIDENTS, ";N$;"."
 4210 C = C - D6
 4220 P = P - INT (10 * Q1 + RND (0) * 10)
 4230 GOTO 4490
 4240 IF D(9) > = 0 THEN 4270
 4250 PRINT "POWER CONVERTER IS DAMAGED, ";N$;"."
 4260 GOTO 560
 4270 IF C > 5 THEN 4300
 4280 PRINT "NOT ENOUGH MEN TO WORK THE CONVERTER, ";N$;"."
 4290 GOTO 560
 4300 PRINT "OPTION? (1=FUEL TO POWER, 2=POWER TO FUEL)";
 4310 INPUT O
 4320 ON O GOTO 4340,4400
 4330 GOTO 4300
 4340 PRINT "FUEL AVAILABLE=";F; CHR$ (8);". CONVERT";
 4350 INPUT C1
 4360 IF (C1 > F) OR (C1 < 0) THEN 4340
 4370 F = F - C1
 4380 P = P + INT (C1 / 3)
 4390 GOTO 4450
 4400 PRINT "POWER AVAILABLE=";P - 1; CHR$ (8);". CONVERT";
 4410 INPUT C1
 4420 IF C1 > P - 1 OR C1 < 0 THEN 4400
 4430 P = P - C1
 4440 F = F + INT (C1 * 3)
 4450 PRINT "CONVERSION COMPLETE. POWER="P; CHR$ (8);". FUEL=";F; CHR$ (8);"."
 4460 GOTO 4490
 4470 PRINT "COWARD!!YOU'RE NOT VERY PATRIOTIC, ";N$;"!!!"
 4480 GOTO 6110
 4490 Q = 0
 4500 FOR X = S1 - 4 TO S1 + 4
 4510 FOR Y = S2 - 4 TO S2 + 4
 4520 IF X < 1 OR X > 15 OR Y < 1 OR Y > 20 THEN 4550
 4530 IF A(X,Y) < > 3 THEN 4550
 4540 Q = Q + ( RND (0) / SQR ((S1 - X) ^ 2 + (S2 - Y) ^ 2))
 4550 NEXT Y
 4560 NEXT X
 4570 IF Q THEN 4600
 4580 PRINT "NO SHIPS IN RANGE TO DEPTH CHARGE YOU, ";N$;"!!"
 4590 GOTO 5040
 4600 PRINT "DEPTH CHARGES OFF";
 4610 IF RND (0) > .5 THEN 4640
 4620 PRINT "PORT SIDE, ";N$;"!!!"
 4630 GOTO 4650
 4640 PRINT "STARBOARD SIDE, ";N$;"!!!"
 4650 IF Q > .13 OR RND (0) > .92 THEN 4680
 4660 PRINT "NO REAL DAMAGE SUSTAINED, ";N$;"."
 4670 GOTO 5040
 4680 IF Q > .36 OR RND (0) > .96 THEN 4730
 4690 PRINT "LIGHT, SUPERFICIAL DAMAGE, ";N$;"."
 4700 P = P - 50
 4710 LET D( INT ( RND (0) * 9) + 1) = RND (0) * 2
 4720 GOTO 5040
 4730 IF Q > .6 OR RND (0) > .975 THEN 4810
 4740 PRINT "MODERATE DAMAGE. REPAIRS NEEDED."
 4750 P = P - 75 + INT ( RND (0) * 30)
 4760 FOR Y = 1 TO 2
 4770 X = INT ( RND (0) * 9) + 1
 4780 D(X) = D(X) - RND (0) * 8
 4790 NEXT Y
 4800 GOTO 5040
 4810 IF Q > .9 OR RND (0) > .983 THEN 4890
 4820 PRINT "HEAVY DAMAGE!! REPAIRS IMMEDIATE, ";N$;"!!!"
 4830 P = P - (200 + INT ( RND (0) * 76))
 4840 FOR X = 1 TO 4 + INT ( RND (0) * 2)
 4850 Y = INT ( RND (0) * 9) + 1
 4860 D(Y) = D(Y) - RND (0) * 11
 4870 NEXT X
 4880 GOTO 5040
 4890 PRINT "DAMAGE CRITICAL!!! WE NEED HELP!!!"
 4900 A$ = "QWERVHTUEAVMAKTIRYGHVNATUALALTYABALGGUTMBMFQIQIEYURQWCVBMNVBCE"
 4910 X = INT ( RND (0) * 16) + 1
 4920 PRINT "SEND 'HELP' IN CODE. HERE IS THE CODE : "; MID$ (A$,X,4);
 4930 : REM ' 
 4940 FOR I = 1 TO 1500
 4950 NEXT I
 4960 PRINT STRING$ (4,8); STRING$ (4,143)
 4970 INPUT "ENTER CODE";B$
 4980 PRINT 
 4990 IF B$ < > MID$ (A$,X,4) THEN 5020
 5000 PRINT "FAST WORK, ";N$;"!! HELP ARRIVES IN TIME TO SAVE YOU!!"
 5010 GOTO 4830
 5020 PRINT "MESSAGE GARBLED, ";N$;"...NO HELP ARRIVES!!!"
 5030 GOTO 6110
 5040 IF D(1) > = 0 OR D(3) > = 0 OR D(4) > = 0 OR D(5) > = 0 OR D(7) > = 0 THEN 5080
 5050 IF D(8) > = 0 OR D(9) > = 0 THEN 5080
 5060 PRINT "DAMAGE TOO MUCH, ";N$;"!!! YOU'RE SUNK!!"
 5070 GOTO 6110
 5080 PRINT @979,"PRESS ANY KEY TO CONTINUE";
 5090 IF INKEY$ = ""THEN 5090
 5100 CLS 
 5110 PRINT "---*** RESULTS OF LAST ENEMY MANOUVER ***---"
 5120 FOR X = 1 TO 15
 5130 FOR Y = 1 TO 20
 5140 IF A(X,Y) < > 3 THEN 5580
 5150 W = D8
 5160 V = D9
 5170 IF X + W > 0 AND X + W < 16 AND Y + V > 0 AND Y + V < 21 THEN 5260
 5180 FOR X0 = 19 TO 1 STEP - 1
 5190 IF A(X - W * X0 * 14 / 19,Y - V * X0) < > 0 THEN 5240
 5200 LET A(X - W * X0 * 14 / 19,Y - V * X0) = 3
 5210 : REM ' 
 5220 A(X,Y) = 0
 5230 GOTO 5920
 5240 NEXT X0
 5250 GOTO 570
 5260 ON A(X + W,Y + V) + 1 GOTO 5270,5300,5390,5300,5420,5490,5540
 5270 A(X + W,Y + V) = 3
 5280 A(X,Y) = 0
 5290 GOTO 5920
 5300 RESTO 
 5310 FOR JK = 1 TO 9
 5320 READ JK$
 5330 NEXT JK
 5340 FOR X0 = 1 TO INT ( RND (0) * 8) + 1
 5350 READ W,V
 5360 NEXT X0
 5370 IF X + W < 1 OR X + W > 15 OR Y + V < 1 OR Y + V > 20 THEN 5300
 5380 GOTO 5260
 5390 IF D > 50 THEN 5300
 5400 PRINT "*** YOU'VE BEEN RAMMED BY A SHIP, ";N$;"!!!"
 5410 GOTO 6110
 5420 IF RND (0) < .15 THEN 5300
 5430 PRINT "*** YOUR HEADQUARTERS WAS RAMMED, ";N$;"!!!"
 5440 S3 = 0
 5450 S4 = 0
 5460 D2 = 0
 5470 A(X + W,Y + V) = 0
 5480 GOTO 5510
 5490 IF RND (0) < .7 THEN 5300
 5500 PRINT "*** SHIP DESTROYED BY A MINE, ";N$;"!!"
 5510 S = S - 1
 5520 IF S < > 0 THEN 5280
 5530 GOTO 6180
 5540 IF RND (0) < .8 THEN 5300
 5550 PRINT "*** SHIP EATEN BY A SEA MONSTER, ";N$;"!!"
 5560 S = S - 1
 5570 GOTO 5520
 5580 IF A(X,Y) < > 6 THEN 5920
 5590 IF X + M1 < 1 OR X + M1 > 15 OR Y + M2 < 1 OR Y + M2 > 20 THEN 5640
 5600 ON A(X + M1,Y + M2) + 1 GOTO 5610,5640,5730,5750,5800,5610,5850
 5610 A(X + M1,Y + M2) = 6
 5620 A(X,Y) = 0
 5630 GOTO 5920
 5640 RESTO 
 5650 FOR JK = 1 TO 9
 5660 READ JK$
 5670 NEXT JK
 5680 FOR X0 = 1 TO INT ( RND (0) * 8) + 1
 5690 READ M1,M2
 5700 NEXT X0
 5710 IF X + M1 < 1 OR X + M1 > 15 OR Y + M2 < 1 OR Y + M2 > 20 THEN 5640
 5720 GOTO 5600
 5730 PRINT "*** YOU'VE BEEN EATEN BY A SEA MONSTER, ";N$;"!!"
 5740 GOTO 6110
 5750 IF RND (0) > .2 THEN 5640
 5760 PRINT "*** SHIP EATEN BY A SEA MONSTER, ";N$;"!!"
 5770 S = S - 1
 5780 IF S < > 0 THEN 5610
 5790 GOTO 6180
 5800 PRINT "*** A SEA MONSTER ATE YOUR HEADQUARTERS, ";N$;"!!"
 5810 S3 = 0
 5820 S4 = 0
 5830 D2 = 0
 5840 GOTO 5610
 5850 IF RND (0) < .75 THEN 5640
 5860 PRINT "*** A SEA MONSTER FIGHT, ";N$;"!!";
 5870 IF RND (0) < .8 THEN 5900
 5880 PRINT "AND ONE DIES!!"
 5890 GOTO 5610
 5900 PRINT "IT'S A TIE!!"
 5910 GOTO 5640
 5920 NEXT Y
 5930 NEXT X
 5940 FOR Y = 1 TO 9
 5950 X = INT ( RND (0) * 9) + 1
 5960 D(X) = D(X) + ( RND (1) * (2 + RND (1) * 2)) * (1 + ( - (D < 51) OR - (D > 2000))) * ( - (D(X) < 3))
 5970 NEXT Y
 5980 GOTO 560
 5990 DATA -1,0,-1,1,0,1,1,1,1,0,1,-1,0,-1,-1,-1
 6000 PRINT "COURSE (1-8)";
 6010 INPUT C1
 6020 IF C1 < 1 OR C1 > 8 THEN 6000
 6030 RESTO 
 6040 FOR JK = 1 TO 9
 6050 READ JK$
 6060 NEXT JK
 6070 FOR X9 = 1 TO INT (C1 + .5)
 6080 READ X1,Y1
 6090 NEXT X9
 6100 RETURN 
 6110 PRINT "THERE ARE STILL";S;"ENEMY SHIPS LEFT, ";N$;"."
 6120 PRINT "YOU WILL BE DEMOTED TO RANK OF DECK SCRUBBER!!!"
 6130 PRINT "WANT ANOTHER GAME";
 6140 INPUT A$
 6150 IF LEFT$ (A$,1) < > "Y" THEN 6170
 6160 CLS : GOTO 70
 6170 END 
 6180 PRINT "GOOD WORK, ";N$;"!!! YOU GOT THEM ALL!!!"
 6190 PRINT "PROMOTION AND COMMENDATIONS WILL BE GIVEN IMMEDIATELY!!!"
 6200 GOTO 6130
 6210 DATA 0,1,1,1,0,0,0,1,1,1,1,0,1,1,1,0,1,1,1,1,0,0,0,1
 6220 DATA 1,1,0,0,1,1,0,1,1,0,1,0,0,0,1,0,0,0
 6230 END 

    1 IF C1 < > 0 THEN 115
    2 POKE 16553,255
    5 RANDOM : CLEAR 100 : DEFINT A,E,P,S,W,U,V,Z : DIM A(276) : RESTO : CLS 
   10 FOR Z = 0 TO 10 : PRINT @ RND (703),"*"; : NEXT Z
   15 PRINT @704,<ERROR>"STAR TREK III Version 3.3" : PRINT <ERROR>"Lance Micklus, Winooski, Vt." : <ERROR> PRINT "COPYRIGHT December 1978"
   20 U = 25 : V = 14 : I = 5 : GOSUB 1865
   25 U = 100 : V = 25 : I = 1 : GOSUB 1865
   30 U = 80 : V = 12 : I = 4 : GOSUB 1865
   35 READ B$,J : IF J < > 999 THEN 35
   40 P = RND (191) - 1 : IF A(P) < > 0 THEN 40
   45 READ J : IF J > 0 LET A(P) = - J : GOTO 40
   50 P = RND (150) : M = P : IF A(P) < > 0 THEN 50
   55 GOSUB 1575 : GOSUB 1635
   60 FOR B = A(256) - 1 TO A(256) + 1 : FOR C = A(257) - 1 TO A(257) + 1
   65 FOR D = A(258) - 1 TO A(258) + 1
   70 GOSUB 1560
   75 IF P < > - 1 LET A(P) = 10 * FIX (A(P) / 10) - 5
   80 NEXT D : NEXT C : NEXT B : A(M) = - 4
   85 P = RND (191) - 1 : IF A(P) < > 0 THEN 85
   90 READ A(P) : IF A(P) < > 0 LET A(P) = - A(P) : GOTO 85
   95 FOR N = 0 TO 190 : IF A(N) = 0 THEN A(N) = - 1
  100 NEXT N : A(256) = 7 : A(257) = 7 : A(258) = 2 : A(276) = 3
  105 E = 3999 : T = 2200 : H = 2470 : Q = 0 : A(191) = 1006 : S = 0 : C1 = 0.785398
  110 A(259) = 3 : A(260) = 3 : A(261) = 1 : GOSUB 910
  115 CLS : RESTO : PRINT CHR$ (23)
  120 PRINT "ENTERPRISE and CREW" : PRINT "AWAITING YOUR ORDERS, CAPTAIN."
  125 READ B$,J : PRINT TAB 5)J; : PRINT TAB 9)B$ : IF J < > 11 THEN 125
  130 INPUT "Orders";O
  135 IF O < 0 OR O > 11 OR INT (O) < > O THEN 115
  140 IF O > 4 THEN 150
  145 ON O + 1 GOSUB 1505,420,350,1175,1325 : GOTO 155
  150 ON O - 4 GOSUB 1980,1345,835,1100,1070,295,485
  155 GOSUB 1640 : GOSUB 1560 : IF ABS (A(P)) < 10000 THEN 185
  160 GOSUB 995
  165 IF A(261) = 2 LET A(261) = 3 : GOSUB 320
  170 IF A(268) = 0 AND A(271) = 0 LET O = 3 : GOSUB 365
  175 IF A(271) = 0 GOSUB 1980
  180 GOTO 195
  185 B$ = "SPACE STORM"
  190 IF RND (100) = 100 GOSUB 330 : GOSUB 520
  195 IF A(261) > 1 GOSUB 1505
  200 T = T + .2 : E = E - A(261) * A(261) * 10
  205 IF E < 0 THEN 2095
  210 J = 1 : GOSUB 485
  215 IF T < H THEN 115
  220 CLS : PRINT CHR$ (23) : PRINT @384,"STAR FLEET COMMAND REQUESTS"
  225 PRINT "ENTERPRISE RETURN TO"
  230 PRINT "STARBASE 7,7,2" : H = H + 10 : GOSUB 1610 : GOTO 115
  235 GOTO 115
  240 CLS : RESTO : N = 2500 - T : IF N < 0 THEN S = S + N * 10
  245 FOR P = 0 TO 191 : IF A(P) < 0 THEN 255 : ELSE S = S + 1
  250 IF A(P) - ( FIX (A(P) / 10) * 10) = 9 LET S = S + 20
  255 NEXT P
  260 READ B$,Z : IF Z < > 425 THEN 260
  265 IF S < Z READ B$,Z : GOTO 265
  270 PRINT @256,"RATING : "; INT (S / 4.91)
  275 PRINT : PRINT "ADMIRAL FITZPATRICK HERE..." : PRINT 
  280 PRINT TAB 5)"CAPTAIN, AFTER REVIEWING YOUR LOG AND DATA TAPES,"
  285 PRINT "I AM GOING TO RECOMMEND TO STAR FLEET THAT YOU BE ";B$;"."
  290 PRINT : PRINT : END 
  295 CLS : PRINT CHR$ (23)
  300 PRINT @320,"1 - Green" : PRINT "2 - Yellow" : PRINT "3 - Red"
  305 INPUT "ENTER CONDITION CODE";N
  310 IF N < 1 OR N > 3 OR INT (N) < > N THEN 305
  315 A(261) = N : IF N = 1 RETURN 
  320 RESTO 
  325 READ B$,J : IF J - 20 < > A(261) THEN 325
  330 CLS : PRINT CHR$ (23)
  335 B$ = STRING$ ((30 - LEN (B$)) / 2," ") + B$
  340 FOR K = 0 TO 4 : PRINT @512,B$ : FOR J = 0 TO 200 : NEXT J
  345 PRINT @512, CHR$ (30) : FOR J = 0 TO 200 : NEXT J : NEXT K : RETURN 
  350 CLS : IF A(268) < > 0 LET I = 2 : GOTO 470
  355 IF A(271) < > 0 LET I = 5 : GOTO 470
  360 O = 0
  365 FOR P = 192 TO 255 : IF A(P) = 18 OR A(P) = 0 THEN 410
  370 IF O = 3 AND A(P) < 25 THEN 410
  375 CLS : U = 62 : V = 14
  380 FOR Z = 0 TO RND (5) + 2 : PRINT @ RND (512) + 63,"*"; : NEXT Z
  385 GOSUB 2015 : GOSUB 1860 : GOSUB 1575
  390 PRINT : PRINT "Object at"; STR$ (B); STR$ (C);" is a ";B$;"."
  395 IF A(P) < 25 THEN 405
  400 PRINT "READING";A(P) - 25;"units of ENERGY."
  405 GOSUB 2025
  410 NEXT P
  415 RETURN 
  420 CLS : RESTO : READ B$,Z
  425 IF A(267) < > 0 LET I = 1 : GOTO 470
  430 PRINT "Lt. Uhura here..."
  435 PRINT "DAMAGE CONTROL REPORTS THE FOLLOWING : ": PRINT 
  440 FOR Z = 267 TO 275 : READ B$,J : PRINT TAB 14)B$,
  445 IF Z = 275 AND A(276) = 0 PRINT "** INOPERATIVE **" : GOTO 465
  450 IF A(Z) = 0 PRINT "OPERATIONAL" : GOTO 465
  455 IF A(Z) < 10 PRINT "NEARLY OPERATIONAL"
  460 IF A(Z) > 9 PRINT "** INOPERATIVE **"
  465 NEXT Z : GOTO 1610
  470 CLS : PRINT CHR$ (23) : RESTO 
  475 READ B$,J : IF I < > J THEN 475
  480 PRINT @320,B$;" INOPERATIVE" : GOTO 2025
  485 CLS : PRINT CHR$ (23) : PRINT @320,""; : FOR N = 1 TO J : FOR Z = 267 TO 275
  490 IF A(Z) = 0 THEN 515
  495 A(Z) = A(Z) - RND (5) : IF A(Z) > 0 THEN 515
  500 A(Z) = 0 : RESTO : IF A(267) < > 0 THEN 515
  505 READ B$,J : IF J < > Z - 266 THEN 505
  510 PRINT B$;" OPERATIONAL" : GOSUB 2025
  515 NEXT Z : NEXT N : RETURN 
  520 FOR J = 1 TO 4 - A(261)
  525 Z = 266 + RND (9) : IF A(Z) < > 0 THEN 550
  530 A(Z) = RND (25) * J : IF A(267) < > 0 THEN 550
  535 CLS : PRINT CHR$ (23) : RESTO 
  540 READ B$,J : IF J < > Z - 266 THEN 540
  545 PRINT @320,"DAMAGE TO ";B$ : GOSUB 2025
  550 NEXT J : RETURN 
  555 CLS : P = X * 8 + Y + 192 : U = 30 : V = 14
  560 GOSUB 1860 : GOSUB 2015 : Z = 338 : M = I
  565 PRINT : PRINT TAB 25)"sector : ";X;Y
  570 B$ = " *" : IF Q = 1 AND I = 5 GOSUB 795 : GOTO 590
  575 B$ = "-" : IF I = 5 THEN GOSUB 795 : GOTO 585
  580 Z = 336 : B$ = ")" : GOSUB 795
  585 B$ = " ": GOSUB 795
  590 L = L * 4
  595 IF Q = 1 THEN 615
  600 IF RND (2) = 1 LET J1 = J1 - X : K1 = K1 - Y : GOTO 615
  605 FOR Z = 1 TO SQR (((X - J1) ^ 2) + ((Y - K1) ^ 2)) : L = L * .6 : NEXT Z
  610 X = J1 : Y = K1 : GOTO 635
  615 GOSUB 2040
  620 X = X + J1 : Y = Y + K1
  625 IF X < 0 OR X > 7 OR Y < 0 OR Y > 7 LET P = - 1 : CLS : GOTO 670
  630 L = L * .6
  635 P = INT (X) * 8 + INT (Y) + 192
  640 IF A(P) = 0 THEN 620
  645 IF Q = 2 RETURN 
  650 CLS : V = 15 : IF A(P) = 18 LET U = 28
  655 IF Q < > 1 AND I = 5 AND A(P) < 25 LET P = - 1 : GOTO 675
  660 IF Q < > 1 AND I = 1 AND A(P) < > 18 LET P = - 1 : GOTO 675
  665 GOSUB 1860
  670 IF Q = 2 RETURN 
  675 GOSUB 2015 : PRINT : PRINT TAB 25)"sector : "; INT (X); INT (Y)
  680 B$ = "* ": IF M = 5 AND Q = 1 GOSUB 815 : GOTO 700
  685 B$ = "-" : IF M = 5 GOSUB 815 : GOTO 695
  690 B$ = "(" : GOSUB 815
  695 B$ = " ": GOSUB 815
  700 Q = 0 : L = INT (L) : IF P = - 1 OR I = 0 RETURN 
  705 GOSUB 1820
  710 IF M = 5 AND I < > 1 THEN 2105
  715 IF I < > 5 THEN 740
  720 E = E - L
  725 IF L - A(261) * 75 > 0 GOSUB 520 : L = L - A(261) * 75 : GOTO 725
  730 IF E > 0 RETURN 
  735 GOTO 2100
  740 IF I < > 1 THEN 760
  745 A(P) = A(P) - L : IF A(P) > 25 RETURN 
  750 GOTO 760
  755 IF L < 100 RETURN 
  760 PRINT TAB 20)B$;" DISTROYED"
  765 FOR N = 0 TO 30
  770 RESET (21 + RND (17),12 + RND (5)) : SET (21 + RND (17),12 + RND (5))
  775 NEXT N
  780 A(P) = 0 : GOSUB 1640 : GOSUB 1560
  785 A(P) = ABS (A(P)) - 10000 : S = S + 10
  790 RETURN 
  795 FOR N = Z TO 380
  800 PRINT @N,B$; : FOR W = 1 TO 3 : NEXT W
  805 NEXT N : IF Q = 1 PRINT @380,"  "
  810 RETURN 
  815 FOR N = 380 TO 338 STEP - 1
  820 PRINT @N,B$; : FOR W = 1 TO 3 : NEXT W
  825 NEXT N : IF Q = 1 PRINT @338," ";
  830 PRINT @640,""; : RETURN 
  835 CLS : IF A(273) < > 0 LET I = 7 : GOTO 470
  840 GOSUB 1640
  845 PRINT CHR$ (23) : PRINT @320,"CHEKOV here..."
  850 INPUT "COURSE (X,Y,Z)";B,C,D : GOSUB 1560
  855 IF P = - 1 THEN 850
  860 INPUT "WARP FACTOR (0-8)";K : IF K = 0 THEN RETURN 
  865 IF K < 0 OR K > 8 OR INT (K) < > K THEN 860
  870 L = SQR (((A(256) - B) ^ 2) + ((A(257) - C) ^ 2) + ((A(258) - D) ^ 2))
  875 IF E - 100 > L * K * K * K THEN 900
  880 CLS : PRINT @320, CHR$ (23);"Scott here..." : PRINT 
  885 PRINT "Sorry CAPTAIN," : PRINT "but we just don't have"
  890 PRINT "enough energy."
  895 GOTO 2025
  900 E = E - L * K * K * K : T = T + 2 * L * L / K : GOSUB 1635
  905 J = INT (L * L / K) : IF J > 0 GOSUB 485
  910 GOSUB 1640 : GOSUB 1560 : GOSUB 1590
  915 IF A(266) = 0 LET A(266) = 8 : A(P) = FIX ( ABS (A(P)) / 10) * 10 + 8
  920 IF A(265) > 0 AND A(266) = 1 LET A(266) = 7 : GOSUB 1580
  925 B = X : C = Y : D = 3 : GOSUB 1565
  930 IF A(266) > 1 AND A(266) < 5 THEN 2060
  935 IF A(266) > 7 LET A(265) = A(265) - 1
  940 FOR N = 192 TO 255 : A(N) = 0 : NEXT N : A(P) = 18
  945 FOR N = 262 TO 265
  950 IF A(N) = 0 THEN 980
  955 IF N = 262 LET M = RND (1500) + 250
  960 IF N = 263 LET M = 20
  965 IF N = 264 LET M = 19
  970 IF N = 265 LET M = 3
  975 GOSUB 1950 : A(N) = A(N) - 1 : GOTO 950
  980 NEXT N
  985 IF A(266) > 7 LET M = 2 : GOSUB 1950
  990 R = 0 : GOTO 1980
  995 FOR R = 192 TO 255
 1000 IF A(R) < 25 THEN 1065
 1005 X = INT ((R - 192) / 8) : Y = R - 192 - (X * 8)
 1010 IF RND (3) > 1 THEN 1035
 1015 J1 = SGN (A(259) - X) : K1 = SGN (A(260) - Y)
 1020 IF X + J1 > = 0 AND X + J1 < = 7 LET X1 = X + J1
 1025 IF Y + K1 > = 0 AND Y + K1 < = 7 LET Y1 = Y + K1
 1030 IF A(X1 * 8 + Y1 + 192) = 0 LET Z = A(X * 8 + Y + 192) : A(X * 8 + Y + 192) = 0 : X = X1 : Y = Y1 : A(X * 8 + Y + 192) = Z
 1035 J1 = A(259) - X : K1 = A(260) - Y
 1040 X1 = X : Y1 = Y : J2 = J1 : K2 = K1 : Q = 2 : GOSUB 615
 1045 IF P = - 1 THEN 1055
 1050 IF A(P) < > 18 THEN 1065
 1055 X = X1 : Y = Y1 : J1 = A(259) : K1 = A(260) : Q = 0 : L = RND (A(R) * .7)
 1060 IF L > 100 LET A(R) = A(R) - L : GOSUB 555
 1065 NEXT : RETURN 
 1070 CLS : IF A(275) < > 0 OR A(276) = 0 LET I = 9 : GOTO 470
 1075 Q = 1 : GOSUB 1980
 1080 INPUT "TORPEDO DIRECTION (0-8)";I : PRINT TAB 18)" ";
 1085 IF I < 0 OR I > 8 THEN 1080
 1090 J1 = COS (I * C1) : K1 = - SIN (I * C1) : GOSUB 1640
 1095 A(276) = A(276) - 1 : Q = 1 : L = 8000 : GOTO 555
 1100 CLS : IF A(274) < > 0 LET I = 8 : GOTO 470
 1105 PRINT CHR$ (23) : PRINT @320,"SULU here..."
 1110 INPUT "ENERGY";O : IF O < = 0 RETURN 
 1115 PRINT "Phasers locked on target."
 1120 FOR R = 0 TO 250 : NEXT R
 1125 FOR R = 192 TO 255
 1130 IF A(R) < 25 THEN 1170
 1135 X = INT ((R - 192) / 8) : Y = R - 192 - X * 8
 1140 J2 = X : K2 = Y
 1145 J1 = X - A(259) : K1 = Y - A(260) : GOSUB 1640
 1150 Q = 2 : GOSUB 615 : Q = 0 : J1 = J2 : K1 = K2 : L = O : GOSUB 1640
 1155 IF P = - 1 THEN 1165
 1160 IF A(P) < 25 THEN 1170
 1165 IF E - 100 - O > 0 LET E = E - O : GOSUB 555
 1170 NEXT R : RETURN 
 1175 CLS : RESTO : IF A(269) < > 0 LET I = 3 : GOTO 470
 1180 READ B$,J : IF J < > 50 THEN 1180
 1185 PRINT "SHIP'S COMPUTER command functions : ": PRINT 
 1190 PRINT TAB 4)J - 50;" DATA BASE SCAN TO LOCATE ";B$
 1195 IF J < > 54 READ B$,J : GOTO 1190
 1200 PRINT TAB 5)"5  LONG RANGE SENSOR SCAN FROM DATA BASE"
 1205 PRINT TAB 5)"6  QUADRANT DETAILED DISPLAY"
 1210 PRINT : INPUT "Enter function";O
 1215 IF O < 0 OR O > 6 OR INT (O) < > O THEN 1175
 1220 IF O < 5 THEN 1230
 1225 ON O - 4 GOTO 1310,1285
 1230 CLS : RESTO 
 1235 READ B$,J : IF J - 50 < > O THEN 1235
 1240 PRINT "ENTERPRISE CURRENTLY LOCATED at : ";A(256);A(257);A(258)
 1245 PRINT "Data base scan for ";B$;" : ": PRINT 
 1250 FOR P = 0 TO 191
 1255 IF O = 4 AND A(P) < 0 THEN 1275
 1260 IF A(P) < 0 OR O = 4 THEN 1280
 1265 GOSUB 1590
 1270 IF A(262 + O) = 0 THEN 1280
 1275 GOSUB 1575 : PRINT B;C;D,
 1280 NEXT P : PRINT : GOTO 1610
 1285 INPUT "enter Quadrant (X,Y,Z)";B,C,D : GOSUB 1560
 1290 IF P = - 1 THEN 1285
 1295 GOSUB 1590
 1300 IF A(P) < 0 PRINT "No data available." : GOTO 2025
 1305 GOTO 1645
 1310 INPUT "enter Quadrant (X,Y,Z)";U,V,W : CLS 
 1315 PRINT @904,"LONG RANGE COMPUTER QUADRANT SCAN of";U;V;W;
 1320 R = 1 : GOTO 1695
 1325 CLS : IF A(270) < > 0 LET I = 4 : GOTO 470
 1330 U = A(256) : V = A(257) : W = A(258) : R = 0
 1335 PRINT @899,"LONG RANGE SENSOR SCAN"; : PRINT @938,"Quadrant";U;V;W;
 1340 GOTO 1695
 1345 CLS : IF A(272) < > 0 LET I = 6 : GOTO 470
 1350 Q = 1 : GOSUB 1980
 1355 INPUT "HEADING (0-8)";I : IF A(271) = 0 PRINT TAB 18)" ";
 1360 IF I < 0 OR I > 8 THEN 1355
 1365 J1 = COS (I * C1) : K1 = - SIN (I * C1) : GOSUB 2040
 1370 INPUT "SPEED (0-9)";J : IF A(271) = 0 PRINT TAB 18)" ";
 1375 IF J < 0 OR J > 9 THEN 1370
 1380 IF J = 0 RETURN 
 1385 GOSUB 1640 : A(X * 8 + Y + 192) = 0
 1390 FOR I = 1 TO J : X = X + J1 : Y = Y + K1
 1395 GOSUB 2030 : GOSUB 1565
 1400 B$ = "ENERGY BARRIER"
 1405 IF P = - 1 LET E = RND (E) : GOTO 1445
 1410 IF B < > A(256) OR C < > A(257) THEN 1460
 1415 W = A( INT (X) * 8 + INT (Y) + 192) : B$ = "COLLISION"
 1420 IF W < > 20 THEN 1440
 1425 IF J - I > 1 LET S = S - 100 : GOTO 1445
 1430 IF A(A(256) * 8 + A(257) + A(258) * 64) = 1006 THEN 240
 1435 A(276) = 3 : E = 4000 : GOTO 1455
 1440 IF W = 0 THEN 1460
 1445 IF J - I > 1 GOSUB 330 : GOSUB 520 : W = 0 : GOTO 1455
 1450 IF W < > 2 AND W < > 3 AND W < > 19 GOSUB 330 : GOSUB 520
 1455 X = X - J1 : Y = Y - K1 : GOSUB 2030 : GOTO 1465
 1460 NEXT I
 1465 X = INT (X) : Y = INT (Y) : A(X * 8 + Y + 192) = 18
 1470 IF B < > A(256) OR C < > A(257) GOSUB 1635 : GOTO 910
 1475 GOSUB 1635 : Q = 1 : GOSUB 1980
 1480 IF W = 2 OR W = 3 OR W = 19 THEN 1495
 1485 IF E = 4000 PRINT "Docked" : PRINT TAB 18)" "; : GOSUB 1615 : T = T + 1 : J = 2 : GOTO 485
 1490 GOTO 1615
 1495 IF W = 2 GOSUB 1640 : GOSUB 1560 : A(P) = FIX ( ABS (A(P)) / 10) * 10 + 9
 1500 PRINT TAB 16)"Orbit" : PRINT TAB 18)" "; : GOTO 1615
 1505 CLS : PRINT CHR$ (23)
 1510 PRINT @266,"Status Report : ": PRINT TAB 5) STRING$ (14,"-")
 1515 PRINT TAB 5)"Stardate : ";T
 1520 PRINT TAB 5)"Energy : ";E
 1525 B$ = "Green" : IF A(261) = 2 LET B$ = "Yellow"
 1530 IF A(261) = 3 LET B$ = "Red"
 1535 PRINT TAB 5)"Condition :  ";B$
 1540 PRINT TAB 5)"Quadrant : ";A(256);A(257);A(258)
 1545 PRINT TAB 5)"Sector : ";A(259);A(260)
 1550 PRINT TAB 5)"Photon Torpedoes : ";A(276)
 1555 GOTO 1610
 1560 IF D < 0 OR D > 2 LET P = - 1 : RETURN 
 1565 IF B < 0 OR B > 7 OR C < 0 OR C > 7 LET P = - 1 : RETURN 
 1570 P = 8 * B + C + 64 * D : RETURN 
 1575 D = INT (P / 64) : B = INT ((P - D * 64) / 8) : C = P - D * 64 - B * 8 : RETURN 
 1580 A(P) = A(262) * 1E4 + A(263) * 1E3 + A(264) * 1E2 + A(265) * 10 + A(266)
 1585 RETURN 
 1590 A(266) = ABS (A(P)) : K = 1E4
 1595 FOR N = 0 TO 3
 1600 A(262 + N) = INT (A(266) / K) : A(266) = A(266) - A(262 + N) * K : K = K / 10
 1605 NEXT N : RETURN 
 1610 PRINT 
 1615 IF Q = 1 LET Q = 0 : RETURN 
 1620 PRINT "Hit (ENTER) to continue.";
 1625 A$ = INKEY$ 
 1630 IF INKEY$ = ""THEN 1630 : ELSE RETURN 
 1635 A(256) = B : A(257) = C : A(258) = D : A(259) = X : A(260) = Y : RETURN 
 1640 B = A(256) : C = A(257) : D = A(258) : X = A(259) : Y = A(260) : RETURN 
 1645 CLS : PRINT @384," ","Coordinates : ";B;C;D
 1650 PRINT " ","Klingons : ";A(262),"Starbases : ";A(263)
 1655 PRINT " ","Stars : ";A(263),"Planets : ";A(264)
 1660 RESTO : IF A(266) > 6 OR A(266) < 2 LET B$ = "None" : GOTO 1670
 1665 READ B$,J : IF J - 30 < > A(266) THEN 1665
 1670 PRINT " ","Astronomical feature :  ";B$ : RESTO 
 1675 IF A(266) < 7 LET B$ = "None" : GOTO 1685
 1680 READ B$,J : IF J - 30 < > A(266) THEN 1680
 1685 PRINT " ","Scientific Interest :  ";B$ : PRINT : PRINT 
 1690 GOTO 1615
 1695 PRINT @64,""
 1700 FOR C = V - 1 TO V + 1 : FOR D = W - 1 TO W + 1 : FOR B = U - 1 TO U + 1
 1705 GOSUB 1560
 1710 IF P = - 1 PRINT "  Unknown Quadrant "; : GOTO 1765
 1715 IF R = 0 LET A(P) = ABS (A(P))
 1720 IF R = 1 AND A(P) < 0 PRINT "      No data      "; : GOTO 1765
 1725 IF ABS (A(P)) = 1 PRINT "        void       "; : GOTO 1765
 1730 GOSUB 1590
 1735 IF A(266) = 2 PRINT "  Large Black Hole "; : GOTO 1765
 1740 IF A(266) = 3 PRINT "    Class O Star   "; : GOTO 1765
 1745 IF A(266) = 4 PRINT "       Pulsar      "; : GOTO 1765
 1750 IF A(266) = 5 PRINT "    Space Noise    "; : GOTO 1765
 1755 IF A(266) = 6 PRINT "   Star Fleet HQ   "; : GOTO 1765
 1760 PRINT "  K";A(262);"B";A(263);"S";A(264);"P";A(265);" ";
 1765 NEXT B : PRINT " ";D : NEXT D : PRINT CHR$ (26); : NEXT C
 1770 PRINT @8,U - 1; : PRINT @28,U; : PRINT @47,U + 1;
 1775 PRINT @253,V - 1; : PRINT @509,V; : PRINT @765,V + 1;
 1780 PRINT @979,""; : I = 191
 1785 FOR Z = 15360 TO 16192 STEP 64
 1790 IF Z = 16192 LET I = 143
 1795 POKE Z,I : POKE Z + 19,I : POKE Z + 38,I : POKE Z + 57,I
 1800 NEXT Z
 1805 FOR Z = 15425 TO 15487
 1810 IF PEEK (Z) = 32 POKE Z,140 : POKE Z + 256,140 : POKE Z + 512,140 : POKE Z + 768,140
 1815 NEXT Z : GOTO 1615
 1820 I = 0 : B$ = "Non-entity"
 1825 IF A(P) = 2 LET I = 4 : B$ = "Class M Planet"
 1830 IF A(P) = 3 LET I = 4 : B$ = "Class G Planet"
 1835 IF A(P) = 18 LET I = 5 : B$ = "Star Ship"
 1840 IF A(P) = 19 LET I = 3 : B$ = "Class F Star"
 1845 IF A(P) = 20 LET I = 2 : B$ = "Star Base"
 1850 IF A(P) > 24 LET I = 1 : B$ = "KLINGON WARSHIP"
 1855 RETURN 
 1860 GOSUB 1820
 1865 ON I + 1 GOTO 1870,1935,1925,1905,1890,1875
 1870 RETURN 
 1875 FOR Z = U - 7 TO U - 1 : SET (Z,V - 1) : NEXT Z
 1880 FOR Z = U - 4 TO U + 5 : SET (Z,V + 1) : NEXT Z
 1885 FOR Z = U + 1 TO U + 7 : SET (Z,V) : NEXT Z : SET (U - 3,V) : RETURN 
 1890 FOR Z = U - 3 TO U + 3 : SET (Z,V - 1) : SET (Z,V) : SET (Z,V + 1) : NEXT Z
 1895 RESET (U - 3,V - 1) : RESET (U + 3,V - 1) : RESET (U - 3,V + 1) : RESET (U + 3,V + 1)
 1900 RETURN 
 1905 FOR Z = U - 2 TO U + 1 : SET (Z,V) : NEXT Z
 1910 FOR Z = V - 1 TO V + 1 STEP 2
 1915 SET (U - 2,Z) : SET (U + 1,Z) : SET (U - 3,Z) : SET (U + 2,Z)
 1920 NEXT Z : RETURN 
 1925 FOR Z = U - 5 TO U + 5 : SET (Z,V + 1) : NEXT Z
 1930 SET (U,V) : SET (U - 2,V - 1) : SET (U - 1,V - 1) : SET (U,V - 1) : RETURN 
 1935 FOR Z = U - 5 TO U + 5 : SET (Z,V) : NEXT Z
 1940 SET (U - 5,V - 1) : SET (U - 4,V - 1) : SET (U + 4,V - 1) : SET (U + 5,V - 1)
 1945 SET (U - 1,V + 1) : SET (U,V + 1) : SET (U + 1,V + 1) : RETURN 
 1950 B = RND (8) - 1 : C = RND (8) - 1 : D = 3
 1955 FOR U = B - 1 TO B + 1 : FOR V = C - 1 TO C + 1
 1960 IF U < 0 OR U > 7 OR V < 0 OR V > 7 THEN 1970
 1965 P = 8 * U + V + 192 : IF A(P) < > 0 THEN 1950
 1970 NEXT V : NEXT U
 1975 GOSUB 1565 : A(P) = M : RETURN 
 1980 CLS : IF A(271) < > 0 LET I = 5 : GOTO 470
 1985 PRINT : FOR C = 0 TO 7 : FOR B = 0 TO 7
 1990 P = B * 8 + C + 192 : PRINT "   -    ";
 1995 IF A(P) < > 0 LET U = B * 16 + 7 : V = 3 * C + 4 : GOSUB 1860
 2000 NEXT B : NEXT C : GOSUB 2015
 2005 PRINT @650,"SHORT RANGE SENSOR SCAN of Quadrant";
 2010 PRINT A(256);A(257);A(258) : PRINT TAB 18)" "; : GOTO 1615
 2015 PRINT @0, STRING$ (63,"="); : PRINT @576, STRING$ (63,"=");
 2020 RETURN 
 2025 FOR N = 0 TO 2000 : NEXT N : RETURN 
 2030 X = B * 8 + X : B = INT (X / 8) : X = X - B * 8 : Y = C * 8 + Y : C = INT (Y / 8) : Y = Y - C * 8
 2035 RETURN 
 2040 IF ABS (J1) > ABS (K1) LET K1 = K1 / ABS (J1) : J1 = J1 / ABS (J1) : GOTO 2050
 2045 J1 = J1 / ABS (K1) : K1 = K1 / ABS (K1)
 2050 J1 = FIX (J1 * 1000 + .5 * SGN (J1)) / 1000
 2055 K1 = FIX (K1 * 1000 + .5 * SGN (K1)) / 1000 : RETURN 
 2060 CLS 
 2065 B$ = "LARGE BLACK HOLE" : IF A(266) = 3 LET B$ = "CLASS O STAR"
 2070 IF A(266) = 4B$ = "PULSAR"
 2075 B$ = "AFTER FLYING INTO A "+ B$
 2080 PRINT @320,"ON STARDATE"; STR$ (T);", ";B$ + ","
 2085 PRINT "THE ENTERPRISE & CREW WERE LOST TO SPACE."
 2090 PRINT : PRINT : END 
 2095 CLS : B$ = "AFTER DEPLETING ITS ENERGY SUPPLY" : GOTO 2080
 2100 CLS : B$ = "WHILE DOING BATTLE AGAINST THE KLINGONS" : GOTO 2080
 2105 CLS 
 2110 PRINT @448,"Destruction of a ";B$;" is grounds for court-martial."
 2115 PRINT : PRINT "You are relieved of your command."
 2120 PRINT : PRINT : END 
 2125 DATA "STATUS",0,"DAMAGE CONTROL",1,"SCIENCE COMPUTER",2
 2130 DATA "SHIP'S COMPUTER",3,"LR SENSORS",4,"SR SENSORS",5
 2135 DATA "IMPULSE ENGINES",6,"WARP DRIVE",7,"PHASERS",8
 2140 DATA "PHOTON TORPEDOES",9,"ALERT",10,"REPAIR",11
 2145 DATA "KLINGON WARSHIPS",50,"STARBASES",51
 2150 DATA "CLASS F STARS",52,"PLANETS",53
 2155 DATA "UNEXPLORED AREAS",54
 2160 DATA "GREEN",21,"YELLOW ALERT",22,"RED ALERT",23
 2165 DATA "Black Hole",32,"O Star",33,"Pulsar",34
 2170 DATA "Space Noise",35,"Star Fleet HQ",36,"G Planet",37
 2175 DATA "Unexplored M Planet",38,"Explored M Planet",39
 2180 DATA "PROMOTED",425,"DECORATED",350,"REASSIGNED",290
 2185 DATA "DEMOTED",190,"RESIGNED",-32675
 2190 DATA "E",999,30111,31111,30101,20121,20201,20001
 2195 DATA 10001,10111,10211,10321,10221,-99
 2200 DATA 1110,110,110,110,110
 2205 DATA 1111,1111,1211,1121,1121
 2210 DATA 3,3,2,2
 2215 DATA 121,121,211,211,311,311,321,321,221,221
 2220 DATA 121,121,211,211,311,311,321,321,221,221,0

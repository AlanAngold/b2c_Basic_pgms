    1 REM NOTE: Basic language type forced to be:
    2 REM       trs2 - TRS-80 Level II BASIC tokenized file
   10 REM  TRS-80 LEVEL II BASIC
   15 REM  COPYRIGHT (C) 1978 BY MARIN COMPUTER CENTER, CREATIVE COMPUTING
   17 REM    AND BRIAN PULLEN     ALL RIGHTS RESERVED
   20 DIM A$(20)
   30 CLS
   40 PRINT@283,"ROMULAN"
   60 PRINT@409,"COPYRIGHT BY"
   70 PRINT@470,"CREATIVE COMPUTING"
   80 PRINT@536,"P.O. BOX 789-M"
   90 PRINT@593,"MORRISTOWN, NEW JERSEY 07960"
  100 FOR I=1TO2000:NEXT I:CLS
  110 PRINT CHR$(14);TAB(20);"DO YOU WANT A BRIEFING? ";
  120 P$=INKEY$:P$=P$:IF P$="" THEN 120 ELSE PRINT CHR$(15)
  130 IF P$="Y" THEN GOSUB 2100
  160 CLS:PRINT CHR$(28);
  170 FOR X=1 TO 14:PRINT:NEXT X
  180 REM  SET UP BORDER
  190 FOR Y=15429 TO 15480:POKE Y,191:NEXT Y
  200 FOR Y=15480 TO 16184 STEP 64:POKE Y,191:NEXT Y
  210 FOR Y=16184 TO 16133 STEP -1:POKE Y,191:NEXT Y
  220 FOR Y=16133 TO 15429 STEP -64:POKE Y,191:NEXT Y
  230 POKE 15866,55:POKE 15867,56:POKE 15868,57
  240 POKE 15930,52:POKE 15931,42:POKE 15932,54
  250 POKE 15994,49:POKE 15995,50:POKE 15996,51
  260 PRINT @ 832,"DIRECTIONS ON RIGHT SIDE.";
  280 REM  FILL IN THE STARS
  290 FOR Z=1 TO 10
  300 Y=INT(626*RND(0))+15494
  310 FOR X=15493 TO 16069 STEP 64
  320 IF Y>X AND Y<X+51 THEN X=16070:NEXT X:GOTO 340 ELSE NEXT X
  330 GOTO 300
  340 POKE Y,42
  350 NEXT Z
  360 REM  CHOOSE POSITION OF ENTERPRISE AND ROMULAN
  370 A=INT(626*RND(0))+15494
  380 FOR Z=15493 TO 16069 STEP 64
  390 IF A>Z AND A<Z+51 THEN Z=16070:NEXT Z:GOTO 410 ELSE NEXT Z
  400 GOTO 370
  410 POKE A,28
  420 B=INT(626*RND(0))+15494
  430 FOR Z=15493 TO 16069 STEP 64
  440 IF B>Z AND B<Z+51 THEN Z=16070:NEXT Z:GOTO 460 ELSE NEXT Z
  450 GOTO 420
  460 FOR Z=1 TO 10
  470 FOR Y=1 TO 100:NEXT Y:POKE B,140
  480 FOR Y=1 TO 100:NEXT Y:POKE B,32
  490 NEXT Z
  500 POKE B,32
  510 REM  RANDOMLY MOVE ROMULAN TO DIFFERENT POSITION
  520 D1=RND(8)
  530 RESTORE
  540 FOR Y=1 TO 8:READ D2:IF D1=Y THEN Y=9:NEXT Y:GOTO 550 ELSE NEXT Y
  550 D1=D2
  560 B1=B+D1
  570 FOR X=15493 TO 16069 STEP 64
  580 IF B1>X AND B1<X+51 THEN X=16070:NEXT X:GOTO 590 ELSE NEXT X:GOTO 520
  590 B=B1
  600 PRINT @ 896,"MOVE, FIRE OR SENSOR SCAN? ";CHR$(14);
  610 GOSUB 2020
  620 IF A$="M" THEN 910
  630 IF A$="F" THEN 710
  640 IF A$="S" THEN 660 ELSE 600
  650 REM  SENSOR SCAN
  660 FOR Z=1 TO 5
  670 FOR Y=1 TO 100:NEXT Y:POKE B,140
  680 FOR Y=1 TO 100:NEXT Y:POKE B,32
  690 NEXT Z:GOTO 1110
  700 REM  FIRING OF ENTERPRISE
  710 PRINT @ 896,"DIRECTION (1-9)? ";CHR$(14);
  720 GOSUB 2040
  730 RESTORE
  740 FOR Z=1 TO 9:READ D2:IF Z=D THEN Z=10:NEXT Z:GOTO 750 ELSE NEXT Z:GOTO 710
  750 D=D2
  760 FOR Z=1 TO 15
  770 C1=A+(Z*D):C2=A+((Z-1)*D)
  780 IF Z=1 THEN 790 ELSE POKE C2,32
  790 IF C1=B THEN Z=16:NEXT Z:GOTO 840
  800 FOR Y=15493 TO 16069 STEP 64
  810 IF C1>Y AND C1<Y+51 THEN Y=16070:NEXT Y:GOTO 820 ELSE NEXT Y:Z=16:NEXT Z:GOTO 1110
  820 IF PEEK(C1)=42 THEN Z=16:NEXT Z:GOTO 1110
  821 POKE C1,35:NEXT Z
  830 POKE C1,32:GOTO 1110
  840 FOR Z=1 TO 7
  850 FOR Y=1 TO 100:NEXT Y:POKE B,140
  860 FOR Y=1 TO 100:NEXT Y:POKE B,32
  870 NEXT Z
  880 PRINT @ 896,"YOU HAVE DESTROYED THE ROMULAN!";
  890 FOR Z=1 TO 2500:NEXT Z:GOTO 3000
  900 REM  MOVEMENT OF THE ENTERPRISE
  910 PRINT @ 896,"DIRECTION (1-9)? ";CHR$(14);
  920 GOSUB 2040
  930 RESTORE
  940 FOR Y=1 TO 9:READ D2:IF D=Y THEN Y=10:NEXT Y:GOTO 960 ELSE NEXT Y
  950 GOTO 910
  960 D=D2
  970 DATA 63,64,65,-1,0,1,-65,-64,-63
  980 PRINT @ 896,"HOW FAR (1-7)? ";CHR$(14);
  990 GOSUB 2060
 1000 IF F<1 OR F>7 THEN 980
 1010 REM  CHECK TO SEE IF OUT OF BOUNDS
 1020 FOR Z=1 TO F
 1030 A1=A+(Z*D):A2=A+((Z-1)*D)
 1040 FOR Y=15493 TO 16069 STEP 64
 1050 IF A1>Y AND A1<Y+51 THEN Y=16070:NEXT Y:GOTO 1070
 1060 NEXT Y:Z=F+1:NEXT Z:GOTO 1100
 1070 IF A1=B THEN Z=F+1:NEXT Z:GOTO 1930
 1075 IF PEEK(A1)=42 THEN Z=F+1:NEXT Z:POKE A2,32:GOTO 2080
 1080 POKE A2,32:POKE A1,28:NEXT Z
 1090 A=A1:GOTO 1110
 1100 A=A2
 1110 REM  FIND QUADRANT OF THE ENTERPRISE
 1120 FOR Z=16070 TO 15494 STEP -64
 1130 IF A>Z+24 THEN Z=15493:NEXT Z:GOTO 1140 ELSE IF A>=Z THEN Z=15493:NEXT Z:GOTO 1150 ELSE NEXT Z
 1140 IF A>15799 THEN 1160 ELSE 1170
 1150 IF A>15799 THEN 1180 ELSE 1190
 1160 E=4:GOTO 1200
 1170 E=2:GOTO 1200
 1180 E=3:GOTO 1200
 1190 E=1
 1200 REM  FIND QUADRANT AND DIRECTION TO MOVE ROMULAN
 1210 FOR Z=16070 TO 15494 STEP -64
 1220 IF B>Z+24 THEN Z=15493:NEXT Z:GOTO 1240 ELSE IF B>=Z THEN Z=15493:NEXT Z:GOTO 1250
 1230 NEXT Z
 1240 IF B>15799 THEN 1260 ELSE 1270
 1250 IF B>15799 THEN 1280 ELSE 1290
 1260 E1=4:GOTO 1300
 1270 E1=2:GOTO 1300
 1280 E1=3:GOTO 1300
 1290 E1=1
 1300 IF E=E1 THEN 1520
 1310 IF E1-E=1 THEN 1340 ELSE IF E1-E=2 THEN 1350
 1320 IF E1-E=3 THEN 1360 ELSE IF E1-E=-1 THEN 1370
 1330 IF E1-E=-2 THEN 1380 ELSE IF E1-E=-3 THEN 1390
 1340 IF E1=3 THEN 1400 ELSE D1=-1:GOTO 1420
 1350 D1=-64:GOTO 1420
 1360 D1=-65:GOTO 1420
 1370 IF E1=2 THEN 1410 ELSE D1=1:GOTO 1420
 1380 D1=64:GOTO 1420
 1390 D1=65:GOTO 1420
 1400 D1=-63:GOTO 1420
 1410 D1=63:GOTO 1420
 1420 FOR Z=1 TO 5
 1430 B1=B+(Z*D1):B2=B+((Z-1)*D1)
 1440 FOR Y=15493 TO 16069 STEP 64
 1450 IF B1>Y AND B1<Y+51 THEN Y=16070:NEXT Y:GOTO 1470 ELSE NEXT Y
 1460 Z=6:NEXT Z:GOTO 1510
 1470 IF B1=A THEN 1480 ELSE 1490
 1480 B=B1:Z=6:NEXT Z:GOTO 1930
 1490 NEXT Z
 1500 B=B1:GOTO 600
 1510 B=B2:GOTO 600
 1520 REM  IF IN SAME QUADRANT PICK SEMI-RANDOM DIRECTION
 1530 IF B<(A-20) THEN 1550 ELSE IF B<A THEN 1560
 1540 IF B>(A-20) THEN 1570 ELSE IF B>A THEN 1580
 1550 D1=INT(3*RND(0))+2:F1=1:GOTO 1590
 1560 D1=1:F1=3:GOTO 1590
 1570 D1=INT(3*RND(0))+6:F1=1:GOTO 1590
 1580 D1=5:F1=3:GOTO 1590
 1590 RESTORE
 1600 FOR Y=1 TO 8:READ D2:IF Y=D1 THEN Y=9:NEXT Y:GOTO 1610 ELSE NEXT Y
 1610 D1=D2
 1620 REM  MOVE ROMULAN AND CHECK IF OUT OF BOUNDS
 1630 FOR Y=1 TO F1
 1640 B1=B+(Y*D1):B2=B+((Y-1)*D1)
 1650 IF PEEK(B1)=42 THEN Y=F1+1:NEXT Y:B=B2:GOTO 1720 ELSE IF B1=A THEN 1660 ELSE 1670
 1660 B=B1:Y=F1+1:NEXT Y:GOTO 1930
 1670 FOR X=15493 TO 16069 STEP 64
 1680 IF B1>X AND B1<X+51 THEN X=16070:NEXT X:GOTO 1700 ELSE NEXT X
 1690 B=B2:Y=F1+1:NEXT Y:GOTO 1720
 1700 NEXT Y
 1710 B=B1
 1720 IF B>A+15 OR B<A-15 THEN 600
 1730 REM  FIRING OF ROMULAN
 1740 IF B>A THEN 1750 ELSE D1=1:GOTO 1760
 1750 D1=-1
 1760 POKE B,140
 1770 FOR Z=1 TO 10
 1780 C3=B+(Z*D1):C4=B+((Z-1)*D1)
 1790 IF Z=1 THEN 1800 ELSE POKE C4,32
 1800 IF C3=A THEN Z=11:NEXT Z:GOTO 1860
 1810 FOR Y=15493 TO 16069 STEP 64
 1820 IF C3>Y AND C3<Y+51 THEN Y=16070:NEXT Y:GOTO 1830 ELSE NEXT Y:GOTO 1850
 1830 IF PEEK(C3)=42 THEN Z=11:NEXT Z:GOTO 1850 ELSE POKE C3,58:FOR Y=1 TO 25:NEXT Y:NEXT Z
 1840 POKE C3,32
 1850 GOTO 500
 1860 FOR Z=1 TO 7
 1870 FOR Y=1 TO 100:NEXT Y:POKE A,28
 1880 FOR Y=1 TO 100:NEXT Y:POKE A,32
 1890 NEXT Z
 1900 PRINT @ 896,"YOU HAVE BEEN DESTROYED BY THE ROMULAN!";
 1910 FOR Z=1 TO 2500:NEXT Z
 1920 GOTO 3000
 1930 POKE A2,32:POKE B2,32
 1940 PRINT @ 896,"YOU AND THE ROMULAN HAVE COLLIDED WITH EACH OTHER!";
 1950 FOR Z=1 TO 7
 1960 FOR Y=1 TO 100:NEXT Y:POKE B,28
 1970 FOR Y=1 TO 100:NEXT Y:POKE B,140
 1980 NEXT Z
 1990 POKE B,32
 2000 FOR Z=1 TO 1000:NEXT Z:GOTO 3000
 2020 A$=INKEY$:A$=A$:IF A$="" THEN 2020 ELSE PRINT A$;CHR$(15);
 2030 PRINT @ 896,CHR$(30);:PRINT @ 896,"";:RETURN
 2040 A$=INKEY$:A$=A$:IF A$="" THEN 2040 ELSE D=VAL(A$):PRINT D;CHR$(15);
 2050 GOSUB 2030:RETURN
 2060 A$=INKEY$:A$=A$:IF A$="" THEN 2060 ELSE F=VAL(A$):PRINT F;CHR$(15);
 2070 GOSUB 2030:RETURN
 2080 PRINT @ 896,"YOU HAVE INCINERATED YOURSELF IN THE STAR!!":FOR Z=1 TO 2000:NEXT Z:GOTO 3000
 2100 CLS:PRINT"AS COMMANDER OF THE ENTERPRISE, YOU MUST LOCATE AND DESTORY THE"
 2110 PRINT"ROMULAN SHIP BEFORE IT DESTROYS YOU.":PRINT
 2120 PRINT"THERE IS ONE SMALL PROBLEM....THE ROMULANS HAVE THE CLOAKING"
 2130 PRINT"DEVICE AND YOU DON'T.  THERE ARE ONLY TWO WAYS TO FIND THEM:":PRINT
 2140 PRINT"1) SCAN WITH THE FEDERATION'S NEW ANTI-CLOAKING DEVICE WHICH"
 2150 PRINT"   USES ENORMOUS AMOUNTS OF POWER AND CAN ONLY OPERATE FOR A"
 2160 PRINT"   FEW SECONDS AT A TIME.":PRINT
 2170 PRINT"2) YOU MAY WAIT FOR THE ROMULANS TO FIRE ON YOU - THEY DON'T"
 2180 PRINT"   HAVE ENOUGH POWER TO KEEP THE DEVICE ON WHILE FIRING...BUT"
 2190 PRINT"   BY THEN IT MAY BE TOOOO LATE!!"
 2200 PRINTTAB(22)"G O O D   L U C K ! !"
 2210 PRINT:INPUT "PRESS RETURN TO CONTINUE ";X$
 2220 RETURN
 3000 CLS:INPUT"ANOTHER GAME";A$
 3010 IF LEFT$(A$,1)="Y"THEN160
 3020 CLS:PRINT"THANKS FOR PLAYING!"
 3030 RUN"MENU"
 3040 PRINT:PRINT"TO LOAD ANOTHER PROGRAM, TYPE 'CLOAD'.":PRINT:END

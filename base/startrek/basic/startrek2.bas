    1 REM NOTE: Basic language type forced to be:
    2 REM       trs2 - TRS-80 Level II BASIC tokenized file
    1 IFC1<>0THEN115
    2 POKE 16553,255
    5 RANDOM:CLEAR100:DEFINTA,E,P,S,W,U,V,Z:DIMA(276):RESTORE:CLS
   10 FORZ=0TO10:PRINT@RND(703),"*";:NEXTZ
   15 PRINT@704,<ERROR>"STAR TREK III Version 3.3":PRINT<ERROR>"Lance Micklus, Winooski, Vt.":<ERROR>PRINT"COPYRIGHT December 1978"
   20 U=25:V=14:I=5:GOSUB1865
   25 U=100:V=25:I=1:GOSUB1865
   30 U=80:V=12:I=4:GOSUB1865
   35 READB$,J:IFJ<>999THEN35
   40 P=RND(191)-1:IFA(P)<>0THEN40
   45 READJ:IFJ>0LETA(P)=-J:GOTO40
   50 P=RND(150):M=P:IFA(P)<>0THEN50
   55 GOSUB1575:GOSUB1635
   60 FORB=A(256)-1TOA(256)+1:FORC=A(257)-1TOA(257)+1
   65 FORD=A(258)-1TOA(258)+1
   70 GOSUB1560
   75 IFP<>-1LETA(P)=10*FIX(A(P)/10)-5
   80 NEXTD:NEXTC:NEXTB:A(M)=-4
   85 P=RND(191)-1:IFA(P)<>0THEN85
   90 READA(P):IFA(P)<>0LETA(P)=-A(P):GOTO85
   95 FORN=0TO190:IFA(N)=0THENA(N)=-1
  100 NEXTN:A(256)=7:A(257)=7:A(258)=2:A(276)=3
  105 E=3999:T=2200:H=2470:Q=0:A(191)=1006:S=0:C1=0.785398
  110 A(259)=3:A(260)=3:A(261)=1:GOSUB910
  115 CLS:RESTORE:PRINTCHR$(23)
  120 PRINT"ENTERPRISE and CREW":PRINT"AWAITING YOUR ORDERS, CAPTAIN."
  125 READB$,J:PRINTTAB(5)J;:PRINTTAB(9)B$:IFJ<>11THEN125
  130 INPUT"Orders";O
  135 IFO<0ORO>11ORINT(O)<>OTHEN115
  140 IFO>4THEN150
  145 ONO+1GOSUB1505,420,350,1175,1325:GOTO155
  150 ONO-4GOSUB1980,1345,835,1100,1070,295,485
  155 GOSUB1640:GOSUB1560:IFABS(A(P))<10000THEN185
  160 GOSUB995
  165 IFA(261)=2LETA(261)=3:GOSUB320
  170 IFA(268)=0ANDA(271)=0LETO=3:GOSUB365
  175 IFA(271)=0GOSUB1980
  180 GOTO195
  185 B$="SPACE STORM"
  190 IFRND(100)=100GOSUB330:GOSUB520
  195 IFA(261)>1GOSUB1505
  200 T=T+.2:E=E-A(261)*A(261)*10
  205 IFE<0THEN2095
  210 J=1:GOSUB485
  215 IFT<HTHEN115
  220 CLS:PRINTCHR$(23):PRINT@384,"STAR FLEET COMMAND REQUESTS"
  225 PRINT"ENTERPRISE RETURN TO"
  230 PRINT"STARBASE 7,7,2":H=H+10:GOSUB1610:GOTO115
  235 GOTO115
  240 CLS:RESTORE:N=2500-T:IFN<0THENS=S+N*10
  245 FORP=0TO191:IFA(P)<0THEN255ELSES=S+1
  250 IFA(P)-(FIX(A(P)/10)*10)=9LETS=S+20
  255 NEXTP
  260 READB$,Z:IFZ<>425THEN260
  265 IFS<ZREADB$,Z:GOTO265
  270 PRINT@256,"RATING:";INT(S/4.91)
  275 PRINT:PRINT"ADMIRAL FITZPATRICK HERE...":PRINT
  280 PRINTTAB(5)"CAPTAIN, AFTER REVIEWING YOUR LOG AND DATA TAPES,"
  285 PRINT"I AM GOING TO RECOMMEND TO STAR FLEET THAT YOU BE ";B$;"."
  290 PRINT:PRINT:END
  295 CLS:PRINTCHR$(23)
  300 PRINT@320,"1 - Green":PRINT"2 - Yellow":PRINT"3 - Red"
  305 INPUT"ENTER CONDITION CODE";N
  310 IFN<1ORN>3ORINT(N)<>NTHEN305
  315 A(261)=N:IFN=1RETURN
  320 RESTORE
  325 READB$,J:IFJ-20<>A(261)THEN325
  330 CLS:PRINTCHR$(23)
  335 B$=STRING$((30-LEN(B$))/2," ")+B$
  340 FORK=0TO4:PRINT@512,B$:FORJ=0TO200:NEXTJ
  345 PRINT@512,CHR$(30):FORJ=0TO200:NEXTJ:NEXTK:RETURN
  350 CLS:IFA(268)<>0LETI=2:GOTO470
  355 IFA(271)<>0LETI=5:GOTO470
  360 O=0
  365 FORP=192TO255:IFA(P)=18ORA(P)=0THEN410
  370 IFO=3ANDA(P)<25THEN410
  375 CLS:U=62:V=14
  380 FORZ=0TORND(5)+2:PRINT@RND(512)+63,"*";:NEXTZ
  385 GOSUB2015:GOSUB1860:GOSUB1575
  390 PRINT:PRINT"Object at";STR$(B);STR$(C);" is a ";B$;"."
  395 IFA(P)<25THEN405
  400 PRINT"READING";A(P)-25;"units of ENERGY."
  405 GOSUB2025
  410 NEXTP
  415 RETURN
  420 CLS:RESTORE:READB$,Z
  425 IFA(267)<>0LETI=1:GOTO470
  430 PRINT"Lt. Uhura here..."
  435 PRINT"DAMAGE CONTROL REPORTS THE FOLLOWING:":PRINT
  440 FORZ=267TO275:READB$,J:PRINTTAB(14)B$,
  445 IFZ=275ANDA(276)=0PRINT"** INOPERATIVE **":GOTO465
  450 IFA(Z)=0PRINT"OPERATIONAL":GOTO465
  455 IFA(Z)<10PRINT"NEARLY OPERATIONAL"
  460 IFA(Z)>9PRINT"** INOPERATIVE **"
  465 NEXTZ:GOTO1610
  470 CLS:PRINTCHR$(23):RESTORE
  475 READB$,J:IFI<>JTHEN475
  480 PRINT@320,B$;" INOPERATIVE":GOTO2025
  485 CLS:PRINTCHR$(23):PRINT@320,"";:FORN=1TOJ:FORZ=267TO275
  490 IFA(Z)=0THEN515
  495 A(Z)=A(Z)-RND(5):IFA(Z)>0THEN515
  500 A(Z)=0:RESTORE:IFA(267)<>0THEN515
  505 READB$,J:IFJ<>Z-266THEN505
  510 PRINTB$;" OPERATIONAL":GOSUB2025
  515 NEXTZ:NEXTN:RETURN
  520 FORJ=1TO4-A(261)
  525 Z=266+RND(9):IFA(Z)<>0THEN550
  530 A(Z)=RND(25)*J:IFA(267)<>0THEN550
  535 CLS:PRINTCHR$(23):RESTORE
  540 READB$,J:IFJ<>Z-266THEN540
  545 PRINT@320,"DAMAGE TO ";B$:GOSUB2025
  550 NEXTJ:RETURN
  555 CLS:P=X*8+Y+192:U=30:V=14
  560 GOSUB1860:GOSUB2015:Z=338:M=I
  565 PRINT:PRINTTAB(25)"sector:";X;Y
  570 B$=" *":IFQ=1ANDI=5GOSUB795:GOTO590
  575 B$="-":IFI=5THENGOSUB795:GOTO585
  580 Z=336:B$=")":GOSUB795
  585 B$=" ":GOSUB795
  590 L=L*4
  595 IFQ=1THEN615
  600 IFRND(2)=1LETJ1=J1-X:K1=K1-Y:GOTO615
  605 FORZ=1TOSQR(((X-J1)^2)+((Y-K1)^2)):L=L*.6:NEXTZ
  610 X=J1:Y=K1:GOTO635
  615 GOSUB2040
  620 X=X+J1:Y=Y+K1
  625 IFX<0ORX>7ORY<0ORY>7LETP=-1:CLS:GOTO670
  630 L=L*.6
  635 P=INT(X)*8+INT(Y)+192
  640 IFA(P)=0THEN620
  645 IFQ=2RETURN
  650 CLS:V=15:IFA(P)=18LETU=28
  655 IFQ<>1ANDI=5ANDA(P)<25LETP=-1:GOTO675
  660 IFQ<>1ANDI=1ANDA(P)<>18LETP=-1:GOTO675
  665 GOSUB1860
  670 IFQ=2RETURN
  675 GOSUB2015:PRINT:PRINTTAB(25)"sector:";INT(X);INT(Y)
  680 B$="* ":IFM=5ANDQ=1GOSUB815:GOTO700
  685 B$="-":IFM=5GOSUB815:GOTO695
  690 B$="(":GOSUB815
  695 B$=" ":GOSUB815
  700 Q=0:L=INT(L):IFP=-1ORI=0RETURN
  705 GOSUB1820
  710 IFM=5ANDI<>1THEN2105
  715 IFI<>5THEN740
  720 E=E-L
  725 IFL-A(261)*75>0GOSUB520:L=L-A(261)*75:GOTO725
  730 IFE>0RETURN
  735 GOTO2100
  740 IFI<>1THEN760
  745 A(P)=A(P)-L:IFA(P)>25RETURN
  750 GOTO760
  755 IFL<100RETURN
  760 PRINTTAB(20)B$;" DISTROYED"
  765 FORN=0TO30
  770 RESET(21+RND(17),12+RND(5)):SET(21+RND(17),12+RND(5))
  775 NEXTN
  780 A(P)=0:GOSUB1640:GOSUB1560
  785 A(P)=ABS(A(P))-10000:S=S+10
  790 RETURN
  795 FORN=ZTO380
  800 PRINT@N,B$;:FORW=1TO3:NEXTW
  805 NEXTN:IFQ=1PRINT@380,"  "
  810 RETURN
  815 FORN=380TO338STEP-1
  820 PRINT@N,B$;:FORW=1TO3:NEXTW
  825 NEXTN:IFQ=1PRINT@338," ";
  830 PRINT@640,"";:RETURN
  835 CLS:IFA(273)<>0LETI=7:GOTO470
  840 GOSUB1640
  845 PRINTCHR$(23):PRINT@320,"CHEKOV here..."
  850 INPUT"COURSE (X,Y,Z)";B,C,D:GOSUB1560
  855 IFP=-1THEN850
  860 INPUT"WARP FACTOR (0-8)";K:IFK=0THENRETURN
  865 IFK<0ORK>8ORINT(K)<>KTHEN860
  870 L=SQR(((A(256)-B)^2)+((A(257)-C)^2)+((A(258)-D)^2))
  875 IFE-100>L*K*K*KTHEN900
  880 CLS:PRINT@320,CHR$(23);"Scott here...":PRINT
  885 PRINT"Sorry CAPTAIN,":PRINT"but we just don't have"
  890 PRINT"enough energy."
  895 GOTO2025
  900 E=E-L*K*K*K:T=T+2*L*L/K:GOSUB1635
  905 J=INT(L*L/K):IFJ>0GOSUB485
  910 GOSUB1640:GOSUB1560:GOSUB1590
  915 IFA(266)=0LETA(266)=8:A(P)=FIX(ABS(A(P))/10)*10+8
  920 IFA(265)>0ANDA(266)=1LETA(266)=7:GOSUB1580
  925 B=X:C=Y:D=3:GOSUB1565
  930 IFA(266)>1ANDA(266)<5THEN2060
  935 IFA(266)>7LETA(265)=A(265)-1
  940 FORN=192TO255:A(N)=0:NEXTN:A(P)=18
  945 FORN=262TO265
  950 IFA(N)=0THEN980
  955 IFN=262LETM=RND(1500)+250
  960 IFN=263LETM=20
  965 IFN=264LETM=19
  970 IFN=265LETM=3
  975 GOSUB1950:A(N)=A(N)-1:GOTO950
  980 NEXTN
  985 IFA(266)>7LETM=2:GOSUB1950
  990 R=0:GOTO1980
  995 FORR=192TO255
 1000 IFA(R)<25THEN1065
 1005 X=INT((R-192)/8):Y=R-192-(X*8)
 1010 IFRND(3)>1THEN1035
 1015 J1=SGN(A(259)-X):K1=SGN(A(260)-Y)
 1020 IFX+J1>=0ANDX+J1<=7LETX1=X+J1
 1025 IFY+K1>=0ANDY+K1<=7LETY1=Y+K1
 1030 IFA(X1*8+Y1+192)=0LETZ=A(X*8+Y+192):A(X*8+Y+192)=0:X=X1:Y=Y1:A(X*8+Y+192)=Z
 1035 J1=A(259)-X:K1=A(260)-Y
 1040 X1=X:Y1=Y:J2=J1:K2=K1:Q=2:GOSUB615
 1045 IFP=-1THEN1055
 1050 IFA(P)<>18THEN1065
 1055 X=X1:Y=Y1:J1=A(259):K1=A(260):Q=0:L=RND(A(R)*.7)
 1060 IFL>100LETA(R)=A(R)-L:GOSUB555
 1065 NEXT:RETURN
 1070 CLS:IFA(275)<>0ORA(276)=0LETI=9:GOTO470
 1075 Q=1:GOSUB1980
 1080 INPUT"TORPEDO DIRECTION (0-8)";I:PRINTTAB(18)" ";
 1085 IFI<0ORI>8THEN1080
 1090 J1=COS(I*C1):K1=-SIN(I*C1):GOSUB1640
 1095 A(276)=A(276)-1:Q=1:L=8000:GOTO555
 1100 CLS:IFA(274)<>0LETI=8:GOTO470
 1105 PRINTCHR$(23):PRINT@320,"SULU here..."
 1110 INPUT"ENERGY";O:IFO<=0RETURN
 1115 PRINT"Phasers locked on target."
 1120 FORR=0TO250:NEXTR
 1125 FORR=192TO255
 1130 IFA(R)<25THEN1170
 1135 X=INT((R-192)/8):Y=R-192-X*8
 1140 J2=X:K2=Y
 1145 J1=X-A(259):K1=Y-A(260):GOSUB1640
 1150 Q=2:GOSUB615:Q=0:J1=J2:K1=K2:L=O:GOSUB1640
 1155 IFP=-1THEN1165
 1160 IFA(P)<25THEN1170
 1165 IFE-100-O>0LETE=E-O:GOSUB555
 1170 NEXTR:RETURN
 1175 CLS:RESTORE:IFA(269)<>0LETI=3:GOTO470
 1180 READB$,J:IFJ<>50THEN1180
 1185 PRINT"SHIP'S COMPUTER command functions:":PRINT
 1190 PRINTTAB(4)J-50;" DATA BASE SCAN TO LOCATE ";B$
 1195 IFJ<>54READB$,J:GOTO1190
 1200 PRINTTAB(5)"5  LONG RANGE SENSOR SCAN FROM DATA BASE"
 1205 PRINTTAB(5)"6  QUADRANT DETAILED DISPLAY"
 1210 PRINT:INPUT"Enter function";O
 1215 IFO<0ORO>6ORINT(O)<>OTHEN1175
 1220 IFO<5THEN1230
 1225 ONO-4GOTO1310,1285
 1230 CLS:RESTORE
 1235 READB$,J:IFJ-50<>OTHEN1235
 1240 PRINT"ENTERPRISE CURRENTLY LOCATED at:";A(256);A(257);A(258)
 1245 PRINT"Data base scan for ";B$;":":PRINT
 1250 FORP=0TO191
 1255 IFO=4ANDA(P)<0THEN1275
 1260 IFA(P)<0ORO=4THEN1280
 1265 GOSUB1590
 1270 IFA(262+O)=0THEN1280
 1275 GOSUB1575:PRINTB;C;D,
 1280 NEXTP:PRINT:GOTO1610
 1285 INPUT"enter Quadrant (X,Y,Z)";B,C,D:GOSUB1560
 1290 IFP=-1THEN1285
 1295 GOSUB1590
 1300 IFA(P)<0PRINT"No data available.":GOTO2025
 1305 GOTO1645
 1310 INPUT"enter Quadrant (X,Y,Z)";U,V,W:CLS
 1315 PRINT@904,"LONG RANGE COMPUTER QUADRANT SCAN of";U;V;W;
 1320 R=1:GOTO1695
 1325 CLS:IFA(270)<>0LETI=4:GOTO470
 1330 U=A(256):V=A(257):W=A(258):R=0
 1335 PRINT@899,"LONG RANGE SENSOR SCAN";:PRINT@938,"Quadrant";U;V;W;
 1340 GOTO1695
 1345 CLS:IFA(272)<>0LETI=6:GOTO470
 1350 Q=1:GOSUB1980
 1355 INPUT"HEADING (0-8)";I:IFA(271)=0PRINTTAB(18)" ";
 1360 IFI<0ORI>8THEN1355
 1365 J1=COS(I*C1):K1=-SIN(I*C1):GOSUB2040
 1370 INPUT"SPEED (0-9)";J:IFA(271)=0PRINTTAB(18)" ";
 1375 IFJ<0ORJ>9THEN1370
 1380 IFJ=0RETURN
 1385 GOSUB1640:A(X*8+Y+192)=0
 1390 FORI=1TOJ:X=X+J1:Y=Y+K1
 1395 GOSUB2030:GOSUB1565
 1400 B$="ENERGY BARRIER"
 1405 IFP=-1LETE=RND(E):GOTO1445
 1410 IFB<>A(256)ORC<>A(257)THEN1460
 1415 W=A(INT(X)*8+INT(Y)+192):B$="COLLISION"
 1420 IFW<>20THEN1440
 1425 IFJ-I>1LETS=S-100:GOTO1445
 1430 IFA(A(256)*8+A(257)+A(258)*64)=1006THEN240
 1435 A(276)=3:E=4000:GOTO1455
 1440 IFW=0THEN1460
 1445 IFJ-I>1GOSUB330:GOSUB520:W=0:GOTO1455
 1450 IFW<>2ANDW<>3ANDW<>19GOSUB330:GOSUB520
 1455 X=X-J1:Y=Y-K1:GOSUB2030:GOTO1465
 1460 NEXTI
 1465 X=INT(X):Y=INT(Y):A(X*8+Y+192)=18
 1470 IFB<>A(256)ORC<>A(257)GOSUB1635:GOTO910
 1475 GOSUB1635:Q=1:GOSUB1980
 1480 IFW=2ORW=3ORW=19THEN1495
 1485 IFE=4000PRINT"Docked":PRINTTAB(18)" ";:GOSUB1615:T=T+1:J=2:GOTO485
 1490 GOTO1615
 1495 IFW=2GOSUB1640:GOSUB1560:A(P)=FIX(ABS(A(P))/10)*10+9
 1500 PRINTTAB(16)"Orbit":PRINTTAB(18)" ";:GOTO1615
 1505 CLS:PRINTCHR$(23)
 1510 PRINT@266,"Status Report:":PRINTTAB(5)STRING$(14,"-")
 1515 PRINTTAB(5)"Stardate:";T
 1520 PRINTTAB(5)"Energy:";E
 1525 B$="Green":IFA(261)=2LETB$="Yellow"
 1530 IFA(261)=3LETB$="Red"
 1535 PRINTTAB(5)"Condition: ";B$
 1540 PRINTTAB(5)"Quadrant:";A(256);A(257);A(258)
 1545 PRINTTAB(5)"Sector:";A(259);A(260)
 1550 PRINTTAB(5)"Photon Torpedoes:";A(276)
 1555 GOTO1610
 1560 IFD<0ORD>2LETP=-1:RETURN
 1565 IFB<0ORB>7ORC<0ORC>7LETP=-1:RETURN
 1570 P=8*B+C+64*D:RETURN
 1575 D=INT(P/64):B=INT((P-D*64)/8):C=P-D*64-B*8:RETURN
 1580 A(P)=A(262)*1E4+A(263)*1E3+A(264)*1E2+A(265)*10+A(266)
 1585 RETURN
 1590 A(266)=ABS(A(P)):K=1E4
 1595 FORN=0TO3
 1600 A(262+N)=INT(A(266)/K):A(266)=A(266)-A(262+N)*K:K=K/10
 1605 NEXTN:RETURN
 1610 PRINT
 1615 IFQ=1LETQ=0:RETURN
 1620 PRINT"Hit (ENTER) to continue.";
 1625 A$=INKEY$
 1630 IFINKEY$=""THEN1630ELSERETURN
 1635 A(256)=B:A(257)=C:A(258)=D:A(259)=X:A(260)=Y:RETURN
 1640 B=A(256):C=A(257):D=A(258):X=A(259):Y=A(260):RETURN
 1645 CLS:PRINT@384," ","Coordinates:";B;C;D
 1650 PRINT" ","Klingons:";A(262),"Starbases:";A(263)
 1655 PRINT" ","Stars:";A(263),"Planets:";A(264)
 1660 RESTORE:IFA(266)>6ORA(266)<2LETB$="None":GOTO1670
 1665 READB$,J:IFJ-30<>A(266)THEN1665
 1670 PRINT" ","Astronomical feature: ";B$:RESTORE
 1675 IFA(266)<7LETB$="None":GOTO1685
 1680 READB$,J:IFJ-30<>A(266)THEN1680
 1685 PRINT" ","Scientific Interest: ";B$:PRINT:PRINT
 1690 GOTO1615
 1695 PRINT@64,""
 1700 FORC=V-1TOV+1:FORD=W-1TOW+1:FORB=U-1TOU+1
 1705 GOSUB1560
 1710 IFP=-1PRINT"  Unknown Quadrant ";:GOTO1765
 1715 IFR=0LETA(P)=ABS(A(P))
 1720 IFR=1ANDA(P)<0PRINT"      No data      ";:GOTO1765
 1725 IFABS(A(P))=1PRINT"        void       ";:GOTO1765
 1730 GOSUB1590
 1735 IFA(266)=2PRINT"  Large Black Hole ";:GOTO1765
 1740 IFA(266)=3PRINT"    Class O Star   ";:GOTO1765
 1745 IFA(266)=4PRINT"       Pulsar      ";:GOTO1765
 1750 IFA(266)=5PRINT"    Space Noise    ";:GOTO1765
 1755 IFA(266)=6PRINT"   Star Fleet HQ   ";:GOTO1765
 1760 PRINT"  K";A(262);"B";A(263);"S";A(264);"P";A(265);" ";
 1765 NEXTB:PRINT" ";D:NEXTD:PRINTCHR$(26);:NEXTC
 1770 PRINT@8,U-1;:PRINT@28,U;:PRINT@47,U+1;
 1775 PRINT@253,V-1;:PRINT@509,V;:PRINT@765,V+1;
 1780 PRINT@979,"";:I=191
 1785 FORZ=15360TO16192STEP64
 1790 IFZ=16192LETI=143
 1795 POKEZ,I:POKEZ+19,I:POKEZ+38,I:POKEZ+57,I
 1800 NEXTZ
 1805 FORZ=15425TO15487
 1810 IFPEEK(Z)=32POKEZ,140:POKEZ+256,140:POKEZ+512,140:POKEZ+768,140
 1815 NEXTZ:GOTO1615
 1820 I=0:B$="Non-entity"
 1825 IFA(P)=2LETI=4:B$="Class M Planet"
 1830 IFA(P)=3LETI=4:B$="Class G Planet"
 1835 IFA(P)=18LETI=5:B$="Star Ship"
 1840 IFA(P)=19LETI=3:B$="Class F Star"
 1845 IFA(P)=20LETI=2:B$="Star Base"
 1850 IFA(P)>24LETI=1:B$="KLINGON WARSHIP"
 1855 RETURN
 1860 GOSUB1820
 1865 ONI+1GOTO1870,1935,1925,1905,1890,1875
 1870 RETURN
 1875 FORZ=U-7TOU-1:SET(Z,V-1):NEXTZ
 1880 FORZ=U-4TOU+5:SET(Z,V+1):NEXTZ
 1885 FORZ=U+1TOU+7:SET(Z,V):NEXTZ:SET(U-3,V):RETURN
 1890 FORZ=U-3TOU+3:SET(Z,V-1):SET(Z,V):SET(Z,V+1):NEXTZ
 1895 RESET(U-3,V-1):RESET(U+3,V-1):RESET(U-3,V+1):RESET(U+3,V+1)
 1900 RETURN
 1905 FORZ=U-2TOU+1:SET(Z,V):NEXTZ
 1910 FORZ=V-1TOV+1STEP2
 1915 SET(U-2,Z):SET(U+1,Z):SET(U-3,Z):SET(U+2,Z)
 1920 NEXTZ:RETURN
 1925 FORZ=U-5TOU+5:SET(Z,V+1):NEXTZ
 1930 SET(U,V):SET(U-2,V-1):SET(U-1,V-1):SET(U,V-1):RETURN
 1935 FORZ=U-5TOU+5:SET(Z,V):NEXTZ
 1940 SET(U-5,V-1):SET(U-4,V-1):SET(U+4,V-1):SET(U+5,V-1)
 1945 SET(U-1,V+1):SET(U,V+1):SET(U+1,V+1):RETURN
 1950 B=RND(8)-1:C=RND(8)-1:D=3
 1955 FORU=B-1TOB+1:FORV=C-1TOC+1
 1960 IFU<0ORU>7ORV<0ORV>7THEN1970
 1965 P=8*U+V+192:IFA(P)<>0THEN1950
 1970 NEXTV:NEXTU
 1975 GOSUB1565:A(P)=M:RETURN
 1980 CLS:IFA(271)<>0LETI=5:GOTO470
 1985 PRINT:FORC=0TO7:FORB=0TO7
 1990 P=B*8+C+192:PRINT"   -    ";
 1995 IFA(P)<>0LETU=B*16+7:V=3*C+4:GOSUB1860
 2000 NEXTB:NEXTC:GOSUB2015
 2005 PRINT@650,"SHORT RANGE SENSOR SCAN of Quadrant";
 2010 PRINTA(256);A(257);A(258):PRINTTAB(18)" ";:GOTO1615
 2015 PRINT@0,STRING$(63,"=");:PRINT@576,STRING$(63,"=");
 2020 RETURN
 2025 FORN=0TO2000:NEXTN:RETURN
 2030 X=B*8+X:B=INT(X/8):X=X-B*8:Y=C*8+Y:C=INT(Y/8):Y=Y-C*8
 2035 RETURN
 2040 IFABS(J1)>ABS(K1)LETK1=K1/ABS(J1):J1=J1/ABS(J1):GOTO2050
 2045 J1=J1/ABS(K1):K1=K1/ABS(K1)
 2050 J1=FIX(J1*1000+.5*SGN(J1))/1000
 2055 K1=FIX(K1*1000+.5*SGN(K1))/1000:RETURN
 2060 CLS
 2065 B$="LARGE BLACK HOLE":IFA(266)=3LETB$="CLASS O STAR"
 2070 IFA(266)=4B$="PULSAR"
 2075 B$="AFTER FLYING INTO A "+B$
 2080 PRINT@320,"ON STARDATE";STR$(T);", ";B$+","
 2085 PRINT"THE ENTERPRISE & CREW WERE LOST TO SPACE."
 2090 PRINT:PRINT:END
 2095 CLS:B$="AFTER DEPLETING ITS ENERGY SUPPLY":GOTO2080
 2100 CLS:B$="WHILE DOING BATTLE AGAINST THE KLINGONS":GOTO2080
 2105 CLS
 2110 PRINT@448,"Destruction of a ";B$;" is grounds for court-martial."
 2115 PRINT:PRINT"You are relieved of your command."
 2120 PRINT:PRINT:END
 2125 DATA"STATUS",0,"DAMAGE CONTROL",1,"SCIENCE COMPUTER",2
 2130 DATA"SHIP'S COMPUTER",3,"LR SENSORS",4,"SR SENSORS",5
 2135 DATA"IMPULSE ENGINES",6,"WARP DRIVE",7,"PHASERS",8
 2140 DATA"PHOTON TORPEDOES",9,"ALERT",10,"REPAIR",11
 2145 DATA"KLINGON WARSHIPS",50,"STARBASES",51
 2150 DATA"CLASS F STARS",52,"PLANETS",53
 2155 DATA"UNEXPLORED AREAS",54
 2160 DATA"GREEN",21,"YELLOW ALERT",22,"RED ALERT",23
 2165 DATA"Black Hole",32,"O Star",33,"Pulsar",34
 2170 DATA"Space Noise",35,"Star Fleet HQ",36,"G Planet",37
 2175 DATA"Unexplored M Planet",38,"Explored M Planet",39
 2180 DATA"PROMOTED",425,"DECORATED",350,"REASSIGNED",290
 2185 DATA"DEMOTED",190,"RESIGNED",-32675
 2190 DATA"E",999,30111,31111,30101,20121,20201,20001
 2195 DATA10001,10111,10211,10321,10221,-99
 2200 DATA1110,110,110,110,110
 2205 DATA1111,1111,1211,1121,1121
 2210 DATA3,3,2,2
 2215 DATA121,121,211,211,311,311,321,321,221,221
 2220 DATA121,121,211,211,311,311,321,321,221,221,0

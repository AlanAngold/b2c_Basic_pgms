    1 REM NOTE: Basic language type forced to be:
    2 REM       trs2 - TRS-80 Level II BASIC tokenized file
  100 CLEAR250:CLS:GOTO170:REM V3.0
  110 FORT1=0TO500:NEXT
  120 FORT1=0TO500:NEXT
  130 FORT1=0TO500:NEXT
  140 FORT1=0TO300:NEXT
  150 FORT1=0TO120:NEXT
  160 FORT1=0TO80:NEXT:RETURN
  170 PRINT@209,"G A L A C T I C     E M P I R E";:PRINT@347,"VERSION 3.0";:PRINT@512,STRING$(64,170);:PRINT@672,"(C) 1979 D. G. CARLSTON";
  180 DEFINTD-L,N-P,T-Z:DEFSTRA-C:DIMU(49),U1(49),U2(49),U3(49),C(19),RO(19),PS(19),PE(19),PA(19),PB(19),PC(19),PD(19):GOSUB120:CLS:PRINT"1) NEW GAME<ERROR>2) LOAD DATA DISK":INPUTT:RANDOM:IFT=2THENGOTO1980ELSE1830
  190 PD(P1)=1:P=P1:GOSUB1810:FORT8=0TO8:PRINT@585," PLANETFALL: "C(P);:GOSUB150:PRINT@586,CHR$(217);:GOSUB160:NEXT
  200 PRINT@65,"ORBITING: "C(P);:GOSUB1740:IFSD>1.5THEN400
  210 BM="COMMAND":GOSUB1750:IFA="Q"THENGOSUB2030:GOTO1870ELSEIFA="E"THENIFP=P1GOTO320ELSE220ELSEIFA="C"THENGOSUB480:GOTO210ELSEIFA="A"THEN1010ELSEIFA="O"THEN1270ELSE210
  220 BS="SCOUT":BF="FIGHTER":BT="TRANSPORT":FORT9=65TO257STEP64:PRINT@T9,CHR$(234);:NEXT
  230 PRINT@0,STRING$(41,176);:A=CHR$(170)+CHR$(26)+CHR$(8):PRINT@104,A;A;A;A;:B=CHR$(149)+CHR$(26)+CHR$(8):PRINT@64,B;B;B;B;:PRINT@320,STRING$(41,179);:PRINT@234,CHR$(151);STRING$(20,131);CHR$(171);:PRINT@298,B;B;B;B;B;B;
  240 PRINT@319,A;A;A;A;A;A;:PRINT@618,STRING$(22,131);:PRINT@384,B;B;B;B;B;B;:PRINT@424,A;A;A;A;A;A;:PRINT@768,STRING$(41,131);:GOSUB250:GOTO300
  250 SD=SD+.001:PRINT@44,"STARDATE: ";:PRINTLLIST"###.#";SD;:PRINT@108,"MODE:";:PRINT@300,BF"S : "F;:PRINT@364,BT"S :";:PRINT@427,TE"EMPTY,"TF"FULL";:PRINT@492,BS"S : "V;:PRINT@556,"CREDITS : ";:PRINTLLIST"#####";M;
  260 IFSD>=1E3THEN1870ELSED5=D5+1:IFD5/200=INT(D5/200)THEN270ELSERETURN
  270 KK=0:FORT9=0TO19:RO(T9)=RO(T9)*1.01:NEXT:IFD5>2E4THEND5=0
  280 FORT9=0TO49:IFU1(T9)=5ANDSD>=U(T9)THENPS(U2(T9))=2:U1(T9)=0:U(T9)=0
  290 NEXT:RETURN
  300 PRINT@682,"CONTROLS:";:PRINT@747,"=A= ATTACK";:PRINT@811,"=C= COMPUTER";:PRINT@875,"=E= EMBARK";:PRINT@939,"=O= ORDERS";
  310 IFF9=0THENGOSUB1970:GOTO390ELSEWS=SD:WQ=SD+DL:W1=0:W2=0:GOTO330
  320 GOSUB1810:PRINT@582,"NAVIGATOR HAS NO ORDERS";:GOSUB120:GOSUB1740:GOTO210
  330 Z=1:GOSUB1810:PRINT@115,"UNDERWAY";:PRINT@585,"DESTINATION: "C(P1);:PRINT@643,"ESTIMATED ARRIVAL: STARDATE "INT(SD+DL);:GOSUB340:GOTO350
  340 X(Z)=RND(40)+20:Y(Z)=7+RND(2):RETURN
  350 FORT=1TODL*2:FORJ=2TO4STEP2:PRINT@20+J*64,"!";:NEXT:A="- - - - ":PRINT@204,A"+ "A;:SD=SD+.5:GOSUB250:FORZ=1TO3:IFX(Z)>40THENXN=X(Z)+2ELSEXN=X(Z)-2
  360 IFY(Z)<9THENYN=Y(Z)-1ELSEYN=Y(Z)+1
  370 RESET(X(Z),Y(Z)):IFXN>79ORXN<1ORYN>14ORYN<3THENGOSUB340ELSEX(Z)=XN:Y(Z)=YN
  380 SET(X(Z),Y(Z)):NEXTZ,T:GOSUB1950
  390 IFF9=0THENF9=1:GOTO200ELSE190
  400 PRINT@115,"SCANNING ";:FF=0:TN=0:VN=0:FORTT=0TO49:IFU(TT)<SD-5ORU(TT)>SDORU1(TT)>3THEN430
  410 IFU3(TT)<>PTHEN430ELSEIFU1(TT)=1THENFF=FF+U2(TT)ELSEIFU1(TT)=2THENTN=TN+U2(TT)ELSEIFU1(TT)=3THENVN=VN+U2(TT)ELSE430
  420 U2(TT)=0:U(TT)=0:U1(TT)=0
  430 NEXTTT:FORTT=0TO49:IFU(TT)<SD-5ORU(TT)>SDORU1(TT)<>4ORU3(TT)<>PTHEN440ELSEGOSUB1810:PRINT@586,BS" SHIP TO";:PRINT@652,C(U2(TT))" HAS RETURNED     ";:PD(U2(TT))=1:GOSUB140:V=V+1:U(TT)=0
  440 NEXTTT:GOSUB1740:IFFF+TN+VN=0THEN470ELSEGOSUB1810:PRINT@451,"ADDITIONS TO FLEET: ";:IFFF=0THEN450ELSEPRINT@586,FF;BF"S";:F=F+FF:GOSUB250
  450 IFTN=0THEN460ELSEPRINT@650,TN;BT"S";:TE=TE+TN:GOSUB250
  460 IFVN=0THEN470ELSEPRINT@714,VN;BS"S";:V=V+VN:GOSUB250
  470 GOSUB140:GOSUB1740:GOTO210
  480 GOSUB1810:PRINT@452,"ENTER CATEGORY :";:PRINT@586,"=A=  STAR MAPS";:PRINT@650,"=B=  PLANETARY DIRECTORY";:PRINT@714,"=C=  STATUS REPORTS";
  490 BM="COMPUTER":GOSUB1750:IFA="A"THEN500ELSEIFA="B"THEN610ELSEIFA="C"THEN740ELSEIFA="R"THENGOSUB1740:A="":RETURNELSE490
  500 GOSUB1740:PRINT@385,"STAR MAPS :";:PRINT@586,"=1=  LOCAL MAP";:PRINT@650,"=2=  RANGE FINDER";:PRINT@714,"=3=  GALAXY MAP";
  510 GOSUB1750:IFA="R"THENGOSUB1740:GOTO480ELSEIFA="1"ORA="2"ORA="3"THENZ=VAL(A):GOSUB1780:ONZGOTO520,550,810ELSE510
  520 GOSUB1740:XH=PA(P):YH=PB(P):FORXN=0TO19:X=PA(XN):Y=PB(XN)
  530 IFABS(XH-X)>10ORABS(YH-Y)>10THENNEXTELSEX=(X-XH)*39/10+40:Y=(Y-YH)*9/10+27:SET(X,Y):NEXT
  540 XP=40:YP=18:WW=1:GOTO820
  550 GOSUB1740:PRINT@385,"RANGE FINDER";:PRINT@451,"ENTER NAMES OF BOTH SYSTEMS";:WW=0
  560 GOSUB1750:WW=WW+1
  570 IFA="R"THENGOSUB1740:GOTO480ELSEGOSUB1790:IFA="X"THEN550ELSEONWWGOTO580,590
  580 PRINT@580,A"      ";:I1=XU:GOTO560
  590 PRINT@600,A"      ";:I2=XU:GOSUB1800:PRINT@642,"("PA(I1)PB(I1)PC(I1)")  ";:PRINT@662,"("PA(I2)PB(I2)PC(I2)")  ";:PRINT@707,"SYSTEMS ARE "D2" LIGHT YEARS APART ";
  600 GOSUB110:WW=0:IFWP=9THENRETURNELSEGOTO560
  610 GOSUB1780:DX=394:GOSUB1740:PRINT@842,"PLANETARY DIRECTORY";:PRINT@385,"EMPIRE:";:FORXN=0TO19:IFPS(XN)>1THENGOSUB620:GOTO640ELSE640
  620 IF(DX/64-INT(DX/64))*64+LEN(C(XN))>39THENDX=INT(DX/64)*64+65
  630 PRINT@DX,C(XN);:DX=DX+LEN(C(XN))+2:RETURN
  640 NEXT:DX=INT(DX/64)*64+65:PRINT@DX,"INDEPENDENT: ";:DX=DX+14:FORXN=0TO19:IFPS(XN)<2THENGOSUB620:NEXTELSENEXT
  650 GOSUB1750:GOSUB1740:FORXN=1TO80:SET(XN,36):NEXT:IFA="R"THENGOSUB1780:GOTO480
  660 PRINT@385,"DATA ON WHICH SYSTEM?";:GOSUB1750
  670 IFA="R"THENGOSUB1740:GOSUB1780:GOTO480ELSEGOSUB1790:IFA="X"THEN660ELSEPRINT@449,A":  ("PA(XU)PB(XU)PC(XU)")  ";
  680 IFPD(XU)=0PRINT@586,"NO DATA ON FILE";:GOSUB110:GOTO610
  690 PRINT@579,"POPULATION: ";:B="###.#":IFPS(XU)<2THEN710ELSEQX=RO(XU)*10:IFQX>999THENQX=QX/1000:PRINTLLISTB;QX;:PRINT" BILLION";ELSEPRINTLLISTB;QX;:PRINT" MILLION";
  700 GOTO720
  710 IFRO(XU)>100PRINT"EST. OVER A BILLION";ELSEIFRO(XU)>RO(0)PRINT"GREATER THAN GALACTICA";ELSEIFRO(XU)>10PRINT"EST. OVER 100 MILLION";ELSEPRINT"EST. UNDER 100 MILLION";
  720 PRINT@643,"TECHNICAL LEVEL: ";:IFPE(XU)=0THENPRINT"PRIMITIVE";ELSEIFPE(XU)=1THENPRINT"LIMITED ATOMIC";ELSEIFPE(XU)=2THENPRINT"SOPHISTICATED";ELSEPRINT"SUPERIOR TO OURS";
  730 GOSUB1750:GOSUB1740:IFA="R"THENGOSUB1780:GOTO480ELSE610
  740 GOSUB1740:PRINT@385,BS"S:    -- STATUS REPORT --";:L=449:FORTT=0TO49:IFU(TT)<SD-5THEN750ELSEIFU1(TT)<>4THEN750ELSEPRINT@L,STRING$(39,32);:PRINT@L,"TO "C(U2(TT))" DUE "C(U3(TT))" ON SD"U(TT);:L=L+64:GOSUB140:IFL>710THENL=L-320
  750 NEXT:GOSUB1750:GOSUB1740:PRINT@385,"OTHERS:    -- STATUS REPORT --";:L=449:FORTT=0TO49:IFU(TT)<SD-5THEN770ELSEIFU1(TT)>3THEN770ELSEIFU2(TT)=0THEN770ELSEONU1(TT)GOSUB780,790,800
  760 PRINT@L,CHR$(230);:PRINT@L,U2(TT)BB"S DUE "C(U3(TT))" ON SD"U(TT);:L=L+64:IFL>710THENL=L-320:GOSUB140ELSEGOSUB140
  770 NEXTTT:GOSUB1750:GOSUB1740:GOTO480
  780 BB=BF:RETURN
  790 BB=BT:RETURN
  800 BB=BS:RETURN
  810 GOSUB1740:FORXN=0TO19:X=PA(XN):Y=PB(XN):X=X*78/60+2:Y=Y*17/60+18:SET(X,Y):NEXT:XP=40:YP=18:WW=2
  820 A=INKEY$:SET(XP,YP):IFA="R"THENA="":GOSUB1740:GOSUB1780:GOTO480ELSEIFPEEK(14400)=32THEN960ELSEIFPEEK(14400)=64THEN970ELSEIFPEEK(14400)=8THEN980ELSEIFPEEK(14400)=16THEN990ELSEFORT4=1TO7:NEXT:RESET(XP,YP):IFA=""THENGOSUB250:GOTO820
  830 GOSUB1790:IFA="X"THEN820ELSEONWWGOTO850,840
  840 XL=PA(XU)*78/60+2:YL=PB(XU)*17/60+18:GOTO860
  850 XL=(PA(XU)-XH)*39/10+40:YL=(PB(XU)-YH)*9/10+27
  860 PRINT@832,A,"("PA(XU)PB(XU)PC(XU)")  ";:IFPS(XU)=2PRINT@898,"EMPIRE     ";ELSEIFPS(XU)=3PRINT@898,"GARRISONED ";ELSEPRINT@898,"INDEPENDENT";
  870 IFWW=1ANDXL>80ORXL<1ORYL<18ORYL>35PRINT@832,A" SYSTEM NOT ON LOCAL MAP        ";:GOTO880ELSEFORXN=0TO100:RESET(XL,YL):SET(XL,YL):NEXT
  880 IFPOINT(XP,YP)THEN890ELSESET(XP,YP):FORXZ=1TO10:NEXT:RESET(XP,YP):GOTO820
  890 FORXZ=0TO19:ONWWGOTO910,900
  900 XG=PA(XZ)*78/60+2:YG=PB(XZ)*17/60+18:IFXG=XPANDYG=YPTHEN920ELSE930
  910 XG=(PA(XZ)-XH)*39/10+40:YG=(PB(XZ)-YH)*9/10+27:IFXG=XPANDYG=YPTHEN920ELSE930
  920 PRINT@832,C(XZ),"(";PA(XZ);PB(XZ);PC(XZ);")   ";:IFPS(XZ)=2PRINT@898,"EMPIRE     ":GOSUB140ELSEIFPS(XZ)=3PRINT@898,"GARRISONED ":GOSUB140ELSEPRINT@898,"INDEPENDENT":GOSUB140
  930 NEXTXZ:IFPOINT(XP+1,YP)THEN940ELSEXP=XP+1:GOTO820
  940 IFPOINT(XP,YP+1)THEN950ELSEYP=YP+1:GOTO820
  950 XP=XP-1:YP=YP-1:GOTO820
  960 GOSUB1000:IFXP>1XP=XP-1:GOTO880ELSE880
  970 GOSUB1000:IFXP<80XP=XP+1:GOTO880ELSE880
  980 GOSUB1000:IFYP>18YP=YP-1:GOTO880ELSE880
  990 GOSUB1000:IFYP<35YP=YP+1:GOTO880ELSE880
 1000 RESET(XP,YP):RETURN
 1010 F8=0:E8=0:IFPS(P)>1PRINT@586,"ATTACKING EMPIRE SYSTEM!!!";:GOTO1940
 1020 IFTF<1THENPRINT@586,"NO FULL TRANSPORTS --";:PRINT@650,"IMPOSSIBLE TO ATTACK!!";:GOSUB130:GOSUB1740:GOTO210
 1030 IFPE(P)<2THEN1140ELSEGOSUB1810:B=" AIR":GOSUB1040:EF=(RND(100)+30):G=RND(4):IFPE(P)=3THENG=2:GOTO1050ELSE1050
 1040 PRINT@451,B;" BATTLE REPORT";:PRINT@515,"PROBABILITY OF SUCCESS:    %";:PRINT@586,"EMPIRE      ENEMY";:PRINT@650,"LOSSES      LOSSES";:RETURN
 1050 PRINT@538,INT(F*100/(F+EF));:PRINT@715,F8;:PRINT@727,E8;:IFF<=0ORTF<=0THEN1250ELSEIFEF<=0THEN1130ELSEONGGOTO1060,1070,1080,1090
 1060 G1=RND(3):G2=RND(3):G3=RND(20):GOTO1100
 1070 G1=RND(3):G2=RND(2)-1:G3=RND(10):GOTO1100
 1080 G1=RND(2)-1:G2=RND(3):G3=RND(50):GOTO1100
 1090 G1=RND(2):G2=RND(4):G3=RND(40)
 1100 F=F-G1:F8=F8+G1:EF=EF-G2:E8=E8+G2:GOSUB160:A=INKEY$:IFG3=1GOTO1820ELSEIFRND(30)=1GOSUB1780:IFPE(P)<>3THENG=RND(4)
 1110 IFF<0THENF=0ELSEIFEF<0THENEF=0
 1120 IFA="R"THEN1250ELSEGOSUB250:GOTO1050
 1130 GOSUB1780:GOSUB1740:PRINT@586,"ENEMY AIR FORCES DEFEATED!!";:GOSUB110
 1140 GOSUB1740:GOSUB1810:B="LAND":GOSUB1040:EF=RO(P)*2:G=RND(4):F8=0:E8=0:IFPS(P)=1THENG=2
 1150 PRINT@538,INT(TF*100/(TF+EF));:PRINT@715,F8;:PRINT@727,E8;:IFTF<=0THEN1250ELSEIFEF<=0THEN1230ELSEONGGOSUB1160,1170,1180,1190:GOTO1200
 1160 G1=RND(3)-1:G2=RND(4):RETURN
 1170 G1=RND(3):G2=RND(2):RETURN
 1180 G1=RND(3):G2=RND(3):RETURN
 1190 G1=RND(2)-1:G2=RND(2):RETURN
 1200 PRINT@427,CHR$(212);:RO(P)=RO(P)-G2/10:TF=TF-G1:F8=F8+G1:EF=EF-G2:E8=E8+G2:IFRO(P)<0THENRO(P)=0:PRINT@650,"POPULATION ANNIHILATED";:GOTO1230
 1210 IFTF<0THENTF=0ELSEIFEF<0THENEF=0
 1220 GOSUB250:GOSUB150:A=INKEY$:IFA="R"THEN1250ELSEIFRND(30)=1ANDPS(P)<>1THENG=RND(4):GOTO1150ELSE1150
 1230 GOSUB1720:U(XX)=SD+10:U1(XX)=5:U2(XX)=P:PS(P)=3:PD(P)=1:RO(P)=RO(P)-E8/100:GOSUB1740:GOSUB1810:PRINT@586,"PLANET SECURED";:GOSUB110:GOSUB1740
 1240 KK=0:FORT9=0TO19:IFPS(T9)>1THENKK=KK+1:IFKK>19THEN1870ELSENEXT:GOTO210ELSENEXT:GOTO210
 1250 GOSUB1740:GOSUB1810:PRINT@586,"ATTACK UNSUCCESSFUL";:GOSUB140:IFF<=0THENGOSUB250:GOTO1900
 1260 GOSUB1740:GOTO210
 1270 GOSUB1740:PRINT@385,"ORDERS FOR WHICH OFFICER?";:PRINT@514,"LT. STARBUCK - "BS"S";:PRINT@578,"LT. BAYLISS - GROUND FORCES";:PRINT@642,"NAVIGATOR KIRMAN";:PRINT@706,"DR. HENDERSON - CRYONICS";
 1280 BM="ORDERS":GOSUB1750:GOSUB1740:GOSUB1780:IFA="R"THEN210ELSEIFA="S"THEN1290ELSEIFA="B"THEN1330ELSEIFA="N"ORA="K"THEN1510ELSEIFA="D"ORA="H"THEN1550ELSE1270
 1290 IFV<=0THENGOSUB1780:PRINT@832,"SIR, I HAVE NO "BS"S!";:GOSUB120:GOSUB1780:GOSUB1740:GOTO1270
 1300 PRINT@832,"WHICH SYSTEM SHOULD I "BS"?";:GOSUB1310:IFPD(XU)=1GOSUB1780:PRINT@832,"THAT DATA IS ALREADY";:PRINT@898,"  IN THE COMPUTER, SIR";:GOSUB120:GOSUB1780:GOTO1300ELSE1320
 1310 GOSUB1750:IFA="R"THENGOSUB1740:GOSUB1780:GOTO1270ELSEGOSUB1790:IFA="X"THEN1310ELSEPRINT@896,A;:RETURN
 1320 I1=P:I2=XU:GOSUB1800:K=SD+D2:GOSUB1720:U1(XX)=4:U2(XX)=XU:GOSUB1780:PRINT@832,"WHERE SHOULD I RETURN?";:GOSUB1310:I1=XU:GOSUB1800:U(XX)=K+D2:U3(XX)=XU:GOSUB130:GOSUB1780:V=V-1:GOSUB1740:GOTO1270
 1330 IFPS(P)<2THENPRINT@832,"WE'RE OVER AN INDEPENDENT SYSTEM, SIR!";:GOSUB130:GOSUB1780:GOTO1270ELSEPRINT@385,"LT. BAYLISS' DUTIES :";:PRINT@517,"=1= SHIP CONSTRUCTION";:PRINT@581,"=2= ENLISTMENTS";:PRINT@645,"=3= TAXATION";
 1340 GOSUB1750:GOSUB1740:IFA="R"THEN1270ELSEIFA="1"ORA="2"ORA="3"THENX=VAL(A):ONXGOTO1350,1570,1610ELSE1330
 1350 IFWS<>INT(SD)XF=22+RND(10):XT=10+RND(10):XS=2+RND(5):WS=SD
 1360 IFPS(P)<2THEN1330ELSEIFPE(P)<2GOSUB1780:PRINT@832,"SORRY SIR, THIS PLANET TOO BACKWARD";:PRINT@898,"TO BUILD SHIPS";:GOSUB110:GOSUB1780:GOTO1330ELSEGOSUB1370:GOTO1390
 1370 K2=RO(P)/10:IFK2<5ANDPE(P)<>3THENK2=5ELSEIFK2<9ANDPE(P)=3THENK2=9
 1380 GOSUB1810:PRINT@451,"PRICES:";:PRINT@517,BF"S   --"XF;:PRINT@581,BT"S --"XT;:PRINT@645,BS"S     --"XS;:PRINT@707,"(MAX. OF"K2"SHIPS PER YEAR)";:RETURN
 1390 GOSUB1400:IFWQ<SDTHENWQ=SD:GOTO1410ELSE1410
 1400 GOSUB1780:PRINT@832,"LT. BAYLISS REPORTING, SIR!  ";:GOSUB140:RETURN
 1410 FORU=1TO3:N(U)=0:NEXT:PRINT@898,"PLACE ORDERS FOR HOW MANY YEARS? ";:GOSUB2040:Y2=VAL(B):FORU=1TO3:ONUGOSUB780,790,800
 1420 GOSUB1780:A=INKEY$:PRINT@832,"BUILD HOW MANY "BB"S EACH YEAR?";:PRINT@898,"";:VW=20:GOSUB2040:VW=200:IFB="R"THENGOSUB1780:WQ=Y3:U=3:NEXT:GOTO1270
 1430 T6=0:N(U)=VAL(B):FORT5=1TOU:T6=T6+N(T5):NEXT:IFT6>K2THENGOSUB1770:GOTO1420ELSEIFT6=K2THENU=3
 1440 NEXT:FORY3=WQTOWQ+Y2-1:FORX9=1TO3:ONX9GOTO1450,1460,1470
 1450 M=M-XF*N(X9):IFM<0THENM=M+XF*N(X9):GOTO1480ELSE1640
 1460 M=M-XT*N(X9):IFM<0THENM=M+XT*N(X9):GOTO1480ELSE1640
 1470 M=M-XS*N(X9):IFM<0THENM=M+XS*N(X9):GOTO1480ELSE1640
 1480 Y3=WQ+Y2-1:X9=3
 1490 GOSUB250:B="":NEXTX9,Y3:WH=0
 1500 WQ=Y3:GOSUB1780:GOSUB1740:GOTO1330
 1510 GOSUB250:GOSUB1780:PRINT@832,"KIRMAN REPORTING SIR!";:PRINT@898,"WHAT IS OUR DESTINATION?";:GOSUB1750
 1520 WP=9:IFA="R"THENGOSUB1740:GOSUB1780:GOTO1270ELSEGOSUB1790:IFA="X"THEN1510ELSEGOSUB1780:PRINT@832,A"!!    YES SIR!!!";:IFXU=PTHEN1540ELSEGOSUB1810:PRINT@580,C(P);:I1=P:GOSUB590:WP=0:DLS=D2
 1530 GOSUB1740:P1=XU:GOSUB1780:GOTO1270
 1540 FORT9=1TO200:NEXT:PRINT@832,"I MEAN NO SIR.  THAT'S WHERE WE";:PRINT@898,"ARE RIGHT NOW!!";:GOSUB120:GOSUB1780:GOTO1510
 1550 PRINT@832,"DR. HENDERSON REPORTING.";:PRINT@896,"HOW MANY YEARS OF SUSPENDED ANIMATION? ";:GOSUB2040:IFB="R"THENGOSUB1780:GOTO1270ELSEY2=VAL(B):FORY3=1TOY2:GOSUB140:SD=SD+1:GOSUB250:NEXT
 1560 GOSUB1780:GOSUB1810:FORTL=1TO10:PRINT@585," WAKE UP, SIR!!!";:GOSUB150:PRINT@586,CHR$(207);:FORT8=1TO30:NEXTT8,TL:GOSUB1740:GOTO200
 1570 IFW1=1THEN1270ELSEW1=1:GOSUB1810:PRINT@522,"ORBITING: ";C(P);:PRINT@586,"POPULATION: ";INT(RO(P)*10);" MILLION";:PRINT@650,"AVAILABLE "BT"S: ";TE;:K1=4-PS(P):IFC(P)="SPARTA"THENK1=10
 1580 GOSUB1780:PRINT@832,"FILL HOW MANY "BT"S, SIR?";:PRINT@898,"";:GOSUB2040:D1=VAL(B)
 1590 IFD1>TEGOSUB1780:PRINT@832,"NOT ENOUGH ROOM ABOARD "BT"S, SIR!!";:GOSUB120:GOTO1580ELSEIFD1>RO(P)*K1GOSUB1780:PRINT@832,"OVER"K1"PERCENT OF POPULATION SIR!!";:GOSUB120:GOTO1580
 1600 PRINT@427,CHR$(212);:RO(P)=RO(P)-D1/100:TE=TE-D1:TF=TF+D1:W1=1:GOSUB250:GOSUB1740:GOSUB1780:GOTO1270
 1610 IFW2=1THEN1270ELSEW2=1:IFPS(P)<2THEN1270ELSEGOSUB1780
 1620 IFRO(P)>400THENKH=4000ELSEKH=INT(RO(P)*10)
 1630 GOSUB1780:PRINT@832,"WE HAVE RAISED"KH"CREDITS IN TAXES, SIR!";:M=M+KH:GOSUB250:GOSUB130:GOSUB1780:GOTO1270
 1640 IFY3>SDTHEN1680ELSEONX9GOTO1650,1660,1670
 1650 F=F+N(X9):GOTO1490
 1660 TE=TE+N(X9):GOTO1490
 1670 V=V+N(X9):GOTO1490
 1680 IFN(X9)=0THEN1490ELSEIFWH=Y3THEN1710ELSEWH=Y3
 1690 GOSUB1780:PRINT@832,"sEND SHIPS COMPLETED IN sd"Y3"TO:";:PRINT@898,"(eNTER =c= FOR REFERENCE TO cOMPUTER)";:GOSUB1750:IFA="C"THENGOSUB1740:GOSUB480:GOSUB1380:BM="ORDERS":GOTO1690
 1700 GOSUB1780:GOSUB1790:IFA="X"THEN1690ELSEPRINT@832,A;
 1710 GOSUB1720:U1(XX)=X9:U2(XX)=N(X9):U3(XX)=XU:I1=P:I2=XU:GOSUB1800:U(XX)=D2+Y3:GOTO1490
 1720 FORTT=0TO49:IFU(TT)=0THENXX=TT:RETURNELSENEXT
 1730 FORTT=0TO49:IFU(TT)<SD-5ANDU1(TT)<>5THENXX=TT:RETURNELSENEXT
 1740 FORX8=385TO705STEP64:PRINT@X8,CHR$(231);:NEXT:FORY=18TO35:RESET(1,Y):RESET(80,Y):NEXT:RETURN
 1750 A=INKEY$:FORLP=1TO500:XV=FRE("0"):GOSUB160:PRINT@115,BM"  ";:SD=SD+.001:A=INKEY$:IFA=""THENGOSUB150:PRINT@115,"        ";:NEXTLP
 1760 GOSUB250:IFA=""THEN1750ELSERETURN
 1770 PRINT@896,"SIR, THEY CAN ONLY BUILD"K2"SHIPS A YEAR! ":GOSUB120:RETURN
 1780 PRINT@832,STRING$(43,32);:PRINT@896,STRING$(43,32);:RETURN
 1790 FORXU=0TO19:IFLEFT$(C(XU),1)=ATHENA=C(XU):RETURNELSENEXT:A="X":RETURN
 1800 D2=INT(SQR((PA(I1)-PA(I2))^2+(PB(I1)-PB(I2))^2+(PC(I1)-PC(I2))^2)):RETURN
 1810 PRINT@385,"COMPUTER CENTRAL REPORTING:";:RETURN
 1820 PRINT@427,CHR$(212);:TF=TF-1:GOSUB250:GOSUB1780:PRINT@832,"THEY GOT A "BT"!!!";:GOSUB150:GOSUB1780:GOTO1110
 1830 WQ=1:VW=100:SD=1:READC(0):FORP=1TO19
 1840 T9=RND(19):IFC(T9)=""THEN READC(T9):IFLEFT$(C(T9),1)="S"THENPS(T9)=1:NEXTELSENEXTELSE1840
 1850 PD(0)=1:PS(0)=2:FORP=0TO19:READRO(P):NEXTP:FORP=0TO19:READPE(P):NEXT:FORP=0TO4:PA(P)=RND(15)+23:PB(P)=RND(15)+23:PC(P)=RND(5)+5:NEXT:FORP=5TO14:PA(P)=RND(30)+15:PB(P)=RND(30)+15:PC(P)=RND(15):NEXT
 1860 FORP=15TO19:PA(P)=RND(60):PB(P)=RND(60):PC(P)=RND(15):NEXTP:M=1000:F=100:TE=100:V=5:P=0:CLS:GOTO220
 1870 KK=0:FORT9=1TO19:IFPS(T9)>1THENKK=KK+1:SC=SC+RO(T9)*(PE(T9)+1):NEXTELSENEXT
 1880 GOSUB1740:GOSUB1810:PRINT@580,KK" SYSTEMS IN "SD" YEARS";:PRINT@714,"SCORE : "SC-SD;:GOSUB1780:PRINT@832,"PLAY AGAIN?";
 1890 A=INKEY$:IFA="Y"THENRUNELSEIFA="N"THENSTOPELSE1890
 1900 GOSUB1740:GOSUB1780:GOSUB1810:PRINT@586,"WE ARE UNDER ATTACK!";:GOSUB110:FORT9=1TO500:OUT255,8:PRINTCHR$(28);:NEXT:GOTO1870
 1910 DATAGALACTICA,PROYC,ALHAMBRA,YANG-TZU,MOONSWEEP,SPARTA,JAVINY,BOK,EVENTIDE,LLYTHLL,OOTSI,UTOPIA,TWRYX,DRASSA 2,FARSIDE,KGOTLA,NOVENA,VIEJO,ZOE,HARKON
 1920 DATA40,25,13,68,102,37,2,7,181,50,88,34,67,92,137,14,19,28,3,19
 1930 DATA2,2,1,2,2,1,3,0,1,2,2,2,1,1,2,3,0,2,1,0
 1940 TF=TF/2:F=F/2:GOSUB250:GOSUB110:GOSUB1740:GOTO210
 1950 PRINT@212,CHR$(174)CHR$(132);:GOSUB160:PRINT@211,CHR$(136)CHR$(191)CHR$(157);:GOSUB160;:PRINT@148," ";:PRINT@204,STRING$(22,32);
 1960 PRINT@210,CHR$(160)CHR$(190)CHR$(191)CHR$(191)CHR$(180);:PRINT@275,CHR$(139)CHR$(143)CHR$(143)CHR$(129);:GOSUB160
 1970 PRINT@207,CHR$(32)CHR$(176)CHR$(184)CHR$(188)CHR$(188);STRING$(7,191);CHR$(189)CHR$(188)CHR$(188)CHR$(176)CHR$(144);:PRINT@269,CHR$(160)CHR$(188);STRING$(17,191);CHR$(189)CHR$(180);:GOSUB160:RETURN
 1980 LINE INPUT "FILENAME? ";FI$:OPEN "I",1,FI$
 1985 FORT=0TO49:X=832:PRINT@X,T:INPUT#1,U(T),U1(T),U2(T),U3(T):NEXT:FORT=0TO19:INPUT#1,C(T),RO(T),PS(T),PE(T),PA(T),PB(T),PC(T),PD(T):PRINT@X,CHR$(30)C(T):NEXT:INPUT#1,D5,F,KK,M,P1,P,V,SC,SD,VN,FF,TN,TE,TF,W1,W2,WP,WQ,WS,WW,XP,YP,Z,DL,VW,XF,XS,XT
 1990 CLOSE:PRINT"DATA LOADED":GOSUB140:CLS:GOTO220
 2000 OPEN "O",1,FI$
 2010 FORT=0TO49:PRINT#1,U(T),U1(T),U2(T),U3(T):NEXT:FORT=0TO19:PRINT#1,C(T)+",",RO(T),PS(T),PE(T),PA(T),PB(T),PC(T),PD(T):NEXT:PRINT#1,D5,F,KK,M,P1,P,V,SC,SD,VN,FF,TN,TE,TF,W1,W2,WP,WQ,WS,WW,XP,YP,Z,DL,VW,XF,XS,XT
 2020 CLOSE:RETURN
 2030 PRINT@832,"1) END GAME  2) PUT DATA ON DISK ";:INPUTT:IFT=2THEN GOSUB1780:LINE INPUT"FILENAME? ";FI$:GOSUB2000:GOSUB150:GOTO1870ELSEGOSUB1780:RETURN
 2040 A=INKEY$:IFA=""ORA=CHR$(13)ORA=CHR$(10)THEN2040ELSEIFASC(A)<48ORASC(A)>57THEN2040ELSEPRINTA;:B=A:FORT9=1TOVW:A=INKEY$:IFA=CHR$(13)THENRETURNELSEB=B+A:PRINTA;:NEXT:RETURN

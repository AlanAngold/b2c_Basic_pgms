    1 REM NOTE: Basic language type forced to be:
    2 REM       trs2 - TRS-80 Level II BASIC tokenized file
   10 PRINTTAB(20);"WORD SEARCH PUZZLE"
   40 PRINT:PRINT:PRINT
   50 PRINT"  This program is a word search puzzle generator!!"
   60 PRINT"The program takes a set on input strings, purges all"
   70 PRINT"non-alphabetic characters out of them, and incorporates"
   80 PRINT"them into a word search puzzle."
   90 PRINT
  100 PRINT"  In the course of making a puzzle, the machine may"
  110 PRINT"find that it can't put a particular word anywhere, and"
  120 PRINT"so will ask you if it should start the whole puzzle"
  130 PRINT"over.  If you don't want it to start over, typing 'NO'"
  140 PRINT"will throw away that particular word.  If this persists,"
  150 PRINT"try either less words or bigger puzzle dimensions!"
  160 PRINT:PRINT
  280 CLEAR3000
  300 DEF FNA(Z)=INT(RND(0)*Z+1)
  310 INPUT"HOW MANY COLUMNS DOES YOUR PRINTER HAVE";TW
  320 INPUT"DO YOU WANT A SOLUTION PRINTOUT";X$
  330 INPUT"WHAT IS TO BE THE WIDTH OF YOUR PUZZLE";W:MD=W
  340 IFW*2<=TW THEN 345
  343 PRINT"THAT WILL NOT FIT IN";TW;" COLUMNS.":GOTO330
  345 IFW<1 THEN 330
  350 INPUT"THE LENGTH OF";L:IFL>W THEN MD=L
  355 IFL<1 THEN 350
  360 INPUT"WHAT IS THE MAXIMUM NUMBER OF WORDS IN THE PUZZLE";M
  370 IFM>=2 THEN 380
  375 PRINT"SORRY; THERE MUST BE AT LEAST 2 WORDS.":GOTO360
  380 PRINT
  390 DIMA$(L,W),W$(M)
  400 DIMW(M,3),DXY(8,2),DD(28)
  410 PRINT"NOW ENTER A HEADING THAT WILL BE PRINTED OVER THE PUZZLE:"
  420 PRINT"(";TW;"CHARACTERS MAXIMUM! )"
  430 INPUTXY$
  440 PRINT"OK . . . Enter a word at each question mark."
  450 PRINT"to redo the previous word, type a hyphen (-)."
  460 PRINT"When you run out of words, type a period (.)."
  470 FORI=1TOM
  480 INPUTT$:IFT$="-" THEN I=I-1:PRINT"REDO";W$(I);". . .":GOTO480
  490 IFT$="." THEN M=I-1:GOTO660
  500 IFLEN(T$)=0 THEN PRINT"INPUT ERROR; REDO:":GOTO480
  510 J=1
  520 TE$=MID$(T$,J,1):IFTE$>="a"ANDTE$<="z" THEN 570
  525 IFTE$<"A"ORTE$>"Z" THEN 530
  527 T$=LEFT$(T$,J-1)+CHR$(ASC(MID$(T$,J,1))+32)+RIGHT$(T$,LEN(T$)-J):GOTO570
  530 IFTE$=T$ THEN T$="":GOTO500
  540 IFJ=LEN(T$) THEN T$=LEFT$(T$,J-1):GOTO580
  550 IFJ=1 THEN T$=RIGHT$(T$,LEN(T$)-1):J=J-1:GOTO570
  560 T$=LEFT$(T$,J-1)+RIGHT$(T$,LEN(T$)-J):J=J-1
  570 J=J+1:IFJ<=LEN(T$) THEN 520
  580 PRINT"-";T$;"-"
  600 IFLEN(T$)<=MD THEN 610
  605 PRINT"THAT'S TOO LONG, I'M AFRAID.";
  607 PRINT" TRY ANOTHER ONE:":GOTO480
  610 FORIZ=1TOI-1:IFW$(IZ)<>T$ THEN NEXT:GOTO630
  620 PRINT"YOU ENTERED THAT ONE ALREADY. TRY ANOTHER:":GOTO480
  630 W$(I)=T$
  640 NEXTI
  650 PRINT"THAT'S IT...";M;"WORDS."
  660 PRINT"NOW LET ME PONDER THIS........."
  680 FORI=1TOM-1
  685 FORJ=I+1TOM
  690 IFLEN(W$(I))<LEN(W$(J)) THEN HZ$=W$(I):W$(I)=W$(J):W$(J)=HZ$
  700 NEXT:NEXT
  710 FORI=1TO8:READDXY(I,1),DXY(I,2):NEXT
  720 FORI=1TO28:READDD(I):NEXT
  730 DATA0,1,1,1,1,0,1,-1,0,-1,-1,-1,-1,0,-1,1
  740 DATA2,4,6,8,2,4,6,8,2,4,6,8,2,4,6,8,2,4,6,8,2,4,6,8,1,3,5,7
  750 FORI=1TOM
  760 LN=LEN(W$(I))
  770 NT=0
  790 SD=DD(FNA(28))
  800 SX=FNA(W):X1=SX+(LN-1)*DXY(SD,1):IFX1<1ORX1>W THEN 790
  810 SY=FNA(L):X1=SY+(LN-1)*DXY(SD,2):IFX1<1ORX1>L THEN 790
  820 NT=NT+1:IFNT<>W*L*2 THEN 850
  830 PRINT"COUNDN'T FIT  '";W$(I);"' IN THE PUZZLE."
  832 INPUT"DO YOU WANT ME TO START OVER";A$
  834 IFLEFT$(A$,1)="Y" THEN 750
  836 W$(I)="":GOTO950
  850 J=SY:K=SX
  860 FORP=1TOLN
  870 IF LEN(A$(J,K))<>0 AND A$(J,K)<>MID$(W$(I),P,1) THEN 790
  880 J=J+DXY(SD,2):K=K+DXY(SD,1):NEXTP
  900 J=SY:K=SX
  910 FORP=1TOLN:A$(J,K)=MID$(W$(I),P,1)
  920 J=J+DXY(SD,2):K=K+DXY(SD,1):NEXT
  940 W(I,1)=SX:W(I,2)=SY:W(I,3)=SD
  950 NEXTI
  970 FORI=1TOL
  975 FORJ=1TOW
  980 IFA$(I,J)="" THEN A$(I,J)=CHR$(FNA(26)+96)
  990 NEXT:NEXT
 1010 FORI=1TOM-1:FORJ=I+1TOM
 1020 IFW$(I)<=W$(J) THEN 1030
 1021 HZ$=W$(I):W$(I)=W$(J):W$(J)=HZ$
 1025 FORK=1TO3:HZ=W(I,K):W(I,K)=W(J,K):W(J,K)=HZ:NEXTK
 1030 NEXTJ:NEXTI
 1040 INPUT"HOW MANY COPIES OF THIS PUZZLE DO YOU WANT";N
 1050 PRINT"FOR EACH COPY, HIT RETURN TO BEGIN PRINTING..."
 1060 FORC=1TON:GOSUB1070:NEXT:GOTO1230
 1070 INPUTA$:PRINT
 1080 T=(TW-2*W)/2:PRINT
 1090 LPRINT
 1100 LPRINTTAB((TW-LEN(XY$))/2);XY$
 1110 LPRINT:LPRINT
 1120 FORJ=1TOL:LPRINTTAB(T);
 1130 FORK=1TOW:IFA$(J,K)="." THEN LPRINT". ";:GOTO1140
 1135 LPRINTCHR$(ASC(A$(J,K))-32);" ";
 1140 NEXT:LPRINT:NEXT
 1150 LPRINT:LPRINT
 1160 LPRINT"FIND THESE HIDDEN WORDS IN THE ABOVE PUZZLE:"
 1170 LPRINT
 1180 FORJ=1TOM:IFLEN(W$(J))=0 THEN 1210
 1190 IFPOS(0)+LEN(W$(J))>TW-2 THEN LPRINT
 1200 LPRINTW$(J),
 1210 NEXT:LPRINT:LPRINT:LPRINT:LPRINT
 1220 RETURN
 1230 IFLEFT$(X$,1)="Y"ORLEFT$(X$,1)="y" THEN 1250
 1240 END
 1250 '
 1260 FORI=1TOL:FORJ=1TOW:A$(I,J)=".":NEXTJ:NEXTI
 1270 FORI=1TOM
 1280 LN=LEN(W$(I)):J=W(I,2):K=W(I,1)
 1290 FORP=1TOLN
 1300 A$(J,K)=MID$(W$(I),P,1)
 1310 J=J+DXY(W(I,3),2):K=K+DXY(W(I,3),1):NEXTP
 1320 NEXTI
 1330 XY$="HERE IS THE ANSWER KEY:"
 1340 GOSUB1070
 1350 LPRINT:LPRINT
 1360 END

    1 REM NOTE: Basic language type forced to be:
    2 REM       trs2 - TRS-80 Level II BASIC tokenized file
   10 REM  SUPER STAR TREK
   20 CLS
   30 PRINT@210,"S U P E R  S T A R  T R E K"
   40 PRINT:PRINT
   50 CLEAR 600
   60 Z$="                      "
   70 DIM G(8,8),C(9,2),K(3,3),N(3),Z(8,8),D(8):RANDOM
   80 T=INT(RND(0)*20+20)*100:T0=T:T9=25+INT(RND(0)*10):D0=0:E=3000:E0=E
   90 P=10:P0=P:S9=200:S=0:B9=0:K9=0:X$=" ":X0$=" IS "
  100 Q1=RND(8):Q2=RND(8):S1=RND(8):S2=RND(8)
  110 FOR I=1 TO 9:C(I,1)=0:C(I,2)=0:NEXT I
  120 C(3,1)=-1:C(2,1)=-1:C(4,1)=-1:C(4,2)=-1:C(5,2)=-1:C(6,2)=-1
  130 C(1,2)=1:C(2,2)=1:C(6,1)=1:C(7,1)=1:C(8,1)=1:C(8,2)=1:C(9,2)=1
  140 FOR I=1 TO 8:D(I)=0:NEXT I
  150 A1$="NAVSRSLRSPHATORSHEDAMCOMXXX"
  160 FOR I=1 TO 8:FOR J=1 TO 8:K3=0:Z(I,J)=0:R1=RND(0)
  170 IF R1>.98 THENK3=3:K9=K9+3:GOTO 200
  180 IF R1>.95 THEN K3=2:K9=K9+2:GOTO 200
  190 IF R1>.8 THEN K3=1:K9=K9+1
  200 B3=0:IF RND(0)>.96 THEN B3=1:B9=B9+1
  210 G(I,J)=K3*100+B3*10+RND(8):NEXT J:NEXT I:IF K9>T9 THEN T9=K9+1
  220 IF B9<>0 THEN 250
  230 IF G(Q1,Q2)<200 THEN G(Q1,Q2)=G(Q1,Q2)+100:K9=K9+1
  240 B9=1:G(Q1,Q2)=G(Q1,Q2)+10:Q1=RND(8):Q2=RND(8)
  250 K7=K9:IF B9<>1 THEN X$="S":X0$=" ARE "
  260 PRINT"YOUR ORDERS ARE AS FOLLOWS:"
  270 PRINT"   DESTROY THE";K9;"KLINGON WARSHIPS WHICH HAVE INVADED"
  280 PRINT"   THE GALAXY BEFORE THEY CAN ATTACK FEDERATION HEADQUARTERS"
  290 PRINT"   ON STARDATE";T0+T9;"  THIS GIVES YOU";T9;"DAYS.   THERE";X0$
  300 PRINT"  ";B9;"STARBASE";X$;" IN THE GALAXY FOR RESUPPLYING YOUR SHIP"
  310 PRINT:INPUT"ENTER YOUR NAME IN THE CAPTAIN'S LOG";NA$
  320 Z4=Q1:Z5=Q2:K3=0:B3=0:S3=0:G5=0:D4=.5*RND(0):Z(Q1,Q2)=G(Q1,Q2)
  330 IF Q1<1 OR Q1>8 OR Q2<1 OR Q2>8 THEN 400
  340 REM
  350 FOR I=1 TO 1500:NEXT I:K3=INT(G(Q1,Q2)*.01):B3=INT(G(Q1,Q2)*.1)-10*K3
  360 S3=G(Q1,Q2)-100*K3-10*B3:IFK3=0THEN390
  370 CLS:PRINT@396,"COMBAT AREA      CONDITION RED":IFS>200THEN390
  380 PRINT@463,"SHIELDS DANGEROUSLY LOW"
  390 FORI=1TO3:K(I,1)=0:K(I,2)=0:NEXTI
  400 FORI=1TO3:K(I,3)=0:NEXTI:Q$=Z$+Z$+Z$+Z$+Z$+Z$+Z$+LEFT$(Z$,17)
  410 A$="<*>":Z1=S1:Z2=S2:GOSUB3390:IFK3<1THEN440
  420 FORI=1TOK3:GOSUB3370:A$="+K+":Z1=R1:Z2=R2
  430 GOSUB3390:K(I,1)=R1:K(I,2)=R2:K(I,3)=S9*(.5+RND(0)):NEXTI
  440 IFB3<1THEN460
  450 GOSUB3370:A$=">!<":Z1=R1:B4=R1:Z2=R2:B5=R2:GOSUB3390
  460 FORI=1TOS3:GOSUB3370
  470 A$=" * "
  480 Z1=R1
  490 Z2=R2
  500 GOSUB3390
  510 NEXTI
  520 GOSUB2490
  530 IFS+E>10THENIFE>10ORD(7)=0THEN580
  540 CLS:PRINT@320,"CAPTIAN ";NA$;"!. YOU'VE JUST STRANDED YOUR SHIP IN SPACE!"
  550 PRINT"YOU HAVE INSUFFICIENT MANEUVERING ENERGY,";
  560 PRINT" AND SHIELD CONTROL":PRINT"IS PRESENTLY INCAPABLE OF CROSS";
  570 PRINT"-CURCUITING TO ENGINE ROOM!!":GOTO2340
  580 PRINT"YOUR ORDERS, CAPTAIN ";NA$;:INPUTA$
  590 FORI=1TO9:IFLEFT$(A$,3)<>MID$(A1$,3*I-2,3)THEN610
  600 ON I GOTO 710,520,1340,1420,1620,1970,2060,2720,2370
  610 NEXTI:CLS:PRINT"ENTER ONE OF THE FOLLOWING:"
  620 PRINT" NAV  (TO SET COURSE)"
  630 PRINT" SRS  (FOR SHORT RANGE SENSOR SCAN)"
  640 PRINT" LRS  (FOR LONG RANGE SENSOR SCAN)"
  650 PRINT" PHA  (TO FIRE PHASERS)"
  660 PRINT" TOR  (TO FIRE PHOTON TORPEDOES)"
  670 PRINT" SHE  (TO RAISE OR LOWER SHIELDS)"
  680 PRINT" DAM  (FOR DAMAGE CONTROL REPORTS)"
  690 PRINT" COM  (TO CALL ON LIBRARY-COMPUTER)"
  700 PRINT" XXX  (TO RESIGN YOUR COMMAND)":PRINT:GOTO530
  710 INPUT"COURSE (0-9)";C1:IFC1=9THENC1=1
  720 IFC1>=1ANDC1<9THEN740
  730 PRINT"  LT. SULU REPORTS, 'INCORRECT COURSE DATA, SIR!'":GOTO530
  740 X$="8":IFD(1)<0THENX$="0.2"
  750 PRINT"WARP FACTOR (0-";X$;")";:INPUTW1:IFD(1)<0ANDW1>.2THEN790
  760 IFW1>0ANDW1<=8THEN800
  770 IFW1=0THEN530
  780 PRINT"  CHIEF ENGINEER SCOTT REPORTS 'THE ENGINES WON'T TAKE WARP;"W1;"'":GOTO590
  790 PRINT"WARP ENGINES ARE DAMAGED.  MAXIMUM SPEED = WARP 0.2":GOTO530
  800 N=INT(W1*8+.5):IFE-N>=0THEN870
  810 PRINT"ENGINEERING REPORTS  'INSUFFICIENT ENERGY AVAILABLE"
  820 PRINTTAB(23)"FOR MANEUVERING AT WARP";W1;"'"
  830 IFS<N-EORD(7)<0THEN530
  840 PRINT"DEFLECTOR CONTROL ROOM ACKNOWLEDGES";S;"UNITS OF ENERGY"
  850 PRINTTAB(23)"PRESENTLY DEPLOYED TO SHIELDS."
  860 GOTO530
  870 FORI=1TOK3:IFK(I,3)=0THEN900
  880 A$="   ":Z1=K(I,1):Z2=K(I,2):GOSUB3390:GOSUB3370
  890 K(I,1)=Z1:K(I,2)=Z2:A$="+K+":GOSUB3390
  900 NEXTI:GOSUB2210:D1=0:D6=W1:IFW1>=1THEND6=1
  910 FORI=1TO8:IFD(I)>=0THEN960
  920 D(I)=D(I)+D6:IFD(1)>-.1ANDD(I)<0THEND(I)=-.1:GOTO960
  930 IFD(I)<0THEN960
  940 IFD1<>1THEND1=1:PRINT"DAMAGE CONTROL REPORT:"
  950 PRINTTAB(8);:R1=I:GOSUB3440:PRINTG2$;" REPAIR COMPLETED."
  960 NEXTI:IFRND(0)>.2THEN1020
  970 R1=RND(8):IFRND(0)>=.6THEN1000
  980 D(R1)=D(R1)-(RND(0)*5+1):PRINT"DAMAGE CONTROL REPORT:";
  990 GOSUB3440:PRINTG2$;"DAMAGED":PRINT:GOTO1020
 1000 D(R1)=D(R1)+RND(0)*3+1:PRINT"DAMAGE CONTROL REPORT"
 1010 GOSUB 3440: PRINT G2$;" STATE OF REPAIR IMPROVED":PRINT
 1020 A$="   ":Z1=INT(S1):Z2=INT(S2):GOSUB3390
 1030 X1=C(C1,1)+(C(C1+1,1)-C(C1,1))*(C1-INT(C1)):X=S1:Y=S2
 1040 X2=C(C1,2)+(C(C1+1,2)-C(C1,2))*(C1-INT(C1)):Q4=Q1:Q5=Q2
 1050 FORI=1TON:S1=S1+X1:S2=S2+X2:IFS1<1ORS1>=9ORS2<1ORS2>=9THEN1140
 1060 S8=INT(S1)*24+INT(S2)*3-26:IFMID$(Q$,S8,2)="  "THEN1090
 1070 S1=INT(S1-X1):S2=INT(S2-X2):PRINT"WARP ENGINE SHUTDOWN AT";
 1080 PRINT"SECTOR";S1;", ";S2;"DO TO BAD NAVIGATION":GOTO1100
 1090 NEXTI:S1=INT(S1):S2=INT(S2)
 1100 A$="<*>":Z1=INT(S1):Z2=INT(S2):GOSUB3390:GOSUB1300:T8=1
 1110 IFW1<1THENT8=.1*INT(10*W1)
 1120 T=T+T8:IFT>T0+T9THEN2340
 1130 GOTO520
 1140 X=8*Q1+X+N*X1:Y=8*Q2+Y+N*X2:Q1=INT(X/8):Q2=INT(Y/8):S1=INT(X-Q1*8)
 1150 S2=INT(Y-Q2*8):IFS1=0THENQ1=Q1-1:S1=8
 1160 IFS2=0THENQ2=Q2-1:S2=8
 1170 X5=0:IFQ1<1THENX5=1:Q1=1:S1=1
 1180 IFQ1>8THENX5=1:Q1=8:S1=8
 1190 IFQ2<1THENX5=1:Q2=1:S2=1
 1200 IFQ2>8THENX5=1:Q2=8:S2=8
 1210 IFX5=0THEN1280
 1220 PRINT"LT. UHURA REPORTS MESSAGE FROM STARFLEET COMMAND:"
 1230 PRINT"PERMISSION TO ATTEMPT CROSSING OF GALACTIC PERIMETER"
 1240 PRINT"  IS HEREBY *DENIED*. SHUTDOWN YOUR ENGINES"
 1250 PRINT"CHIEF ENGINEER SCOTT REPORTS, WARP ENGINES SHUT DOWN"
 1260 PRINT"AT SECTOR";S1;",";S2;"OF QUADRANT";Q1;",";Q2;"."
 1270 IF T>T0+T9THEN 2340
 1280 IF 8+Q1+Q2=8+Q4+Q5THEN 1100
 1290 T=T+1:GOSUB 1300:GOTO320
 1300 E=E-N-10:IF E>0 THEN RETURN
 1310 PRINT "SHIELD CONTROL SUPPLIES ENERGY TO COMPLETE THE MANEUVER"
 1320 S=S+E:E=0:IF S<0 THEN S=0
 1330 RETURN
 1340 IF D(3)<0 THEN PRINT"LONG RANGE SENSORS ARE INOPERABLE":GOTO 530
 1350 IF D <3><0 THEN PRINT "LONG RANGE FOR QUADRANT" ;Q1;",";Q2
 1360 O1$="--------------------":PRINT O1$
 1370 FOR I=Q1-1 TO Q1+1:N(1)=-1:N(2)=-2:N(3)=-3:FOR J=Q2-1 TO Q2+1
 1380 IFI>0ANDI<9ANDJ>0ANDJ<9THENN(J-Q2+2)=G(I,J):Z(I,J)=G(I,J)
 1390 NEXTJ:FORL=1TO3:PRINT": ";:IFN(L)<0THENPRINT"*** ";:GOTO1410
 1400 PRINTRIGHT$(STR$(N(L)+1000),3);" ";
 1410 NEXTL:PRINT":":PRINTO1$:NEXTI:GOTO530
 1420 CLS:PRINT:IFD(4)<0THENPRINT"PHASERS INOPERATIVE":GOTO530
 1430 IFK3>0THEN1460
 1440 PRINT"SCIENCE OFFICER SPOCK REPORTS ' SENSORS SHOW NO ENEMY SHIPS"
 1450 PRINTTAB(32)"IN THIS QUADRANT '":GOTO530
 1460 IFD(8)<0THENPRINT"COMPUTER FAILURE HAMPERS ACCURACY"
 1470 PRINT"PHASERS LOCKED ON TARGET;  ";
 1480 PRINT"ENERGY AVAILABLE =";E;"UNITS"
 1490 INPUT"NUMBER OF UNITS TO FIRE";X:IFX<=0THEN530
 1500 IFE-X<0THEN1480
 1510 E=E-X:IFD(7)<0THENX=X*RND(0)
 1520 H1=INT(X/K3):FORI=1TO3:IFK(I,3)<=0THEN1610
 1530 JH=SQR((K(I,1)-S1)^2+(K(I,2)-S2)^2)
 1540 H=INT((H1/JH)*(RND(0)+2)):IFH>.15*K(I,3)THEN1560
 1550 PRINT"SENSORS SHOW NO DAMAGE TO ENEMY AT";K(I,1);",";K(I,2):GOTO1610
 1560 K(I,3)=K(I,3)-H:PRINTH;"UNIT HIT ON KLINGON AT SECTOR";K(I,1);",";
 1570 PRINTK(I,2):IFK(I,3)<=0THENPRINT"*** KLINGON DESTROYED ***":GOTO1590
 1580 PRINT"   (SENSORS SHOW";K(I,3);"UNITS REMAINING)":GOTO1610
 1590 K3=K3-1:K9=K9-1:Z1=K(I,1):Z2=K(I,2):A$="   ":GOSUB3390
 1600 K(I,3)=0:G(Q1,Q2)=G(Q1,Q2)-100:Z(Q1,Q2)=G(Q1,Q2):IFK9<=0THEN2450
 1610 NEXTI:GOSUB2210:GOTO530
 1620 FOR X = 1 TO 10:NEXT X
 1630 IFP<0PRINT"ALL PHOTON TORPEDOES EXPENDED":GOTO530
 1640 IFD(5)<0THENPRINT"PHOTON TUBES ARE NOT OPERATIONAL":GOTO530
 1650 INPUT"PHOTON TORPEDOE COURSE (1-9)";C1:IFC1=9THENC1=1
 1660 IFC1>=1ANDC1<9THEN1690
 1670 PRINT"ENSIGN CHEKOV REPORTS, 'INCORECT COURSE DATA, SIR!'"
 1680 GOTO530
 1690 X1=C(C1,1)+(C(C1+1,1)-C(C1,1))*(C1-INT(C1)):E=E-2:P=P-1
 1700 X2=C(C1,2)+(C(C1+1,2)-C(C1,2))*(C1-INT(C1)):X=S1:Y=S2
 1710 X=X+X1:Y=Y+X2:X3=INT(X+.5):Y3=INT(Y+.5)
 1720 IFX3<1ORX3>8ORY3<1ORY3>8THEN1960
 1730 PRINT@832,STRING$(63," ")
 1740 PRINT@832,"TRACKING TORPEDOE:";X3;",";Y3;:A$="   ":Z1=X:Z2=Y:GOSUB3530
 1750 IFZ3<>0THEN1710
 1760 PRINT
 1770 A$="+K+":Z1=X:Z2=Y:GOSUB3530:IFZ3=0THEN1820
 1780 PRINT"*** KLINGON DESTROYED ***":K3=K3-1:K9=K9-1:IFK9<=0THEN2450
 1790 FORI=1TO3:IFX3=K(I,1)ANDY3=K(I,2)THEN1810
 1800 NEXTI:I=3
 1810 K(I,3)=0:GOTO1940
 1820 A$=" * ":Z1=X:Z2=Y:GOSUB3530:IFZ3=0THEN1840
 1830 PRINT"STAR AT";X3;",";Y3;"ABSORBED TORPEDO ENERGY.":GOSUB2210:GOTO530
 1840 A$=">!<":Z1=X:Z2=Y:GOSUB3530:IFZ3=0THEN1650
 1850 PRINT"*** STARBASE DESTROYED ***":B3=B3-1:B9=B9-1
 1860 IFB9>0ORK9>T-T0-T9THEN1920
 1870 NA$="WALDO"
 1880 PRINT"CAPTAIN ";NA$;", YOU ARE HEREBY RELIEVED OF COMMAND"
 1890 PRINT"AND SENTENCED TO 99 STARDATES AT HARD LABOR ON CYGNUS 12!!"
 1900 FORII=1TO2500:NEXT
 1910 GOTO 2370
 1920 PRINT"STARFLEET COMMAND REVIEWING YOUR RECORD TO CONSIDER"
 1930 PRINT"COURT MARTIAL!":D0=0
 1940 Z1=X:Z2=Y:A$="   ":GOSUB3390
 1950 G(Q1,Q2)=K3*100+B3*10+S3:Z(Q1,Q2)=G(Q1,Q2):GOSUB2210:GOTO530
 1960 PRINT:PRINT"TORPEDO MISSED":GOSUB2210:GOTO530
 1970 IFD(7)<0THENPRINT"SHIELD CONTROL INOPERABLE":GOTO530
 1980 PRINT"ENERGY AVAILABLE=";E+S :INPUT"NUMBER OF UNITS TO SHIELDS";X
 1990  IFX<0ORS=XTHENPRINT"(SHIELDS UNCHANGED)":GOTO530
 2000 IFX<=E+STHEN2030
 2010 PRINT"CAPTAIN"NA$"!   THIS IS NOT THE FEDERATION TREASURY."
 2020 PRINT"(SHIELDS UNCHANGED)":GOTO530
 2030 E=E+S-X:S=X:PRINT"DEFLECTOR CONTROL ROOM REPORT:"<ERROR>
 2040 PRINT"  'SHIELDS NOW AT";INT(S);"UNITS PER YOUR COMMAND.'"
 2050 FORII=1TO1500:NEXT:CLS:GOSUB2490:GOTO530
 2060 IFD(6)>=0THEN2170
 2070 PRINT"DAMAGE CONTROL REPORT NOT AVAILABLE":IFD0=0THEN530
 2080 D3=0:FORI=1TO8:IFD(I)<0THEND3=D3+.1
 2090 NEXTI:IFD3=0THEN530
 2100 PRINT:D3=D3+D4:IFD3>=1THEND3=.9
 2110 PRINT"TECHNICIANS STANDING BY TO EFFECT REPAIRS TO YOUR SHIP;"
 2120 PRINT"ESTIMATED TIME TO REPAIR:";.01*INT(100*D3);"STARDATES"
 2130 INPUT"WILL YOU AUTHORIZE THE REPAIR ORDER (Y/N)";A$
 2140 IFA$<>"Y"THEN530
 2150 FORI=1TO8:IFD(I)<0THEND(I)=0
 2160 NEXTI:T=T+D3+.1
 2170 CLS:PRINT:PRINT"DEVICE            STATE OF REPAIR":FORR1=1TO8
 2180 GOSUB3440:PRINTG2$;LEFT$(Z$,25-LEN(G2$));INT(D(R1)*100)*.01
 2190 NEXTR1:PRINT:IFD0<>0THEN2080
 2200 GOTO530
 2210 IFK3<=0THENRETURN
 2220 IFD0<>0THENPRINT"STARBASE SHIELDS PROTECT THE ENTERPRISE":RETURN
 2230 FORI=1TO3:IFK(I,3)<=0THEN2330
 2240 JH=SQR((K(I,1)-S1)^2+(K(I,2)-S2)^2)
 2250 H=INT((K(I,3)/JH)*(2+RND(0))):S=S-H:K(I,3)=K(I,3)/(3+RND(O))
 2260 PRINTH;"UNIT HIT ON ENTERPRISE FROM SECTOR";K(I,1);,;;K(I,2)
 2270 FORIX=1TO1000:NEXTIX
 2280 IFS<=0THEN2350
 2290 PRINT"      (SHIELDS DOWN TO";S;"UNITS)":IF8<20THEN2330
 2300 IFRND(0)>.6ORH/S<=.02THEN2330
 2310 R1=RND(8):D(R1)=D(R1)-H/S-.5*RND(0):GOSUB3440
 2320 PRINT"DAMAGE CONTROL REPORTS '";G2$;" DAMAGED BY THE HIT'"
 2330 NEXTI:RETURN
 2340 PRINT"IT IS STARDATE";T:FORI=1TO1500:NEXTI:GOTO2370
 2350 CLS:PRINT:PRINT"THE ENTERPRISE HAS BEEN DESTROYED."::PRINT"THE FEDERATION";
 2360 PRINT"WILL BE CONQUERED":GOTO2340
 2370 CLS:PRINT"THERE WERE";K9;"KLINGON BATTLE CRUISERS LEFT AT"
 2380 PRINT"THE END OF YOUR MISSION."
 2390 PRINT:PRINT:IFB9=0THEN2430
 2400 PRINT"THE FEDERATION IS IN NEED OF A NEW STAR SHIP COMMANDER"
 2410 PRINT"FOR A SIMILER MISSION -- IF THERE IS A VOLUNTEER."
 2420 INPUT"LET HIM STEP FORWARD AND ENTER 'AYE'";A$:IFA$="AYE"THEN20
 2430 END
 2440 T=100:B9=1
 2450 FOR II=1 TO 1500:NEXT:CLS
 2460 PRINT@192,"CONGRATULATIONS, MON CAPITAN "NA$"!  THE LAST KLINGON BATTLE"
 2470 PRINTTAB(5)"CRUISER MENACING THE FEDERATION HAS BEEN DESTROYED!":PRINT
 2480 PRINTTAB(10)"YOUR EFFICIENCY RATING IS";1000*(K7/(T-T0))^2:GOTO2390
 2490 FORI=S1-1TOS1+1:FORJ=S2-1TOS2+1
 2500 IFINT(I+.5)<1ORINT(I+.5)>8ORINT(J+.5)<1ORINT(J+.5)>8THEN2520
 2510 A$=">!<":Z1=I:Z2=J:GOSUB3530:IFZ3=1THEN2530
 2520 NEXTJ:NEXTI:D0=0:GOTO2550
 2530 D0=1:C$="DOCKED":E=E0:P=P0
 2540 PRINT"SHIELDS DROPPED FOR DOCKING PURPOSES":FORIX=1TO1500:NEXTIX:S=0:GOTO2570
 2550 IFK3>0THENC$="*RED*":GOTO2570
 2560 C$="GREEN":IFE<E0*.1THENC$="YELLOW"
 2570 IFD(2)>=0THEN2600
 2580 IF(PEEK(16000)<>32)OR(PEEK(16064)<>32)THENCLS:PRINT
 2590 PRINT"*** SHORT RANGE SENSORS ARE OUT ***":PRINT:RETURN
 2600 CLS:O1$="---------------------------------":PRINTO1$:FORI=1TO8
 2610 FORJ=(I-1)*24+1TO(I-1)*24+22STEP3:PRINT" ";MID$(Q$,J,3);:NEXTJ
 2620 ONIGOTO2630,2640,2650,2660,2670,2680,2690,2700
 2630 PRINT"   STARDATE          ";INT(T*10)*.1:GOTO2710
 2640 PRINT"   CONDITION          ";C$:GOTO2710
 2650 PRINT"   QUADRANT          ";Q1;",";Q2:GOTO2710
 2660 PRINT"   SECTOR            ";S1;",";S2:GOTO2710
 2670 PRINT"   pHOTON TORPEDOES  ";INT(P):GOTO2710
 2680 PRINT"   TOTAL ENERGY      ";INT(E+S):GOTO 2710
 2690 PRINT"   SHIELDS           ";INT(S):GOTO 2710
 2700 PRINT"   KLINGONS REMAINING";INT(K9)
 2710 NEXTI:PRINTO1$:RETURN
 2720 IFD(8)<0THENPRINT"COMPUTER DISABLED":GOTO530
 2730 INPUT"COMPUTER ACTIVE AND AWAITING COMMAND";A:IFA<0ORA>4THEN2750
 2740 H8=1:ONA+1GOTO2830,2950,3050,3340,3110,
 2750 CLS:PRINT"FUNCTIONS AVAILABLE FROM LIBRARY-COMPUTER."
 2760 PRINT"   0 = CUMULATIVE GALACTIC RECORD"
 2770 PRINT"   1 = STATUS REPORT"
 2780 PRINT"   2 = PHOTON TORPEDO DATA"
 2790 PRINT"   3 = STARBASE NAV DATA"
 2800 PRINT"   4 = DIRECTION/DISTANCE CACULATOR"
 2810 PRINT:GOTO2730
 2820 H8=0:G5=1:CLS:PRINTTAB(24)"THE GALAXY":GOTO2860
 2830 PRINT:PRINT"        ";
 2840 CLS:PRINT"COMPUTER RECORD OF GALAXY FOR QUADRANT";Q1;",";Q2
 2850 PRINT
 2860 PRINT"       1     2     3     4     5     6     7     8"
 2870 O1$="     ----- ----- ----- ----- ----- ----- ----- -----"
 2880 PRINTO1$:FORI=1TO8:PRINTI;:IFH8=0THEN2920
 2890 FORJ=1TO8:PRINT"   ";:IFZ(I,J)=0THENPRINT"***";:GOTO2910
 2900 PRINTRIGHT$(STR$(Z(I,J)+1000),3);
 2910 NEXTJ:GOTO2940
 2920 Z4=I:Z5=1:GOSUB3560:J0=INT(15-.5*LEN(G2$)):PRINTTAB(J0);G2$;
 2930 Z5=5:GOSUB 3560:J0=INT(39-.5*LEN(G2$)):PRINTTAB(J0);G2$;
 2940 PRINT:NEXTI:PRINT:GOTO530
 2950 CLS:PRINT "   STATUS REPORT:":X$="":IFK9>1THENX$="S"
 2960 PRINT"KLINGON";X$;" LEFT: ";K9
 2970 PRINT"MISSION MUST BE COMPLETED IN";.1*INT((T0+T9-T)*10),"STARDATES"
 2980 X$="S":IFB9<2THENX$="":IFB9<1THEN3020
 2990 PRINT"THE FEDERATION IS MANTAINING";B9;"STARBASE";X$;" IN THE GALAXY"
 3000 FORIX=1TO1500:NEXTIX
 3010 GOTO2060
 3020 PRINT"CAPTAIN "NA$"!  YOUR STUPIDITY HAS LEFT YOU ON YOUR OWN"
 3030 PRINT"IN THE GALAXY -- YOU HAVE NO STARBASES LEFT!"
 3040 FORII=1TO2000:NEXT:GOTO2060
 3050 IFK3<=0THEN1440
 3060 X$="":IFK3>1THENX$="S"
 3070 PRINT"FROM ENTERPRISE TO KLINGON";X$
 3080 H8=0:FORI=1TO3:IFK(I,3)<=0THEN3330
 3090 W1=K(I,1):X=K(I,2)
 3100 C1=S1:A=S2:GOTO3150
 3110 CLS:PRINT"DIRECTION/DISTANCE CALCULATOR:"
 3120 PRINT"YOU ARE AT QUADRANT ";Q1;",";Q2;" SECTOR ";S1;".";S2
 3130 PRINT"PLEASE ENTER":C1=Q1:A=Q2
 3140 INPUT"  DESTINATION COORDINATES (X,Y)";W1,X
 3150 X=X-A:A=C1-W1:IFX<0THEN3230
 3160 IFA<0THEN3250
 3170 IFX>0THEN3190
 3180 IFA=0THENC1=5:GOTO3200
 3190 C1=1
 3200 IFABS(A)<=ABS(X)THEN3220
 3210 PRINT"DIRECTION =";C1+(((ABS(A)-ABS(X))+ABS(A))/ABS(A));:GOTO3290
 3220 PRINT"DIRECTION =";C1+(ABS(A)/(ABS(X)+.001));:GOTO3290
 3230 IFA>0THENC1=3:GOTO3260
 3240 IFX<>0THENC1=5:GOTO3200
 3250 C1=7
 3260 IFABS(A)>=ABS(X)THEN3280
 3270 PRINT"DIRECTION =";C1+(((ABS(X)-ABS(A))+ABS(X))/ABS(X));:GOTO3290
 3280 PRINT"DIRECTION =";C1+(ABS(X)/ABS(A));
 3290 PRINT"DISTANCE =";
 3300 IFW1=B4PRINTSQR(X^2+.9^2)/10:GOTO3320
 3310 PRINTSQR(X^2+A^2)
 3320 IFH8=1THEN530
 3330 NEXTI:GOTO530
 3340 IFB3<>0THENPRINT"FROM ENTERPRISE TO STARBASE:":W1=P4:X=B5:GOTO3100
 3350 PRINT"MR SPOCK REPORTS, 'SENSORS SHOW NO STARBASES IN THIS";
 3360 PRINT" QUADRANT.'":GOTO 530
 3370 R1=RND(8):R2=RND(8):A$="   ":Z1=R1:Z2=R2:GOSUB3530:IFZ3=0THEN3370:PRINTZ3
 3380 RETURN
 3390 S8=INT(Z2-.5)*3+INT(Z1-.5)*24+1
 3400 IFLEN(A$)<>3THENPRINT"ERROR":STOP
 3410 IFS8=1THENQ$=A$+RIGHT$(Q$,189):RETURN
 3420 IFS8=190THENQ$=LEFT$(Q$,189)+A$:RETURN
 3430 Q$=LEFT$(Q$,S8-1)+A$+RIGHT$(Q$,190-S8):RETURN
 3440 ONR1GOTO3450,3460,3470,3480,3490,3500,3510,3520
 3450 G2$="WARP ENGINES":RETURN
 3460 G2$="SHORT RANGE SENSORS":RETURN
 3470 G2$="LONG RANGE SENSORS":RETURN
 3480 G2$="PHASER CONTROL":RETURN
 3490 G2$="PHOTON TUBES":RETURN
 3500 G2$="DAMAGE CONTROL":RETURN
 3510 G2$="SHIELD COTROL":RETURN
 3520 G2$="LIBRARY-COMPUTER":RETURN
 3530 Z1=INT(Z1+.5):Z2=INT(Z2+.5):S8=(Z2-1)*3+(Z1-1)*24+1:Z3=0
 3540 IFMID$(Q$,S8,3)<>A$THENRETURN
 3550 Z3=1:RETURN
 3560 PRINT"GOSUB3490":RETURN

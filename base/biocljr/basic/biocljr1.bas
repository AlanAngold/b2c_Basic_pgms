    1 REM NOTE: Basic language type forced to be:
    2 REM       trs2 - TRS-80 Level II BASIC tokenized file
   10 CLS
   11 '    ****** BIORYTHM ******
   12 ' CREATIVE COMPUTING: JAN-FEB 1978   P. 75
   13 'MCIROSOFT BASIC PROGRAM
   14 P=6.23819
   15 FORI=1TO4:PRINT:NEXTI
   16 PRINTTAB(16)"Wait please --- working!"
   17 DIMP1(23),P2(23),E1(28),E2(28),I1(33),I2(33)
   18 DIMW$(7),L$(41),M$(12)
   19 DATASUN,MON,TUE,WED,THR,FRI,SAT
   20 DATAJAN,FEB,MAR,APR,MAY,JUN
   21 DATAJUL,AUG,SEP,OCT,NOV,DEC
   22 FORN=1TO23
   23 P2(N)=SIN(P*(N-1)/23)
   24 P1(N)=INT(21.5+20*P2(N))
   25 NEXTN
   26 FORN=1TO28
   27 E2(N)=SIN(P*(N-1)/28)
   28 E1(N)=INT(21.5+20*E2(N))
   29 NEXTN
   30 FORN=1TO33
   31 I2(N)=SIN(P*(N-1)/33)
   32 I1(N)=INT(21.5+20*I2(N))
   33 NEXTN
   34 FORN=1TO7
   35 READW$(N)
   36 NEXTN
   37 FORN=1TO12
   38 READM$(N)
   39 NEXTN
   40 FORN=1TO41
   41 L$(N)=" "
   42 NEXTN
   43 PRINTCHR$(12)
   44 PRINT"Enter name: ";
   45 INPUTN$
   46 PRINT"Enter birth date: "
   47 PRINT"10,9,43 means Oct 9, 1943"
   48 INPUTM,D,Y
   49 Y=Y+1900
   50 PRINT"Enter month and year for biorhythmic calender"
   51 PRINT"4, 77 means Apr, 1977"
   52 INPUTM4,Y4
   53 Y7=Y:M7=M:D7=D
   54 Y4=Y4+1900
   55 Y=Y7:M=M7:D=D7
   56 GOSUB154
   57 M=M4
   58 D=1
   59 Y=Y4
   60 GOSUB117
   61 S1=J
   62 GOSUB154
   63 L1=31
   64 IFM4=12THEN70
   65 GOSUB130
   66 S3=N3
   67 M=M4+1
   68 GOSUB130
   69 L1=N3-S3
   70 B=J-S1+1
   71 E=B+L1-1
   72 PRINT"  BIO";TAB(56);M$(M4)
   73 PRINT" INDEX";TAB(54);Y
   74 PRINTTAB(9);"-....................0";
   75 PRINT"....................+"
   76 V=0
   77 FORI=BTOE
   78 V=V+1
   79 J3=I-1
   80 K1=INT(J3/23)
   81 K2=J3-(K1*23)+1
   82 K3=INT(J3/28)
   83 K4=J3-(K3*28)+1
   84 K5=INT(J3/33)
   85 K6=J3-(K5*33)+1
   86 P=P1(K2)
   87 Q=E1(K4)
   88 R=I1(K6)
   89 O=P2(K2)+E2(K4)+I2(K6)
   90 O=INT(16666*(O+3))+1
   91 L$(21)="."
   92 L$(P)="P"
   93 L$(Q)="E"
   94 L$(R)="I"
   95 PRINTO;TAB(10)
   96 FORN=1TO41
   97 PRINTL$(N);
   98 NEXTN
   99 PRINTTAB(54);V;TAB(58);W$(N2)
  100 L$(P)=" "
  101 L$(Q)=" "
  102 L$(R)=" "
  103 N2=N2+1
  104 IFN2<8THEN106
  105 N2=1
  106 NEXTI
  107 PRINTTAB(9);"-....................0";
  108 PRINT"....................+"
  109 IFLEN(N$)/2=INT(LEN(N$)/2)THENPL=31-LEN(N$)/2ELSEPL=30-INT(LEN(N$)/2)
  110 PRINTTAB(PL);N$
  111 INPUT"Do you want the next month";Q$
  112 IFLEFT$(Q$,1)="Y"ORLEFT$(Q$,1)="y"THEN113ELSEIFLEFT$(Q$,1)="N"ORLEFT$(Q$,1)="n"THEN116ELSE111
  113 M4=M4+1
  114 IFM4<=12THEN55
  115 M4=1:Y4=Y4+1:GOTO55
  116 STOP
  117 IFM<3THEN121
  118 M1=M-2
  119 Y1=Y
  120 GOTO123
  121 M1=M+10
  122 Y1=Y-1
  123 C=INT(Y1/100)
  124 D1=Y1-(C*100)
  125 N4=INT((13*M1-1)/5)+D+D1+INT(D1/4)
  126 N=N4+INT(C/4)-2*C+77
  127 N1=INT(N/7)
  128 N2=N-(N1*7)+1
  129 RETURN
  130 Y2=INT(Y/4)
  131 Y3=Y-(Y2*4)
  132 IFY3=0THEN134
  133 GOTO144
  134 Y2=INT(Y/100)
  135 Y3=Y-(Y2*100)
  136 IFY3=0THEN138
  137 GOTO142
  138 Y2=INT(Y/400)
  139 Y3=Y-(Y2*400)
  140 IFY3=0THEN142
  141 GOTO144
  142 L1=1
  143 GOTO145
  144 L1=0
  145 N1=INT((3055*(M+2))/100)-91
  146 L=0
  147 IFM<3THEN152
  148 IFL1=0THEN151
  149 L=1
  150 GOTO152
  151 L=2
  152 N3=N1+D-L
  153 RETURN
  154 IFM<3THEN158
  155 M1=M-3
  156 Y1=Y
  157 GOTO160
  158 M1=M+9
  159 Y1=Y-1
  160 C=INT(Y1/100)
  161 D1=Y1-(C*100)
  162 N=INT((146097!*C)/4)+D+INT((1461*D1)/4)
  163 J=N+1.72112E+06+INT((153*M1+2)/5)
  164 RETURN
  165 END

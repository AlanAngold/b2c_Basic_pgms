/*
 * Title: The annotated BASIC Listing
 *
 *  Listing of basic/civilwar2.bas: 
 *
                   +--------+---- Routine IDs (Empty field=Inaccessible code, A=Main program).
                   |        | +-- Target status (G-GOSUB, T-GOTO, B-Both GOSUB and GOTO)
        Program    |        | |
        Address    v        v v Original BASIC statement
    -------------- ---------- - ------------------------------------------------------------------------------
    0x56323c66b6d0 ---------A   00002  PRINT TAB(26) "CIVIL WAR"
    0x56323c66b670 ---------A   00004  PRINT TAB(15) "CREATIVE COMPUTING  MORRISTOWN, NEW JERSEY"
    0x56323c66b9e0 ---------A   00006  PRINT : PRINT : PRINT
    0x56323c66de90 ---------A   00020  REM ORIGINAL GAME DESIGN: CRAM, GOODIE, HIBBARD LEXINGTON H.S.
    0x56323c66e010 ---------A   00030  REM MODIFICATIONS: G. PAUL, R. HESS (TIES), 1973
    0x56323c673e20 ---------A   00050   DIM S(4),C$(14),M1(14),M2(14),C1(14),C2(14),M(14)
    0x56323c673eb0 ---------A   00060   REM UNION INFO ON LIKELY CONFEDERATE STRATEGY
    0x56323c674930 ---------A   00070   S(1)=25 : S(2)=25 : S(3)=25 : S(4)=25
    0x56323c674980 ---------A   00082   REM READ HISTORICAL DATA.
    0x56323c674d50 ---------A   00084   FOR D=1 TO 14
    0x56323c66e0d0 ---------A   00086   READ C$(D),M1(D),M2(D),C1(D),C2(D),M(D)
    0x56323c675930 ---------A   00088   NEXT D
    0x56323c675c40 ---------A   00089   LET D=RND(-1)
    0x56323c675c90 ---------A   00090   PRINT
    0x56323c675df0 ---------A   00100   PRINT "DO YOU WANT INSTRUCTIONS";
    0x56323c675ff0 ---------A T 00110   INPUT X$
    0x56323c676250 ---------A   00120   IF X$="YES" THEN 160
    0x56323c6764b0 ---------A   00130   IF X$="NO" THEN 370
    0x56323c676630 ---------A   00140   PRINT "YES OR NO -- ";
    0x56323c6766c0 ---------A   00150   GOTO 110
    0x56323c676870 ---------A T 00160   PRINT : PRINT : PRINT : PRINT
    0x56323c676a10 ---------A   00170   PRINT "THIS IS A CIVIL WAR SIMULATION."
    0x56323c676bc0 ---------A   00180   PRINT "TO PLAY TYPE A RESPONSE WHEN THE COMPUTER ASKS."
    0x56323c676d80 ---------A   00190   PRINT "REMEMBER THAT ALL FACTORS ARE INTERRELATED AND THAT YOUR"
    0x56323c676f50 ---------A   00200   PRINT "RESPONSES COULD CHANGE HISTORY. FACTS AND FIGURES USED ARE"
    0x56323c677110 ---------A   00210   PRINT "BASED ON THE ACTUAL OCCURRENCE. MOST BATTLES TEND TO RESULT"
    0x56323c6772a0 ---------A   00220   PRINT "AS THEY DID IN THE CIVIL WAR, BUT IT ALL DEPENDS ON YOU!!"
    0x56323c677350 ---------A   00230   PRINT
    0x56323c6774f0 ---------A   00240   PRINT "THE OBJECT OF THE GAME IS TO WIN AS MANY BATTLES AS ";
    0x56323c677650 ---------A   00245   PRINT "POSSIBLE."
    0x56323c6776f0 ---------A   00250   PRINT
    0x56323c677890 ---------A   00260   PRINT "YOUR CHOICES FOR DEFENSIVE STRATEGY ARE:"
    0x56323c677a30 ---------A   00270   PRINT "        (1) ARTILLERY ATTACK"
    0x56323c677df0 ---------A   00280   PRINT "        (2) FORTIFICATION AGAINST FRONTAL ATTACK"
    0x56323c677f80 ---------A   00290   PRINT "        (3) FORTIFICATION AGAINST FLANKING MANEUVERS"
    0x56323c678110 ---------A   00300   PRINT "        (4) FALLING BACK"
    0x56323c6782b0 ---------A   00310   PRINT " YOUR CHOICES FOR OFFENSIVE STRATEGY ARE:"
    0x56323c678430 ---------A   00320   PRINT "        (1) ARTILLERY ATTACK"
    0x56323c6785c0 ---------A   00330   PRINT "        (2) FRONTAL ATTACK"
    0x56323c678740 ---------A   00340   PRINT "        (3) FLANKING MANEUVERS"
    0x56323c6788e0 ---------A   00350   PRINT "        (4) ENCIRCLEMENT"
    0x56323c678a90 ---------A   00360   PRINT "YOU MAY SURRENDER BY TYPING A '5' FOR YOUR STRATEGY."
    0x56323c678d50 ---------A T 00370   PRINT : PRINT : PRINT : PRINT "ARE THERE TWO GENERALS PRESENT ";
    0x56323c678ed0 ---------A T 00380   PRINT "(ANSWER YES OR NO)";
    0x56323c679100 ---------A   00390   INPUT B$
    0x56323c679390 ---------A   00400   IF B$="YES" THEN 430
    0x56323c679640 ---------A   00410   IF B$ <> "NO" THEN 380
    0x56323c679810 ---------A   00420   PRINT : PRINT "YOU ARE THE CONFEDERACY.   GOOD LUCK!"
    0x56323c679890 ---------A   00425   PRINT
    0x56323c679ac0 ---------A T 00430   LET D=1
    0x56323c679d30 ---------A   00440   IF B$ <> "YES" THEN 460
    0x56323c679f80 ---------A   00450   LET D=2
    0x56323c67a120 ---------A T 00460   PRINT "SELECT A BATTLE BY TYPING A NUMBER FROM 1 TO 14 ON"
    0x56323c67a2e0 ---------A   00470   PRINT "REQUEST.  TYPE ANY OTHER NUMBER TO END THE SIMULATION."
    0x56323c67a470 ---------A   00480   PRINT "BUT '0' BRINGS BACK EXACT PREVIOUS BATTLE SITUATION"
    0x56323c67a5e0 ---------A   00490   PRINT "ALLOWING YOU TO REPLAY IT"
    0x56323c67a690 ---------A   00500   PRINT
    0x56323c67a830 ---------A   00510   PRINT "NOTE: A NEGATIVE FOOD$ ENTRY CAUSES THE PROGRAM TO "
    0x56323c67a9b0 ---------A   00520   PRINT "USE THE ENTRIES FROM THE PREVIOUS BATTLE"
    0x56323c67aa50 ---------A   00530   PRINT
    0x56323c67ac00 ---------A   00540   PRINT "AFTER REQUESTING A BATTLE, DO YOU WISH ";
    0x56323c67ad90 ---------A   00550   PRINT "BATTLE DESCRIPTIONS ";
    0x56323c67af10 ---------A T 00560   PRINT "(ANSWER YES OR NO)";
    0x56323c67b080 ---------A   00570   INPUT X$
    0x56323c67b310 ---------A   00580   IF X$="YES" THEN 600
    0x56323c67b9c0 ---------A   00590   IF X$ <> "NO" THEN 560
    0x56323c67d500 ---------A T 00600   L=0:W=0:R1=0:Q1=0:M3=0:M4=0:P1=0:P2=0:T1=0:T2=0
    0x56323c67f6f0 ---------A   00610   F(2)=0:H(2)=0:B(2)=0:R2=0:Q2=0:C6=0:F=0:W0=0:Y=0:Y2=0:U=0:U2=0
    0x56323c67f840 ---------A T 00620   PRINT : PRINT : PRINT
    0x56323c67f9d0 ---------A   00630   PRINT "WHICH BATTLE DO YOU WISH TO SIMULATE";
    0x56323c67fbf0 ---------A   00640   INPUT A
    0x56323c67fe60 ---------A   00650   IF A <> 0 THEN 660
    0x56323c680180 ---------A   00655   IF R <> 0 THEN 1140
    0x56323c6803f0 ---------A T 00660   IF A <=0 THEN 2860
    0x56323c680650 ---------A   00665   IF A >= 15 THEN 2860
    0x56323c680970 ---------A   00670   LET C$=C$(A)
    0x56323c680c80 ---------A   00680   LET M1=M1(A)
    0x56323c680f90 ---------A   00690   LET M2=M2(A)
    0x56323c6812a0 ---------A   00700   LET C1=C1(A)
    0x56323c6815b0 ---------A   00710   LET C2=C2(A)
    0x56323c6818c0 ---------A   00720   LET M=M(A)
    0x56323c681ae0 ---------A   00960   LET U=0
    0x56323c681b50 ---------A   00970   REM  INFLATION CALC
    0x56323c6821c0 ---------A   00980   LET I1=10+(L-W)*2
    0x56323c682820 ---------A   00990   LET I2=10+(W-L)*2
    0x56323c682890 ---------A   01000   REM - MONEY AVAILABLE
    0x56323c683890 ---------A   01010   LET D(1)=100*INT((M1*(100-I1)/2000)*(1+(R1-Q1)/(R1+1))+.5)
    0x56323c6841d0 ---------A   01020   LET D(2)=100*INT(M2*(100-I2)/2000+.5)
    0x56323c684470 ---------A   01030   IF B$ <> "YES" THEN 1050
    0x56323c685420 ---------A   01040   LET D(2)=100*INT((M2*(100-I2)/2000)*(1+(R2-Q2)/(R2+1))+.5)
    0x56323c685490 ---------A T 01050   REM - MEN   AVAILABLE
    0x56323c685ec0 ---------A   01060   LET M5=INT(M1*(1+(P1-T1)/(M3+1)))
    0x56323c6868b0 ---------A   01070   LET M6=INT(M2*(1+(P2-T2)/(M4+1)))
    0x56323c686dc0 ---------A   01080   LET F1=5*M1/6
    0x56323c686fc0 ---------A   01090   PRINT : PRINT : PRINT : PRINT : PRINT
    0x56323c687240 ---------A   01100   PRINT "THIS IS THE BATTLE OF ";C$
    0x56323c6874c0 ---------A   01110   IF X$="NO" THEN 1150
    0x56323c687750 ---------A   01120   IF A>11 THEN 1130
    0x56323c688100 ---------A   01125   ON A GOTO 3580,3620,3650,3690,3720,3750,3780,3800,3830,3860,3890
    0x56323c6885b0 ---------A T 01130   ON A-11 GOTO 3920,3950,3980
    0x56323c688810 ---------A T 01140   PRINT C$" INSTANT REPLAY"
    0x56323c6888a0 ---------A T 01150   PRINT
    0x56323c688c10 ---------A   01160   PRINT " ","CONFEDERACY"," UNION"
    0x56323c689180 ---------A   01170   PRINT "MEN"," "M5," "M6
    0x56323c689880 ---------A   01180   PRINT "MONEY","$";D(1),"$";D(2)
    0x56323c68a0e0 ---------A   01190   PRINT "INFLATION"," ";I1+15;"%"," ";I2;"%"
    0x56323c68a190 ---------A   01195   PRINT
    0x56323c68a230 ---------A   01200   REM - ONLY IN PRINTOUT IS CONFED INFLATION = I1+15%
    0x56323c68a300 ---------A   01210   REM - IF TWO GENERALS, INPUT CONFED. FIRST
    0x56323c68a6e0 ---------A   01220   FOR I=1 TO D
    0x56323c68a960 ---------A   01230   IF B$ <> "YES" THEN 1260
    0x56323c68abd0 ---------A   01240   IF I=2 THEN 1260
    0x56323c68ad80 ---------A   01250   PRINT "CONFEDERATE GENERAL---";
    0x56323c68af00 ---------A T 01260   PRINT "HOW MUCH DO YOU WISH TO SPEND FOR"
    0x56323c68b080 ---------A T 01270   PRINT " - FOOD......";
    0x56323c68b1f0 ---------A   01280   INPUT F
    0x56323c68b460 ---------A   01290   IF F >= 0 THEN 1360
    0x56323c68b6d0 ---------A   01300   IF R1 <> 0 THEN 1330
    0x56323c68b830 ---------A   01310   PRINT "NO PREVIOUS ENTRIES"
    0x56323c68b8d0 ---------A   01320   GOTO 1270
    0x56323c68ba40 ---------A T 01330   PRINT "ASSUME YOU WANT TO KEEP SAME ALLOCATIONS"
    0x56323c68bac0 ---------A   01340   PRINT
    0x56323c68bb40 ---------A   01350   GOTO 1510
    0x56323c68be60 ---------A T 01360   LET F(I)=F
    0x56323c68bfd0 ---------A T 01370   PRINT " - SALARIES..";
    0x56323c68c210 ---------A   01380   INPUT H(I)
    0x56323c68c500 ---------A   01390   LET N=1
    0x56323c68c840 ---------A   01400   IF H(I)<0 THEN 1490
    0x56323c68c9c0 ---------A T 01410   PRINT " - AMMUNITION";
    0x56323c68d410 ---------A   01420   INPUT B(I)
    0x56323c68d640 ---------A   01430   LET N=2
    0x56323c68d970 ---------A   01440   IF B(I)<0 THEN 1490
    0x56323c68da10 ---------A   01450   PRINT
    0x56323c68e270 ---------A   01460   IF F(I)+H(I)+B(I) <= D(I) THEN 1510
    0x56323c68e5c0 ---------A   01470   PRINT "THINK AGAIN! YOU HAVE ONLY $"D(I)
    0x56323c68e660 ---------A   01480   GOTO 1270
    0x56323c68e7d0 ---------A T 01490   PRINT "NEGATIVE VALUES NOT ALLOWED."
    0x56323c68eac0 ---------A   01500   ON N GOTO 1370,1410
    0x56323c68ed40 ---------A T 01510   IF B$ <> "YES" THEN 1550
    0x56323c68efb0 ---------A   01520   IF I=2 THEN 1550
    0x56323c68f130 ---------A   01530   PRINT "UNION GENERAL---";
    0x56323c68f270 ---------A   01540   NEXT I
    0x56323c68f650 ---------A T 01550   FOR Z=1 TO D
    0x56323c68f8e0 ---------A   01560   IF B$ <> "YES" THEN 1620
    0x56323c68fbd0 ---------A   01570   ON Z GOTO 1580,1600
    0x56323c68fd50 ---------A T 01580   PRINT "CONFEDERATE ";
    0x56323c68fde0 ---------A   01590   GOTO 1620
    0x56323c68ff50 ---------A T 01600   PRINT "      UNION ";
    0x56323c68ffd0 ---------A   01610   REM - FIND MORALE
    0x56323c690c70 ---------A T 01620   LET O=((2*F(Z)^2+H(Z)^2)/F1^2+1)
    0x56323c690ed0 ---------A   01630   IF O<10 THEN 1660
    0x56323c691030 ---------A   01640   PRINT "MORALE IS HIGH"
    0x56323c6910b0 ---------A   01650   GOTO 1700
    0x56323c691310 ---------A T 01660   IF O<5 THEN 1690
    0x56323c691470 ---------A   01670   PRINT "MORALE IS FAIR"
    0x56323c691500 ---------A   01680   GOTO 1700
    0x56323c691660 ---------A T 01690   PRINT "MORALE IS POOR"
    0x56323c6918e0 ---------A T 01700   IF B$ <> "YES" THEN 1760
    0x56323c691c00 ---------A   01710   LET O(Z)=O
    0x56323c691d30 ---------A   01720   NEXT Z
    0x56323c692100 ---------A   01730   LET O2=O(2)
    0x56323c692400 ---------A   01740   LET O=O(1)
    0x56323c6925a0 ---------A   01750   PRINT "CONFEDERATE GENERAL---";
    0x56323c692630 ---------A T 01760   REM - ACTUAL OFF/DEF BATTLE SITUATION
    0x56323c6928c0 ---------A   01770   IF M <> 3 THEN 1800
    0x56323c692a30 ---------A   01780   PRINT "YOU ARE ON THE OFFENSIVE"
    0x56323c692ac0 ---------A   01790   GOTO 1840
    0x56323c692d20 ---------A T 01800   IF M <> 1 THEN 1830
    0x56323c692e90 ---------A   01810   PRINT "YOU ARE ON THE DEFENSIVE"
    0x56323c692f30 ---------A   01820   GOTO 1840
    0x56323c693090 ---------A T 01830   PRINT "BOTH SIDES ARE ON THE OFFENSIVE "
    0x56323c693120 ---------A T 01840   PRINT
    0x56323c6931a0 ---------A   01850   REM - CHOOSE STRATEGIES
    0x56323c693440 ---------A   01860   IF B$ <> "YES" THEN 1910
    0x56323c693730 ---------A   01870   FOR I=1 TO 2
    0x56323c693a20 ---------A   01880   ON I GOTO 1890,1920
    0x56323c693ba0 ---------A T 01890   PRINT "CONFEDERATE STRATEGY ";
    0x56323c693c30 ---------A   01900   GOTO 1920
    0x56323c693da0 ---------A T 01910   PRINT "YOUR STRATEGY ";
    0x56323c693f10 ---------A T 01920   INPUT Y
    0x56323c694360 ---------A   01930   IF ABS(Y-3)<3 THEN 1960
    0x56323c6946c0 ---------A   01940   PRINT "STRATEGY";Y;"NOT ALLOWED."
    0x56323c694750 ---------A   01950   GOTO 1910
    0x56323c6949c0 ---------A T 01960   IF B$="YES" THEN 2000
    0x56323c694c20 ---------A   01970   IF Y=5 THEN 2830
    0x56323c694ca0 ---------A   01980   GOSUB 3110
    0x56323c694d10 ---------A   01990   GOTO 2170
    0x56323c694f60 ---------A T 02000   IF I=2 THEN 2040
    0x56323c695270 ---------A   02010   LET Y1=Y
    0x56323c6953e0 ---------A T 02020   PRINT "UNION STRATEGY ";
    0x56323c695520 ---------A   02030   NEXT I
    0x56323c695770 ---------A T 02040   LET Y2=Y
    0x56323c6959a0 ---------A   02050   LET Y=Y1
    0x56323c695c00 ---------A   02060   IF Y2=5 THEN 2020
    0x56323c695c90 ---------A   02070   REM : SIMULATED LOSSES-NORTH
    0x56323c696940 ---------A   02080   LET C6=(2*C2/5)*(1+1/(2*(ABS(Y2-Y)+1)))
    0x56323c697340 ---------A   02090   LET C6=C6*(1.28+(5*M2/6)/(B(2)+1))
    0x56323c697ad0 ---------A   02100   LET C6=INT(C6*(1+1/O2)+.5)
    0x56323c697b60 ---------A   02110   REM - IF LOSS > MEN PRESENT, RESCALE LOSSES
    0x56323c697f80 ---------A   02120   LET E2=100/O2
    0x56323c698400 ---------A   02130   IF INT(C6+E2)<M6 THEN 2190
    0x56323c698920 ---------A   02140   LET C6=INT(13*M6/20)
    0x56323c698d50 ---------A   02150   LET E2=7*C6/13
    0x56323c698f70 ---------A   02160   LET U2=1
    0x56323c698ff0 ---------A T 02170   REM - CALCULATE SIMULATED LOSSES
    0x56323c6990a0 ---------A   02180   PRINT
    0x56323c699400 ---------A T 02190   PRINT : PRINT : PRINT ,"CONFEDERACY","UNION"
    0x56323c69a140 ---------A   02200   LET C5=(2*C1/5)*(1+1/(2*(ABS(Y2-Y)+1)))
    0x56323c69ae30 ---------A   02210   LET C5=INT(C5*(1+1/O)*(1.28+F1/(B(1)+1))+.5)
    0x56323c69b240 ---------A   02220   LET E=100/O
    0x56323c69bd10 ---------A   02230   IF C5+100/O<M1*(1+(P1-T1)/(M3+1)) THEN 2270
    0x56323c69c850 ---------A   02240   LET C5=INT(13*M1/20*(1+(P1-T1)/(M3+1)))
    0x56323c69cc80 ---------A   02250   LET E=7*C5/13
    0x56323c69ce90 ---------A   02260   LET U=1
    0x56323c69d0f0 ---------A T 02270   IF D=1 THEN 2500
    0x56323c69d460 ---------A T 02280   PRINT "CASUALTIES",C5,C6
    0x56323c69d980 ---------A   02290   PRINT "DESERTIONS",INT(E),INT(E2)
    0x56323c69da10 ---------A   02300   PRINT
    0x56323c69dcb0 ---------A   02310   IF B$ <> "YES" THEN 2350
    0x56323c69df50 ---------A   02320   PRINT "COMPARED TO THE ACTUAL CASUALTIES AT "C$
    0x56323c69e720 ---------A   02330   PRINT "CONFEDERATE:"INT(100*(C5/C1)+.5)"% OF THE ORIGINAL"
    0x56323c69eec0 ---------A   02340   PRINT "UNION:      "INT(100*(C6/C2)+.5)"% OF THE ORIGINAL"
    0x56323c69ef40 ---------A T 02350   PRINT
    0x56323c69efc0 ---------A   02360   REM - 1 WHO ONE
    0x56323c69f240 ---------A   02370   IF U <> 1 THEN 2380
    0x56323c69f4a0 ---------A   02375   IF U2=1 THEN 2460
    0x56323c69f700 ---------A T 02380   IF U=1 THEN 2420
    0x56323c69f970 ---------A   02390   IF U2=1 THEN 2440
    0x56323c69fe40 ---------A   02400   IF C5+E=C6+E2 THEN 2460
    0x56323c6a0310 ---------A   02410   IF C5+E<C6+E2 THEN 2440
    0x56323c6a0570 ---------A T 02420   PRINT "THE UNION WINS "C$
    0x56323c6a0600 ---------A   02430   GOTO 2600
    0x56323c6a0850 ---------A T 02440   PRINT "THE CONFEDERACY WINS "C$
    0x56323c6a08e0 ---------A   02450   GOTO 2660
    0x56323c6a0a40 ---------A T 02460   PRINT "BATTLE OUTCOME UNRESOLVED"
    0x56323c6a0d80 ---------A   02470   LET W0=W0+1
    0x56323c6a0fd0 ---------A   02480   IF A=0 THEN 2790
    0x56323c6a1060 ---------A   02490   GOTO 2680
    0x56323c6a17f0 ---------A T 02500   LET C6=INT(17*C2*C1/(C5*20))
    0x56323c6a1b20 ---------A   02510   LET E2=5*O
    0x56323c6a1bc0 ---------A   02520   GOTO 2280
    0x56323c6a2370 ----------   02530   PRINT "YOUR CASUALTIES WERE "INT(100*(C5/C1)+.5)"% OF "
    0x56323c6a25e0 ----------   02540   PRINT "THE ACTUAL CASUALTIES AT ";C$
    0x56323c6a2670 ----------   02550   PRINT
    0x56323c6a26f0 ---------A   02560   REM - FIND WHO WON
    0x56323c6a2980 ----------   02570   IF U=1 THEN 2590
    0x56323c6a33d0 ----------   02580   IF C5+E<17*C2*C1/(C5*20)+5*O THEN 2630
    0x56323c6a3630 ---------- T 02590   PRINT "YOU LOSE ";C$
    0x56323c6a3890 ---------A T 02600   IF A=0 THEN 2790
    0x56323c6a3bd0 ---------A   02610   LET L=L+1
    0x56323c6a3c50 ---------A   02620   GOTO 2680
    0x56323c6a3ed0 ---------- T 02630   PRINT "YOU WIN ";C$
    0x56323c6a3f70 ---------A   02640   REM - CUMULATIVE BATTLE FACTORS WHICH ALTER HISTORICAL
    0x56323c6a4050 ---------A   02650   REM  RESOURCES AVAILABLE.IF A REPLAY DON'T UPDATE.
    0x56323c6a42c0 ---------A T 02660   IF A=0 THEN 2790
    0x56323c6a4600 ---------A   02670   LET W=W+1
    0x56323c6a4a70 ---------A T 02680   LET T1=T1+C5+E
    0x56323c68ce40 ---------A   02690   LET T2=T2+C6+E2
    0x56323c68d190 ---------A   02700   LET P1=P1+C1
    0x56323c6a5da0 ---------A   02710   LET P2=P2+C2
    0x56323c6a65c0 ---------A   02720   LET Q1=Q1+(F(1)+H(1)+B(1))
    0x56323c6a6de0 ---------A   02730   LET Q2=Q2+(F(2)+H(2)+B(2))
    0x56323c6a74a0 ---------A   02740   LET R1=R1+M1*(100-I1)/20
    0x56323c6a7b50 ---------A   02750   LET R2=R2+M2*(100-I2)/20
    0x56323c6a7ea0 ---------A   02760   LET M3=M3+M1
    0x56323c6a81f0 ---------A   02770   LET M4=M4+M2
    0x56323c6a8260 ---------A   02780   GOSUB 3300
    0x56323c6a8670 ---------A T 02790   U=0:U2=0
    0x56323c6a87c0 ---------A   02800   PRINT "---------------"
    0x56323c6a8850 ---------A   02810   GOTO 620
    0x56323c6a88c0 ---------A   02820   REM------FINISH OFF
    0x56323c6a8a60 ---------A T 02830   PRINT "THE CONFEDERACY HAS SURRENDERED"
    0x56323c6a8b00 ---------A   02840   GOTO 2860
    0x56323c6a8c80 ----------   02850   PRINT "THE UNION HAS SURRENDERED."
    0x56323c6a8ef0 ---------A T 02860   PRINT : PRINT : PRINT : PRINT : PRINT : PRINT
    0x56323c6a9090 ---------A   02870   PRINT "THE CONFEDERACY ";
    0x56323c6a94f0 ---------A   02880   PRINT "HAS WON "W" BATTLES AND LOST "L
    0x56323c6a9750 ---------A   02890   IF Y=5 THEN 2940
    0x56323c6a99c0 ---------A   02900   IF Y2=5 THEN 2920
    0x56323c6a9c40 ---------A   02910   IF W <= L THEN 2940
    0x56323c6a9ec0 ---------A   02915   IF Y=5 THEN 2940
    0x56323c6aa030 ---------A T 02920   PRINT "THE CONFEDERACY HAS WON THE WAR"
    0x56323c6aa0c0 ---------A   02930   GOTO 2950
    0x56323c6aa220 ---------A T 02940   PRINT "THE UNION HAS WON THE WAR"
    0x56323c6aa2a0 ---------A T 02950   PRINT
    0x56323c6aa530 ---------A   02960   IF R1=0 THEN 3100
    0x56323c6aaaf0 ---------A   02970   PRINT "FOR THE "W+L+W0" BATTLES FOUGHT (EXCUDING RERUNS)"
    0x56323c6aae80 ---------A   02980   PRINT " "," "," ";
    0x56323c6ab100 ---------A   02990   PRINT "CONFEDERACY"," UNION"
    0x56323c6ab840 ---------A   03000   PRINT "HISTORICAL LOSSES",INT(P1+.5),INT(P2+.5)
    0x56323c6abf60 ---------A   03010   PRINT "SIMULATED LOSSES",INT(T1+.5),INT(T2+.5)
    0x56323c6ac010 ---------A   03020   PRINT
    0x56323c6acc00 ---------A   03030   PRINT "    % OF ORIGINAL",INT(100*(T1/P1)+.5),INT(100*(T2/P2)+.5)
    0x56323c6ace80 ---------A   03040   IF B$="YES" THEN 3100
    0x56323c6acf30 ---------A   03050   PRINT
    0x56323c6ad0e0 ---------A   03060   PRINT "UNION INTELLIGENCE SUGGESTS THAT THE SOUTH USED "
    0x56323c6ad270 ---------A   03070   PRINT "STRATEGIES 1, 2, 3, 4 IN THE FOLLOWING PERCENTAGES"
    0x56323c6adab0 ---------A   03080   PRINT S(1);S2(2);S(3);S(4)
    0x56323c6adb40 ---------A   03090   REM---------------------------------
    0x56323c6adbb0 ---------A T 03100   STOP
    0x56323c6adc60 ---------B G 03110   REM - UNION STRATEGY IS COMPUTER CHOSEN
    0x56323c6ade10 ---------B   03120   PRINT "UNION STRATEGY IS ";
    0x56323c6ae070 ---------B   03130   IF A <> 0 THEN 3180
    0x56323c6ae1e0 ---------B T 03140   INPUT Y2
    0x56323c6ae440 ---------B   03150   IF Y2 <=0 THEN 3160
    0x56323c6ae6d0 ---------B   03155   IF Y2<5 THEN 3290
    0x56323c6ae860 ---------B T 03160   PRINT "ENTER 1 , 2 ,3 , OR 4 (USUALLY PREVIOUS UNION STRATEGY)"
    0x56323c6ae8e0 ---------B   03170   GOTO 3140
    0x56323c6aebb0 ---------B T 03180   LET S0=0
    0x56323c6aefa0 ---------B   03190   LET R=100*RND(0)
    0x56323c6af270 ---------B   03200   FOR I=1 TO 4
    0x56323c6af6e0 ---------B   03210   LET S0=S0+S(I)
    0x56323c6af780 ---------B   03220   REM - IF ACTUAL STRATEGY INFO IS IN PROGRAM DATA STATEMENTS
    0x56323c6af860 ---------B   03230   REM   THEN R-100 IS EXTRA WEIGHT GIVEN TO THAT STATEGY.
    0x56323c6afaf0 ---------B   03240   IF R<S0 THEN 3270
    0x56323c6afc30 ---------B   03250   NEXT I
    0x56323c6afd10 ---------B   03260   REM - IF ACTUAL STRAT. IN,THEN HERE IS Y2= HIST. STRAT.
    0x56323c6aff60 ---------B T 03270   LET Y2=I
    0x56323c6b00b0 ---------B   03280   PRINT Y2
    0x56323c6b0110 ---------B T 03290   RETURN
    0x56323c6b01e0 ---------C G 03300   REM LEARN  PRESENT STRATEGY, START FORGETTING OLD ONES
    0x56323c6b02d0 ---------C   03310   REM - PRESENT STRATEGY OF SOUTH GAINS 3*S, OTHERS LOSE S
    0x56323c6b03c0 ---------C   03320   REM   PROBABILITY POINTS, UNLESS A STRATEGY FALLS BELOW 5%.
    0x56323c6b05f0 ---------C   03330   LET S=3
    0x56323c6b0800 ---------C   03340   LET S0=0
    0x56323c6b0ae0 ---------C   03350   FOR I=1 TO 4
    0x56323c6b0e20 ---------C   03360   IF S(I) <= 5 THEN 3390
    0x56323c6b1340 ---------C   03370   LET S(I)=S(I)-S
    0x56323c6b1690 ---------C   03380   LET S0=S0+S
    0x56323c6b17c0 ---------C T 03390   NEXT I
    0x56323c6b1cf0 ---------C   03400   LET S(Y)=S(Y)+S0
    0x56323c6b1d40 ---------C   03410   RETURN
    0x56323c6b1e20 ---------A   03420   REM - HISTORICAL DATA...CAN ADD MORE (STRAT.,ETC) BY INSERTING
    0x56323c6b1f10 ---------A   03430   REM   DATA STATEMENTS AFTER APPRO. INFO, AND ADJUSTING READ
    0x56323c6b2520 ---------A   03440   DATA "BULL RUN",18000,18500,1967,2708,1
    0x56323c6b2af0 ---------A   03450   DATA "SHILOH",40000.,44894.,10699,13047,3
    0x56323c6b30d0 ---------A   03460   DATA "SEVEN DAYS",95000.,115000.,20614,15849,3
    0x56323c6b36a0 ---------A   03470   DATA "SECOND BULL RUN",54000.,63000.,10000,14000,2
    0x56323c6b3c70 ---------A   03480   DATA "ANTIETAM",40000.,50000.,10000,12000,3
    0x56323c6b4240 ---------A   03490   DATA "FREDERICKSBURG",75000.,120000.,5377,12653,1
    0x56323c6b4820 ---------A   03500   DATA "MURFREESBORO",38000.,45000.,11000,12000,1
    0x56323c6b4df0 ---------A   03510   DATA "CHANCELLORSVILLE",32000,90000.,13000,17197,2
    0x56323c6b53c0 ---------A   03520   DATA "VICKSBURG",50000.,70000.,12000,19000,1
    0x56323c6b5990 ---------A   03530   DATA "GETTYSBURG",72500.,85000.,20000,23000,3
    0x56323c6b5f60 ---------A   03540   DATA "CHICKAMAUGA",66000.,60000.,18000,16000,2
    0x56323c6b6530 ---------A   03550   DATA "CHATTANOOGA",37000.,60000.,36700.,5800,2
    0x56323c6b6b00 ---------A   03560   DATA "SPOTSYLVANIA",62000.,110000.,17723,18000,2
    0x56323c6b70f0 ---------A   03570   DATA "ATLANTA",65000.,100000.,8500,3700,1
    0x56323c6b72a0 ---------A T 03580   PRINT "JULY 21, 1861.  GEN. BEAUREGARD, COMMANDING THE SOUTH, MET"
    0x56323c6b7460 ---------A   03590   PRINT "UNION FORCES WITH GEN. MCDOWELL IN A PREMATURE BATTLE AT"
    0x56323c6b75f0 ---------A   03600   PRINT "BULL RUN. GEN. JACKSON HELPED PUSH BACK THE UNION ATTACK."
    0x56323c6b76a0 ---------A   03610   GOTO 1150
    0x56323c6b7830 ---------A T 03620   PRINT "APRIL 6-7, 1862.  THE CONFEDERATE SURPRISE ATTACK AT"
    0x56323c6b79b0 ---------A   03630   PRINT "SHILOH FAILED DUE TO POOR ORGANIZATION."
    0x56323c6b7a60 ---------A   03640   GOTO 1150
    0x56323c6b7c00 ---------A T 03650   PRINT "JUNE 25-JULY 1, 1862.  GENERAL LEE (CSA) UPHELD THE"
    0x56323c6b7db0 ---------A   03660   PRINT "OFFENSIVE THROUGHOUT THE BATTLE AND FORCED GEN. MCCLELLAN"
    0x56323c6b7f30 ---------A   03670   PRINT "AND THE UNION FORCES AWAY FROM RICHMOND."
    0x56323c6b7fe0 ---------A   03680   GOTO 1150
    0x56323c6b8180 ---------A T 03690   PRINT "AUG 29-30, 1862.  THE COMBINED CONFEDERATE FORCES UNDER";
    0x56323c6b8310 ---------A   03695   PRINT " LEE"
    0x56323c6b84a0 ---------A   03700   PRINT "AND JACKSON DROVE THE UNION FORCES BACK INTO WASHINGTON."
    0x56323c6b8550 ---------A   03710   GOTO 1150
    0x56323c6b86e0 ---------A T 03720   PRINT "SEPT 17, 1862.  THE SOUTH FAILED TO INCORPORATE MARYLAND"
    0x56323c6b8840 ---------A   03730   PRINT "INTO THE CONFEDERACY."
    0x56323c6b88f0 ---------A   03740   GOTO 1150
    0x56323c6b8a90 ---------A T 03750   PRINT "DEC 13, 1862.  THE CONFEDERACY UNDER LEE SUCCESSFULLY"
    0x56323c6b8c10 ---------A   03760   PRINT "REPULSED AN ATTACK BY THE UNION UNDER GEN. BURNSIDE."
    0x56323c6b8cc0 ---------A   03770   GOTO 1150
    0x56323c6b8e60 ---------A T 03780   PRINT "DEC 31, 1862.  THE SOUTH UNDER GEN. BRAGG WON A CLOSE ";
    0x56323c6b8fc0 ---------A   03785   PRINT "BATTLE."
    0x56323c6b9070 ---------A   03790   GOTO 1150
    0x56323c6b9220 ---------A T 03800   PRINT "MAY 1-6, 1863.  THE SOUTH HAD A COSTLY VICTORY AND LOST"
    0x56323c6b93b0 ---------A   03810   PRINT "ONE OF THEIR OUTSTANDING GENERALS, 'STONEWALL' JACKSON."
    0x56323c6b9470 ---------A   03820   GOTO 1150
    0x56323c6b9620 ---------A T 03830   PRINT "JULY 4, 1863.  VICKSBURG WAS A COSTLY DEFEAT FOR THE SOUTH"
    0x56323c6b97a0 ---------A   03840   PRINT "BECAUSE IT GAVE THE UNION ACCESS TO THE MISSISSIPPI."
    0x56323c6b9850 ---------A   03850   GOTO 1150
    0x56323c6b99f0 ---------A T 03860   PRINT "JULY 1-3, 1863.  A SOUTHERN MISTAKE BY GEN. LEE AT ";
    0x56323c6b9b80 ---------A   03865   PRINT "GETTYSBURG"
    0x56323c6b9d00 ---------A   03870   PRINT "COST THEM ONE OF THE MOST CRUCIAL BATTLES OF THE WAR."
    0x56323c6b9dc0 ---------A   03880   GOTO 1150
    0x56323c6b9f60 ---------A T 03890   PRINT "SEPT. 15, 1863. CONFUSION IN A FOREST NEAR CHICKAMAUGA LED"
    0x56323c6ba0d0 ---------A   03900   PRINT "TO A COSTLY SOUTHERN VICTORY."
    0x56323c6ba190 ---------A   03910   GOTO 1150
    0x56323c6ba340 ---------A T 03920   PRINT "NOV. 25, 1863. AFTER THE SOUTH HAD SIEGED GEN. ROSENCRANS'"
    0x56323c6ba4c0 ---------A   03930   PRINT "ARMY FOR THREE MONTHS, GEN. GRANT BROKE THE SIEGE."
    0x56323c6ba570 ---------A   03940   GOTO 1150
    0x56323c6ba720 ---------A T 03950   PRINT "MAY 5, 1864.  GRANT'S PLAN TO KEEP LEE ISOLATED BEGAN TO"
    0x56323c6ba8b0 ---------A   03960   PRINT "FAIL HERE, AND CONTINUED AT COLD HARBOR AND PETERSBURG."
    0x56323c6ba960 ---------A   03970   GOTO 1150
    0x56323c6bab10 ---------A T 03980   PRINT "AUGUST, 1864.  SHERMAN AND THREE VETERAN ARMIES CONVERGED"
    0x56323c6baca0 ---------A   03990   PRINT "ON ATLANTA AND DEALT THE DEATH BLOW TO THE CONFEDERACY."
    0x56323c6bad20 ---------A   04000   GOTO 1150
    0x56323c6bad70 ---------A   04010   END
 */

/*
 * Line reference table:
 *

    Target
   Line Num.    Referencing line number (Reference is T-GOTO or G-GOSUB).
   ---------    -------------------------------------------------------------------
     00110      00150T
     00160      00120T
     00370      00130T
     00380      00410T
     00430      00400T
     00460      00440T
     00560      00590T
     00600      00580T
     00620      02810T
     00660      00650T
     01050      01030T
     01130      01120T
     01140      00655T
     01150      01110T, 03610T, 03640T, 03680T, 03710T, 03740T, 03770T, 03790T, 
                03820T, 03850T, 03880T, 03910T, 03940T, 03970T, 04000T
     01260      01230T, 01240T
     01270      01320T, 01480T
     01330      01300T
     01360      01290T
     01370      01500T
     01410      01500T
     01490      01400T, 01440T
     01510      01350T, 01460T
     01550      01510T, 01520T
     01580      01570T
     01600      01570T
     01620      01560T, 01590T
     01660      01630T
     01690      01660T
     01700      01650T, 01680T
     01760      01700T
     01800      01770T
     01830      01800T
     01840      01790T, 01820T
     01890      01880T
     01910      01860T, 01950T
     01920      01880T, 01900T
     01960      01930T
     02000      01960T
     02020      02060T
     02040      02000T
     02170      01990T
     02190      02130T
     02270      02230T
     02280      02520T
     02350      02310T
     02380      02370T
     02420      02380T
     02440      02390T, 02410T
     02460      02375T, 02400T
     02500      02270T
     02590      02570T
     02600      02430T
     02630      02580T
     02660      02450T
     02680      02490T, 02620T
     02790      02480T, 02600T, 02660T
     02830      01970T
     02860      00660T, 00665T, 02840T
     02920      02900T
     02940      02890T, 02910T, 02915T
     02950      02930T
     03100      02960T, 03040T
     03110      01980G
     03140      03170T
     03160      03150T
     03180      03130T
     03270      03240T
     03290      03155T
     03300      02780G
     03390      03360T
     03580      01125T
     03620      01125T
     03650      01125T
     03690      01125T
     03720      01125T
     03750      01125T
     03780      01125T
     03800      01125T
     03830      01125T
     03860      01125T
     03890      01125T
     03920      01130T
     03950      01130T
     03980      01130T

 */

/* 
 * Routine Start, Target, Return and End Program Addresses 
 * 

  Rtn      Start     LineNum       Target     LineNum        Return    LineNum        End       LineNum  
  --- --------------  -----    --------------  -----    --------------  -----    --------------  -----   
   A) 0x56323c66b6d0 (00002)   0x56323c66b6d0 (00002)   0x56323c6bad70 (04010)   0x56323c6bad70 (04010)   
   B) 0x56323c6adc60 (03110)   0x56323c6adc60 (03110)   0x56323c6b0110 (03290)   0x56323c6b0110 (03290)   
   C) 0x56323c6b01e0 (03300)   0x56323c6b01e0 (03300)   0x56323c6b1d40 (03410)   0x56323c6b1d40 (03410)   

    NOTE: Routine B overlaps, or is tangled with, routine A!
    NOTE: Routine C overlaps, or is tangled with, routine A!

 */

/*
 * Title: The unrolled BASIC Listing
 *
 *  Listing of basic/civilwar2.bas: 
 *
                   +--------+---- Routine IDs (Empty field=Inaccessible code, A=Main program).
                   |        | +-- Target status (G-GOSUB, T-GOTO, B-Both GOSUB and GOTO)
        Program    |        | |
        Address    v        v v Original BASIC statement
    -------------- ---------- - ------------------------------------------------------------------------------
    0x56323c66b6d0 ---------A   00002  PRINT TAB(26) "CIVIL WAR"
    0x56323c66b670 ---------A   00004  PRINT TAB(15) "CREATIVE COMPUTING  MORRISTOWN, NEW JERSEY"
    0x56323c66c910 ----------   00006  PRINT 
    0x56323c65c2b0 ----------        a PRINT 
    0x56323c66b9e0 ---------A        b PRINT
    0x56323c66de90 ---------A   00020  REM ORIGINAL GAME DESIGN
    0x56323c66e010 ---------A   00030  REM MODIFICATIONS
    0x56323c673e20 ---------A   00050  DIM S(4),C$(14),M1(14),M2(14),C1(14),C2(14),M(14)
    0x56323c673eb0 ---------A   00060  REM UNION INFO ON LIKELY CONFEDERATE STRATEGY
    0x56323c674180 ----------   00070  S(1)=25 
    0x56323c674410 ----------        a S(2)=25 
    0x56323c6746a0 ----------        b S(3)=25 
    0x56323c674930 ---------A        c S(4)=25
    0x56323c674980 ---------A   00082  REM READ HISTORICAL DATA.
    0x56323c674d50 ---------A   00084  FOR D=1 TO 14
    0x56323c66e0d0 ---------A   00086  READ C$(D),M1(D),M2(D),C1(D),C2(D),M(D)
    0x56323c675930 ---------A   00088  NEXT D
    0x56323c675c40 ---------A   00089  LET D=RND(-1)
    0x56323c675c90 ---------A   00090  PRINT
    0x56323c675df0 ---------A   00100  PRINT "DO YOU WANT INSTRUCTIONS";
    0x56323c675ff0 ---------A T 00110  INPUT X$
    0x56323c676250 ---------A   00120  IF X$="YES" THEN 160
    0x56323c6764b0 ---------A   00130  IF X$="NO" THEN 370
    0x56323c676630 ---------A   00140  PRINT "YES OR NO -- ";
    0x56323c6766c0 ---------A   00150  GOTO 110
    0x56323c676710 ---------- T 00160  PRINT 
    0x56323c676770 ---------- T      a PRINT 
    0x56323c6767d0 ---------- T      b PRINT 
    0x56323c676870 ---------A T      c PRINT
    0x56323c676a10 ---------A   00170  PRINT "THIS IS A CIVIL WAR SIMULATION."
    0x56323c676bc0 ---------A   00180  PRINT "TO PLAY TYPE A RESPONSE WHEN THE COMPUTER ASKS."
    0x56323c676d80 ---------A   00190  PRINT "REMEMBER THAT ALL FACTORS ARE INTERRELATED AND THAT YOUR"
    0x56323c676f50 ---------A   00200  PRINT "RESPONSES COULD CHANGE HISTORY. FACTS AND FIGURES USED ARE"
    0x56323c677110 ---------A   00210  PRINT "BASED ON THE ACTUAL OCCURRENCE. MOST BATTLES TEND TO RESULT"
    0x56323c6772a0 ---------A   00220  PRINT "AS THEY DID IN THE CIVIL WAR, BUT IT ALL DEPENDS ON YOU!!"
    0x56323c677350 ---------A   00230  PRINT
    0x56323c6774f0 ---------A   00240  PRINT "THE OBJECT OF THE GAME IS TO WIN AS MANY BATTLES AS ";
    0x56323c677650 ---------A   00245  PRINT "POSSIBLE."
    0x56323c6776f0 ---------A   00250  PRINT
    0x56323c677890 ---------A   00260  PRINT "YOUR CHOICES FOR DEFENSIVE STRATEGY ARE:"
    0x56323c677a30 ---------A   00270  PRINT "        (1) ARTILLERY ATTACK"
    0x56323c677df0 ---------A   00280  PRINT "        (2) FORTIFICATION AGAINST FRONTAL ATTACK"
    0x56323c677f80 ---------A   00290  PRINT "        (3) FORTIFICATION AGAINST FLANKING MANEUVERS"
    0x56323c678110 ---------A   00300  PRINT "        (4) FALLING BACK"
    0x56323c6782b0 ---------A   00310  PRINT " YOUR CHOICES FOR OFFENSIVE STRATEGY ARE:"
    0x56323c678430 ---------A   00320  PRINT "        (1) ARTILLERY ATTACK"
    0x56323c6785c0 ---------A   00330  PRINT "        (2) FRONTAL ATTACK"
    0x56323c678740 ---------A   00340  PRINT "        (3) FLANKING MANEUVERS"
    0x56323c6788e0 ---------A   00350  PRINT "        (4) ENCIRCLEMENT"
    0x56323c678a90 ---------A   00360  PRINT "YOU MAY SURRENDER BY TYPING A '5' FOR YOUR STRATEGY."
    0x56323c678af0 ---------- T 00370  PRINT 
    0x56323c678b50 ---------- T      a PRINT 
    0x56323c678bb0 ---------- T      b PRINT 
    0x56323c678d50 ---------A T      c PRINT "ARE THERE TWO GENERALS PRESENT ";
    0x56323c678ed0 ---------A T 00380  PRINT "(ANSWER YES OR NO)";
    0x56323c679100 ---------A   00390  INPUT B$
    0x56323c679390 ---------A   00400  IF B$="YES" THEN 430
    0x56323c679640 ---------A   00410  IF B$ <> "NO" THEN 380
    0x56323c6796a0 ----------   00420  PRINT 
    0x56323c679810 ---------A        a PRINT "YOU ARE THE CONFEDERACY.   GOOD LUCK!"
    0x56323c679890 ---------A   00425  PRINT
    0x56323c679ac0 ---------A T 00430  LET D=1
    0x56323c679d30 ---------A   00440  IF B$ <> "YES" THEN 460
    0x56323c679f80 ---------A   00450  LET D=2
    0x56323c67a120 ---------A T 00460  PRINT "SELECT A BATTLE BY TYPING A NUMBER FROM 1 TO 14 ON"
    0x56323c67a2e0 ---------A   00470  PRINT "REQUEST.  TYPE ANY OTHER NUMBER TO END THE SIMULATION."
    0x56323c67a470 ---------A   00480  PRINT "BUT '0' BRINGS BACK EXACT PREVIOUS BATTLE SITUATION"
    0x56323c67a5e0 ---------A   00490  PRINT "ALLOWING YOU TO REPLAY IT"
    0x56323c67a690 ---------A   00500  PRINT
    0x56323c67a830 ---------A   00510  PRINT "NOTE: A NEGATIVE FOOD$ ENTRY CAUSES THE PROGRAM TO "
    0x56323c67a9b0 ---------A   00520  PRINT "USE THE ENTRIES FROM THE PREVIOUS BATTLE"
    0x56323c67aa50 ---------A   00530  PRINT
    0x56323c67ac00 ---------A   00540  PRINT "AFTER REQUESTING A BATTLE, DO YOU WISH ";
    0x56323c67ad90 ---------A   00550  PRINT "BATTLE DESCRIPTIONS ";
    0x56323c67af10 ---------A T 00560  PRINT "(ANSWER YES OR NO)";
    0x56323c67b080 ---------A   00570  INPUT X$
    0x56323c67b310 ---------A   00580  IF X$="YES" THEN 600
    0x56323c67b9c0 ---------A   00590  IF X$ <> "NO" THEN 560
    0x56323c67bc80 ---------- T 00600  L=0
    0x56323c67bf30 ---------- T      a W=0
    0x56323c67c1e0 ---------- T      b R1=0
    0x56323c67c490 ---------- T      c Q1=0
    0x56323c67c740 ---------- T      d M3=0
    0x56323c67c9f0 ---------- T      e M4=0
    0x56323c67cca0 ---------- T      f P1=0
    0x56323c67cf50 ---------- T      g P2=0
    0x56323c67d200 ---------- T      h T1=0
    0x56323c67d500 ---------A T      i T2=0
    0x56323c67d870 ----------   00610  F(2)=0
    0x56323c67dbe0 ----------        a H(2)=0
    0x56323c67df50 ----------        b B(2)=0
    0x56323c67e200 ----------        c R2=0
    0x56323c67e4b0 ----------        d Q2=0
    0x56323c67e760 ----------        e C6=0
    0x56323c67e950 ----------        f F=0
    0x56323c67ec00 ----------        g W0=0
    0x56323c67eeb0 ----------        h Y=0
    0x56323c67f160 ----------        i Y2=0
    0x56323c67f410 ----------        j U=0
    0x56323c67f6f0 ---------A        k U2=0
    0x56323c67f740 ---------- T 00620  PRINT 
    0x56323c67f7a0 ---------- T      a PRINT 
    0x56323c67f840 ---------A T      b PRINT
    0x56323c67f9d0 ---------A   00630  PRINT "WHICH BATTLE DO YOU WISH TO SIMULATE";
    0x56323c67fbf0 ---------A   00640  INPUT A
    0x56323c67fe60 ---------A   00650  IF A <> 0 THEN 660
    0x56323c680180 ---------A   00655  IF R <> 0 THEN 1140
    0x56323c6803f0 ---------A T 00660  IF A <=0 THEN 2860
    0x56323c680650 ---------A   00665  IF A >= 15 THEN 2860
    0x56323c680970 ---------A   00670  LET C$=C$(A)
    0x56323c680c80 ---------A   00680  LET M1=M1(A)
    0x56323c680f90 ---------A   00690  LET M2=M2(A)
    0x56323c6812a0 ---------A   00700  LET C1=C1(A)
    0x56323c6815b0 ---------A   00710  LET C2=C2(A)
    0x56323c6818c0 ---------A   00720  LET M=M(A)
    0x56323c681ae0 ---------A   00960  LET U=0
    0x56323c681b50 ---------A   00970  REM  INFLATION CALC
    0x56323c6821c0 ---------A   00980  LET I1=10+(L-W)*2
    0x56323c682820 ---------A   00990  LET I2=10+(W-L)*2
    0x56323c682890 ---------A   01000  REM - MONEY AVAILABLE
    0x56323c683890 ---------A   01010  LET D(1)=100*INT((M1*(100-I1)/2000)*(1+(R1-Q1)/(R1+1))+.5)
    0x56323c6841d0 ---------A   01020  LET D(2)=100*INT(M2*(100-I2)/2000+.5)
    0x56323c684470 ---------A   01030  IF B$ <> "YES" THEN 1050
    0x56323c685420 ---------A   01040  LET D(2)=100*INT((M2*(100-I2)/2000)*(1+(R2-Q2)/(R2+1))+.5)
    0x56323c685490 ---------A T 01050  REM - MEN   AVAILABLE
    0x56323c685ec0 ---------A   01060  LET M5=INT(M1*(1+(P1-T1)/(M3+1)))
    0x56323c6868b0 ---------A   01070  LET M6=INT(M2*(1+(P2-T2)/(M4+1)))
    0x56323c686dc0 ---------A   01080  LET F1=5*M1/6
    0x56323c686e10 ----------   01090  PRINT 
    0x56323c686e70 ----------        a PRINT 
    0x56323c686ed0 ----------        b PRINT 
    0x56323c686f30 ----------        c PRINT 
    0x56323c686fc0 ---------A        d PRINT
    0x56323c687240 ---------A   01100  PRINT "THIS IS THE BATTLE OF ";C$
    0x56323c6874c0 ---------A   01110  IF X$="NO" THEN 1150
    0x56323c687750 ---------A   01120  IF A>11 THEN 1130
    0x56323c688100 ---------A   01125  ON A GOTO 3580,3620,3650,3690,3720,3750,3780,3800,3830,3860,3890
    0x56323c6885b0 ---------A T 01130  ON A-11 GOTO 3920,3950,3980
    0x56323c688810 ---------A T 01140  PRINT C$" INSTANT REPLAY"
    0x56323c6888a0 ---------A T 01150  PRINT
    0x56323c688c10 ---------A   01160  PRINT " ","CONFEDERACY"," UNION"
    0x56323c689180 ---------A   01170  PRINT "MEN"," "M5," "M6
    0x56323c689880 ---------A   01180  PRINT "MONEY","$";D(1),"$";D(2)
    0x56323c68a0e0 ---------A   01190  PRINT "INFLATION"," ";I1+15;"%"," ";I2;"%"
    0x56323c68a190 ---------A   01195  PRINT
    0x56323c68a230 ---------A   01200  REM - ONLY IN PRINTOUT IS CONFED INFLATION = I1+15%
    0x56323c68a300 ---------A   01210  REM - IF TWO GENERALS, INPUT CONFED. FIRST
    0x56323c68a6e0 ---------A   01220  FOR I=1 TO D
    0x56323c68a960 ---------A   01230  IF B$ <> "YES" THEN 1260
    0x56323c68abd0 ---------A   01240  IF I=2 THEN 1260
    0x56323c68ad80 ---------A   01250  PRINT "CONFEDERATE GENERAL---";
    0x56323c68af00 ---------A T 01260  PRINT "HOW MUCH DO YOU WISH TO SPEND FOR"
    0x56323c68b080 ---------A T 01270  PRINT " - FOOD......";
    0x56323c68b1f0 ---------A   01280  INPUT F
    0x56323c68b460 ---------A   01290  IF F >= 0 THEN 1360
    0x56323c68b6d0 ---------A   01300  IF R1 <> 0 THEN 1330
    0x56323c68b830 ---------A   01310  PRINT "NO PREVIOUS ENTRIES"
    0x56323c68b8d0 ---------A   01320  GOTO 1270
    0x56323c68ba40 ---------A T 01330  PRINT "ASSUME YOU WANT TO KEEP SAME ALLOCATIONS"
    0x56323c68bac0 ---------A   01340  PRINT
    0x56323c68bb40 ---------A   01350  GOTO 1510
    0x56323c68be60 ---------A T 01360  LET F(I)=F
    0x56323c68bfd0 ---------A T 01370  PRINT " - SALARIES..";
    0x56323c68c210 ---------A   01380  INPUT H(I)
    0x56323c68c500 ---------A   01390  LET N=1
    0x56323c68c840 ---------A   01400  IF H(I)<0 THEN 1490
    0x56323c68c9c0 ---------A T 01410  PRINT " - AMMUNITION";
    0x56323c68d410 ---------A   01420  INPUT B(I)
    0x56323c68d640 ---------A   01430  LET N=2
    0x56323c68d970 ---------A   01440  IF B(I)<0 THEN 1490
    0x56323c68da10 ---------A   01450  PRINT
    0x56323c68e270 ---------A   01460  IF F(I)+H(I)+B(I) <= D(I) THEN 1510
    0x56323c68e5c0 ---------A   01470  PRINT "THINK AGAIN! YOU HAVE ONLY $"D(I)
    0x56323c68e660 ---------A   01480  GOTO 1270
    0x56323c68e7d0 ---------A T 01490  PRINT "NEGATIVE VALUES NOT ALLOWED."
    0x56323c68eac0 ---------A   01500  ON N GOTO 1370,1410
    0x56323c68ed40 ---------A T 01510  IF B$ <> "YES" THEN 1550
    0x56323c68efb0 ---------A   01520  IF I=2 THEN 1550
    0x56323c68f130 ---------A   01530  PRINT "UNION GENERAL---";
    0x56323c68f270 ---------A   01540  NEXT I
    0x56323c68f650 ---------A T 01550  FOR Z=1 TO D
    0x56323c68f8e0 ---------A   01560  IF B$ <> "YES" THEN 1620
    0x56323c68fbd0 ---------A   01570  ON Z GOTO 1580,1600
    0x56323c68fd50 ---------A T 01580  PRINT "CONFEDERATE ";
    0x56323c68fde0 ---------A   01590  GOTO 1620
    0x56323c68ff50 ---------A T 01600  PRINT "      UNION ";
    0x56323c68ffd0 ---------A   01610  REM - FIND MORALE
    0x56323c690c70 ---------A T 01620  LET O=((2*F(Z)^2+H(Z)^2)/F1^2+1)
    0x56323c690ed0 ---------A   01630  IF O<10 THEN 1660
    0x56323c691030 ---------A   01640  PRINT "MORALE IS HIGH"
    0x56323c6910b0 ---------A   01650  GOTO 1700
    0x56323c691310 ---------A T 01660  IF O<5 THEN 1690
    0x56323c691470 ---------A   01670  PRINT "MORALE IS FAIR"
    0x56323c691500 ---------A   01680  GOTO 1700
    0x56323c691660 ---------A T 01690  PRINT "MORALE IS POOR"
    0x56323c6918e0 ---------A T 01700  IF B$ <> "YES" THEN 1760
    0x56323c691c00 ---------A   01710  LET O(Z)=O
    0x56323c691d30 ---------A   01720  NEXT Z
    0x56323c692100 ---------A   01730  LET O2=O(2)
    0x56323c692400 ---------A   01740  LET O=O(1)
    0x56323c6925a0 ---------A   01750  PRINT "CONFEDERATE GENERAL---";
    0x56323c692630 ---------A T 01760  REM - ACTUAL OFF/DEF BATTLE SITUATION
    0x56323c6928c0 ---------A   01770  IF M <> 3 THEN 1800
    0x56323c692a30 ---------A   01780  PRINT "YOU ARE ON THE OFFENSIVE"
    0x56323c692ac0 ---------A   01790  GOTO 1840
    0x56323c692d20 ---------A T 01800  IF M <> 1 THEN 1830
    0x56323c692e90 ---------A   01810  PRINT "YOU ARE ON THE DEFENSIVE"
    0x56323c692f30 ---------A   01820  GOTO 1840
    0x56323c693090 ---------A T 01830  PRINT "BOTH SIDES ARE ON THE OFFENSIVE "
    0x56323c693120 ---------A T 01840  PRINT
    0x56323c6931a0 ---------A   01850  REM - CHOOSE STRATEGIES
    0x56323c693440 ---------A   01860  IF B$ <> "YES" THEN 1910
    0x56323c693730 ---------A   01870  FOR I=1 TO 2
    0x56323c693a20 ---------A   01880  ON I GOTO 1890,1920
    0x56323c693ba0 ---------A T 01890  PRINT "CONFEDERATE STRATEGY ";
    0x56323c693c30 ---------A   01900  GOTO 1920
    0x56323c693da0 ---------A T 01910  PRINT "YOUR STRATEGY ";
    0x56323c693f10 ---------A T 01920  INPUT Y
    0x56323c694360 ---------A   01930  IF ABS(Y-3)<3 THEN 1960
    0x56323c6946c0 ---------A   01940  PRINT "STRATEGY";Y;"NOT ALLOWED."
    0x56323c694750 ---------A   01950  GOTO 1910
    0x56323c6949c0 ---------A T 01960  IF B$="YES" THEN 2000
    0x56323c694c20 ---------A   01970  IF Y=5 THEN 2830
    0x56323c694ca0 ---------A   01980  GOSUB 3110
    0x56323c694d10 ---------A   01990  GOTO 2170
    0x56323c694f60 ---------A T 02000  IF I=2 THEN 2040
    0x56323c695270 ---------A   02010  LET Y1=Y
    0x56323c6953e0 ---------A T 02020  PRINT "UNION STRATEGY ";
    0x56323c695520 ---------A   02030  NEXT I
    0x56323c695770 ---------A T 02040  LET Y2=Y
    0x56323c6959a0 ---------A   02050  LET Y=Y1
    0x56323c695c00 ---------A   02060  IF Y2=5 THEN 2020
    0x56323c695c90 ---------A   02070  REM 
    0x56323c696940 ---------A   02080  LET C6=(2*C2/5)*(1+1/(2*(ABS(Y2-Y)+1)))
    0x56323c697340 ---------A   02090  LET C6=C6*(1.28+(5*M2/6)/(B(2)+1))
    0x56323c697ad0 ---------A   02100  LET C6=INT(C6*(1+1/O2)+.5)
    0x56323c697b60 ---------A   02110  REM - IF LOSS > MEN PRESENT, RESCALE LOSSES
    0x56323c697f80 ---------A   02120  LET E2=100/O2
    0x56323c698400 ---------A   02130  IF INT(C6+E2)<M6 THEN 2190
    0x56323c698920 ---------A   02140  LET C6=INT(13*M6/20)
    0x56323c698d50 ---------A   02150  LET E2=7*C6/13
    0x56323c698f70 ---------A   02160  LET U2=1
    0x56323c698ff0 ---------A T 02170  REM - CALCULATE SIMULATED LOSSES
    0x56323c6990a0 ---------A   02180  PRINT
    0x56323c699100 ---------- T 02190  PRINT 
    0x56323c699160 ---------- T      a PRINT 
    0x56323c699400 ---------A T      b PRINT ,"CONFEDERACY","UNION"
    0x56323c69a140 ---------A   02200  LET C5=(2*C1/5)*(1+1/(2*(ABS(Y2-Y)+1)))
    0x56323c69ae30 ---------A   02210  LET C5=INT(C5*(1+1/O)*(1.28+F1/(B(1)+1))+.5)
    0x56323c69b240 ---------A   02220  LET E=100/O
    0x56323c69bd10 ---------A   02230  IF C5+100/O<M1*(1+(P1-T1)/(M3+1)) THEN 2270
    0x56323c69c850 ---------A   02240  LET C5=INT(13*M1/20*(1+(P1-T1)/(M3+1)))
    0x56323c69cc80 ---------A   02250  LET E=7*C5/13
    0x56323c69ce90 ---------A   02260  LET U=1
    0x56323c69d0f0 ---------A T 02270  IF D=1 THEN 2500
    0x56323c69d460 ---------A T 02280  PRINT "CASUALTIES",C5,C6
    0x56323c69d980 ---------A   02290  PRINT "DESERTIONS",INT(E),INT(E2)
    0x56323c69da10 ---------A   02300  PRINT
    0x56323c69dcb0 ---------A   02310  IF B$ <> "YES" THEN 2350
    0x56323c69df50 ---------A   02320  PRINT "COMPARED TO THE ACTUAL CASUALTIES AT "C$
    0x56323c69e720 ---------A   02330  PRINT "CONFEDERATE:"INT(100*(C5/C1)+.5)"% OF THE ORIGINAL"
    0x56323c69eec0 ---------A   02340  PRINT "UNION:      "INT(100*(C6/C2)+.5)"% OF THE ORIGINAL"
    0x56323c69ef40 ---------A T 02350  PRINT
    0x56323c69efc0 ---------A   02360  REM - 1 WHO ONE
    0x56323c69f240 ---------A   02370  IF U <> 1 THEN 2380
    0x56323c69f4a0 ---------A   02375  IF U2=1 THEN 2460
    0x56323c69f700 ---------A T 02380  IF U=1 THEN 2420
    0x56323c69f970 ---------A   02390  IF U2=1 THEN 2440
    0x56323c69fe40 ---------A   02400  IF C5+E=C6+E2 THEN 2460
    0x56323c6a0310 ---------A   02410  IF C5+E<C6+E2 THEN 2440
    0x56323c6a0570 ---------A T 02420  PRINT "THE UNION WINS "C$
    0x56323c6a0600 ---------A   02430  GOTO 2600
    0x56323c6a0850 ---------A T 02440  PRINT "THE CONFEDERACY WINS "C$
    0x56323c6a08e0 ---------A   02450  GOTO 2660
    0x56323c6a0a40 ---------A T 02460  PRINT "BATTLE OUTCOME UNRESOLVED"
    0x56323c6a0d80 ---------A   02470  LET W0=W0+1
    0x56323c6a0fd0 ---------A   02480  IF A=0 THEN 2790
    0x56323c6a1060 ---------A   02490  GOTO 2680
    0x56323c6a17f0 ---------A T 02500  LET C6=INT(17*C2*C1/(C5*20))
    0x56323c6a1b20 ---------A   02510  LET E2=5*O
    0x56323c6a1bc0 ---------A   02520  GOTO 2280
    0x56323c6a2370 ----------   02530  PRINT "YOUR CASUALTIES WERE "INT(100*(C5/C1)+.5)"% OF "
    0x56323c6a25e0 ----------   02540  PRINT "THE ACTUAL CASUALTIES AT ";C$
    0x56323c6a2670 ----------   02550  PRINT
    0x56323c6a26f0 ---------A   02560  REM - FIND WHO WON
    0x56323c6a2980 ----------   02570  IF U=1 THEN 2590
    0x56323c6a33d0 ----------   02580  IF C5+E<17*C2*C1/(C5*20)+5*O THEN 2630
    0x56323c6a3630 ---------- T 02590  PRINT "YOU LOSE ";C$
    0x56323c6a3890 ---------A T 02600  IF A=0 THEN 2790
    0x56323c6a3bd0 ---------A   02610  LET L=L+1
    0x56323c6a3c50 ---------A   02620  GOTO 2680
    0x56323c6a3ed0 ---------- T 02630  PRINT "YOU WIN ";C$
    0x56323c6a3f70 ---------A   02640  REM - CUMULATIVE BATTLE FACTORS WHICH ALTER HISTORICAL
    0x56323c6a4050 ---------A   02650  REM  RESOURCES AVAILABLE.IF A REPLAY DON'T UPDATE.
    0x56323c6a42c0 ---------A T 02660  IF A=0 THEN 2790
    0x56323c6a4600 ---------A   02670  LET W=W+1
    0x56323c6a4a70 ---------A T 02680  LET T1=T1+C5+E
    0x56323c68ce40 ---------A   02690  LET T2=T2+C6+E2
    0x56323c68d190 ---------A   02700  LET P1=P1+C1
    0x56323c6a5da0 ---------A   02710  LET P2=P2+C2
    0x56323c6a65c0 ---------A   02720  LET Q1=Q1+(F(1)+H(1)+B(1))
    0x56323c6a6de0 ---------A   02730  LET Q2=Q2+(F(2)+H(2)+B(2))
    0x56323c6a74a0 ---------A   02740  LET R1=R1+M1*(100-I1)/20
    0x56323c6a7b50 ---------A   02750  LET R2=R2+M2*(100-I2)/20
    0x56323c6a7ea0 ---------A   02760  LET M3=M3+M1
    0x56323c6a81f0 ---------A   02770  LET M4=M4+M2
    0x56323c6a8260 ---------A   02780  GOSUB 3300
    0x56323c6a8450 ---------- T 02790  U=0
    0x56323c6a8670 ---------A T      a U2=0
    0x56323c6a87c0 ---------A   02800  PRINT "---------------"
    0x56323c6a8850 ---------A   02810  GOTO 620
    0x56323c6a88c0 ---------A   02820  REM------FINISH OFF
    0x56323c6a8a60 ---------A T 02830  PRINT "THE CONFEDERACY HAS SURRENDERED"
    0x56323c6a8b00 ---------A   02840  GOTO 2860
    0x56323c6a8c80 ----------   02850  PRINT "THE UNION HAS SURRENDERED."
    0x56323c6a8ce0 ---------- T 02860  PRINT 
    0x56323c6a8d40 ---------- T      a PRINT 
    0x56323c6a8da0 ---------- T      b PRINT 
    0x56323c6a8e00 ---------- T      c PRINT 
    0x56323c6a8e60 ---------- T      d PRINT 
    0x56323c6a8ef0 ---------A T      e PRINT
    0x56323c6a9090 ---------A   02870  PRINT "THE CONFEDERACY ";
    0x56323c6a94f0 ---------A   02880  PRINT "HAS WON "W" BATTLES AND LOST "L
    0x56323c6a9750 ---------A   02890  IF Y=5 THEN 2940
    0x56323c6a99c0 ---------A   02900  IF Y2=5 THEN 2920
    0x56323c6a9c40 ---------A   02910  IF W <= L THEN 2940
    0x56323c6a9ec0 ---------A   02915  IF Y=5 THEN 2940
    0x56323c6aa030 ---------A T 02920  PRINT "THE CONFEDERACY HAS WON THE WAR"
    0x56323c6aa0c0 ---------A   02930  GOTO 2950
    0x56323c6aa220 ---------A T 02940  PRINT "THE UNION HAS WON THE WAR"
    0x56323c6aa2a0 ---------A T 02950  PRINT
    0x56323c6aa530 ---------A   02960  IF R1=0 THEN 3100
    0x56323c6aaaf0 ---------A   02970  PRINT "FOR THE "W+L+W0" BATTLES FOUGHT (EXCUDING RERUNS)"
    0x56323c6aae80 ---------A   02980  PRINT " "," "," ";
    0x56323c6ab100 ---------A   02990  PRINT "CONFEDERACY"," UNION"
    0x56323c6ab840 ---------A   03000  PRINT "HISTORICAL LOSSES",INT(P1+.5),INT(P2+.5)
    0x56323c6abf60 ---------A   03010  PRINT "SIMULATED LOSSES",INT(T1+.5),INT(T2+.5)
    0x56323c6ac010 ---------A   03020  PRINT
    0x56323c6acc00 ---------A   03030  PRINT "    % OF ORIGINAL",INT(100*(T1/P1)+.5),INT(100*(T2/P2)+.5)
    0x56323c6ace80 ---------A   03040  IF B$="YES" THEN 3100
    0x56323c6acf30 ---------A   03050  PRINT
    0x56323c6ad0e0 ---------A   03060  PRINT "UNION INTELLIGENCE SUGGESTS THAT THE SOUTH USED "
    0x56323c6ad270 ---------A   03070  PRINT "STRATEGIES 1, 2, 3, 4 IN THE FOLLOWING PERCENTAGES"
    0x56323c6adab0 ---------A   03080  PRINT S(1);S2(2);S(3);S(4)
    0x56323c6adb40 ---------A   03090  REM---------------------------------
    0x56323c6adbb0 ---------A T 03100  STOP
    0x56323c6adc60 ---------B G 03110  REM - UNION STRATEGY IS COMPUTER CHOSEN
    0x56323c6ade10 ---------B   03120  PRINT "UNION STRATEGY IS ";
    0x56323c6ae070 ---------B   03130  IF A <> 0 THEN 3180
    0x56323c6ae1e0 ---------B T 03140  INPUT Y2
    0x56323c6ae440 ---------B   03150  IF Y2 <=0 THEN 3160
    0x56323c6ae6d0 ---------B   03155  IF Y2<5 THEN 3290
    0x56323c6ae860 ---------B T 03160  PRINT "ENTER 1 , 2 ,3 , OR 4 (USUALLY PREVIOUS UNION STRATEGY)"
    0x56323c6ae8e0 ---------B   03170  GOTO 3140
    0x56323c6aebb0 ---------B T 03180  LET S0=0
    0x56323c6aefa0 ---------B   03190  LET R=100*RND(0)
    0x56323c6af270 ---------B   03200  FOR I=1 TO 4
    0x56323c6af6e0 ---------B   03210  LET S0=S0+S(I)
    0x56323c6af780 ---------B   03220  REM - IF ACTUAL STRATEGY INFO IS IN PROGRAM DATA STATEMENTS
    0x56323c6af860 ---------B   03230  REM   THEN R-100 IS EXTRA WEIGHT GIVEN TO THAT STATEGY.
    0x56323c6afaf0 ---------B   03240  IF R<S0 THEN 3270
    0x56323c6afc30 ---------B   03250  NEXT I
    0x56323c6afd10 ---------B   03260  REM - IF ACTUAL STRAT. IN,THEN HERE IS Y2= HIST. STRAT.
    0x56323c6aff60 ---------B T 03270  LET Y2=I
    0x56323c6b00b0 ---------B   03280  PRINT Y2
    0x56323c6b0110 ---------B T 03290  RETURN
    0x56323c6b01e0 ---------C G 03300  REM LEARN  PRESENT STRATEGY, START FORGETTING OLD ONES
    0x56323c6b02d0 ---------C   03310  REM - PRESENT STRATEGY OF SOUTH GAINS 3*S, OTHERS LOSE S
    0x56323c6b03c0 ---------C   03320  REM   PROBABILITY POINTS, UNLESS A STRATEGY FALLS BELOW 5%.
    0x56323c6b05f0 ---------C   03330  LET S=3
    0x56323c6b0800 ---------C   03340  LET S0=0
    0x56323c6b0ae0 ---------C   03350  FOR I=1 TO 4
    0x56323c6b0e20 ---------C   03360  IF S(I) <= 5 THEN 3390
    0x56323c6b1340 ---------C   03370  LET S(I)=S(I)-S
    0x56323c6b1690 ---------C   03380  LET S0=S0+S
    0x56323c6b17c0 ---------C T 03390  NEXT I
    0x56323c6b1cf0 ---------C   03400  LET S(Y)=S(Y)+S0
    0x56323c6b1d40 ---------C   03410  RETURN
    0x56323c6b1e20 ---------A   03420  REM - HISTORICAL DATA...CAN ADD MORE (STRAT.,ETC) BY INSERTING
    0x56323c6b1f10 ---------A   03430  REM   DATA STATEMENTS AFTER APPRO. INFO, AND ADJUSTING READ
    0x56323c6b2520 ---------A   03440  DATA "BULL RUN",18000,18500,1967,2708,1
    0x56323c6b2af0 ---------A   03450  DATA "SHILOH",40000.,44894.,10699,13047,3
    0x56323c6b30d0 ---------A   03460  DATA "SEVEN DAYS",95000.,115000.,20614,15849,3
    0x56323c6b36a0 ---------A   03470  DATA "SECOND BULL RUN",54000.,63000.,10000,14000,2
    0x56323c6b3c70 ---------A   03480  DATA "ANTIETAM",40000.,50000.,10000,12000,3
    0x56323c6b4240 ---------A   03490  DATA "FREDERICKSBURG",75000.,120000.,5377,12653,1
    0x56323c6b4820 ---------A   03500  DATA "MURFREESBORO",38000.,45000.,11000,12000,1
    0x56323c6b4df0 ---------A   03510  DATA "CHANCELLORSVILLE",32000,90000.,13000,17197,2
    0x56323c6b53c0 ---------A   03520  DATA "VICKSBURG",50000.,70000.,12000,19000,1
    0x56323c6b5990 ---------A   03530  DATA "GETTYSBURG",72500.,85000.,20000,23000,3
    0x56323c6b5f60 ---------A   03540  DATA "CHICKAMAUGA",66000.,60000.,18000,16000,2
    0x56323c6b6530 ---------A   03550  DATA "CHATTANOOGA",37000.,60000.,36700.,5800,2
    0x56323c6b6b00 ---------A   03560  DATA "SPOTSYLVANIA",62000.,110000.,17723,18000,2
    0x56323c6b70f0 ---------A   03570  DATA "ATLANTA",65000.,100000.,8500,3700,1
    0x56323c6b72a0 ---------A T 03580  PRINT "JULY 21, 1861.  GEN. BEAUREGARD, COMMANDING THE SOUTH, MET"
    0x56323c6b7460 ---------A   03590  PRINT "UNION FORCES WITH GEN. MCDOWELL IN A PREMATURE BATTLE AT"
    0x56323c6b75f0 ---------A   03600  PRINT "BULL RUN. GEN. JACKSON HELPED PUSH BACK THE UNION ATTACK."
    0x56323c6b76a0 ---------A   03610  GOTO 1150
    0x56323c6b7830 ---------A T 03620  PRINT "APRIL 6-7, 1862.  THE CONFEDERATE SURPRISE ATTACK AT"
    0x56323c6b79b0 ---------A   03630  PRINT "SHILOH FAILED DUE TO POOR ORGANIZATION."
    0x56323c6b7a60 ---------A   03640  GOTO 1150
    0x56323c6b7c00 ---------A T 03650  PRINT "JUNE 25-JULY 1, 1862.  GENERAL LEE (CSA) UPHELD THE"
    0x56323c6b7db0 ---------A   03660  PRINT "OFFENSIVE THROUGHOUT THE BATTLE AND FORCED GEN. MCCLELLAN"
    0x56323c6b7f30 ---------A   03670  PRINT "AND THE UNION FORCES AWAY FROM RICHMOND."
    0x56323c6b7fe0 ---------A   03680  GOTO 1150
    0x56323c6b8180 ---------A T 03690  PRINT "AUG 29-30, 1862.  THE COMBINED CONFEDERATE FORCES UNDER";
    0x56323c6b8310 ---------A   03695  PRINT " LEE"
    0x56323c6b84a0 ---------A   03700  PRINT "AND JACKSON DROVE THE UNION FORCES BACK INTO WASHINGTON."
    0x56323c6b8550 ---------A   03710  GOTO 1150
    0x56323c6b86e0 ---------A T 03720  PRINT "SEPT 17, 1862.  THE SOUTH FAILED TO INCORPORATE MARYLAND"
    0x56323c6b8840 ---------A   03730  PRINT "INTO THE CONFEDERACY."
    0x56323c6b88f0 ---------A   03740  GOTO 1150
    0x56323c6b8a90 ---------A T 03750  PRINT "DEC 13, 1862.  THE CONFEDERACY UNDER LEE SUCCESSFULLY"
    0x56323c6b8c10 ---------A   03760  PRINT "REPULSED AN ATTACK BY THE UNION UNDER GEN. BURNSIDE."
    0x56323c6b8cc0 ---------A   03770  GOTO 1150
    0x56323c6b8e60 ---------A T 03780  PRINT "DEC 31, 1862.  THE SOUTH UNDER GEN. BRAGG WON A CLOSE ";
    0x56323c6b8fc0 ---------A   03785  PRINT "BATTLE."
    0x56323c6b9070 ---------A   03790  GOTO 1150
    0x56323c6b9220 ---------A T 03800  PRINT "MAY 1-6, 1863.  THE SOUTH HAD A COSTLY VICTORY AND LOST"
    0x56323c6b93b0 ---------A   03810  PRINT "ONE OF THEIR OUTSTANDING GENERALS, 'STONEWALL' JACKSON."
    0x56323c6b9470 ---------A   03820  GOTO 1150
    0x56323c6b9620 ---------A T 03830  PRINT "JULY 4, 1863.  VICKSBURG WAS A COSTLY DEFEAT FOR THE SOUTH"
    0x56323c6b97a0 ---------A   03840  PRINT "BECAUSE IT GAVE THE UNION ACCESS TO THE MISSISSIPPI."
    0x56323c6b9850 ---------A   03850  GOTO 1150
    0x56323c6b99f0 ---------A T 03860  PRINT "JULY 1-3, 1863.  A SOUTHERN MISTAKE BY GEN. LEE AT ";
    0x56323c6b9b80 ---------A   03865  PRINT "GETTYSBURG"
    0x56323c6b9d00 ---------A   03870  PRINT "COST THEM ONE OF THE MOST CRUCIAL BATTLES OF THE WAR."
    0x56323c6b9dc0 ---------A   03880  GOTO 1150
    0x56323c6b9f60 ---------A T 03890  PRINT "SEPT. 15, 1863. CONFUSION IN A FOREST NEAR CHICKAMAUGA LED"
    0x56323c6ba0d0 ---------A   03900  PRINT "TO A COSTLY SOUTHERN VICTORY."
    0x56323c6ba190 ---------A   03910  GOTO 1150
    0x56323c6ba340 ---------A T 03920  PRINT "NOV. 25, 1863. AFTER THE SOUTH HAD SIEGED GEN. ROSENCRANS'"
    0x56323c6ba4c0 ---------A   03930  PRINT "ARMY FOR THREE MONTHS, GEN. GRANT BROKE THE SIEGE."
    0x56323c6ba570 ---------A   03940  GOTO 1150
    0x56323c6ba720 ---------A T 03950  PRINT "MAY 5, 1864.  GRANT'S PLAN TO KEEP LEE ISOLATED BEGAN TO"
    0x56323c6ba8b0 ---------A   03960  PRINT "FAIL HERE, AND CONTINUED AT COLD HARBOR AND PETERSBURG."
    0x56323c6ba960 ---------A   03970  GOTO 1150
    0x56323c6bab10 ---------A T 03980  PRINT "AUGUST, 1864.  SHERMAN AND THREE VETERAN ARMIES CONVERGED"
    0x56323c6baca0 ---------A   03990  PRINT "ON ATLANTA AND DEALT THE DEATH BLOW TO THE CONFEDERACY."
    0x56323c6bad20 ---------A   04000  GOTO 1150
    0x56323c6bad70 ---------A   04010  END
 */

/*
 * Title: The unrolled BASIC Listing,after renumbering
 *
 *  Listing of basic/civilwar2.bas: 
 *
                   +--------+---- Routine IDs (Empty field=Inaccessible code, A=Main program).
                   |        | +-- Target status (G-GOSUB, T-GOTO, B-Both GOSUB and GOTO)
        Program    |        | |
        Address    v        v v Original BASIC statement
    -------------- ---------- - ------------------------------------------------------------------------------
    0x56323c66b6d0 ---------A   01000  PRINT TAB(26) "CIVIL WAR"
    0x56323c66b670 ---------A   01010  PRINT TAB(15) "CREATIVE COMPUTING  MORRISTOWN, NEW JERSEY"
    0x56323c66c910 ----------   01020  PRINT 
    0x56323c65c2b0 ----------   01030  PRINT 
    0x56323c66b9e0 ---------A   01040  PRINT
    0x56323c66de90 ---------A T 01050  REM ORIGINAL GAME DESIGN
    0x56323c66e010 ---------A   01060  REM MODIFICATIONS
    0x56323c673e20 ---------A   01070  DIM S(4),C$(14),M1(14),M2(14),C1(14),C2(14),M(14)
    0x56323c673eb0 ---------A   01080  REM UNION INFO ON LIKELY CONFEDERATE STRATEGY
    0x56323c674180 ----------   01090  S(1)=25 
    0x56323c674410 ----------   01100  S(2)=25 
    0x56323c6746a0 ----------   01110  S(3)=25 
    0x56323c674930 ---------A   01120  S(4)=25
    0x56323c674980 ---------A T 01130  REM READ HISTORICAL DATA.
    0x56323c674d50 ---------A T 01140  FOR D=1 TO 14
    0x56323c66e0d0 ---------A T 01150  READ C$(D),M1(D),M2(D),C1(D),C2(D),M(D)
    0x56323c675930 ---------A   01160  NEXT D
    0x56323c675c40 ---------A   01170  LET D=RND(-1)
    0x56323c675c90 ---------A   01180  PRINT
    0x56323c675df0 ---------A   01190  PRINT "DO YOU WANT INSTRUCTIONS";
    0x56323c675ff0 ---------A   01200  INPUT X$
    0x56323c676250 ---------A   01210  IF X$="YES" THEN 1280
    0x56323c6764b0 ---------A   01220  IF X$="NO" THEN 1530
    0x56323c676630 ---------A   01230  PRINT "YES OR NO -- ";
    0x56323c6766c0 ---------A   01240  GOTO 1200
    0x56323c676710 ----------   01250  PRINT 
    0x56323c676770 ---------- T 01260  PRINT 
    0x56323c6767d0 ---------- T 01270  PRINT 
    0x56323c676870 ---------A   01280  PRINT
    0x56323c676a10 ---------A   01290  PRINT "THIS IS A CIVIL WAR SIMULATION."
    0x56323c676bc0 ---------A   01300  PRINT "TO PLAY TYPE A RESPONSE WHEN THE COMPUTER ASKS."
    0x56323c676d80 ---------A   01310  PRINT "REMEMBER THAT ALL FACTORS ARE INTERRELATED AND THAT YOUR"
    0x56323c676f50 ---------A   01320  PRINT "RESPONSES COULD CHANGE HISTORY. FACTS AND FIGURES USED ARE"
    0x56323c677110 ---------A T 01330  PRINT "BASED ON THE ACTUAL OCCURRENCE. MOST BATTLES TEND TO RESULT"
    0x56323c6772a0 ---------A   01340  PRINT "AS THEY DID IN THE CIVIL WAR, BUT IT ALL DEPENDS ON YOU!!"
    0x56323c677350 ---------A   01350  PRINT
    0x56323c6774f0 ---------A T 01360  PRINT "THE OBJECT OF THE GAME IS TO WIN AS MANY BATTLES AS ";
    0x56323c677650 ---------A T 01370  PRINT "POSSIBLE."
    0x56323c6776f0 ---------A   01380  PRINT
    0x56323c677890 ---------A   01390  PRINT "YOUR CHOICES FOR DEFENSIVE STRATEGY ARE:"
    0x56323c677a30 ---------A   01400  PRINT "        (1) ARTILLERY ATTACK"
    0x56323c677df0 ---------A T 01410  PRINT "        (2) FORTIFICATION AGAINST FRONTAL ATTACK"
    0x56323c677f80 ---------A   01420  PRINT "        (3) FORTIFICATION AGAINST FLANKING MANEUVERS"
    0x56323c678110 ---------A   01430  PRINT "        (4) FALLING BACK"
    0x56323c6782b0 ---------A   01440  PRINT " YOUR CHOICES FOR OFFENSIVE STRATEGY ARE:"
    0x56323c678430 ---------A   01450  PRINT "        (1) ARTILLERY ATTACK"
    0x56323c6785c0 ---------A   01460  PRINT "        (2) FRONTAL ATTACK"
    0x56323c678740 ---------A   01470  PRINT "        (3) FLANKING MANEUVERS"
    0x56323c6788e0 ---------A   01480  PRINT "        (4) ENCIRCLEMENT"
    0x56323c678a90 ---------A T 01490  PRINT "YOU MAY SURRENDER BY TYPING A '5' FOR YOUR STRATEGY."
    0x56323c678af0 ----------   01500  PRINT 
    0x56323c678b50 ---------- T 01510  PRINT 
    0x56323c678bb0 ----------   01520  PRINT 
    0x56323c678d50 ---------A   01530  PRINT "ARE THERE TWO GENERALS PRESENT ";
    0x56323c678ed0 ---------A   01540  PRINT "(ANSWER YES OR NO)";
    0x56323c679100 ---------A T 01550  INPUT B$
    0x56323c679390 ---------A   01560  IF B$="YES" THEN 1610
    0x56323c679640 ---------A   01570  IF B$ <> "NO" THEN 1540
    0x56323c6796a0 ---------- T 01580  PRINT 
    0x56323c679810 ---------A   01590  PRINT "YOU ARE THE CONFEDERACY.   GOOD LUCK!"
    0x56323c679890 ---------A T 01600  PRINT
    0x56323c679ac0 ---------A   01610  LET D=1
    0x56323c679d30 ---------A T 01620  IF B$ <> "YES" THEN 1640
    0x56323c679f80 ---------A   01630  LET D=2
    0x56323c67a120 ---------A   01640  PRINT "SELECT A BATTLE BY TYPING A NUMBER FROM 1 TO 14 ON"
    0x56323c67a2e0 ---------A   01650  PRINT "REQUEST.  TYPE ANY OTHER NUMBER TO END THE SIMULATION."
    0x56323c67a470 ---------A T 01660  PRINT "BUT '0' BRINGS BACK EXACT PREVIOUS BATTLE SITUATION"
    0x56323c67a5e0 ---------A   01670  PRINT "ALLOWING YOU TO REPLAY IT"
    0x56323c67a690 ---------A   01680  PRINT
    0x56323c67a830 ---------A T 01690  PRINT "NOTE: A NEGATIVE FOOD$ ENTRY CAUSES THE PROGRAM TO "
    0x56323c67a9b0 ---------A T 01700  PRINT "USE THE ENTRIES FROM THE PREVIOUS BATTLE"
    0x56323c67aa50 ---------A   01710  PRINT
    0x56323c67ac00 ---------A   01720  PRINT "AFTER REQUESTING A BATTLE, DO YOU WISH ";
    0x56323c67ad90 ---------A   01730  PRINT "BATTLE DESCRIPTIONS ";
    0x56323c67af10 ---------A   01740  PRINT "(ANSWER YES OR NO)";
    0x56323c67b080 ---------A   01750  INPUT X$
    0x56323c67b310 ---------A T 01760  IF X$="YES" THEN 1870
    0x56323c67b9c0 ---------A   01770  IF X$ <> "NO" THEN 1740
    0x56323c67bc80 ----------   01780  L=0
    0x56323c67bf30 ----------   01790  W=0
    0x56323c67c1e0 ---------- T 01800  R1=0
    0x56323c67c490 ----------   01810  Q1=0
    0x56323c67c740 ----------   01820  M3=0
    0x56323c67c9f0 ---------- T 01830  M4=0
    0x56323c67cca0 ---------- T 01840  P1=0
    0x56323c67cf50 ----------   01850  P2=0
    0x56323c67d200 ----------   01860  T1=0
    0x56323c67d500 ---------A   01870  T2=0
    0x56323c67d870 ----------   01880  F(2)=0
    0x56323c67dbe0 ---------- T 01890  H(2)=0
    0x56323c67df50 ----------   01900  B(2)=0
    0x56323c67e200 ---------- T 01910  R2=0
    0x56323c67e4b0 ---------- T 01920  Q2=0
    0x56323c67e760 ----------   01930  C6=0
    0x56323c67e950 ----------   01940  F=0
    0x56323c67ec00 ----------   01950  W0=0
    0x56323c67eeb0 ---------- T 01960  Y=0
    0x56323c67f160 ----------   01970  Y2=0
    0x56323c67f410 ----------   01980  U=0
    0x56323c67f6f0 ---------A   01990  U2=0
    0x56323c67f740 ---------- T 02000  PRINT 
    0x56323c67f7a0 ----------   02010  PRINT 
    0x56323c67f840 ---------A T 02020  PRINT
    0x56323c67f9d0 ---------A   02030  PRINT "WHICH BATTLE DO YOU WISH TO SIMULATE";
    0x56323c67fbf0 ---------A T 02040  INPUT A
    0x56323c67fe60 ---------A   02050  IF A <> 0 THEN 2070
    0x56323c680180 ---------A   02060  IF R <> 0 THEN 2380
    0x56323c6803f0 ---------A   02070  IF A <=0 THEN 4200
    0x56323c680650 ---------A   02080  IF A >= 15 THEN 4200
    0x56323c680970 ---------A   02090  LET C$=C$(A)
    0x56323c680c80 ---------A   02100  LET M1=M1(A)
    0x56323c680f90 ---------A   02110  LET M2=M2(A)
    0x56323c6812a0 ---------A   02120  LET C1=C1(A)
    0x56323c6815b0 ---------A   02130  LET C2=C2(A)
    0x56323c6818c0 ---------A   02140  LET M=M(A)
    0x56323c681ae0 ---------A   02150  LET U=0
    0x56323c681b50 ---------A   02160  REM  INFLATION CALC
    0x56323c6821c0 ---------A T 02170  LET I1=10+(L-W)*2
    0x56323c682820 ---------A   02180  LET I2=10+(W-L)*2
    0x56323c682890 ---------A T 02190  REM - MONEY AVAILABLE
    0x56323c683890 ---------A   02200  LET D(1)=100*INT((M1*(100-I1)/2000)*(1+(R1-Q1)/(R1+1))+.5)
    0x56323c6841d0 ---------A   02210  LET D(2)=100*INT(M2*(100-I2)/2000+.5)
    0x56323c684470 ---------A   02220  IF B$ <> "YES" THEN 2240
    0x56323c685420 ---------A   02230  LET D(2)=100*INT((M2*(100-I2)/2000)*(1+(R2-Q2)/(R2+1))+.5)
    0x56323c685490 ---------A   02240  REM - MEN   AVAILABLE
    0x56323c685ec0 ---------A   02250  LET M5=INT(M1*(1+(P1-T1)/(M3+1)))
    0x56323c6868b0 ---------A   02260  LET M6=INT(M2*(1+(P2-T2)/(M4+1)))
    0x56323c686dc0 ---------A T 02270  LET F1=5*M1/6
    0x56323c686e10 ---------- T 02280  PRINT 
    0x56323c686e70 ----------   02290  PRINT 
    0x56323c686ed0 ----------   02300  PRINT 
    0x56323c686f30 ----------   02310  PRINT 
    0x56323c686fc0 ---------A   02320  PRINT
    0x56323c687240 ---------A   02330  PRINT "THIS IS THE BATTLE OF ";C$
    0x56323c6874c0 ---------A   02340  IF X$="NO" THEN 2390
    0x56323c687750 ---------A T 02350  IF A>11 THEN 2370
    0x56323c688100 ---------A   02360  ON A GOTO 4940,4980,5010,5050,5090,5120,5150,5180,5210,5240,5280
    0x56323c6885b0 ---------A   02370  ON A-11 GOTO 5310,5340,5370
    0x56323c688810 ---------A T 02380  PRINT C$" INSTANT REPLAY"
    0x56323c6888a0 ---------A   02390  PRINT
    0x56323c688c10 ---------A   02400  PRINT " ","CONFEDERACY"," UNION"
    0x56323c689180 ---------A   02410  PRINT "MEN"," "M5," "M6
    0x56323c689880 ---------A T 02420  PRINT "MONEY","$";D(1),"$";D(2)
    0x56323c68a0e0 ---------A   02430  PRINT "INFLATION"," ";I1+15;"%"," ";I2;"%"
    0x56323c68a190 ---------A T 02440  PRINT
    0x56323c68a230 ---------A   02450  REM - ONLY IN PRINTOUT IS CONFED INFLATION = I1+15%
    0x56323c68a300 ---------A T 02460  REM - IF TWO GENERALS, INPUT CONFED. FIRST
    0x56323c68a6e0 ---------A   02470  FOR I=1 TO D
    0x56323c68a960 ---------A   02480  IF B$ <> "YES" THEN 2510
    0x56323c68abd0 ---------A   02490  IF I=2 THEN 2510
    0x56323c68ad80 ---------A T 02500  PRINT "CONFEDERATE GENERAL---";
    0x56323c68af00 ---------A   02510  PRINT "HOW MUCH DO YOU WISH TO SPEND FOR"
    0x56323c68b080 ---------A   02520  PRINT " - FOOD......";
    0x56323c68b1f0 ---------A   02530  INPUT F
    0x56323c68b460 ---------A   02540  IF F >= 0 THEN 2610
    0x56323c68b6d0 ---------A   02550  IF R1 <> 0 THEN 2580
    0x56323c68b830 ---------A   02560  PRINT "NO PREVIOUS ENTRIES"
    0x56323c68b8d0 ---------A   02570  GOTO 2520
    0x56323c68ba40 ---------A   02580  PRINT "ASSUME YOU WANT TO KEEP SAME ALLOCATIONS"
    0x56323c68bac0 ---------A T 02590  PRINT
    0x56323c68bb40 ---------A T 02600  GOTO 2760
    0x56323c68be60 ---------A   02610  LET F(I)=F
    0x56323c68bfd0 ---------A   02620  PRINT " - SALARIES..";
    0x56323c68c210 ---------A T 02630  INPUT H(I)
    0x56323c68c500 ---------A   02640  LET N=1
    0x56323c68c840 ---------A   02650  IF H(I)<0 THEN 2740
    0x56323c68c9c0 ---------A T 02660  PRINT " - AMMUNITION";
    0x56323c68d410 ---------A   02670  INPUT B(I)
    0x56323c68d640 ---------A T 02680  LET N=2
    0x56323c68d970 ---------A   02690  IF B(I)<0 THEN 2740
    0x56323c68da10 ---------A   02700  PRINT
    0x56323c68e270 ---------A   02710  IF F(I)+H(I)+B(I) <= D(I) THEN 2760
    0x56323c68e5c0 ---------A   02720  PRINT "THINK AGAIN! YOU HAVE ONLY $"D(I)
    0x56323c68e660 ---------A   02730  GOTO 2520
    0x56323c68e7d0 ---------A   02740  PRINT "NEGATIVE VALUES NOT ALLOWED."
    0x56323c68eac0 ---------A   02750  ON N GOTO 2620,2660
    0x56323c68ed40 ---------A   02760  IF B$ <> "YES" THEN 2800
    0x56323c68efb0 ---------A   02770  IF I=2 THEN 2800
    0x56323c68f130 ---------A   02780  PRINT "UNION GENERAL---";
    0x56323c68f270 ---------A T 02790  NEXT I
    0x56323c68f650 ---------A   02800  FOR Z=1 TO D
    0x56323c68f8e0 ---------A   02810  IF B$ <> "YES" THEN 2870
    0x56323c68fbd0 ---------A   02820  ON Z GOTO 2830,2850
    0x56323c68fd50 ---------A T 02830  PRINT "CONFEDERATE ";
    0x56323c68fde0 ---------A   02840  GOTO 2870
    0x56323c68ff50 ---------A   02850  PRINT "      UNION ";
    0x56323c68ffd0 ---------A T 02860  REM - FIND MORALE
    0x56323c690c70 ---------A   02870  LET O=((2*F(Z)^2+H(Z)^2)/F1^2+1)
    0x56323c690ed0 ---------A   02880  IF O<10 THEN 2910
    0x56323c691030 ---------A   02890  PRINT "MORALE IS HIGH"
    0x56323c6910b0 ---------A   02900  GOTO 2950
    0x56323c691310 ---------A   02910  IF O<5 THEN 2940
    0x56323c691470 ---------A T 02920  PRINT "MORALE IS FAIR"
    0x56323c691500 ---------A   02930  GOTO 2950
    0x56323c691660 ---------A T 02940  PRINT "MORALE IS POOR"
    0x56323c6918e0 ---------A T 02950  IF B$ <> "YES" THEN 3010
    0x56323c691c00 ---------A   02960  LET O(Z)=O
    0x56323c691d30 ---------A   02970  NEXT Z
    0x56323c692100 ---------A   02980  LET O2=O(2)
    0x56323c692400 ---------A   02990  LET O=O(1)
    0x56323c6925a0 ---------A   03000  PRINT "CONFEDERATE GENERAL---";
    0x56323c692630 ---------A   03010  REM - ACTUAL OFF/DEF BATTLE SITUATION
    0x56323c6928c0 ---------A   03020  IF M <> 3 THEN 3050
    0x56323c692a30 ---------A   03030  PRINT "YOU ARE ON THE OFFENSIVE"
    0x56323c692ac0 ---------A   03040  GOTO 3090
    0x56323c692d20 ---------A   03050  IF M <> 1 THEN 3080
    0x56323c692e90 ---------A   03060  PRINT "YOU ARE ON THE DEFENSIVE"
    0x56323c692f30 ---------A   03070  GOTO 3090
    0x56323c693090 ---------A   03080  PRINT "BOTH SIDES ARE ON THE OFFENSIVE "
    0x56323c693120 ---------A   03090  PRINT
    0x56323c6931a0 ---------A T 03100  REM - CHOOSE STRATEGIES
    0x56323c693440 ---------A G 03110  IF B$ <> "YES" THEN 3160
    0x56323c693730 ---------A   03120  FOR I=1 TO 2
    0x56323c693a20 ---------A   03130  ON I GOTO 3140,3170
    0x56323c693ba0 ---------A T 03140  PRINT "CONFEDERATE STRATEGY ";
    0x56323c693c30 ---------A   03150  GOTO 3170
    0x56323c693da0 ---------A T 03160  PRINT "YOUR STRATEGY ";
    0x56323c693f10 ---------A   03170  INPUT Y
    0x56323c694360 ---------A T 03180  IF ABS(Y-3)<3 THEN 3210
    0x56323c6946c0 ---------A   03190  PRINT "STRATEGY";Y;"NOT ALLOWED."
    0x56323c694750 ---------A   03200  GOTO 3160
    0x56323c6949c0 ---------A   03210  IF B$="YES" THEN 3250
    0x56323c694c20 ---------A   03220  IF Y=5 THEN 4120
    0x56323c694ca0 ---------A   03230  GOSUB 4460
    0x56323c694d10 ---------A   03240  GOTO 3420
    0x56323c694f60 ---------A   03250  IF I=2 THEN 3290
    0x56323c695270 ---------A   03260  LET Y1=Y
    0x56323c6953e0 ---------A T 03270  PRINT "UNION STRATEGY ";
    0x56323c695520 ---------A   03280  NEXT I
    0x56323c695770 ---------A T 03290  LET Y2=Y
    0x56323c6959a0 ---------A G 03300  LET Y=Y1
    0x56323c695c00 ---------A   03310  IF Y2=5 THEN 3270
    0x56323c695c90 ---------A   03320  REM 
    0x56323c696940 ---------A   03330  LET C6=(2*C2/5)*(1+1/(2*(ABS(Y2-Y)+1)))
    0x56323c697340 ---------A   03340  LET C6=C6*(1.28+(5*M2/6)/(B(2)+1))
    0x56323c697ad0 ---------A   03350  LET C6=INT(C6*(1+1/O2)+.5)
    0x56323c697b60 ---------A   03360  REM - IF LOSS > MEN PRESENT, RESCALE LOSSES
    0x56323c697f80 ---------A   03370  LET E2=100/O2
    0x56323c698400 ---------A   03380  IF INT(C6+E2)<M6 THEN 3460
    0x56323c698920 ---------A T 03390  LET C6=INT(13*M6/20)
    0x56323c698d50 ---------A   03400  LET E2=7*C6/13
    0x56323c698f70 ---------A   03410  LET U2=1
    0x56323c698ff0 ---------A   03420  REM - CALCULATE SIMULATED LOSSES
    0x56323c6990a0 ---------A   03430  PRINT
    0x56323c699100 ----------   03440  PRINT 
    0x56323c699160 ----------   03450  PRINT 
    0x56323c699400 ---------A   03460  PRINT ,"CONFEDERACY","UNION"
    0x56323c69a140 ---------A   03470  LET C5=(2*C1/5)*(1+1/(2*(ABS(Y2-Y)+1)))
    0x56323c69ae30 ---------A   03480  LET C5=INT(C5*(1+1/O)*(1.28+F1/(B(1)+1))+.5)
    0x56323c69b240 ---------A   03490  LET E=100/O
    0x56323c69bd10 ---------A   03500  IF C5+100/O<M1*(1+(P1-T1)/(M3+1)) THEN 3540
    0x56323c69c850 ---------A   03510  LET C5=INT(13*M1/20*(1+(P1-T1)/(M3+1)))
    0x56323c69cc80 ---------A   03520  LET E=7*C5/13
    0x56323c69ce90 ---------A   03530  LET U=1
    0x56323c69d0f0 ---------A   03540  IF D=1 THEN 3780
    0x56323c69d460 ---------A   03550  PRINT "CASUALTIES",C5,C6
    0x56323c69d980 ---------A   03560  PRINT "DESERTIONS",INT(E),INT(E2)
    0x56323c69da10 ---------A   03570  PRINT
    0x56323c69dcb0 ---------A T 03580  IF B$ <> "YES" THEN 3620
    0x56323c69df50 ---------A   03590  PRINT "COMPARED TO THE ACTUAL CASUALTIES AT "C$
    0x56323c69e720 ---------A   03600  PRINT "CONFEDERATE:"INT(100*(C5/C1)+.5)"% OF THE ORIGINAL"
    0x56323c69eec0 ---------A   03610  PRINT "UNION:      "INT(100*(C6/C2)+.5)"% OF THE ORIGINAL"
    0x56323c69ef40 ---------A T 03620  PRINT
    0x56323c69efc0 ---------A   03630  REM - 1 WHO ONE
    0x56323c69f240 ---------A   03640  IF U <> 1 THEN 3660
    0x56323c69f4a0 ---------A T 03650  IF U2=1 THEN 3740
    0x56323c69f700 ---------A   03660  IF U=1 THEN 3700
    0x56323c69f970 ---------A   03670  IF U2=1 THEN 3720
    0x56323c69fe40 ---------A   03680  IF C5+E=C6+E2 THEN 3740
    0x56323c6a0310 ---------A T 03690  IF C5+E<C6+E2 THEN 3720
    0x56323c6a0570 ---------A   03700  PRINT "THE UNION WINS "C$
    0x56323c6a0600 ---------A   03710  GOTO 3880
    0x56323c6a0850 ---------A T 03720  PRINT "THE CONFEDERACY WINS "C$
    0x56323c6a08e0 ---------A   03730  GOTO 3940
    0x56323c6a0a40 ---------A   03740  PRINT "BATTLE OUTCOME UNRESOLVED"
    0x56323c6a0d80 ---------A T 03750  LET W0=W0+1
    0x56323c6a0fd0 ---------A   03760  IF A=0 THEN 4080
    0x56323c6a1060 ---------A   03770  GOTO 3960
    0x56323c6a17f0 ---------A T 03780  LET C6=INT(17*C2*C1/(C5*20))
    0x56323c6a1b20 ---------A   03790  LET E2=5*O
    0x56323c6a1bc0 ---------A T 03800  GOTO 3550
    0x56323c6a2370 ----------   03810  PRINT "YOUR CASUALTIES WERE "INT(100*(C5/C1)+.5)"% OF "
    0x56323c6a25e0 ----------   03820  PRINT "THE ACTUAL CASUALTIES AT ";C$
    0x56323c6a2670 ---------- T 03830  PRINT
    0x56323c6a26f0 ---------A   03840  REM - FIND WHO WON
    0x56323c6a2980 ----------   03850  IF U=1 THEN 3870
    0x56323c6a33d0 ---------- T 03860  IF C5+E<17*C2*C1/(C5*20)+5*O THEN 3910
    0x56323c6a3630 ----------   03870  PRINT "YOU LOSE ";C$
    0x56323c6a3890 ---------A   03880  IF A=0 THEN 4080
    0x56323c6a3bd0 ---------A T 03890  LET L=L+1
    0x56323c6a3c50 ---------A   03900  GOTO 3960
    0x56323c6a3ed0 ----------   03910  PRINT "YOU WIN ";C$
    0x56323c6a3f70 ---------A T 03920  REM - CUMULATIVE BATTLE FACTORS WHICH ALTER HISTORICAL
    0x56323c6a4050 ---------A   03930  REM  RESOURCES AVAILABLE.IF A REPLAY DON'T UPDATE.
    0x56323c6a42c0 ---------A   03940  IF A=0 THEN 4080
    0x56323c6a4600 ---------A T 03950  LET W=W+1
    0x56323c6a4a70 ---------A   03960  LET T1=T1+C5+E
    0x56323c68ce40 ---------A   03970  LET T2=T2+C6+E2
    0x56323c68d190 ---------A T 03980  LET P1=P1+C1
    0x56323c6a5da0 ---------A   03990  LET P2=P2+C2
    0x56323c6a65c0 ---------A   04000  LET Q1=Q1+(F(1)+H(1)+B(1))
    0x56323c6a6de0 ---------A   04010  LET Q2=Q2+(F(2)+H(2)+B(2))
    0x56323c6a74a0 ---------A   04020  LET R1=R1+M1*(100-I1)/20
    0x56323c6a7b50 ---------A   04030  LET R2=R2+M2*(100-I2)/20
    0x56323c6a7ea0 ---------A   04040  LET M3=M3+M1
    0x56323c6a81f0 ---------A   04050  LET M4=M4+M2
    0x56323c6a8260 ---------A   04060  GOSUB 4660
    0x56323c6a8450 ----------   04070  U=0
    0x56323c6a8670 ---------A   04080  U2=0
    0x56323c6a87c0 ---------A   04090  PRINT "---------------"
    0x56323c6a8850 ---------A   04100  GOTO 2020
    0x56323c6a88c0 ---------A   04110  REM------FINISH OFF
    0x56323c6a8a60 ---------A   04120  PRINT "THE CONFEDERACY HAS SURRENDERED"
    0x56323c6a8b00 ---------A   04130  GOTO 4200
    0x56323c6a8c80 ----------   04140  PRINT "THE UNION HAS SURRENDERED."
    0x56323c6a8ce0 ----------   04150  PRINT 
    0x56323c6a8d40 ----------   04160  PRINT 
    0x56323c6a8da0 ----------   04170  PRINT 
    0x56323c6a8e00 ----------   04180  PRINT 
    0x56323c6a8e60 ----------   04190  PRINT 
    0x56323c6a8ef0 ---------A   04200  PRINT
    0x56323c6a9090 ---------A   04210  PRINT "THE CONFEDERACY ";
    0x56323c6a94f0 ---------A   04220  PRINT "HAS WON "W" BATTLES AND LOST "L
    0x56323c6a9750 ---------A   04230  IF Y=5 THEN 4290
    0x56323c6a99c0 ---------A   04240  IF Y2=5 THEN 4270
    0x56323c6a9c40 ---------A   04250  IF W <= L THEN 4290
    0x56323c6a9ec0 ---------A   04260  IF Y=5 THEN 4290
    0x56323c6aa030 ---------A   04270  PRINT "THE CONFEDERACY HAS WON THE WAR"
    0x56323c6aa0c0 ---------A   04280  GOTO 4300
    0x56323c6aa220 ---------A   04290  PRINT "THE UNION HAS WON THE WAR"
    0x56323c6aa2a0 ---------A   04300  PRINT
    0x56323c6aa530 ---------A   04310  IF R1=0 THEN 4450
    0x56323c6aaaf0 ---------A   04320  PRINT "FOR THE "W+L+W0" BATTLES FOUGHT (EXCUDING RERUNS)"
    0x56323c6aae80 ---------A   04330  PRINT " "," "," ";
    0x56323c6ab100 ---------A   04340  PRINT "CONFEDERACY"," UNION"
    0x56323c6ab840 ---------A   04350  PRINT "HISTORICAL LOSSES",INT(P1+.5),INT(P2+.5)
    0x56323c6abf60 ---------A   04360  PRINT "SIMULATED LOSSES",INT(T1+.5),INT(T2+.5)
    0x56323c6ac010 ---------A   04370  PRINT
    0x56323c6acc00 ---------A   04380  PRINT "    % OF ORIGINAL",INT(100*(T1/P1)+.5),INT(100*(T2/P2)+.5)
    0x56323c6ace80 ---------A   04390  IF B$="YES" THEN 4450
    0x56323c6acf30 ---------A   04400  PRINT
    0x56323c6ad0e0 ---------A   04410  PRINT "UNION INTELLIGENCE SUGGESTS THAT THE SOUTH USED "
    0x56323c6ad270 ---------A   04420  PRINT "STRATEGIES 1, 2, 3, 4 IN THE FOLLOWING PERCENTAGES"
    0x56323c6adab0 ---------A   04430  PRINT S(1);S2(2);S(3);S(4)
    0x56323c6adb40 ---------A   04440  REM---------------------------------
    0x56323c6adbb0 ---------A   04450  STOP
    0x56323c6adc60 ---------B   04460  REM - UNION STRATEGY IS COMPUTER CHOSEN
    0x56323c6ade10 ---------B   04470  PRINT "UNION STRATEGY IS ";
    0x56323c6ae070 ---------B   04480  IF A <> 0 THEN 4540
    0x56323c6ae1e0 ---------B   04490  INPUT Y2
    0x56323c6ae440 ---------B   04500  IF Y2 <=0 THEN 4520
    0x56323c6ae6d0 ---------B   04510  IF Y2<5 THEN 4650
    0x56323c6ae860 ---------B   04520  PRINT "ENTER 1 , 2 ,3 , OR 4 (USUALLY PREVIOUS UNION STRATEGY)"
    0x56323c6ae8e0 ---------B   04530  GOTO 4490
    0x56323c6aebb0 ---------B   04540  LET S0=0
    0x56323c6aefa0 ---------B   04550  LET R=100*RND(0)
    0x56323c6af270 ---------B   04560  FOR I=1 TO 4
    0x56323c6af6e0 ---------B   04570  LET S0=S0+S(I)
    0x56323c6af780 ---------B   04580  REM - IF ACTUAL STRATEGY INFO IS IN PROGRAM DATA STATEMENTS
    0x56323c6af860 ---------B   04590  REM   THEN R-100 IS EXTRA WEIGHT GIVEN TO THAT STATEGY.
    0x56323c6afaf0 ---------B   04600  IF R<S0 THEN 4630
    0x56323c6afc30 ---------B   04610  NEXT I
    0x56323c6afd10 ---------B   04620  REM - IF ACTUAL STRAT. IN,THEN HERE IS Y2= HIST. STRAT.
    0x56323c6aff60 ---------B   04630  LET Y2=I
    0x56323c6b00b0 ---------B   04640  PRINT Y2
    0x56323c6b0110 ---------B   04650  RETURN
    0x56323c6b01e0 ---------C   04660  REM LEARN  PRESENT STRATEGY, START FORGETTING OLD ONES
    0x56323c6b02d0 ---------C   04670  REM - PRESENT STRATEGY OF SOUTH GAINS 3*S, OTHERS LOSE S
    0x56323c6b03c0 ---------C   04680  REM   PROBABILITY POINTS, UNLESS A STRATEGY FALLS BELOW 5%.
    0x56323c6b05f0 ---------C   04690  LET S=3
    0x56323c6b0800 ---------C   04700  LET S0=0
    0x56323c6b0ae0 ---------C   04710  FOR I=1 TO 4
    0x56323c6b0e20 ---------C   04720  IF S(I) <= 5 THEN 4750
    0x56323c6b1340 ---------C   04730  LET S(I)=S(I)-S
    0x56323c6b1690 ---------C   04740  LET S0=S0+S
    0x56323c6b17c0 ---------C   04750  NEXT I
    0x56323c6b1cf0 ---------C   04760  LET S(Y)=S(Y)+S0
    0x56323c6b1d40 ---------C   04770  RETURN
    0x56323c6b1e20 ---------A   04780  REM - HISTORICAL DATA...CAN ADD MORE (STRAT.,ETC) BY INSERTING
    0x56323c6b1f10 ---------A   04790  REM   DATA STATEMENTS AFTER APPRO. INFO, AND ADJUSTING READ
    0x56323c6b2520 ---------A   04800  DATA "BULL RUN",18000,18500,1967,2708,1
    0x56323c6b2af0 ---------A   04810  DATA "SHILOH",40000.,44894.,10699,13047,3
    0x56323c6b30d0 ---------A   04820  DATA "SEVEN DAYS",95000.,115000.,20614,15849,3
    0x56323c6b36a0 ---------A   04830  DATA "SECOND BULL RUN",54000.,63000.,10000,14000,2
    0x56323c6b3c70 ---------A   04840  DATA "ANTIETAM",40000.,50000.,10000,12000,3
    0x56323c6b4240 ---------A   04850  DATA "FREDERICKSBURG",75000.,120000.,5377,12653,1
    0x56323c6b4820 ---------A   04860  DATA "MURFREESBORO",38000.,45000.,11000,12000,1
    0x56323c6b4df0 ---------A   04870  DATA "CHANCELLORSVILLE",32000,90000.,13000,17197,2
    0x56323c6b53c0 ---------A   04880  DATA "VICKSBURG",50000.,70000.,12000,19000,1
    0x56323c6b5990 ---------A   04890  DATA "GETTYSBURG",72500.,85000.,20000,23000,3
    0x56323c6b5f60 ---------A   04900  DATA "CHICKAMAUGA",66000.,60000.,18000,16000,2
    0x56323c6b6530 ---------A   04910  DATA "CHATTANOOGA",37000.,60000.,36700.,5800,2
    0x56323c6b6b00 ---------A   04920  DATA "SPOTSYLVANIA",62000.,110000.,17723,18000,2
    0x56323c6b70f0 ---------A   04930  DATA "ATLANTA",65000.,100000.,8500,3700,1
    0x56323c6b72a0 ---------A   04940  PRINT "JULY 21, 1861.  GEN. BEAUREGARD, COMMANDING THE SOUTH, MET"
    0x56323c6b7460 ---------A   04950  PRINT "UNION FORCES WITH GEN. MCDOWELL IN A PREMATURE BATTLE AT"
    0x56323c6b75f0 ---------A   04960  PRINT "BULL RUN. GEN. JACKSON HELPED PUSH BACK THE UNION ATTACK."
    0x56323c6b76a0 ---------A   04970  GOTO 2390
    0x56323c6b7830 ---------A   04980  PRINT "APRIL 6-7, 1862.  THE CONFEDERATE SURPRISE ATTACK AT"
    0x56323c6b79b0 ---------A   04990  PRINT "SHILOH FAILED DUE TO POOR ORGANIZATION."
    0x56323c6b7a60 ---------A   05000  GOTO 2390
    0x56323c6b7c00 ---------A   05010  PRINT "JUNE 25-JULY 1, 1862.  GENERAL LEE (CSA) UPHELD THE"
    0x56323c6b7db0 ---------A   05020  PRINT "OFFENSIVE THROUGHOUT THE BATTLE AND FORCED GEN. MCCLELLAN"
    0x56323c6b7f30 ---------A   05030  PRINT "AND THE UNION FORCES AWAY FROM RICHMOND."
    0x56323c6b7fe0 ---------A   05040  GOTO 2390
    0x56323c6b8180 ---------A   05050  PRINT "AUG 29-30, 1862.  THE COMBINED CONFEDERATE FORCES UNDER";
    0x56323c6b8310 ---------A   05060  PRINT " LEE"
    0x56323c6b84a0 ---------A   05070  PRINT "AND JACKSON DROVE THE UNION FORCES BACK INTO WASHINGTON."
    0x56323c6b8550 ---------A   05080  GOTO 2390
    0x56323c6b86e0 ---------A   05090  PRINT "SEPT 17, 1862.  THE SOUTH FAILED TO INCORPORATE MARYLAND"
    0x56323c6b8840 ---------A   05100  PRINT "INTO THE CONFEDERACY."
    0x56323c6b88f0 ---------A   05110  GOTO 2390
    0x56323c6b8a90 ---------A   05120  PRINT "DEC 13, 1862.  THE CONFEDERACY UNDER LEE SUCCESSFULLY"
    0x56323c6b8c10 ---------A   05130  PRINT "REPULSED AN ATTACK BY THE UNION UNDER GEN. BURNSIDE."
    0x56323c6b8cc0 ---------A   05140  GOTO 2390
    0x56323c6b8e60 ---------A   05150  PRINT "DEC 31, 1862.  THE SOUTH UNDER GEN. BRAGG WON A CLOSE ";
    0x56323c6b8fc0 ---------A   05160  PRINT "BATTLE."
    0x56323c6b9070 ---------A   05170  GOTO 2390
    0x56323c6b9220 ---------A   05180  PRINT "MAY 1-6, 1863.  THE SOUTH HAD A COSTLY VICTORY AND LOST"
    0x56323c6b93b0 ---------A   05190  PRINT "ONE OF THEIR OUTSTANDING GENERALS, 'STONEWALL' JACKSON."
    0x56323c6b9470 ---------A   05200  GOTO 2390
    0x56323c6b9620 ---------A   05210  PRINT "JULY 4, 1863.  VICKSBURG WAS A COSTLY DEFEAT FOR THE SOUTH"
    0x56323c6b97a0 ---------A   05220  PRINT "BECAUSE IT GAVE THE UNION ACCESS TO THE MISSISSIPPI."
    0x56323c6b9850 ---------A   05230  GOTO 2390
    0x56323c6b99f0 ---------A   05240  PRINT "JULY 1-3, 1863.  A SOUTHERN MISTAKE BY GEN. LEE AT ";
    0x56323c6b9b80 ---------A   05250  PRINT "GETTYSBURG"
    0x56323c6b9d00 ---------A   05260  PRINT "COST THEM ONE OF THE MOST CRUCIAL BATTLES OF THE WAR."
    0x56323c6b9dc0 ---------A   05270  GOTO 2390
    0x56323c6b9f60 ---------A   05280  PRINT "SEPT. 15, 1863. CONFUSION IN A FOREST NEAR CHICKAMAUGA LED"
    0x56323c6ba0d0 ---------A   05290  PRINT "TO A COSTLY SOUTHERN VICTORY."
    0x56323c6ba190 ---------A   05300  GOTO 2390
    0x56323c6ba340 ---------A   05310  PRINT "NOV. 25, 1863. AFTER THE SOUTH HAD SIEGED GEN. ROSENCRANS'"
    0x56323c6ba4c0 ---------A   05320  PRINT "ARMY FOR THREE MONTHS, GEN. GRANT BROKE THE SIEGE."
    0x56323c6ba570 ---------A   05330  GOTO 2390
    0x56323c6ba720 ---------A   05340  PRINT "MAY 5, 1864.  GRANT'S PLAN TO KEEP LEE ISOLATED BEGAN TO"
    0x56323c6ba8b0 ---------A   05350  PRINT "FAIL HERE, AND CONTINUED AT COLD HARBOR AND PETERSBURG."
    0x56323c6ba960 ---------A   05360  GOTO 2390
    0x56323c6bab10 ---------A   05370  PRINT "AUGUST, 1864.  SHERMAN AND THREE VETERAN ARMIES CONVERGED"
    0x56323c6baca0 ---------A   05380  PRINT "ON ATLANTA AND DEALT THE DEATH BLOW TO THE CONFEDERACY."
    0x56323c6bad20 ---------A   05390  GOTO 2390
    0x56323c6bad70 ---------A   05400  END
 */



/*
 * Free line number map.
 *
     Start    End    # Lines in Gap
     -----   -----   ------------------
     00000 - 00990     100 
     05270 - 10000    4740 

 */



/*
 *  Symbol Table Listing for 'basic/civilwar2.bas'
 *
    A                        Integer     
    ABS             Function Integer         args=1, int    
    ASC             Function Integer         args=1, char*  
    ATN             Function Float           args=1, float  
    B               Array    Integer         {0,9} 
    B$                       String      
    C$              Array    String          {0,13} 
    C1              Array    Integer         {0,13} 
    C2              Array    Integer         {0,13} 
    C5                       Integer     
    C6                       Integer     
    CDBL            Function Float           args=1, int    
    CHR$            Function String          args=1, int    
    CINT            Function Integer         args=1, float  
    COS             Function Float           args=1, float  
    CSNG            Function Float           args=1, int    
    CVD             Function Float           args=1, float  
    CVI             Function Integer         args=1, char*  
    CVS             Function Float           args=1, char*  
    D                        Integer     
    E                        Integer     
    E2                       Integer     
    ENVIRON$        Function String          args=1, int    
    EOF             Function Integer         args=1, int    
    EXP             Function Float           args=1, int    
    EXTERR          Function Integer         args=1, int    
    F               Array    Integer         {0,9} 
    F1                       Integer     
    FIX             Function Integer         args=1, float  
    FRE             Function Integer         args=1, char*  
    H               Array    Integer         {0,9} 
    HEX$            Function String          args=1, int    
    I                        Integer     
    I1                       Integer     
    I2                       Integer     
    INP             Function Integer         args=1, int    
    INPUT$          Function String          args=2, int    int    
    INSTR           Function Integer         args=3, int    char*  char*  
    INT             Function Integer         args=1, float  
    IOCTL$          Function String          args=1, int    
    L                        Integer     
    LEFT$           Function String          args=2, char*  int    
    LEN             Function Integer         args=1, char*  
    LOC             Function Integer         args=1, int    
    LOF             Function Integer         args=1, int    
    LOG             Function Float           args=1, float  
    LPOS            Function Integer         args=1, Any    
    M               Array    Integer         {0,13} 
    M1              Array    Integer         {0,13} 
    M2              Array    Integer         {0,13} 
    M3                       Integer     
    M4                       Integer     
    M5                       Integer     
    M6                       Integer     
    MAX             Function Integer         args=1, int    
    MID$            Function String          args=2, char*  int    
    MIN             Function Integer         args=1, int    
    MKD$            Function String          args=1, int    
    MKI$            Function String          args=1, float  
    MKS$            Function String          args=1, float  
    N                        Integer     
    O                        Integer     
    O2                       Integer     
    OCT$            Function String          args=1, float  
    P1                       Integer     
    P2                       Integer     
    PEEK            Function Integer         args=1, int    
    PEN             Function Integer         args=1, char*  
    PLAY            Function Integer         args=1, Any    
    PMAP            Function Integer         args=2, int    int    
    POINT           Function Integer         args=2, int    int    
    POS             Function Integer         args=1, Any    
    Q1                       Integer     
    Q2                       Integer     
    R                        Integer     
    R1                       Integer     
    R2                       Integer     
    RIGHT$          Function String          args=2, char*  int    
    RND             Function Float           args=1, int    
    S               Array    Integer         {0,3} 
    S0                       Integer     
    S2              Array    Integer         {0,9} 
    SGN             Function Integer         args=1, int    
    SIN             Function Float           args=1, float  
    SPACE$          Function String          args=1, int    
    SPC             Function Unknown (0)    args=1, int    
    SQR             Function Float           args=1, float  
    STICK           Function Integer         args=1, int    
    STR$            Function String          args=1, float  
    STRING$         Function String          args=2, int    int    
    T1                       Integer     
    T2                       Integer     
    TAB             Function Unknown (0)    args=1, int    
    TAB$            Function String          args=1, int    
    TAN             Function Float           args=1, int    
    TIMER           Function Float           args=0, 
    U                        Integer     
    U2                       Integer     
    VAL             Function Integer         args=1, char*  
    VARPTR          Function Integer         args=1, Any    
    VARPTR$         Function String          args=1, Any    
    W                        Integer     
    W0                       Integer     
    X$                       String      
    Y                        Integer     
    Y1                       Integer     
    Y2                       Integer     
    Z                        Integer     

 */


/*
 * Title: Display of final 'clean' BASIC listing.
 *
 *  Listing of basic/civilwar2.bas: 
 *
                   +--------+---- Routine IDs (Empty field=Inaccessible code, A=Main program).
                   |        | +-- Target status (G-GOSUB, T-GOTO, B-Both GOSUB and GOTO)
        Program    |        | |
        Address    v        v v Original BASIC statement
    -------------- ---------- - ------------------------------------------------------------------------------
    0x56323c66b6d0 ---------A   01000  PRINT TAB(26) "CIVIL WAR"
    0x56323c66b670 ---------A   01010  PRINT TAB(15) "CREATIVE COMPUTING  MORRISTOWN, NEW JERSEY"
    0x56323c66c910 ---------A   01020  PRINT 
    0x56323c65c2b0 ---------A   01030  PRINT 
    0x56323c66b9e0 ---------A   01040  PRINT
    0x56323c66de90 ---------A   01050  REM ORIGINAL GAME DESIGN
    0x56323c66e010 ---------A   01060  REM MODIFICATIONS
    0x56323c673e20 ---------A   01070  DIM S(4),C$(14),M1(14),M2(14),C1(14),C2(14),M(14)
    0x56323c673eb0 ---------A   01080  REM UNION INFO ON LIKELY CONFEDERATE STRATEGY
    0x56323c674180 ---------A   01090  S(1)=25 
    0x56323c674410 ---------A   01100  S(2)=25 
    0x56323c6746a0 ---------A   01110  S(3)=25 
    0x56323c674930 ---------A   01120  S(4)=25
    0x56323c674980 ---------A   01130  REM READ HISTORICAL DATA.
    0x56323c674d50 ---------A   01140  FOR D=1 TO 14
    0x56323c66e0d0 ---------A   01150  READ C$(D),M1(D),M2(D),C1(D),C2(D),M(D)
    0x56323c675930 ---------A   01160  NEXT D
    0x56323c675c40 ---------A   01170  LET D=RND(-1)
    0x56323c675c90 ---------A   01180  PRINT
    0x56323c675df0 ---------A   01190  PRINT "DO YOU WANT INSTRUCTIONS";
    0x56323c675ff0 ---------A T 01200  INPUT X$
    0x56323c676250 ---------A   01210  IF X$="YES" THEN 1250
    0x56323c6764b0 ---------A   01220  IF X$="NO" THEN 1500
    0x56323c676630 ---------A   01230  PRINT "YES OR NO -- ";
    0x56323c6766c0 ---------A   01240  GOTO 1200
    0x56323c676870 ---------A T 01250  PRINT
    0x56323c676a10 ---------A   01260  PRINT "THIS IS A CIVIL WAR SIMULATION."
    0x56323c676bc0 ---------A   01270  PRINT "TO PLAY TYPE A RESPONSE WHEN THE COMPUTER ASKS."
    0x56323c676d80 ---------A   01280  PRINT "REMEMBER THAT ALL FACTORS ARE INTERRELATED AND THAT YOUR"
    0x56323c676f50 ---------A   01290  PRINT "RESPONSES COULD CHANGE HISTORY. FACTS AND FIGURES USED ARE"
    0x56323c677110 ---------A   01300  PRINT "BASED ON THE ACTUAL OCCURRENCE. MOST BATTLES TEND TO RESULT"
    0x56323c6772a0 ---------A   01310  PRINT "AS THEY DID IN THE CIVIL WAR, BUT IT ALL DEPENDS ON YOU!!"
    0x56323c677350 ---------A   01320  PRINT
    0x56323c6774f0 ---------A   01330  PRINT "THE OBJECT OF THE GAME IS TO WIN AS MANY BATTLES AS ";
    0x56323c677650 ---------A   01340  PRINT "POSSIBLE."
    0x56323c6776f0 ---------A   01350  PRINT
    0x56323c677890 ---------A   01360  PRINT "YOUR CHOICES FOR DEFENSIVE STRATEGY ARE:"
    0x56323c677a30 ---------A   01370  PRINT "        (1) ARTILLERY ATTACK"
    0x56323c677df0 ---------A   01380  PRINT "        (2) FORTIFICATION AGAINST FRONTAL ATTACK"
    0x56323c677f80 ---------A   01390  PRINT "        (3) FORTIFICATION AGAINST FLANKING MANEUVERS"
    0x56323c678110 ---------A   01400  PRINT "        (4) FALLING BACK"
    0x56323c6782b0 ---------A   01410  PRINT " YOUR CHOICES FOR OFFENSIVE STRATEGY ARE:"
    0x56323c678430 ---------A   01420  PRINT "        (1) ARTILLERY ATTACK"
    0x56323c6785c0 ---------A   01430  PRINT "        (2) FRONTAL ATTACK"
    0x56323c678740 ---------A   01440  PRINT "        (3) FLANKING MANEUVERS"
    0x56323c6788e0 ---------A   01450  PRINT "        (4) ENCIRCLEMENT"
    0x56323c678a90 ---------A   01460  PRINT "YOU MAY SURRENDER BY TYPING A '5' FOR YOUR STRATEGY."
    0x56323c678af0 ---------A   01470  PRINT 
    0x56323c678b50 ---------A   01480  PRINT 
    0x56323c678bb0 ---------A   01490  PRINT 
    0x56323c678d50 ---------A T 01500  PRINT "ARE THERE TWO GENERALS PRESENT ";
    0x56323c678ed0 ---------A T 01510  PRINT "(ANSWER YES OR NO)";
    0x56323c679100 ---------A   01520  INPUT B$
    0x56323c679390 ---------A   01530  IF B$="YES" THEN 1580
    0x56323c679640 ---------A   01540  IF B$ <> "NO" THEN 1510
    0x56323c6796a0 ---------A   01550  PRINT 
    0x56323c679810 ---------A   01560  PRINT "YOU ARE THE CONFEDERACY.   GOOD LUCK!"
    0x56323c679890 ---------A   01570  PRINT
    0x56323c679ac0 ---------A T 01580  LET D=1
    0x56323c679d30 ---------A   01590  IF B$ <> "YES" THEN 1610
    0x56323c679f80 ---------A   01600  LET D=2
    0x56323c67a120 ---------A T 01610  PRINT "SELECT A BATTLE BY TYPING A NUMBER FROM 1 TO 14 ON"
    0x56323c67a2e0 ---------A   01620  PRINT "REQUEST.  TYPE ANY OTHER NUMBER TO END THE SIMULATION."
    0x56323c67a470 ---------A   01630  PRINT "BUT '0' BRINGS BACK EXACT PREVIOUS BATTLE SITUATION"
    0x56323c67a5e0 ---------A   01640  PRINT "ALLOWING YOU TO REPLAY IT"
    0x56323c67a690 ---------A   01650  PRINT
    0x56323c67a830 ---------A   01660  PRINT "NOTE: A NEGATIVE FOOD$ ENTRY CAUSES THE PROGRAM TO "
    0x56323c67a9b0 ---------A   01670  PRINT "USE THE ENTRIES FROM THE PREVIOUS BATTLE"
    0x56323c67aa50 ---------A   01680  PRINT
    0x56323c67ac00 ---------A   01690  PRINT "AFTER REQUESTING A BATTLE, DO YOU WISH ";
    0x56323c67ad90 ---------A   01700  PRINT "BATTLE DESCRIPTIONS ";
    0x56323c67af10 ---------A T 01710  PRINT "(ANSWER YES OR NO)";
    0x56323c67b080 ---------A   01720  INPUT X$
    0x56323c67b310 ---------A   01730  IF X$="YES" THEN 1840
    0x56323c67b9c0 ---------A   01740  IF X$ <> "NO" THEN 1710
    0x56323c67bc80 ---------A   01750  L=0
    0x56323c67bf30 ---------A   01760  W=0
    0x56323c67c1e0 ---------A   01770  R1=0
    0x56323c67c490 ---------A   01780  Q1=0
    0x56323c67c740 ---------A   01790  M3=0
    0x56323c67c9f0 ---------A   01800  M4=0
    0x56323c67cca0 ---------A   01810  P1=0
    0x56323c67cf50 ---------A   01820  P2=0
    0x56323c67d200 ---------A   01830  T1=0
    0x56323c67d500 ---------A T 01840  T2=0
    0x56323c67d870 ---------A   01850  F(2)=0
    0x56323c67dbe0 ---------A   01860  H(2)=0
    0x56323c67df50 ---------A   01870  B(2)=0
    0x56323c67e200 ---------A   01880  R2=0
    0x56323c67e4b0 ---------A   01890  Q2=0
    0x56323c67e760 ---------A   01900  C6=0
    0x56323c67e950 ---------A   01910  F=0
    0x56323c67ec00 ---------A   01920  W0=0
    0x56323c67eeb0 ---------A   01930  Y=0
    0x56323c67f160 ---------A   01940  Y2=0
    0x56323c67f410 ---------A   01950  U=0
    0x56323c67f6f0 ---------A   01960  U2=0
    0x56323c67f740 ---------A   01970  PRINT 
    0x56323c67f7a0 ---------A   01980  PRINT 
    0x56323c67f840 ---------A T 01990  PRINT
    0x56323c67f9d0 ---------A   02000  PRINT "WHICH BATTLE DO YOU WISH TO SIMULATE";
    0x56323c67fbf0 ---------A   02010  INPUT A
    0x56323c67fe60 ---------A   02020  IF A <> 0 THEN 2040
    0x56323c680180 ---------A   02030  IF R <> 0 THEN 2350
    0x56323c6803f0 ---------A T 02040  IF A <=0 THEN 4040
    0x56323c680650 ---------A   02050  IF A >= 15 THEN 4040
    0x56323c680970 ---------A   02060  LET C$=C$(A)
    0x56323c680c80 ---------A   02070  LET M1=M1(A)
    0x56323c680f90 ---------A   02080  LET M2=M2(A)
    0x56323c6812a0 ---------A   02090  LET C1=C1(A)
    0x56323c6815b0 ---------A   02100  LET C2=C2(A)
    0x56323c6818c0 ---------A   02110  LET M=M(A)
    0x56323c681ae0 ---------A   02120  LET U=0
    0x56323c681b50 ---------A   02130  REM  INFLATION CALC
    0x56323c6821c0 ---------A   02140  LET I1=10+(L-W)*2
    0x56323c682820 ---------A   02150  LET I2=10+(W-L)*2
    0x56323c682890 ---------A   02160  REM - MONEY AVAILABLE
    0x56323c683890 ---------A   02170  LET D(1)=100*INT((M1*(100-I1)/2000)*(1+(R1-Q1)/(R1+1))+.5)
    0x56323c6841d0 ---------A   02180  LET D(2)=100*INT(M2*(100-I2)/2000+.5)
    0x56323c684470 ---------A   02190  IF B$ <> "YES" THEN 2210
    0x56323c685420 ---------A   02200  LET D(2)=100*INT((M2*(100-I2)/2000)*(1+(R2-Q2)/(R2+1))+.5)
    0x56323c685490 ---------A T 02210  REM - MEN   AVAILABLE
    0x56323c685ec0 ---------A   02220  LET M5=INT(M1*(1+(P1-T1)/(M3+1)))
    0x56323c6868b0 ---------A   02230  LET M6=INT(M2*(1+(P2-T2)/(M4+1)))
    0x56323c686dc0 ---------A   02240  LET F1=5*M1/6
    0x56323c686e10 ---------A   02250  PRINT 
    0x56323c686e70 ---------A   02260  PRINT 
    0x56323c686ed0 ---------A   02270  PRINT 
    0x56323c686f30 ---------A   02280  PRINT 
    0x56323c686fc0 ---------A   02290  PRINT
    0x56323c687240 ---------A   02300  PRINT "THIS IS THE BATTLE OF ";C$
    0x56323c6874c0 ---------A   02310  IF X$="NO" THEN 2360
    0x56323c687750 ---------A   02320  IF A>11 THEN 2340
    0x56323c688100 ---------A   02330  ON A GOTO 4460,4500,4530,4570,4610,4640,4670,4700,4730,4760,4800
    0x56323c6885b0 ---------A T 02340  ON A-11 GOTO 4830,4860,4890
    0x56323c688810 ---------A T 02350  PRINT C$" INSTANT REPLAY"
    0x56323c6888a0 ---------A T 02360  PRINT
    0x56323c688c10 ---------A   02370  PRINT " ","CONFEDERACY"," UNION"
    0x56323c689180 ---------A   02380  PRINT "MEN"," "M5," "M6
    0x56323c689880 ---------A   02390  PRINT "MONEY","$";D(1),"$";D(2)
    0x56323c68a0e0 ---------A   02400  PRINT "INFLATION"," ";I1+15;"%"," ";I2;"%"
    0x56323c68a190 ---------A   02410  PRINT
    0x56323c68a230 ---------A   02420  REM - ONLY IN PRINTOUT IS CONFED INFLATION = I1+15%
    0x56323c68a300 ---------A   02430  REM - IF TWO GENERALS, INPUT CONFED. FIRST
    0x56323c68a6e0 ---------A   02440  FOR I=1 TO D
    0x56323c68a960 ---------A   02450  IF B$ <> "YES" THEN 2480
    0x56323c68abd0 ---------A   02460  IF I=2 THEN 2480
    0x56323c68ad80 ---------A   02470  PRINT "CONFEDERATE GENERAL---";
    0x56323c68af00 ---------A T 02480  PRINT "HOW MUCH DO YOU WISH TO SPEND FOR"
    0x56323c68b080 ---------A T 02490  PRINT " - FOOD......";
    0x56323c68b1f0 ---------A   02500  INPUT F
    0x56323c68b460 ---------A   02510  IF F >= 0 THEN 2580
    0x56323c68b6d0 ---------A   02520  IF R1 <> 0 THEN 2550
    0x56323c68b830 ---------A   02530  PRINT "NO PREVIOUS ENTRIES"
    0x56323c68b8d0 ---------A   02540  GOTO 2490
    0x56323c68ba40 ---------A T 02550  PRINT "ASSUME YOU WANT TO KEEP SAME ALLOCATIONS"
    0x56323c68bac0 ---------A   02560  PRINT
    0x56323c68bb40 ---------A   02570  GOTO 2730
    0x56323c68be60 ---------A T 02580  LET F(I)=F
    0x56323c68bfd0 ---------A T 02590  PRINT " - SALARIES..";
    0x56323c68c210 ---------A   02600  INPUT H(I)
    0x56323c68c500 ---------A   02610  LET N=1
    0x56323c68c840 ---------A   02620  IF H(I)<0 THEN 2710
    0x56323c68c9c0 ---------A T 02630  PRINT " - AMMUNITION";
    0x56323c68d410 ---------A   02640  INPUT B(I)
    0x56323c68d640 ---------A   02650  LET N=2
    0x56323c68d970 ---------A   02660  IF B(I)<0 THEN 2710
    0x56323c68da10 ---------A   02670  PRINT
    0x56323c68e270 ---------A   02680  IF F(I)+H(I)+B(I) <= D(I) THEN 2730
    0x56323c68e5c0 ---------A   02690  PRINT "THINK AGAIN! YOU HAVE ONLY $"D(I)
    0x56323c68e660 ---------A   02700  GOTO 2490
    0x56323c68e7d0 ---------A T 02710  PRINT "NEGATIVE VALUES NOT ALLOWED."
    0x56323c68eac0 ---------A   02720  ON N GOTO 2590,2630
    0x56323c68ed40 ---------A T 02730  IF B$ <> "YES" THEN 2770
    0x56323c68efb0 ---------A   02740  IF I=2 THEN 2770
    0x56323c68f130 ---------A   02750  PRINT "UNION GENERAL---";
    0x56323c68f270 ---------A   02760  NEXT I
    0x56323c68f650 ---------A T 02770  FOR Z=1 TO D
    0x56323c68f8e0 ---------A   02780  IF B$ <> "YES" THEN 2840
    0x56323c68fbd0 ---------A   02790  ON Z GOTO 2800,2820
    0x56323c68fd50 ---------A T 02800  PRINT "CONFEDERATE ";
    0x56323c68fde0 ---------A   02810  GOTO 2840
    0x56323c68ff50 ---------A T 02820  PRINT "      UNION ";
    0x56323c68ffd0 ---------A   02830  REM - FIND MORALE
    0x56323c690c70 ---------A T 02840  LET O=((2*F(Z)^2+H(Z)^2)/F1^2+1)
    0x56323c690ed0 ---------A   02850  IF O<10 THEN 2880
    0x56323c691030 ---------A   02860  PRINT "MORALE IS HIGH"
    0x56323c6910b0 ---------A   02870  GOTO 2920
    0x56323c691310 ---------A T 02880  IF O<5 THEN 2910
    0x56323c691470 ---------A   02890  PRINT "MORALE IS FAIR"
    0x56323c691500 ---------A   02900  GOTO 2920
    0x56323c691660 ---------A T 02910  PRINT "MORALE IS POOR"
    0x56323c6918e0 ---------A T 02920  IF B$ <> "YES" THEN 2980
    0x56323c691c00 ---------A   02930  LET O(Z)=O
    0x56323c691d30 ---------A   02940  NEXT Z
    0x56323c692100 ---------A   02950  LET O2=O(2)
    0x56323c692400 ---------A   02960  LET O=O(1)
    0x56323c6925a0 ---------A   02970  PRINT "CONFEDERATE GENERAL---";
    0x56323c692630 ---------A T 02980  REM - ACTUAL OFF/DEF BATTLE SITUATION
    0x56323c6928c0 ---------A   02990  IF M <> 3 THEN 3020
    0x56323c692a30 ---------A   03000  PRINT "YOU ARE ON THE OFFENSIVE"
    0x56323c692ac0 ---------A   03010  GOTO 3060
    0x56323c692d20 ---------A T 03020  IF M <> 1 THEN 3050
    0x56323c692e90 ---------A   03030  PRINT "YOU ARE ON THE DEFENSIVE"
    0x56323c692f30 ---------A   03040  GOTO 3060
    0x56323c693090 ---------A T 03050  PRINT "BOTH SIDES ARE ON THE OFFENSIVE "
    0x56323c693120 ---------A T 03060  PRINT
    0x56323c6931a0 ---------A   03070  REM - CHOOSE STRATEGIES
    0x56323c693440 ---------A   03080  IF B$ <> "YES" THEN 3130
    0x56323c693730 ---------A   03090  FOR I=1 TO 2
    0x56323c693a20 ---------A   03100  ON I GOTO 3110,3140
    0x56323c693ba0 ---------A T 03110  PRINT "CONFEDERATE STRATEGY ";
    0x56323c693c30 ---------A   03120  GOTO 3140
    0x56323c693da0 ---------A T 03130  PRINT "YOUR STRATEGY ";
    0x56323c693f10 ---------A T 03140  INPUT Y
    0x56323c694360 ---------A   03150  IF ABS(Y-3)<3 THEN 3180
    0x56323c6946c0 ---------A   03160  PRINT "STRATEGY";Y;"NOT ALLOWED."
    0x56323c694750 ---------A   03170  GOTO 3130
    0x56323c6949c0 ---------A T 03180  IF B$="YES" THEN 3220
    0x56323c694c20 ---------A   03190  IF Y=5 THEN 4020
    0x56323c694ca0 ---------A   03200  GOSUB 4930
    0x56323c694d10 ---------A   03210  GOTO 3390
    0x56323c694f60 ---------A T 03220  IF I=2 THEN 3260
    0x56323c695270 ---------A   03230  LET Y1=Y
    0x56323c6953e0 ---------A T 03240  PRINT "UNION STRATEGY ";
    0x56323c695520 ---------A   03250  NEXT I
    0x56323c695770 ---------A T 03260  LET Y2=Y
    0x56323c6959a0 ---------A   03270  LET Y=Y1
    0x56323c695c00 ---------A   03280  IF Y2=5 THEN 3240
    0x56323c695c90 ---------A   03290  REM 
    0x56323c696940 ---------A   03300  LET C6=(2*C2/5)*(1+1/(2*(ABS(Y2-Y)+1)))
    0x56323c697340 ---------A   03310  LET C6=C6*(1.28+(5*M2/6)/(B(2)+1))
    0x56323c697ad0 ---------A   03320  LET C6=INT(C6*(1+1/O2)+.5)
    0x56323c697b60 ---------A   03330  REM - IF LOSS > MEN PRESENT, RESCALE LOSSES
    0x56323c697f80 ---------A   03340  LET E2=100/O2
    0x56323c698400 ---------A   03350  IF INT(C6+E2)<M6 THEN 3430
    0x56323c698920 ---------A   03360  LET C6=INT(13*M6/20)
    0x56323c698d50 ---------A   03370  LET E2=7*C6/13
    0x56323c698f70 ---------A   03380  LET U2=1
    0x56323c698ff0 ---------A T 03390  REM - CALCULATE SIMULATED LOSSES
    0x56323c6990a0 ---------A   03400  PRINT
    0x56323c699100 ---------A   03410  PRINT 
    0x56323c699160 ---------A   03420  PRINT 
    0x56323c699400 ---------A T 03430  PRINT ,"CONFEDERACY","UNION"
    0x56323c69a140 ---------A   03440  LET C5=(2*C1/5)*(1+1/(2*(ABS(Y2-Y)+1)))
    0x56323c69ae30 ---------A   03450  LET C5=INT(C5*(1+1/O)*(1.28+F1/(B(1)+1))+.5)
    0x56323c69b240 ---------A   03460  LET E=100/O
    0x56323c69bd10 ---------A   03470  IF C5+100/O<M1*(1+(P1-T1)/(M3+1)) THEN 3510
    0x56323c69c850 ---------A   03480  LET C5=INT(13*M1/20*(1+(P1-T1)/(M3+1)))
    0x56323c69cc80 ---------A   03490  LET E=7*C5/13
    0x56323c69ce90 ---------A   03500  LET U=1
    0x56323c69d0f0 ---------A T 03510  IF D=1 THEN 3750
    0x56323c69d460 ---------A T 03520  PRINT "CASUALTIES",C5,C6
    0x56323c69d980 ---------A   03530  PRINT "DESERTIONS",INT(E),INT(E2)
    0x56323c69da10 ---------A   03540  PRINT
    0x56323c69dcb0 ---------A   03550  IF B$ <> "YES" THEN 3590
    0x56323c69df50 ---------A   03560  PRINT "COMPARED TO THE ACTUAL CASUALTIES AT "C$
    0x56323c69e720 ---------A   03570  PRINT "CONFEDERATE:"INT(100*(C5/C1)+.5)"% OF THE ORIGINAL"
    0x56323c69eec0 ---------A   03580  PRINT "UNION:      "INT(100*(C6/C2)+.5)"% OF THE ORIGINAL"
    0x56323c69ef40 ---------A T 03590  PRINT
    0x56323c69efc0 ---------A   03600  REM - 1 WHO ONE
    0x56323c69f240 ---------A   03610  IF U <> 1 THEN 3630
    0x56323c69f4a0 ---------A   03620  IF U2=1 THEN 3710
    0x56323c69f700 ---------A T 03630  IF U=1 THEN 3670
    0x56323c69f970 ---------A   03640  IF U2=1 THEN 3690
    0x56323c69fe40 ---------A   03650  IF C5+E=C6+E2 THEN 3710
    0x56323c6a0310 ---------A   03660  IF C5+E<C6+E2 THEN 3690
    0x56323c6a0570 ---------A T 03670  PRINT "THE UNION WINS "C$
    0x56323c6a0600 ---------A   03680  GOTO 3790
    0x56323c6a0850 ---------A T 03690  PRINT "THE CONFEDERACY WINS "C$
    0x56323c6a08e0 ---------A   03700  GOTO 3840
    0x56323c6a0a40 ---------A T 03710  PRINT "BATTLE OUTCOME UNRESOLVED"
    0x56323c6a0d80 ---------A   03720  LET W0=W0+1
    0x56323c6a0fd0 ---------A   03730  IF A=0 THEN 3980
    0x56323c6a1060 ---------A   03740  GOTO 3860
    0x56323c6a17f0 ---------A T 03750  LET C6=INT(17*C2*C1/(C5*20))
    0x56323c6a1b20 ---------A   03760  LET E2=5*O
    0x56323c6a1bc0 ---------A   03770  GOTO 3520
    0x56323c6a26f0 ---------A   03780  REM - FIND WHO WON
    0x56323c6a3890 ---------A T 03790  IF A=0 THEN 3980
    0x56323c6a3bd0 ---------A   03800  LET L=L+1
    0x56323c6a3c50 ---------A   03810  GOTO 3860
    0x56323c6a3f70 ---------A   03820  REM - CUMULATIVE BATTLE FACTORS WHICH ALTER HISTORICAL
    0x56323c6a4050 ---------A   03830  REM  RESOURCES AVAILABLE.IF A REPLAY DON'T UPDATE.
    0x56323c6a42c0 ---------A T 03840  IF A=0 THEN 3980
    0x56323c6a4600 ---------A   03850  LET W=W+1
    0x56323c6a4a70 ---------A T 03860  LET T1=T1+C5+E
    0x56323c68ce40 ---------A   03870  LET T2=T2+C6+E2
    0x56323c68d190 ---------A   03880  LET P1=P1+C1
    0x56323c6a5da0 ---------A   03890  LET P2=P2+C2
    0x56323c6a65c0 ---------A   03900  LET Q1=Q1+(F(1)+H(1)+B(1))
    0x56323c6a6de0 ---------A   03910  LET Q2=Q2+(F(2)+H(2)+B(2))
    0x56323c6a74a0 ---------A   03920  LET R1=R1+M1*(100-I1)/20
    0x56323c6a7b50 ---------A   03930  LET R2=R2+M2*(100-I2)/20
    0x56323c6a7ea0 ---------A   03940  LET M3=M3+M1
    0x56323c6a81f0 ---------A   03950  LET M4=M4+M2
    0x56323c6a8260 ---------A   03960  GOSUB 5140
    0x56323c6a8450 ---------A   03970  U=0
    0x56323c6a8670 ---------A T 03980  U2=0
    0x56323c6a87c0 ---------A   03990  PRINT "---------------"
    0x56323c6a8850 ---------A   04000  GOTO 1990
    0x56323c6a88c0 ---------A   04010  REM------FINISH OFF
    0x56323c6a8a60 ---------A T 04020  PRINT "THE CONFEDERACY HAS SURRENDERED"
    0x56323c6a8b00 ---------A   04030  GOTO 4040
    0x56323c6a8ef0 ---------A T 04040  PRINT
    0x56323c6a9090 ---------A   04050  PRINT "THE CONFEDERACY ";
    0x56323c6a94f0 ---------A   04060  PRINT "HAS WON "W" BATTLES AND LOST "L
    0x56323c6a9750 ---------A   04070  IF Y=5 THEN 4130
    0x56323c6a99c0 ---------A   04080  IF Y2=5 THEN 4110
    0x56323c6a9c40 ---------A   04090  IF W <= L THEN 4130
    0x56323c6a9ec0 ---------A   04100  IF Y=5 THEN 4130
    0x56323c6aa030 ---------A T 04110  PRINT "THE CONFEDERACY HAS WON THE WAR"
    0x56323c6aa0c0 ---------A   04120  GOTO 4140
    0x56323c6aa220 ---------A T 04130  PRINT "THE UNION HAS WON THE WAR"
    0x56323c6aa2a0 ---------A T 04140  PRINT
    0x56323c6aa530 ---------A   04150  IF R1=0 THEN 4290
    0x56323c6aaaf0 ---------A   04160  PRINT "FOR THE "W+L+W0" BATTLES FOUGHT (EXCUDING RERUNS)"
    0x56323c6aae80 ---------A   04170  PRINT " "," "," ";
    0x56323c6ab100 ---------A   04180  PRINT "CONFEDERACY"," UNION"
    0x56323c6ab840 ---------A   04190  PRINT "HISTORICAL LOSSES",INT(P1+.5),INT(P2+.5)
    0x56323c6abf60 ---------A   04200  PRINT "SIMULATED LOSSES",INT(T1+.5),INT(T2+.5)
    0x56323c6ac010 ---------A   04210  PRINT
    0x56323c6acc00 ---------A   04220  PRINT "    % OF ORIGINAL",INT(100*(T1/P1)+.5),INT(100*(T2/P2)+.5)
    0x56323c6ace80 ---------A   04230  IF B$="YES" THEN 4290
    0x56323c6acf30 ---------A   04240  PRINT
    0x56323c6ad0e0 ---------A   04250  PRINT "UNION INTELLIGENCE SUGGESTS THAT THE SOUTH USED "
    0x56323c6ad270 ---------A   04260  PRINT "STRATEGIES 1, 2, 3, 4 IN THE FOLLOWING PERCENTAGES"
    0x56323c6adab0 ---------A   04270  PRINT S(1);S2(2);S(3);S(4)
    0x56323c6adb40 ---------A   04280  REM---------------------------------
    0x56323c6adbb0 ---------A T 04290  STOP
    0x56323c6b1e20 ---------A   04300  REM - HISTORICAL DATA...CAN ADD MORE (STRAT.,ETC) BY INSERTING
    0x56323c6b1f10 ---------A   04310  REM   DATA STATEMENTS AFTER APPRO. INFO, AND ADJUSTING READ
    0x56323c6b2520 ---------A   04320  DATA "BULL RUN",18000,18500,1967,2708,1
    0x56323c6b2af0 ---------A   04330  DATA "SHILOH",40000.,44894.,10699,13047,3
    0x56323c6b30d0 ---------A   04340  DATA "SEVEN DAYS",95000.,115000.,20614,15849,3
    0x56323c6b36a0 ---------A   04350  DATA "SECOND BULL RUN",54000.,63000.,10000,14000,2
    0x56323c6b3c70 ---------A   04360  DATA "ANTIETAM",40000.,50000.,10000,12000,3
    0x56323c6b4240 ---------A   04370  DATA "FREDERICKSBURG",75000.,120000.,5377,12653,1
    0x56323c6b4820 ---------A   04380  DATA "MURFREESBORO",38000.,45000.,11000,12000,1
    0x56323c6b4df0 ---------A   04390  DATA "CHANCELLORSVILLE",32000,90000.,13000,17197,2
    0x56323c6b53c0 ---------A   04400  DATA "VICKSBURG",50000.,70000.,12000,19000,1
    0x56323c6b5990 ---------A   04410  DATA "GETTYSBURG",72500.,85000.,20000,23000,3
    0x56323c6b5f60 ---------A   04420  DATA "CHICKAMAUGA",66000.,60000.,18000,16000,2
    0x56323c6b6530 ---------A   04430  DATA "CHATTANOOGA",37000.,60000.,36700.,5800,2
    0x56323c6b6b00 ---------A   04440  DATA "SPOTSYLVANIA",62000.,110000.,17723,18000,2
    0x56323c6b70f0 ---------A   04450  DATA "ATLANTA",65000.,100000.,8500,3700,1
    0x56323c6b72a0 ---------A T 04460  PRINT "JULY 21, 1861.  GEN. BEAUREGARD, COMMANDING THE SOUTH, MET"
    0x56323c6b7460 ---------A   04470  PRINT "UNION FORCES WITH GEN. MCDOWELL IN A PREMATURE BATTLE AT"
    0x56323c6b75f0 ---------A   04480  PRINT "BULL RUN. GEN. JACKSON HELPED PUSH BACK THE UNION ATTACK."
    0x56323c6b76a0 ---------A   04490  GOTO 2360
    0x56323c6b7830 ---------A T 04500  PRINT "APRIL 6-7, 1862.  THE CONFEDERATE SURPRISE ATTACK AT"
    0x56323c6b79b0 ---------A   04510  PRINT "SHILOH FAILED DUE TO POOR ORGANIZATION."
    0x56323c6b7a60 ---------A   04520  GOTO 2360
    0x56323c6b7c00 ---------A T 04530  PRINT "JUNE 25-JULY 1, 1862.  GENERAL LEE (CSA) UPHELD THE"
    0x56323c6b7db0 ---------A   04540  PRINT "OFFENSIVE THROUGHOUT THE BATTLE AND FORCED GEN. MCCLELLAN"
    0x56323c6b7f30 ---------A   04550  PRINT "AND THE UNION FORCES AWAY FROM RICHMOND."
    0x56323c6b7fe0 ---------A   04560  GOTO 2360
    0x56323c6b8180 ---------A T 04570  PRINT "AUG 29-30, 1862.  THE COMBINED CONFEDERATE FORCES UNDER";
    0x56323c6b8310 ---------A   04580  PRINT " LEE"
    0x56323c6b84a0 ---------A   04590  PRINT "AND JACKSON DROVE THE UNION FORCES BACK INTO WASHINGTON."
    0x56323c6b8550 ---------A   04600  GOTO 2360
    0x56323c6b86e0 ---------A T 04610  PRINT "SEPT 17, 1862.  THE SOUTH FAILED TO INCORPORATE MARYLAND"
    0x56323c6b8840 ---------A   04620  PRINT "INTO THE CONFEDERACY."
    0x56323c6b88f0 ---------A   04630  GOTO 2360
    0x56323c6b8a90 ---------A T 04640  PRINT "DEC 13, 1862.  THE CONFEDERACY UNDER LEE SUCCESSFULLY"
    0x56323c6b8c10 ---------A   04650  PRINT "REPULSED AN ATTACK BY THE UNION UNDER GEN. BURNSIDE."
    0x56323c6b8cc0 ---------A   04660  GOTO 2360
    0x56323c6b8e60 ---------A T 04670  PRINT "DEC 31, 1862.  THE SOUTH UNDER GEN. BRAGG WON A CLOSE ";
    0x56323c6b8fc0 ---------A   04680  PRINT "BATTLE."
    0x56323c6b9070 ---------A   04690  GOTO 2360
    0x56323c6b9220 ---------A T 04700  PRINT "MAY 1-6, 1863.  THE SOUTH HAD A COSTLY VICTORY AND LOST"
    0x56323c6b93b0 ---------A   04710  PRINT "ONE OF THEIR OUTSTANDING GENERALS, 'STONEWALL' JACKSON."
    0x56323c6b9470 ---------A   04720  GOTO 2360
    0x56323c6b9620 ---------A T 04730  PRINT "JULY 4, 1863.  VICKSBURG WAS A COSTLY DEFEAT FOR THE SOUTH"
    0x56323c6b97a0 ---------A   04740  PRINT "BECAUSE IT GAVE THE UNION ACCESS TO THE MISSISSIPPI."
    0x56323c6b9850 ---------A   04750  GOTO 2360
    0x56323c6b99f0 ---------A T 04760  PRINT "JULY 1-3, 1863.  A SOUTHERN MISTAKE BY GEN. LEE AT ";
    0x56323c6b9b80 ---------A   04770  PRINT "GETTYSBURG"
    0x56323c6b9d00 ---------A   04780  PRINT "COST THEM ONE OF THE MOST CRUCIAL BATTLES OF THE WAR."
    0x56323c6b9dc0 ---------A   04790  GOTO 2360
    0x56323c6b9f60 ---------A T 04800  PRINT "SEPT. 15, 1863. CONFUSION IN A FOREST NEAR CHICKAMAUGA LED"
    0x56323c6ba0d0 ---------A   04810  PRINT "TO A COSTLY SOUTHERN VICTORY."
    0x56323c6ba190 ---------A   04820  GOTO 2360
    0x56323c6ba340 ---------A T 04830  PRINT "NOV. 25, 1863. AFTER THE SOUTH HAD SIEGED GEN. ROSENCRANS'"
    0x56323c6ba4c0 ---------A   04840  PRINT "ARMY FOR THREE MONTHS, GEN. GRANT BROKE THE SIEGE."
    0x56323c6ba570 ---------A   04850  GOTO 2360
    0x56323c6ba720 ---------A T 04860  PRINT "MAY 5, 1864.  GRANT'S PLAN TO KEEP LEE ISOLATED BEGAN TO"
    0x56323c6ba8b0 ---------A   04870  PRINT "FAIL HERE, AND CONTINUED AT COLD HARBOR AND PETERSBURG."
    0x56323c6ba960 ---------A   04880  GOTO 2360
    0x56323c6bab10 ---------A T 04890  PRINT "AUGUST, 1864.  SHERMAN AND THREE VETERAN ARMIES CONVERGED"
    0x56323c6baca0 ---------A   04900  PRINT "ON ATLANTA AND DEALT THE DEATH BLOW TO THE CONFEDERACY."
    0x56323c6bad20 ---------A   04910  GOTO 2360
    0x56323c6bad70 ---------A   04920  END
    0x56323c6adc60 ---------B G 04930  REM - UNION STRATEGY IS COMPUTER CHOSEN
    0x56323c6ade10 ---------B   04940  PRINT "UNION STRATEGY IS ";
    0x56323c6ae070 ---------B   04950  IF A <> 0 THEN 5010
    0x56323c6ae1e0 ---------B T 04960  INPUT Y2
    0x56323c6ae440 ---------B   04970  IF Y2 <=0 THEN 4990
    0x56323c6ae6d0 ---------B   04980  IF Y2<5 THEN 5120
    0x56323c6ae860 ---------B T 04990  PRINT "ENTER 1 , 2 ,3 , OR 4 (USUALLY PREVIOUS UNION STRATEGY)"
    0x56323c6ae8e0 ---------B   05000  GOTO 4960
    0x56323c6aebb0 ---------B T 05010  LET S0=0
    0x56323c6aefa0 ---------B   05020  LET R=100*RND(0)
    0x56323c6af270 ---------B   05030  FOR I=1 TO 4
    0x56323c6af6e0 ---------B   05040  LET S0=S0+S(I)
    0x56323c6af780 ---------B   05050  REM - IF ACTUAL STRATEGY INFO IS IN PROGRAM DATA STATEMENTS
    0x56323c6af860 ---------B   05060  REM   THEN R-100 IS EXTRA WEIGHT GIVEN TO THAT STATEGY.
    0x56323c6afaf0 ---------B   05070  IF R<S0 THEN 5100
    0x56323c6afc30 ---------B   05080  NEXT I
    0x56323c6afd10 ---------B   05090  REM - IF ACTUAL STRAT. IN,THEN HERE IS Y2= HIST. STRAT.
    0x56323c6aff60 ---------B T 05100  LET Y2=I
    0x56323c6b00b0 ---------B   05110  PRINT Y2
    0x56323c6d4a00 ---------B T 05120  GOTO 05130
    0x56323c6d6840 ---------B T 05130  RETURN
    0x56323c6b01e0 ---------C G 05140  REM LEARN  PRESENT STRATEGY, START FORGETTING OLD ONES
    0x56323c6b02d0 ---------C   05150  REM - PRESENT STRATEGY OF SOUTH GAINS 3*S, OTHERS LOSE S
    0x56323c6b03c0 ---------C   05160  REM   PROBABILITY POINTS, UNLESS A STRATEGY FALLS BELOW 5%.
    0x56323c6b05f0 ---------C   05170  LET S=3
    0x56323c6b0800 ---------C   05180  LET S0=0
    0x56323c6b0ae0 ---------C   05190  FOR I=1 TO 4
    0x56323c6b0e20 ---------C   05200  IF S(I) <= 5 THEN 5230
    0x56323c6b1340 ---------C   05210  LET S(I)=S(I)-S
    0x56323c6b1690 ---------C   05220  LET S0=S0+S
    0x56323c6b17c0 ---------C T 05230  NEXT I
    0x56323c6b1cf0 ---------C   05240  LET S(Y)=S(Y)+S0
    0x56323c6d49b0 ---------C   05250  GOTO 05260
    0x56323c6d68a0 ---------C T 05260  RETURN
 */

//---------------------------------------------------------------------------
// $Header$ 
//
// NOTE: This program has been automatically tranlated by b2c
//
// $Log$ 
// 
//---------------------------------------------------------------------------
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <errno.h>
//---------------------------------------------------------------------------
// Global data area.
//---------------------------------------------------------------------------
char* data_04320s[]={"BULL RUN","18000","18500","1967","2708","1"};
char* data_04330s[]={"SHILOH","40000.","44894.","10699","13047","3"};
char* data_04340s[]={"SEVEN DAYS","95000.","115000.","20614","15849","3"};
char* data_04350s[]={"SECOND BULL RUN","54000.","63000.","10000","14000","2"};
char* data_04360s[]={"ANTIETAM","40000.","50000.","10000","12000","3"};
char* data_04370s[]={"FREDERICKSBURG","75000.","120000.","5377","12653","1"};
char* data_04380s[]={"MURFREESBORO","38000.","45000.","11000","12000","1"};
char* data_04390s[]={"CHANCELLORSVILLE","32000","90000.","13000","17197","2"};
char* data_04400s[]={"VICKSBURG","50000.","70000.","12000","19000","1"};
char* data_04410s[]={"GETTYSBURG","72500.","85000.","20000","23000","3"};
char* data_04420s[]={"CHICKAMAUGA","66000.","60000.","18000","16000","2"};
char* data_04430s[]={"CHATTANOOGA","37000.","60000.","36700.","5800","2"};
char* data_04440s[]={"SPOTSYLVANIA","62000.","110000.","17723","18000","2"};
char* data_04450s[]={"ATLANTA","65000.","100000.","8500","3700","1"};
//---------------------------------------------------------------------------




typedef enum {TYPE_None,TYPE_Integer,TYPE_Float,TYPE_String}t_type;
typedef struct{
    int    LineNum;
    int    Size;
    char** SData;
}t_data;
t_data ProgramData[] = {
    { 4320,  6,data_04320s},
    { 4330,  6,data_04330s},
    { 4340,  6,data_04340s},
    { 4350,  6,data_04350s},
    { 4360,  6,data_04360s},
    { 4370,  6,data_04370s},
    { 4380,  6,data_04380s},
    { 4390,  6,data_04390s},
    { 4400,  6,data_04400s},
    { 4410,  6,data_04410s},
    { 4420,  6,data_04420s},
    { 4430,  6,data_04430s},
    { 4440,  6,data_04440s},
    { 4450,  6,data_04450s},
    {    0,  0,nullptr       }
};

#include "intrinsics.h"


//---------------------------------------------------------------------------
// Global variable area.
//
// NOTE: Variable names are long to allow for easy editing.
//---------------------------------------------------------------------------
int    A_int;                                     // Basic: A 
int    B_int_arr[10];                             // Basic: B 
char*  B_str;                                     // Basic: B$ 
char*  C_str_arr[14];                             // Basic: C$ 
int    C1_int_arr[14];                            // Basic: C1 
int    C2_int_arr[14];                            // Basic: C2 
int    C5_int;                                    // Basic: C5 
int    C6_int;                                    // Basic: C6 
int    D_int;                                     // Basic: D 
int    E_int;                                     // Basic: E 
int    E2_int;                                    // Basic: E2 
int    F_int_arr[10];                             // Basic: F 
int    F1_int;                                    // Basic: F1 
int    H_int_arr[10];                             // Basic: H 
int    I_int;                                     // Basic: I 
int    I1_int;                                    // Basic: I1 
int    I2_int;                                    // Basic: I2 
int    L_int;                                     // Basic: L 
int    M_int_arr[14];                             // Basic: M 
int    M1_int_arr[14];                            // Basic: M1 
int    M2_int_arr[14];                            // Basic: M2 
int    M3_int;                                    // Basic: M3 
int    M4_int;                                    // Basic: M4 
int    M5_int;                                    // Basic: M5 
int    M6_int;                                    // Basic: M6 
int    N_int;                                     // Basic: N 
int    O_int;                                     // Basic: O 
int    O2_int;                                    // Basic: O2 
int    P1_int;                                    // Basic: P1 
int    P2_int;                                    // Basic: P2 
int    Q1_int;                                    // Basic: Q1 
int    Q2_int;                                    // Basic: Q2 
int    R_int;                                     // Basic: R 
int    R1_int;                                    // Basic: R1 
int    R2_int;                                    // Basic: R2 
int    S_int_arr[4];                              // Basic: S 
int    S0_int;                                    // Basic: S0 
int    S2_int_arr[10];                            // Basic: S2 
int    T1_int;                                    // Basic: T1 
int    T2_int;                                    // Basic: T2 
int    U_int;                                     // Basic: U 
int    U2_int;                                    // Basic: U2 
int    W_int;                                     // Basic: W 
int    W0_int;                                    // Basic: W0 
char*  X_str;                                     // Basic: X$ 
int    Y_int;                                     // Basic: Y 
int    Y1_int;                                    // Basic: Y1 
int    Y2_int;                                    // Basic: Y2 
int    Z_int;                                     // Basic: Z 
//---------------------------------------------------------------------------
//---------------------------------------------------------------------------
char* GLBpStr=nullptr;
//---------------------------------------------------------------------------


//---------------------------------------------------------------------------
// Subroutine Prototypes.
//---------------------------------------------------------------------------
void Routine_04930();
void Routine_05140();

//---------------------------------------------------------------------------
// Program Functions.
//---------------------------------------------------------------------------
//---------------------------------------------------------------------------
// Common area load and store routines.
//---------------------------------------------------------------------------
// void  LoadCommonAreas(char* filename){
//     json_error_t error;
// 
//     // Read in the COMMON area save-file
//     json_t *root = json_load_file(filename, 0, &error);
//     if (!root) {
//         fprintf(stderr, "Error reading JSON file: %s\n",error.text);
//         return;
//     }
// 
//     // Get the number of variables read.
//     int count = json_array_size(root);
// 
//     // Read in each variable and store it...
//     for(int v=0;v<count;v++){
// 
//     }
// 
//     // Get rid of storage area
//     json_decref(root);
// };
// void  SaveCommonAreas(char* file){
// };
//---------------------------------------------------------------------------
// Program Subroutines.
//---------------------------------------------------------------------------


//---------------------------------------------------------------------------
// Routine B
//---------------------------------------------------------------------------

void Routine_04930(){
    // 04930 REM - UNION STRATEGY IS COMPUTER CHOSEN
    // 04940 PRINT "UNION STRATEGY IS ";
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"UNION STRATEGY IS ");fputs(buf,fh); };
    // 04950 IF A <> 0 THEN 5010
    if(A_int!=0)goto Lbl_05010;

  Lbl_04960:
    // 04960 INPUT Y2
    // Start of Basic INPUT statement 04960
    {
        int numargs=1;
        char *args[numargs+1];
        bool echoeol=true;
        while(true){
            fprintf(stdout," ? ");
            int err=input(args,numargs,echoeol);
            if(err==0x03) break;
            if(err || 
                (err += b2c_strtoi(&Y2_int,args,0)) ){
                 printf("?Redo from start\n");
            }else{
                break;
            };
        };
    }; // End of Basic INPUT statement 04960
    // 04970 IF Y2 <=0 THEN 4990
    if(Y2_int<=0)goto Lbl_04990;
    // 04980 IF Y2<5 THEN 5120
    if(Y2_int<5)goto Lbl_05120;

  Lbl_04990:
    // 04990 PRINT "ENTER 1 , 2 ,3 , OR 4 (USUALLY PREVIOUS UNION STRATEGY)"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"ENTER 1 , 2 ,3 , OR 4 (USUALLY PREVIOUS UNION STRATEGY)");strcat(buf,"\n");fputs(buf,fh); };
    // 05000 GOTO 4960
    goto Lbl_04960;

  Lbl_05010:
    // 05010 LET S0=0
    S0_int = 0;
    // 05020 LET R=100*RND(0)
    R_int = 100*RND(0);
    // 05030 FOR I=1 TO 4
    for(I_int=1;I_int<=4;I_int++){
        // 05040 LET S0=S0+S(I)
        S0_int = S0_int+S_int_arr[I_int];
        // 05050 REM - IF ACTUAL STRATEGY INFO IS IN PROGRAM DATA STATEMENTS
        // 05060 REM   THEN R-100 IS EXTRA WEIGHT GIVEN TO THAT STATEGY.
        // 05070 IF R<S0 THEN 5100
        if(R_int<S0_int)goto Lbl_05100;
        // 05080 NEXT I
        int dummy_5080=0; // Ignore this line.
    }; // End-For(I_int)
    // 05090 REM - IF ACTUAL STRAT. IN,THEN HERE IS Y2= HIST. STRAT.

  Lbl_05100:
    // 05100 LET Y2=I
    Y2_int = I_int;
    // 05110 PRINT Y2
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256); b2c_INT(buf,Y2_int);strcat(buf,"\n");fputs(buf,fh); };

  Lbl_05120:
    // 05120 GOTO 05130
    goto Lbl_05130;

  Lbl_05130:
    // 05130 RETURN
    return;
};


//---------------------------------------------------------------------------
// Routine C
//---------------------------------------------------------------------------

void Routine_05140(){
    // 05140 REM LEARN  PRESENT STRATEGY, START FORGETTING OLD ONES
    // 05150 REM - PRESENT STRATEGY OF SOUTH GAINS 3*S, OTHERS LOSE S
    // 05160 REM   PROBABILITY POINTS, UNLESS A STRATEGY FALLS BELOW 5%.
    // 05170 LET S=3
    S_int_arr[0] = 3;
    // 05180 LET S0=0
    S0_int = 0;
    // 05190 FOR I=1 TO 4
    for(I_int=1;I_int<=4;I_int++){
        // 05200 IF S(I) <= 5 THEN 5230
        if(S_int_arr[I_int]<=5)goto Lbl_05230;
        // 05210 LET S(I)=S(I)-S
        S_int_arr[I_int] = S_int_arr[I_int]-S_int_arr[0];
        // 05220 LET S0=S0+S
        S0_int = S0_int+S_int_arr[0];

  Lbl_05230:
        // 05230 NEXT I
        int dummy_5230=0; // Ignore this line.
    }; // End-For(I_int)
    // 05240 LET S(Y)=S(Y)+S0
    S_int_arr[Y_int] = S_int_arr[Y_int]+S0_int;
    // 05250 GOTO 05260
    goto Lbl_05260;

  Lbl_05260:
    // 05260 RETURN
    return;
};

//---------------------------------------------------------------------------
// Main Program.
//---------------------------------------------------------------------------
#pragma argsused
int main(int argc,char *argv[])
{
    // 01000 PRINT TAB(26) "CIVIL WAR"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);b2c_TAB(buf,26);strcat(buf,"CIVIL WAR");strcat(buf,"\n");fputs(buf,fh); };
    // 01010 PRINT TAB(15) "CREATIVE COMPUTING  MORRISTOWN, NEW JERSEY"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);b2c_TAB(buf,15);strcat(buf,"CREATIVE COMPUTING  MORRISTOWN, NEW JERSEY");strcat(buf,"\n");fputs(buf,fh); };
    // 01020 PRINT 
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };
    // 01030 PRINT 
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };
    // 01040 PRINT
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };
    // 01050 REM ORIGINAL GAME DESIGN
    // 01060 REM MODIFICATIONS
    // 01070 DIM S(4),C$(14),M1(14),M2(14),C1(14),C2(14),M(14)
    // 01080 REM UNION INFO ON LIKELY CONFEDERATE STRATEGY
    // 01090 S(1)=25 
    S_int_arr[1] = 25;
    // 01100 S(2)=25 
    S_int_arr[2] = 25;
    // 01110 S(3)=25 
    S_int_arr[3] = 25;
    // 01120 S(4)=25
    S_int_arr[4] = 25;
    // 01130 REM READ HISTORICAL DATA.
    // 01140 FOR D=1 TO 14
    for(D_int=1;D_int<=14;D_int++){
        // 01150 READ C$(D),M1(D),M2(D),C1(D),C2(D),M(D)
        C_str_arr[D_int] = Get_Data_String();
        M1_int_arr[D_int] = Get_Data_Int();
        M2_int_arr[D_int] = Get_Data_Int();
        C1_int_arr[D_int] = Get_Data_Int();
        C2_int_arr[D_int] = Get_Data_Int();
        M_int_arr[D_int] = Get_Data_Int();
        // 01160 NEXT D
        int dummy_1160=0; // Ignore this line.
    }; // End-For(D_int)
    // 01170 LET D=RND(-1)
    D_int = RND(-1);
    // 01180 PRINT
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };
    // 01190 PRINT "DO YOU WANT INSTRUCTIONS";
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"DO YOU WANT INSTRUCTIONS");fputs(buf,fh); };

  Lbl_01200:
    // 01200 INPUT X$
    // Start of Basic INPUT statement 01200
    {
        int numargs=1;
        char *args[numargs+1];
        bool echoeol=true;
        while(true){
            fprintf(stdout," ? ");
            int err=input(args,numargs,echoeol);
            if(err==0x03) break;
            if(err || 
                (err += b2c_strtos(&X_str,args,0)) ){
                 printf("?Redo from start\n");
            }else{
                break;
            };
        };
    }; // End of Basic INPUT statement 01200
    // 01210 IF X$="YES" THEN 1250
    if(strcmp(X_str,"YES")==0)goto Lbl_01250;
    // 01220 IF X$="NO" THEN 1500
    if(strcmp(X_str,"NO")==0)goto Lbl_01500;
    // 01230 PRINT "YES OR NO -- ";
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"YES OR NO -- ");fputs(buf,fh); };
    // 01240 GOTO 1200
    goto Lbl_01200;

  Lbl_01250:
    // 01250 PRINT
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };
    // 01260 PRINT "THIS IS A CIVIL WAR SIMULATION."
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"THIS IS A CIVIL WAR SIMULATION.");strcat(buf,"\n");fputs(buf,fh); };
    // 01270 PRINT "TO PLAY TYPE A RESPONSE WHEN THE COMPUTER ASKS."
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"TO PLAY TYPE A RESPONSE WHEN THE COMPUTER ASKS.");strcat(buf,"\n");fputs(buf,fh); };
    // 01280 PRINT "REMEMBER THAT ALL FACTORS ARE INTERRELATED AND THAT YOUR"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"REMEMBER THAT ALL FACTORS ARE INTERRELATED AND THAT YOUR");strcat(buf,"\n");fputs(buf,fh); };
    // 01290 PRINT "RESPONSES COULD CHANGE HISTORY. FACTS AND FIGURES USED ARE"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"RESPONSES COULD CHANGE HISTORY. FACTS AND FIGURES USED ARE");strcat(buf,"\n");fputs(buf,fh); };
    // 01300 PRINT "BASED ON THE ACTUAL OCCURRENCE. MOST BATTLES TEND TO RESULT"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"BASED ON THE ACTUAL OCCURRENCE. MOST BATTLES TEND TO RESULT");strcat(buf,"\n");fputs(buf,fh); };
    // 01310 PRINT "AS THEY DID IN THE CIVIL WAR, BUT IT ALL DEPENDS ON YOU!!"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"AS THEY DID IN THE CIVIL WAR, BUT IT ALL DEPENDS ON YOU!!");strcat(buf,"\n");fputs(buf,fh); };
    // 01320 PRINT
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };
    // 01330 PRINT "THE OBJECT OF THE GAME IS TO WIN AS MANY BATTLES AS ";
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"THE OBJECT OF THE GAME IS TO WIN AS MANY BATTLES AS ");fputs(buf,fh); };
    // 01340 PRINT "POSSIBLE."
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"POSSIBLE.");strcat(buf,"\n");fputs(buf,fh); };
    // 01350 PRINT
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };
    // 01360 PRINT "YOUR CHOICES FOR DEFENSIVE STRATEGY ARE:"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"YOUR CHOICES FOR DEFENSIVE STRATEGY ARE:");strcat(buf,"\n");fputs(buf,fh); };
    // 01370 PRINT "        (1) ARTILLERY ATTACK"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"        (1) ARTILLERY ATTACK");strcat(buf,"\n");fputs(buf,fh); };
    // 01380 PRINT "        (2) FORTIFICATION AGAINST FRONTAL ATTACK"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"        (2) FORTIFICATION AGAINST FRONTAL ATTACK");strcat(buf,"\n");fputs(buf,fh); };
    // 01390 PRINT "        (3) FORTIFICATION AGAINST FLANKING MANEUVERS"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"        (3) FORTIFICATION AGAINST FLANKING MANEUVERS");strcat(buf,"\n");fputs(buf,fh); };
    // 01400 PRINT "        (4) FALLING BACK"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"        (4) FALLING BACK");strcat(buf,"\n");fputs(buf,fh); };
    // 01410 PRINT " YOUR CHOICES FOR OFFENSIVE STRATEGY ARE:"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf," YOUR CHOICES FOR OFFENSIVE STRATEGY ARE:");strcat(buf,"\n");fputs(buf,fh); };
    // 01420 PRINT "        (1) ARTILLERY ATTACK"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"        (1) ARTILLERY ATTACK");strcat(buf,"\n");fputs(buf,fh); };
    // 01430 PRINT "        (2) FRONTAL ATTACK"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"        (2) FRONTAL ATTACK");strcat(buf,"\n");fputs(buf,fh); };
    // 01440 PRINT "        (3) FLANKING MANEUVERS"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"        (3) FLANKING MANEUVERS");strcat(buf,"\n");fputs(buf,fh); };
    // 01450 PRINT "        (4) ENCIRCLEMENT"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"        (4) ENCIRCLEMENT");strcat(buf,"\n");fputs(buf,fh); };
    // 01460 PRINT "YOU MAY SURRENDER BY TYPING A '5' FOR YOUR STRATEGY."
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"YOU MAY SURRENDER BY TYPING A '5' FOR YOUR STRATEGY.");strcat(buf,"\n");fputs(buf,fh); };
    // 01470 PRINT 
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };
    // 01480 PRINT 
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };
    // 01490 PRINT 
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };

  Lbl_01500:
    // 01500 PRINT "ARE THERE TWO GENERALS PRESENT ";
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"ARE THERE TWO GENERALS PRESENT ");fputs(buf,fh); };

  Lbl_01510:
    // 01510 PRINT "(ANSWER YES OR NO)";
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"(ANSWER YES OR NO)");fputs(buf,fh); };
    // 01520 INPUT B$
    // Start of Basic INPUT statement 01520
    {
        int numargs=1;
        char *args[numargs+1];
        bool echoeol=true;
        while(true){
            fprintf(stdout," ? ");
            int err=input(args,numargs,echoeol);
            if(err==0x03) break;
            if(err || 
                (err += b2c_strtos(&B_str,args,0)) ){
                 printf("?Redo from start\n");
            }else{
                break;
            };
        };
    }; // End of Basic INPUT statement 01520
    // 01530 IF B$="YES" THEN 1580
    if(strcmp(B_str,"YES")==0)goto Lbl_01580;
    // 01540 IF B$ <> "NO" THEN 1510
    if(strcmp(B_str,"NO")!=0)goto Lbl_01510;
    // 01550 PRINT 
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };
    // 01560 PRINT "YOU ARE THE CONFEDERACY.   GOOD LUCK!"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"YOU ARE THE CONFEDERACY.   GOOD LUCK!");strcat(buf,"\n");fputs(buf,fh); };
    // 01570 PRINT
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };

  Lbl_01580:
    // 01580 LET D=1
    D_int = 1;
    // 01590 IF B$ <> "YES" THEN 1610
    if(strcmp(B_str,"YES")!=0)goto Lbl_01610;
    // 01600 LET D=2
    D_int = 2;

  Lbl_01610:
    // 01610 PRINT "SELECT A BATTLE BY TYPING A NUMBER FROM 1 TO 14 ON"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"SELECT A BATTLE BY TYPING A NUMBER FROM 1 TO 14 ON");strcat(buf,"\n");fputs(buf,fh); };
    // 01620 PRINT "REQUEST.  TYPE ANY OTHER NUMBER TO END THE SIMULATION."
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"REQUEST.  TYPE ANY OTHER NUMBER TO END THE SIMULATION.");strcat(buf,"\n");fputs(buf,fh); };
    // 01630 PRINT "BUT '0' BRINGS BACK EXACT PREVIOUS BATTLE SITUATION"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"BUT '0' BRINGS BACK EXACT PREVIOUS BATTLE SITUATION");strcat(buf,"\n");fputs(buf,fh); };
    // 01640 PRINT "ALLOWING YOU TO REPLAY IT"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"ALLOWING YOU TO REPLAY IT");strcat(buf,"\n");fputs(buf,fh); };
    // 01650 PRINT
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };
    // 01660 PRINT "NOTE: A NEGATIVE FOOD$ ENTRY CAUSES THE PROGRAM TO "
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"NOTE: A NEGATIVE FOOD$ ENTRY CAUSES THE PROGRAM TO ");strcat(buf,"\n");fputs(buf,fh); };
    // 01670 PRINT "USE THE ENTRIES FROM THE PREVIOUS BATTLE"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"USE THE ENTRIES FROM THE PREVIOUS BATTLE");strcat(buf,"\n");fputs(buf,fh); };
    // 01680 PRINT
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };
    // 01690 PRINT "AFTER REQUESTING A BATTLE, DO YOU WISH ";
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"AFTER REQUESTING A BATTLE, DO YOU WISH ");fputs(buf,fh); };
    // 01700 PRINT "BATTLE DESCRIPTIONS ";
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"BATTLE DESCRIPTIONS ");fputs(buf,fh); };

  Lbl_01710:
    // 01710 PRINT "(ANSWER YES OR NO)";
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"(ANSWER YES OR NO)");fputs(buf,fh); };
    // 01720 INPUT X$
    // Start of Basic INPUT statement 01720
    {
        int numargs=1;
        char *args[numargs+1];
        bool echoeol=true;
        while(true){
            fprintf(stdout," ? ");
            int err=input(args,numargs,echoeol);
            if(err==0x03) break;
            if(err || 
                (err += b2c_strtos(&X_str,args,0)) ){
                 printf("?Redo from start\n");
            }else{
                break;
            };
        };
    }; // End of Basic INPUT statement 01720
    // 01730 IF X$="YES" THEN 1840
    if(strcmp(X_str,"YES")==0)goto Lbl_01840;
    // 01740 IF X$ <> "NO" THEN 1710
    if(strcmp(X_str,"NO")!=0)goto Lbl_01710;
    // 01750 L=0
    L_int = 0;
    // 01760 W=0
    W_int = 0;
    // 01770 R1=0
    R1_int = 0;
    // 01780 Q1=0
    Q1_int = 0;
    // 01790 M3=0
    M3_int = 0;
    // 01800 M4=0
    M4_int = 0;
    // 01810 P1=0
    P1_int = 0;
    // 01820 P2=0
    P2_int = 0;
    // 01830 T1=0
    T1_int = 0;

  Lbl_01840:
    // 01840 T2=0
    T2_int = 0;
    // 01850 F(2)=0
    F_int_arr[2] = 0;
    // 01860 H(2)=0
    H_int_arr[2] = 0;
    // 01870 B(2)=0
    B_int_arr[2] = 0;
    // 01880 R2=0
    R2_int = 0;
    // 01890 Q2=0
    Q2_int = 0;
    // 01900 C6=0
    C6_int = 0;
    // 01910 F=0
    F_int_arr[0] = 0;
    // 01920 W0=0
    W0_int = 0;
    // 01930 Y=0
    Y_int = 0;
    // 01940 Y2=0
    Y2_int = 0;
    // 01950 U=0
    U_int = 0;
    // 01960 U2=0
    U2_int = 0;
    // 01970 PRINT 
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };
    // 01980 PRINT 
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };

  Lbl_01990:
    // 01990 PRINT
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };
    // 02000 PRINT "WHICH BATTLE DO YOU WISH TO SIMULATE";
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"WHICH BATTLE DO YOU WISH TO SIMULATE");fputs(buf,fh); };
    // 02010 INPUT A
    // Start of Basic INPUT statement 02010
    {
        int numargs=1;
        char *args[numargs+1];
        bool echoeol=true;
        while(true){
            fprintf(stdout," ? ");
            int err=input(args,numargs,echoeol);
            if(err==0x03) break;
            if(err || 
                (err += b2c_strtoi(&A_int,args,0)) ){
                 printf("?Redo from start\n");
            }else{
                break;
            };
        };
    }; // End of Basic INPUT statement 02010
    // 02020 IF A <> 0 THEN 2040
    if(A_int!=0)goto Lbl_02040;
    // 02030 IF R <> 0 THEN 2350
    if(R_int!=0)goto Lbl_02350;

  Lbl_02040:
    // 02040 IF A <=0 THEN 4040
    if(A_int<=0)goto Lbl_04040;
    // 02050 IF A >= 15 THEN 4040
    if(A_int>=15)goto Lbl_04040;
    // 02060 LET C$=C$(A)
    GLBpStr=C_str_arr[A_int];
    C_str_arr[0] = (GLBpStr==GLB_StrCatBuf)?strdup(GLBpStr):GLBpStr;
    // 02070 LET M1=M1(A)
    M1_int_arr[0] = M1_int_arr[A_int];
    // 02080 LET M2=M2(A)
    M2_int_arr[0] = M2_int_arr[A_int];
    // 02090 LET C1=C1(A)
    C1_int_arr[0] = C1_int_arr[A_int];
    // 02100 LET C2=C2(A)
    C2_int_arr[0] = C2_int_arr[A_int];
    // 02110 LET M=M(A)
    M_int_arr[0] = M_int_arr[A_int];
    // 02120 LET U=0
    U_int = 0;
    // 02130 REM  INFLATION CALC
    // 02140 LET I1=10+(L-W)*2
    I1_int = 10+(L_int-W_int)*2;
    // 02150 LET I2=10+(W-L)*2
    I2_int = 10+(W_int-L_int)*2;
    // 02160 REM - MONEY AVAILABLE
    // 02170 LET D(1)=100*INT((M1*(100-I1)/2000)*(1+(R1-Q1)/(R1+1))+.5)
    D_int = 100*INT((M1_int_arr[0]*(100-I1_int)/2000)*(1+(R1_int-Q1_int)/(R1_int+1))+0.5);
    // 02180 LET D(2)=100*INT(M2*(100-I2)/2000+.5)
    D_int = 100*INT(M2_int_arr[0]*(100-I2_int)/2000+0.5);
    // 02190 IF B$ <> "YES" THEN 2210
    if(strcmp(B_str,"YES")!=0)goto Lbl_02210;
    // 02200 LET D(2)=100*INT((M2*(100-I2)/2000)*(1+(R2-Q2)/(R2+1))+.5)
    D_int = 100*INT((M2_int_arr[0]*(100-I2_int)/2000)*(1+(R2_int-Q2_int)/(R2_int+1))+0.5);

  Lbl_02210:
    // 02210 REM - MEN   AVAILABLE
    // 02220 LET M5=INT(M1*(1+(P1-T1)/(M3+1)))
    M5_int = INT(M1_int_arr[0]*(1+(P1_int-T1_int)/(M3_int+1)));
    // 02230 LET M6=INT(M2*(1+(P2-T2)/(M4+1)))
    M6_int = INT(M2_int_arr[0]*(1+(P2_int-T2_int)/(M4_int+1)));
    // 02240 LET F1=5*M1/6
    F1_int = 5*M1_int_arr[0]/6;
    // 02250 PRINT 
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };
    // 02260 PRINT 
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };
    // 02270 PRINT 
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };
    // 02280 PRINT 
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };
    // 02290 PRINT
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };
    // 02300 PRINT "THIS IS THE BATTLE OF ";C$
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"THIS IS THE BATTLE OF "); strcat(buf,C_str_arr[0]);strcat(buf,"\n");fputs(buf,fh); };
    // 02310 IF X$="NO" THEN 2360
    if(strcmp(X_str,"NO")==0)goto Lbl_02360;
    // 02320 IF A>11 THEN 2340
    if(A_int>11)goto Lbl_02340;
    // 02330 ON A GOTO 4460,4500,4530,4570,4610,4640,4670,4700,4730,4760,4800
    switch((int)(A_int)){
        case 1: goto Lbl_04460;
        case 2: goto Lbl_04500;
        case 3: goto Lbl_04530;
        case 4: goto Lbl_04570;
        case 5: goto Lbl_04610;
        case 6: goto Lbl_04640;
        case 7: goto Lbl_04670;
        case 8: goto Lbl_04700;
        case 9: goto Lbl_04730;
        case 10: goto Lbl_04760;
        case 11: goto Lbl_04800;
        default: break; 
    };

  Lbl_02340:
    // 02340 ON A-11 GOTO 4830,4860,4890
    switch((int)(A_int-11)){
        case 1: goto Lbl_04830;
        case 2: goto Lbl_04860;
        case 3: goto Lbl_04890;
        default: break; 
    };

  Lbl_02350:
    // 02350 PRINT C$" INSTANT REPLAY"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256); strcat(buf,C_str_arr[0]);strcat(buf," INSTANT REPLAY");strcat(buf,"\n");fputs(buf,fh); };

  Lbl_02360:
    // 02360 PRINT
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };
    // 02370 PRINT " ","CONFEDERACY"," UNION"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf," ");strcat(buf,"CONFEDERACY");strcat(buf," UNION");strcat(buf,"\n");fputs(buf,fh); };
    // 02380 PRINT "MEN"," "M5," "M6
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"MEN");strcat(buf," "); b2c_INT(buf,M5_int);strcat(buf," "); b2c_INT(buf,M6_int);strcat(buf,"\n");fputs(buf,fh); };
    // 02390 PRINT "MONEY","$";D(1),"$";D(2)
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"MONEY");strcat(buf,"$"); b2c_INT(buf,D_int);strcat(buf,"$"); b2c_INT(buf,D_int);strcat(buf,"\n");fputs(buf,fh); };
    // 02400 PRINT "INFLATION"," ";I1+15;"%"," ";I2;"%"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"INFLATION");strcat(buf," "); b2c_INT(buf,I1_int+15);strcat(buf,"%%");strcat(buf," "); b2c_INT(buf,I2_int);strcat(buf,"%%");strcat(buf,"\n");fputs(buf,fh); };
    // 02410 PRINT
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };
    // 02420 REM - ONLY IN PRINTOUT IS CONFED INFLATION = I1+15%
    // 02430 REM - IF TWO GENERALS, INPUT CONFED. FIRST
    // 02440 FOR I=1 TO D
    for(I_int=1;I_int<=D_int;I_int++){
        // 02450 IF B$ <> "YES" THEN 2480
        if(strcmp(B_str,"YES")!=0)goto Lbl_02480;
        // 02460 IF I=2 THEN 2480
        if(I_int==2)goto Lbl_02480;
        // 02470 PRINT "CONFEDERATE GENERAL---";
        { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"CONFEDERATE GENERAL---");fputs(buf,fh); };

  Lbl_02480:
        // 02480 PRINT "HOW MUCH DO YOU WISH TO SPEND FOR"
        { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"HOW MUCH DO YOU WISH TO SPEND FOR");strcat(buf,"\n");fputs(buf,fh); };

  Lbl_02490:
        // 02490 PRINT " - FOOD......";
        { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf," - FOOD......");fputs(buf,fh); };
        // 02500 INPUT F
        // Start of Basic INPUT statement 02500
        {
            int numargs=1;
            char *args[numargs+1];
            bool echoeol=true;
            while(true){
                fprintf(stdout," ? ");
                int err=input(args,numargs,echoeol);
                if(err==0x03) break;
                if(err || 
                    (err += b2c_strtoi(&F_int_arr[0],args,0)) ){
                     printf("?Redo from start\n");
                }else{
                    break;
                };
            };
        }; // End of Basic INPUT statement 02500
        // 02510 IF F >= 0 THEN 2580
        if(F_int_arr[0]>=0)goto Lbl_02580;
        // 02520 IF R1 <> 0 THEN 2550
        if(R1_int!=0)goto Lbl_02550;
        // 02530 PRINT "NO PREVIOUS ENTRIES"
        { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"NO PREVIOUS ENTRIES");strcat(buf,"\n");fputs(buf,fh); };
        // 02540 GOTO 2490
        goto Lbl_02490;

  Lbl_02550:
        // 02550 PRINT "ASSUME YOU WANT TO KEEP SAME ALLOCATIONS"
        { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"ASSUME YOU WANT TO KEEP SAME ALLOCATIONS");strcat(buf,"\n");fputs(buf,fh); };
        // 02560 PRINT
        { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };
        // 02570 GOTO 2730
        goto Lbl_02730;

  Lbl_02580:
        // 02580 LET F(I)=F
        F_int_arr[I_int] = F_int_arr[0];

  Lbl_02590:
        // 02590 PRINT " - SALARIES..";
        { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf," - SALARIES..");fputs(buf,fh); };
        // 02600 INPUT H(I)
        // Start of Basic INPUT statement 02600
        {
            int numargs=1;
            char *args[numargs+1];
            bool echoeol=true;
            while(true){
                fprintf(stdout," ? ");
                int err=input(args,numargs,echoeol);
                if(err==0x03) break;
                if(err || 
                    (err += b2c_strtoi(&H_int_arr[I_int],args,0)) ){
                     printf("?Redo from start\n");
                }else{
                    break;
                };
            };
        }; // End of Basic INPUT statement 02600
        // 02610 LET N=1
        N_int = 1;
        // 02620 IF H(I)<0 THEN 2710
        if(H_int_arr[I_int]<0)goto Lbl_02710;

  Lbl_02630:
        // 02630 PRINT " - AMMUNITION";
        { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf," - AMMUNITION");fputs(buf,fh); };
        // 02640 INPUT B(I)
        // Start of Basic INPUT statement 02640
        {
            int numargs=1;
            char *args[numargs+1];
            bool echoeol=true;
            while(true){
                fprintf(stdout," ? ");
                int err=input(args,numargs,echoeol);
                if(err==0x03) break;
                if(err || 
                    (err += b2c_strtoi(&B_int_arr[I_int],args,0)) ){
                     printf("?Redo from start\n");
                }else{
                    break;
                };
            };
        }; // End of Basic INPUT statement 02640
        // 02650 LET N=2
        N_int = 2;
        // 02660 IF B(I)<0 THEN 2710
        if(B_int_arr[I_int]<0)goto Lbl_02710;
        // 02670 PRINT
        { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };
        // 02680 IF F(I)+H(I)+B(I) <= D(I) THEN 2730
        if(F_int_arr[I_int]+H_int_arr[I_int]+B_int_arr[I_int]<=D_int)goto Lbl_02730;
        // 02690 PRINT "THINK AGAIN! YOU HAVE ONLY $"D(I)
        { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"THINK AGAIN! YOU HAVE ONLY $"); b2c_INT(buf,D_int);strcat(buf,"\n");fputs(buf,fh); };
        // 02700 GOTO 2490
        goto Lbl_02490;

  Lbl_02710:
        // 02710 PRINT "NEGATIVE VALUES NOT ALLOWED."
        { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"NEGATIVE VALUES NOT ALLOWED.");strcat(buf,"\n");fputs(buf,fh); };
        // 02720 ON N GOTO 2590,2630
        switch((int)(N_int)){
            case 1: goto Lbl_02590;
            case 2: goto Lbl_02630;
            default: break; 
        };

  Lbl_02730:
        // 02730 IF B$ <> "YES" THEN 2770
        if(strcmp(B_str,"YES")!=0)goto Lbl_02770;
        // 02740 IF I=2 THEN 2770
        if(I_int==2)goto Lbl_02770;
        // 02750 PRINT "UNION GENERAL---";
        { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"UNION GENERAL---");fputs(buf,fh); };
        // 02760 NEXT I
        int dummy_2760=0; // Ignore this line.
    }; // End-For(I_int)

  Lbl_02770:
    // 02770 FOR Z=1 TO D
    for(Z_int=1;Z_int<=D_int;Z_int++){
        // 02780 IF B$ <> "YES" THEN 2840
        if(strcmp(B_str,"YES")!=0)goto Lbl_02840;
        // 02790 ON Z GOTO 2800,2820
        switch((int)(Z_int)){
            case 1: goto Lbl_02800;
            case 2: goto Lbl_02820;
            default: break; 
        };

  Lbl_02800:
        // 02800 PRINT "CONFEDERATE ";
        { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"CONFEDERATE ");fputs(buf,fh); };
        // 02810 GOTO 2840
        goto Lbl_02840;

  Lbl_02820:
        // 02820 PRINT "      UNION ";
        { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"      UNION ");fputs(buf,fh); };
        // 02830 REM - FIND MORALE

  Lbl_02840:
        // 02840 LET O=((2*F(Z)^2+H(Z)^2)/F1^2+1)
        O_int = ((2*IPower(F_int_arr[Z_int],2)+IPower(H_int_arr[Z_int],2))/IPower(F1_int,2)+1);
        // 02850 IF O<10 THEN 2880
        if(O_int<10)goto Lbl_02880;
        // 02860 PRINT "MORALE IS HIGH"
        { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"MORALE IS HIGH");strcat(buf,"\n");fputs(buf,fh); };
        // 02870 GOTO 2920
        goto Lbl_02920;

  Lbl_02880:
        // 02880 IF O<5 THEN 2910
        if(O_int<5)goto Lbl_02910;
        // 02890 PRINT "MORALE IS FAIR"
        { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"MORALE IS FAIR");strcat(buf,"\n");fputs(buf,fh); };
        // 02900 GOTO 2920
        goto Lbl_02920;

  Lbl_02910:
        // 02910 PRINT "MORALE IS POOR"
        { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"MORALE IS POOR");strcat(buf,"\n");fputs(buf,fh); };

  Lbl_02920:
        // 02920 IF B$ <> "YES" THEN 2980
        if(strcmp(B_str,"YES")!=0)goto Lbl_02980;
        // 02930 LET O(Z)=O
        O_int = O_int;
        // 02940 NEXT Z
        int dummy_2940=0; // Ignore this line.
    }; // End-For(Z_int)
    // 02950 LET O2=O(2)
    O2_int = O_int;
    // 02960 LET O=O(1)
    O_int = O_int;
    // 02970 PRINT "CONFEDERATE GENERAL---";
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"CONFEDERATE GENERAL---");fputs(buf,fh); };

  Lbl_02980:
    // 02980 REM - ACTUAL OFF/DEF BATTLE SITUATION
    // 02990 IF M <> 3 THEN 3020
    if(M_int_arr[0]!=3)goto Lbl_03020;
    // 03000 PRINT "YOU ARE ON THE OFFENSIVE"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"YOU ARE ON THE OFFENSIVE");strcat(buf,"\n");fputs(buf,fh); };
    // 03010 GOTO 3060
    goto Lbl_03060;

  Lbl_03020:
    // 03020 IF M <> 1 THEN 3050
    if(M_int_arr[0]!=1)goto Lbl_03050;
    // 03030 PRINT "YOU ARE ON THE DEFENSIVE"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"YOU ARE ON THE DEFENSIVE");strcat(buf,"\n");fputs(buf,fh); };
    // 03040 GOTO 3060
    goto Lbl_03060;

  Lbl_03050:
    // 03050 PRINT "BOTH SIDES ARE ON THE OFFENSIVE "
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"BOTH SIDES ARE ON THE OFFENSIVE ");strcat(buf,"\n");fputs(buf,fh); };

  Lbl_03060:
    // 03060 PRINT
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };
    // 03070 REM - CHOOSE STRATEGIES
    // 03080 IF B$ <> "YES" THEN 3130
    if(strcmp(B_str,"YES")!=0)goto Lbl_03130;
    // 03090 FOR I=1 TO 2
    for(I_int=1;I_int<=2;I_int++){
        // 03100 ON I GOTO 3110,3140
        switch((int)(I_int)){
            case 1: goto Lbl_03110;
            case 2: goto Lbl_03140;
            default: break; 
        };

  Lbl_03110:
        // 03110 PRINT "CONFEDERATE STRATEGY ";
        { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"CONFEDERATE STRATEGY ");fputs(buf,fh); };
        // 03120 GOTO 3140
        goto Lbl_03140;

  Lbl_03130:
        // 03130 PRINT "YOUR STRATEGY ";
        { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"YOUR STRATEGY ");fputs(buf,fh); };

  Lbl_03140:
        // 03140 INPUT Y
        // Start of Basic INPUT statement 03140
        {
            int numargs=1;
            char *args[numargs+1];
            bool echoeol=true;
            while(true){
                fprintf(stdout," ? ");
                int err=input(args,numargs,echoeol);
                if(err==0x03) break;
                if(err || 
                    (err += b2c_strtoi(&Y_int,args,0)) ){
                     printf("?Redo from start\n");
                }else{
                    break;
                };
            };
        }; // End of Basic INPUT statement 03140
        // 03150 IF ABS(Y-3)<3 THEN 3180
        if(ABS(Y_int-3)<3)goto Lbl_03180;
        // 03160 PRINT "STRATEGY";Y;"NOT ALLOWED."
        { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"STRATEGY"); b2c_INT(buf,Y_int);strcat(buf,"NOT ALLOWED.");strcat(buf,"\n");fputs(buf,fh); };
        // 03170 GOTO 3130
        goto Lbl_03130;

  Lbl_03180:
        // 03180 IF B$="YES" THEN 3220
        if(strcmp(B_str,"YES")==0)goto Lbl_03220;
        // 03190 IF Y=5 THEN 4020
        if(Y_int==5)goto Lbl_04020;
        // 03200 GOSUB 4930
        Routine_04930();
        // 03210 GOTO 3390
        goto Lbl_03390;

  Lbl_03220:
        // 03220 IF I=2 THEN 3260
        if(I_int==2)goto Lbl_03260;
        // 03230 LET Y1=Y
        Y1_int = Y_int;

  Lbl_03240:
        // 03240 PRINT "UNION STRATEGY ";
        { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"UNION STRATEGY ");fputs(buf,fh); };
        // 03250 NEXT I
        int dummy_3250=0; // Ignore this line.
    }; // End-For(I_int)

  Lbl_03260:
    // 03260 LET Y2=Y
    Y2_int = Y_int;
    // 03270 LET Y=Y1
    Y_int = Y1_int;
    // 03280 IF Y2=5 THEN 3240
    if(Y2_int==5)goto Lbl_03240;
    // 03290 REM 
    // 03300 LET C6=(2*C2/5)*(1+1/(2*(ABS(Y2-Y)+1)))
    C6_int = (2*C2_int_arr[0]/5)*(1+1/(2*(ABS(Y2_int-Y_int)+1)));
    // 03310 LET C6=C6*(1.28+(5*M2/6)/(B(2)+1))
    C6_int = C6_int*(1.28+(5*M2_int_arr[0]/6)/(B_int_arr[2]+1));
    // 03320 LET C6=INT(C6*(1+1/O2)+.5)
    C6_int = INT(C6_int*(1+1/O2_int)+0.5);
    // 03330 REM - IF LOSS > MEN PRESENT, RESCALE LOSSES
    // 03340 LET E2=100/O2
    E2_int = 100/O2_int;
    // 03350 IF INT(C6+E2)<M6 THEN 3430
    if(INT(C6_int+E2_int)<M6_int)goto Lbl_03430;
    // 03360 LET C6=INT(13*M6/20)
    C6_int = INT(13*M6_int/20);
    // 03370 LET E2=7*C6/13
    E2_int = 7*C6_int/13;
    // 03380 LET U2=1
    U2_int = 1;

  Lbl_03390:
    // 03390 REM - CALCULATE SIMULATED LOSSES
    // 03400 PRINT
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };
    // 03410 PRINT 
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };
    // 03420 PRINT 
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };

  Lbl_03430:
    // 03430 PRINT ,"CONFEDERACY","UNION"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"CONFEDERACY");strcat(buf,"UNION");strcat(buf,"\n");fputs(buf,fh); };
    // 03440 LET C5=(2*C1/5)*(1+1/(2*(ABS(Y2-Y)+1)))
    C5_int = (2*C1_int_arr[0]/5)*(1+1/(2*(ABS(Y2_int-Y_int)+1)));
    // 03450 LET C5=INT(C5*(1+1/O)*(1.28+F1/(B(1)+1))+.5)
    C5_int = INT(C5_int*(1+1/O_int)*(1.28+F1_int/(B_int_arr[1]+1))+0.5);
    // 03460 LET E=100/O
    E_int = 100/O_int;
    // 03470 IF C5+100/O<M1*(1+(P1-T1)/(M3+1)) THEN 3510
    if(C5_int+100/O_int<M1_int_arr[0]*(1+(P1_int-T1_int)/(M3_int+1)))goto Lbl_03510;
    // 03480 LET C5=INT(13*M1/20*(1+(P1-T1)/(M3+1)))
    C5_int = INT(13*M1_int_arr[0]/20*(1+(P1_int-T1_int)/(M3_int+1)));
    // 03490 LET E=7*C5/13
    E_int = 7*C5_int/13;
    // 03500 LET U=1
    U_int = 1;

  Lbl_03510:
    // 03510 IF D=1 THEN 3750
    if(D_int==1)goto Lbl_03750;

  Lbl_03520:
    // 03520 PRINT "CASUALTIES",C5,C6
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"CASUALTIES"); b2c_INT(buf,C5_int); b2c_INT(buf,C6_int);strcat(buf,"\n");fputs(buf,fh); };
    // 03530 PRINT "DESERTIONS",INT(E),INT(E2)
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"DESERTIONS");b2c_INT(buf,INT(E_int));b2c_INT(buf,INT(E2_int));strcat(buf,"\n");fputs(buf,fh); };
    // 03540 PRINT
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };
    // 03550 IF B$ <> "YES" THEN 3590
    if(strcmp(B_str,"YES")!=0)goto Lbl_03590;
    // 03560 PRINT "COMPARED TO THE ACTUAL CASUALTIES AT "C$
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"COMPARED TO THE ACTUAL CASUALTIES AT "); strcat(buf,C_str_arr[0]);strcat(buf,"\n");fputs(buf,fh); };
    // 03570 PRINT "CONFEDERATE:"INT(100*(C5/C1)+.5)"% OF THE ORIGINAL"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"CONFEDERATE:");b2c_INT(buf,INT(100*(C5_int/C1_int_arr[0])+0.5));strcat(buf,"%% OF THE ORIGINAL");strcat(buf,"\n");fputs(buf,fh); };
    // 03580 PRINT "UNION:      "INT(100*(C6/C2)+.5)"% OF THE ORIGINAL"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"UNION:      ");b2c_INT(buf,INT(100*(C6_int/C2_int_arr[0])+0.5));strcat(buf,"%% OF THE ORIGINAL");strcat(buf,"\n");fputs(buf,fh); };

  Lbl_03590:
    // 03590 PRINT
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };
    // 03600 REM - 1 WHO ONE
    // 03610 IF U <> 1 THEN 3630
    if(U_int!=1)goto Lbl_03630;
    // 03620 IF U2=1 THEN 3710
    if(U2_int==1)goto Lbl_03710;

  Lbl_03630:
    // 03630 IF U=1 THEN 3670
    if(U_int==1)goto Lbl_03670;
    // 03640 IF U2=1 THEN 3690
    if(U2_int==1)goto Lbl_03690;
    // 03650 IF C5+E=C6+E2 THEN 3710
    if(C5_int+E_int==C6_int+E2_int)goto Lbl_03710;
    // 03660 IF C5+E<C6+E2 THEN 3690
    if(C5_int+E_int<C6_int+E2_int)goto Lbl_03690;

  Lbl_03670:
    // 03670 PRINT "THE UNION WINS "C$
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"THE UNION WINS "); strcat(buf,C_str_arr[0]);strcat(buf,"\n");fputs(buf,fh); };
    // 03680 GOTO 3790
    goto Lbl_03790;

  Lbl_03690:
    // 03690 PRINT "THE CONFEDERACY WINS "C$
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"THE CONFEDERACY WINS "); strcat(buf,C_str_arr[0]);strcat(buf,"\n");fputs(buf,fh); };
    // 03700 GOTO 3840
    goto Lbl_03840;

  Lbl_03710:
    // 03710 PRINT "BATTLE OUTCOME UNRESOLVED"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"BATTLE OUTCOME UNRESOLVED");strcat(buf,"\n");fputs(buf,fh); };
    // 03720 LET W0=W0+1
    W0_int = W0_int+1;
    // 03730 IF A=0 THEN 3980
    if(A_int==0)goto Lbl_03980;
    // 03740 GOTO 3860
    goto Lbl_03860;

  Lbl_03750:
    // 03750 LET C6=INT(17*C2*C1/(C5*20))
    C6_int = INT(17*C2_int_arr[0]*C1_int_arr[0]/(C5_int*20));
    // 03760 LET E2=5*O
    E2_int = 5*O_int;
    // 03770 GOTO 3520
    goto Lbl_03520;
    // 03780 REM - FIND WHO WON

  Lbl_03790:
    // 03790 IF A=0 THEN 3980
    if(A_int==0)goto Lbl_03980;
    // 03800 LET L=L+1
    L_int = L_int+1;
    // 03810 GOTO 3860
    goto Lbl_03860;
    // 03820 REM - CUMULATIVE BATTLE FACTORS WHICH ALTER HISTORICAL
    // 03830 REM  RESOURCES AVAILABLE.IF A REPLAY DON'T UPDATE.

  Lbl_03840:
    // 03840 IF A=0 THEN 3980
    if(A_int==0)goto Lbl_03980;
    // 03850 LET W=W+1
    W_int = W_int+1;

  Lbl_03860:
    // 03860 LET T1=T1+C5+E
    T1_int = T1_int+C5_int+E_int;
    // 03870 LET T2=T2+C6+E2
    T2_int = T2_int+C6_int+E2_int;
    // 03880 LET P1=P1+C1
    P1_int = P1_int+C1_int_arr[0];
    // 03890 LET P2=P2+C2
    P2_int = P2_int+C2_int_arr[0];
    // 03900 LET Q1=Q1+(F(1)+H(1)+B(1))
    Q1_int = Q1_int+(F_int_arr[1]+H_int_arr[1]+B_int_arr[1]);
    // 03910 LET Q2=Q2+(F(2)+H(2)+B(2))
    Q2_int = Q2_int+(F_int_arr[2]+H_int_arr[2]+B_int_arr[2]);
    // 03920 LET R1=R1+M1*(100-I1)/20
    R1_int = R1_int+M1_int_arr[0]*(100-I1_int)/20;
    // 03930 LET R2=R2+M2*(100-I2)/20
    R2_int = R2_int+M2_int_arr[0]*(100-I2_int)/20;
    // 03940 LET M3=M3+M1
    M3_int = M3_int+M1_int_arr[0];
    // 03950 LET M4=M4+M2
    M4_int = M4_int+M2_int_arr[0];
    // 03960 GOSUB 5140
    Routine_05140();
    // 03970 U=0
    U_int = 0;

  Lbl_03980:
    // 03980 U2=0
    U2_int = 0;
    // 03990 PRINT "---------------"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"---------------");strcat(buf,"\n");fputs(buf,fh); };
    // 04000 GOTO 1990
    goto Lbl_01990;
    // 04010 REM------FINISH OFF

  Lbl_04020:
    // 04020 PRINT "THE CONFEDERACY HAS SURRENDERED"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"THE CONFEDERACY HAS SURRENDERED");strcat(buf,"\n");fputs(buf,fh); };
    // 04030 GOTO 4040
    goto Lbl_04040;

  Lbl_04040:
    // 04040 PRINT
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };
    // 04050 PRINT "THE CONFEDERACY ";
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"THE CONFEDERACY ");fputs(buf,fh); };
    // 04060 PRINT "HAS WON "W" BATTLES AND LOST "L
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"HAS WON "); b2c_INT(buf,W_int);strcat(buf," BATTLES AND LOST "); b2c_INT(buf,L_int);strcat(buf,"\n");fputs(buf,fh); };
    // 04070 IF Y=5 THEN 4130
    if(Y_int==5)goto Lbl_04130;
    // 04080 IF Y2=5 THEN 4110
    if(Y2_int==5)goto Lbl_04110;
    // 04090 IF W <= L THEN 4130
    if(W_int<=L_int)goto Lbl_04130;
    // 04100 IF Y=5 THEN 4130
    if(Y_int==5)goto Lbl_04130;

  Lbl_04110:
    // 04110 PRINT "THE CONFEDERACY HAS WON THE WAR"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"THE CONFEDERACY HAS WON THE WAR");strcat(buf,"\n");fputs(buf,fh); };
    // 04120 GOTO 4140
    goto Lbl_04140;

  Lbl_04130:
    // 04130 PRINT "THE UNION HAS WON THE WAR"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"THE UNION HAS WON THE WAR");strcat(buf,"\n");fputs(buf,fh); };

  Lbl_04140:
    // 04140 PRINT
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };
    // 04150 IF R1=0 THEN 4290
    if(R1_int==0)goto Lbl_04290;
    // 04160 PRINT "FOR THE "W+L+W0" BATTLES FOUGHT (EXCUDING RERUNS)"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"FOR THE "); b2c_INT(buf,W_int+L_int+W0_int);strcat(buf," BATTLES FOUGHT (EXCUDING RERUNS)");strcat(buf,"\n");fputs(buf,fh); };
    // 04170 PRINT " "," "," ";
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf," ");strcat(buf," ");strcat(buf," ");fputs(buf,fh); };
    // 04180 PRINT "CONFEDERACY"," UNION"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"CONFEDERACY");strcat(buf," UNION");strcat(buf,"\n");fputs(buf,fh); };
    // 04190 PRINT "HISTORICAL LOSSES",INT(P1+.5),INT(P2+.5)
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"HISTORICAL LOSSES");b2c_INT(buf,INT(P1_int+0.5));b2c_INT(buf,INT(P2_int+0.5));strcat(buf,"\n");fputs(buf,fh); };
    // 04200 PRINT "SIMULATED LOSSES",INT(T1+.5),INT(T2+.5)
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"SIMULATED LOSSES");b2c_INT(buf,INT(T1_int+0.5));b2c_INT(buf,INT(T2_int+0.5));strcat(buf,"\n");fputs(buf,fh); };
    // 04210 PRINT
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };
    // 04220 PRINT "    % OF ORIGINAL",INT(100*(T1/P1)+.5),INT(100*(T2/P2)+.5)
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"    %% OF ORIGINAL");b2c_INT(buf,INT(100*(T1_int/P1_int)+0.5));b2c_INT(buf,INT(100*(T2_int/P2_int)+0.5));strcat(buf,"\n");fputs(buf,fh); };
    // 04230 IF B$="YES" THEN 4290
    if(strcmp(B_str,"YES")==0)goto Lbl_04290;
    // 04240 PRINT
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"\n");fputs(buf,fh); };
    // 04250 PRINT "UNION INTELLIGENCE SUGGESTS THAT THE SOUTH USED "
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"UNION INTELLIGENCE SUGGESTS THAT THE SOUTH USED ");strcat(buf,"\n");fputs(buf,fh); };
    // 04260 PRINT "STRATEGIES 1, 2, 3, 4 IN THE FOLLOWING PERCENTAGES"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"STRATEGIES 1, 2, 3, 4 IN THE FOLLOWING PERCENTAGES");strcat(buf,"\n");fputs(buf,fh); };
    // 04270 PRINT S(1);S2(2);S(3);S(4)
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256); b2c_INT(buf,S_int_arr[1]); b2c_INT(buf,S2_int_arr[2]); b2c_INT(buf,S_int_arr[3]); b2c_INT(buf,S_int_arr[4]);strcat(buf,"\n");fputs(buf,fh); };
    // 04280 REM---------------------------------

  Lbl_04290:
    // 04290 STOP
    exit(1);
    // 04300 REM - HISTORICAL DATA...CAN ADD MORE (STRAT.,ETC) BY INSERTING
    // 04310 REM   DATA STATEMENTS AFTER APPRO. INFO, AND ADJUSTING READ
    // 04320 DATA "BULL RUN",18000,18500,1967,2708,1
    // 04330 DATA "SHILOH",40000.,44894.,10699,13047,3
    // 04340 DATA "SEVEN DAYS",95000.,115000.,20614,15849,3
    // 04350 DATA "SECOND BULL RUN",54000.,63000.,10000,14000,2
    // 04360 DATA "ANTIETAM",40000.,50000.,10000,12000,3
    // 04370 DATA "FREDERICKSBURG",75000.,120000.,5377,12653,1
    // 04380 DATA "MURFREESBORO",38000.,45000.,11000,12000,1
    // 04390 DATA "CHANCELLORSVILLE",32000,90000.,13000,17197,2
    // 04400 DATA "VICKSBURG",50000.,70000.,12000,19000,1
    // 04410 DATA "GETTYSBURG",72500.,85000.,20000,23000,3
    // 04420 DATA "CHICKAMAUGA",66000.,60000.,18000,16000,2
    // 04430 DATA "CHATTANOOGA",37000.,60000.,36700.,5800,2
    // 04440 DATA "SPOTSYLVANIA",62000.,110000.,17723,18000,2
    // 04450 DATA "ATLANTA",65000.,100000.,8500,3700,1

  Lbl_04460:
    // 04460 PRINT "JULY 21, 1861.  GEN. BEAUREGARD, COMMANDING THE SOUTH, MET"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"JULY 21, 1861.  GEN. BEAUREGARD, COMMANDING THE SOUTH, MET");strcat(buf,"\n");fputs(buf,fh); };
    // 04470 PRINT "UNION FORCES WITH GEN. MCDOWELL IN A PREMATURE BATTLE AT"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"UNION FORCES WITH GEN. MCDOWELL IN A PREMATURE BATTLE AT");strcat(buf,"\n");fputs(buf,fh); };
    // 04480 PRINT "BULL RUN. GEN. JACKSON HELPED PUSH BACK THE UNION ATTACK."
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"BULL RUN. GEN. JACKSON HELPED PUSH BACK THE UNION ATTACK.");strcat(buf,"\n");fputs(buf,fh); };
    // 04490 GOTO 2360
    goto Lbl_02360;

  Lbl_04500:
    // 04500 PRINT "APRIL 6-7, 1862.  THE CONFEDERATE SURPRISE ATTACK AT"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"APRIL 6-7, 1862.  THE CONFEDERATE SURPRISE ATTACK AT");strcat(buf,"\n");fputs(buf,fh); };
    // 04510 PRINT "SHILOH FAILED DUE TO POOR ORGANIZATION."
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"SHILOH FAILED DUE TO POOR ORGANIZATION.");strcat(buf,"\n");fputs(buf,fh); };
    // 04520 GOTO 2360
    goto Lbl_02360;

  Lbl_04530:
    // 04530 PRINT "JUNE 25-JULY 1, 1862.  GENERAL LEE (CSA) UPHELD THE"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"JUNE 25-JULY 1, 1862.  GENERAL LEE (CSA) UPHELD THE");strcat(buf,"\n");fputs(buf,fh); };
    // 04540 PRINT "OFFENSIVE THROUGHOUT THE BATTLE AND FORCED GEN. MCCLELLAN"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"OFFENSIVE THROUGHOUT THE BATTLE AND FORCED GEN. MCCLELLAN");strcat(buf,"\n");fputs(buf,fh); };
    // 04550 PRINT "AND THE UNION FORCES AWAY FROM RICHMOND."
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"AND THE UNION FORCES AWAY FROM RICHMOND.");strcat(buf,"\n");fputs(buf,fh); };
    // 04560 GOTO 2360
    goto Lbl_02360;

  Lbl_04570:
    // 04570 PRINT "AUG 29-30, 1862.  THE COMBINED CONFEDERATE FORCES UNDER";
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"AUG 29-30, 1862.  THE COMBINED CONFEDERATE FORCES UNDER");fputs(buf,fh); };
    // 04580 PRINT " LEE"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf," LEE");strcat(buf,"\n");fputs(buf,fh); };
    // 04590 PRINT "AND JACKSON DROVE THE UNION FORCES BACK INTO WASHINGTON."
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"AND JACKSON DROVE THE UNION FORCES BACK INTO WASHINGTON.");strcat(buf,"\n");fputs(buf,fh); };
    // 04600 GOTO 2360
    goto Lbl_02360;

  Lbl_04610:
    // 04610 PRINT "SEPT 17, 1862.  THE SOUTH FAILED TO INCORPORATE MARYLAND"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"SEPT 17, 1862.  THE SOUTH FAILED TO INCORPORATE MARYLAND");strcat(buf,"\n");fputs(buf,fh); };
    // 04620 PRINT "INTO THE CONFEDERACY."
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"INTO THE CONFEDERACY.");strcat(buf,"\n");fputs(buf,fh); };
    // 04630 GOTO 2360
    goto Lbl_02360;

  Lbl_04640:
    // 04640 PRINT "DEC 13, 1862.  THE CONFEDERACY UNDER LEE SUCCESSFULLY"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"DEC 13, 1862.  THE CONFEDERACY UNDER LEE SUCCESSFULLY");strcat(buf,"\n");fputs(buf,fh); };
    // 04650 PRINT "REPULSED AN ATTACK BY THE UNION UNDER GEN. BURNSIDE."
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"REPULSED AN ATTACK BY THE UNION UNDER GEN. BURNSIDE.");strcat(buf,"\n");fputs(buf,fh); };
    // 04660 GOTO 2360
    goto Lbl_02360;

  Lbl_04670:
    // 04670 PRINT "DEC 31, 1862.  THE SOUTH UNDER GEN. BRAGG WON A CLOSE ";
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"DEC 31, 1862.  THE SOUTH UNDER GEN. BRAGG WON A CLOSE ");fputs(buf,fh); };
    // 04680 PRINT "BATTLE."
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"BATTLE.");strcat(buf,"\n");fputs(buf,fh); };
    // 04690 GOTO 2360
    goto Lbl_02360;

  Lbl_04700:
    // 04700 PRINT "MAY 1-6, 1863.  THE SOUTH HAD A COSTLY VICTORY AND LOST"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"MAY 1-6, 1863.  THE SOUTH HAD A COSTLY VICTORY AND LOST");strcat(buf,"\n");fputs(buf,fh); };
    // 04710 PRINT "ONE OF THEIR OUTSTANDING GENERALS, 'STONEWALL' JACKSON."
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"ONE OF THEIR OUTSTANDING GENERALS, 'STONEWALL' JACKSON.");strcat(buf,"\n");fputs(buf,fh); };
    // 04720 GOTO 2360
    goto Lbl_02360;

  Lbl_04730:
    // 04730 PRINT "JULY 4, 1863.  VICKSBURG WAS A COSTLY DEFEAT FOR THE SOUTH"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"JULY 4, 1863.  VICKSBURG WAS A COSTLY DEFEAT FOR THE SOUTH");strcat(buf,"\n");fputs(buf,fh); };
    // 04740 PRINT "BECAUSE IT GAVE THE UNION ACCESS TO THE MISSISSIPPI."
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"BECAUSE IT GAVE THE UNION ACCESS TO THE MISSISSIPPI.");strcat(buf,"\n");fputs(buf,fh); };
    // 04750 GOTO 2360
    goto Lbl_02360;

  Lbl_04760:
    // 04760 PRINT "JULY 1-3, 1863.  A SOUTHERN MISTAKE BY GEN. LEE AT ";
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"JULY 1-3, 1863.  A SOUTHERN MISTAKE BY GEN. LEE AT ");fputs(buf,fh); };
    // 04770 PRINT "GETTYSBURG"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"GETTYSBURG");strcat(buf,"\n");fputs(buf,fh); };
    // 04780 PRINT "COST THEM ONE OF THE MOST CRUCIAL BATTLES OF THE WAR."
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"COST THEM ONE OF THE MOST CRUCIAL BATTLES OF THE WAR.");strcat(buf,"\n");fputs(buf,fh); };
    // 04790 GOTO 2360
    goto Lbl_02360;

  Lbl_04800:
    // 04800 PRINT "SEPT. 15, 1863. CONFUSION IN A FOREST NEAR CHICKAMAUGA LED"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"SEPT. 15, 1863. CONFUSION IN A FOREST NEAR CHICKAMAUGA LED");strcat(buf,"\n");fputs(buf,fh); };
    // 04810 PRINT "TO A COSTLY SOUTHERN VICTORY."
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"TO A COSTLY SOUTHERN VICTORY.");strcat(buf,"\n");fputs(buf,fh); };
    // 04820 GOTO 2360
    goto Lbl_02360;

  Lbl_04830:
    // 04830 PRINT "NOV. 25, 1863. AFTER THE SOUTH HAD SIEGED GEN. ROSENCRANS'"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"NOV. 25, 1863. AFTER THE SOUTH HAD SIEGED GEN. ROSENCRANS'");strcat(buf,"\n");fputs(buf,fh); };
    // 04840 PRINT "ARMY FOR THREE MONTHS, GEN. GRANT BROKE THE SIEGE."
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"ARMY FOR THREE MONTHS, GEN. GRANT BROKE THE SIEGE.");strcat(buf,"\n");fputs(buf,fh); };
    // 04850 GOTO 2360
    goto Lbl_02360;

  Lbl_04860:
    // 04860 PRINT "MAY 5, 1864.  GRANT'S PLAN TO KEEP LEE ISOLATED BEGAN TO"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"MAY 5, 1864.  GRANT'S PLAN TO KEEP LEE ISOLATED BEGAN TO");strcat(buf,"\n");fputs(buf,fh); };
    // 04870 PRINT "FAIL HERE, AND CONTINUED AT COLD HARBOR AND PETERSBURG."
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"FAIL HERE, AND CONTINUED AT COLD HARBOR AND PETERSBURG.");strcat(buf,"\n");fputs(buf,fh); };
    // 04880 GOTO 2360
    goto Lbl_02360;

  Lbl_04890:
    // 04890 PRINT "AUGUST, 1864.  SHERMAN AND THREE VETERAN ARMIES CONVERGED"
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"AUGUST, 1864.  SHERMAN AND THREE VETERAN ARMIES CONVERGED");strcat(buf,"\n");fputs(buf,fh); };
    // 04900 PRINT "ON ATLANTA AND DEALT THE DEATH BLOW TO THE CONFEDERACY."
    { FILE*fh=stdout;char buf[256]; memset(buf,0,256);strcat(buf,"ON ATLANTA AND DEALT THE DEATH BLOW TO THE CONFEDERACY.");strcat(buf,"\n");fputs(buf,fh); };
    // 04910 GOTO 2360
    goto Lbl_02360;
    // 04920 END
   return(0);
};

//---------------------------------------------------------------------------
// End of $RCSfile$ 
//---------------------------------------------------------------------------

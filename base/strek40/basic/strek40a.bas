    1 REM NOTE: Basic language type forced to be:
    2 REM       trs2 - TRS-80 Level II BASIC tokenized file
   10 CLS:CLEAR150:DEFINTA,D-H,K-T:DIMS(8,8),G(8,8),Z(8,8),C(9,2),K(3,3),D$(8),B$(30),C$(3)
   20 Z$=STRING$(24," "):Y$="  ...................   ":X$=STRING$(14," "):W$=CHR$(30):V$="ENTERPRISE":U$="FEDERATION":CO$="## ,##"
   30 PRINTTAB(25)"STAR TREK 4.0<ERROR>"TAB(23)"BY JAKE COMMANDER<ERROR><ERROR>":INPUT"DO YOU WANT INSTRUCTIONS ";A$:IFLEFT$(A$,1)="Y"GOSUB1160
   40 FORX=0TO3:READC$(X):NEXT:FORY=1TO2:FORX=1TO9:READC(X,Y):NEXTX,Y:FORX=0TO5:READA$(X):NEXT:FORX=1TO8:READD$(X):NEXT:FORX=1TO30:READB$(X):NEXT:A$(3)=CHR$(34)+"V"+CHR$(34)
   50 GOSUB1490:GOSUB1710:T=(RND(20)+19)*100+RND(100):T0=T+1:TT=32:GOSUB1660:L=RND(8):M=RND(8):U=RND(8):V=RND(8):PRINT@640,"AWAIT FURTHER ORDERS."
   60 DATADOCKED,"GREEN ",YELLOW,"RED   ",,1,1,1,,-1,-1,-1,,-1,-1,,1,1,1,,-1,-1,"   ",<*>,"   ","   "," . ",>!<,WARP ENGINES,S. R. SCANNER,L. R. SENSORS,PHASER CONTROL,PHOTON TUBES,SHIELD CONTROL,DAMAGE CONTROL,COMPUTER,,SET COURSE,SHORT RANGE,VISUAL SCAN
   70 DATALONG-RANGE,SENSOR SCAN,,FIRE PHASERS,FIRE PHOTON,TORPEDO,,SHIELD CONTROL,DAMAGE CONTROL,REPORT,CALL ON-BOARD,COMPUTER,,FINISHED,COMPUTER,GUIDANCE,STATUS,REPORT,PHOTON TORP-,EDO DATA,COURSE,CALCULATOR,GUIDED-PHOTON,TORPEDO,CUMULATIVE GA-,LACTIC RECORD
   80 FORJ=1TO8:FORI=1TO8:R=RND(100):IFR>98K=3ELSEIFR>95K=2ELSEIFR>80K=1ELSEK=0
   90 KT=KT+K:R=RND(100):IFR<97THENB=0ELSEB=1:BT=BT+1
  100 S=RND(8):G(I,J)=K*100+B*10+S:Z(I,J)=0:NEXTI,J
  110 K7=KT:IFBT=0ORKT=0THEN80ELSEPRINT@640,"YOU MUST DESTROY";KT;"KLINGONS WITHIN";TT;"STARDATES,<ERROR>THERE ARE";BT;U$" STARBASES IN THE GALAXY."
  120 CL=0:K=0:B=0:S=0:S(U,V)=3:IFL<1ORL>8ORM<1ORM>8THEN210
  130 X=G(L,M):K=INT(X/100):X=X-K*100:B=INT(X/10):S=X-B*10
  140 IFK=0THEN180ELSEIFG>200THEN170ELSEIFZ9=1ORZ7=1THEN160
  150 PRINT"YOU HAVE JUST ENTERED A COMBAT AREA WITH YOUR SHIELDS LOW.";W$;"<ERROR>THIS TIME THEY DIDN'T SHOOT FIRST. YOU HAVE BEEN WARNED....":Z9=1:GOTO170
  160 PRINT"COMBAT AREA  .. CONDITION RED - SHIELDS ARE DANGEROUSLY LOW."
  170 GOSUB1450
  180 IFB<>0FORI=1TOB:GOSUB1150:S(X,Y)=5:NEXT
  190 IFS<>0FORI=1TOS:GOSUB1150:S(X,Y)=4:NEXT
  200 ST=4:GOSUB1570
  210 PRINT@204,LLISTCO$;L;M;:PRINT@332,LLISTCO$;U;V;:PRINT@640,;:IFCL=1PRINT"SENSORS DETECT KLINGONS CLOAKING - PHASERS NECESSARY ";W$
  220 IFD(2)<0O=0:A=2:GOTO280ELSEO=1:Z=81:FORY=1TO8:FORX=1TO8:PRINT@X*3+Z,A$(S(X,Y));:NEXTX:Z=Z+64:NEXTY
  230 IFK<>0IFZ=1IFRND(2)>1GOSUB870ELSEZ7=1
  240 A=0:GOSUB290:PRINT@580,X$+CHR$(29)+"COMMAND?";:M2=0
  250 H=0
  260 H=H+1:IFH=350THEN300ELSEA$=INKEY$:IFA$=""THEN260ELSEH=0:IFASC(A$)=13THENPRINT@640,CHR$(31)ELSEGOSUB290:A=VAL(A$):PRINT@590,A;:IFA=0ORA>8THEN260ELSEPRINT@494,B$(A*2-1);:PRINT@558,B$(A*2);:FORVC=640TO896STEP64:PRINT@VC,CHR$(255);:NEXT:GOTO260
  270 IFA<3ORD(A)>=0PRINT@576,"#################";:PRINT@640,;:ONA+1GOTO240,320,210,560,620,700,830,850,950,240
  280 PRINTD$(A);" - INOPERATIVE";W$:IFA=4ANDCL=1PRINT"ILLOGICAL TO REMAIN HERE, KLINGONS CLOAKING":GOTO240ELSE240
  290 PRINT@591," ";:PRINT@494,X$;:PRINT@558,X$;:RETURN
  300 GOSUB1660:PRINT@640,;:GOSUB360:IFK<>0IFRND(2)>1GOSUB870:GOTO250ELSE250ELSEIFRND(10)<9THEN250ELSEGOSUB1660:IFL<1ORL>8ORM<1ORM>8THEN250ELSEFORN=1TO8:FORQ=1TO8:X=INT(G(N,Q)/100):IFX=0NEXTQ,N
  310 G(N,Q)=G(N,Q)-X*100:G(L,M)=G(L,M)+X*100:K=X:PRINT"KLINGONS HAVE JUST ENTERED THIS QUADRANT";W$:GOSUB1450:GOSUB1570:GOTO210
  320 PRINT@640,;:INPUT"COURSE(1-9) ";C:IFC=0THEN240ELSEIFC<0ORC>8THEN320ELSEPRINT@569,LLIST"#.#";C;:IFC=9C=1
  330 PRINT@640,;:INPUT"WARP FACTOR (0-8)";W:IFW=0THEN240ELSEIFW<0ORW>8THEN330
  340 IFD(1)<0ANDW>.2PRINTD$(1);" DAMAGED, MAX. SPEED IS WARP 0.2":W=.25ELSEIFW<.9W=W*1.25
  350 GOSUB360:GOTO420
  360 IFST=0RETURNELSER=0:FORI=1TO8:IFD(I)>=0NEXTELSED(I)=D(I)+1:IFD(I)=0R=I:I=8:NEXTELSENEXT
  370 IFD(7)<0RETURNELSEPRINT@640,;:IFR<>0PRINTD$(R);" NOW FUNCTIONING CORRECTLY";:GOTO410
  380 IFRND(10)<9RETURNELSER=RND(8):ONRND(2)GOTO390,400
  390 D(R)=D(R)-RND(5):IFD(R)<0PRINTD$(7);" REPORT - ";D$(R);" OUT";:GOTO410ELSERETURN
  400 D(R)=D(R)+RND(5):PRINTD$(7);" REPORT - ";D$(R);" - REINFORCED";
  410 PRINTW$;:GOSUB1470:GOTO1640
  420 GOSUB870:N=W*8:F=E/(5*(G/100+1)):IFN<=FTHENF=0ELSEN=F:F=1
  430 X=U:Y=V:S(X,Y)=0
  440 GOSUB510:FORH=1TON:GOSUB520:ONZGOTO450,460,530
  450 NEXT:IFF=0THEN500ELSEH=H-1:GOTO480
  460 IFM2=1PRINT"SERIOUS DAMAGE HAS OCCURED - CHECK ";D$(6):FORI=1TO8:D(I)=D(I)-RND(5)+1:NEXT
  470 PRINT"NAVIGATIONAL ERROR - ";:GOTO490
  480 GOSUB1610:PRINT"ENERGY DEPLETED - ";
  490 X=X-X1:Y=Y-Y1:N=H-1:PRINTLLISTD$(1)+" SHUT DOWN AT SECTOR"+CO$+W$;X;Y
  500 U=INT(X+.5):V=INT(Y+.5):S(U,V)=3:GOSUB1540:IFW<1THEN210ELSEGOSUB1660:GOTO210
  510 D=C:X1=C(D,1)+(C(D+1,1)-C(D,1))*(C-D):Y1=C(D,2)+(C(D+1,2)-C(D,2))*(C-D):RETURN
  520 X=X+X1:Y=Y+Y1:C=INT(X+.5):D=INT(Y+.5):IFC<1ORC>8ORD<1ORD>8Z=3:RETURNELSEIFS(C,D)<>0Z=2:RETURNELSEZ=1:RETURN
  530 FORJ=1TO8:FORI=1TO8:S(I,J)=0:NEXTI,J:U=L*8+U+X1*N:V=M*8+V+Y1*N:L=U/8:M=V/8:U=INT(U-L*8+.5):V=INT(V-M*8+.5):IFU=0L=L-1:U=8
  540 IFV=0M=M-1:V=8
  550 GOSUB1660:GOSUB1540:GOTO120
  560 O=0:A=84:PRINT@A,Y$;:FORJ=M-1TOM+1:FORZ=1TO3:N(Z)=0:NEXT
  570 FORI=L-1TOL+1:IFI<1ORI>8ORJ<1ORJ>8THEN600
  580 N(I-L+2)=G(I,J):IFD(8)<0THEN600
  590 Z(I,J)=G(I,J)
  600 NEXT
  610 A=A+64:PRINT@A,LLIST"  : ### : ### : ### :   ";N(1);N(2);N(3);:A=A+64:PRINT@A,Y$;:NEXT:A=A+64:PRINT@A,Z$;:GOTO240
  620 IFST=0PRINTC$(0);" - ";:GOTO280ELSEIFK=0GOSUB1760:GOTO240
  630 GOSUB1640:Z7=1:IFD(8)<0PRINTD$(8);" FAILURE. MANUALLY ";
  640 PRINT"LOCKED ON. ENERGY=";E;"... ";
  650 INPUT"UNITS TO FIRE";F:IFF<=0THEN240ELSEIFF>ETHEN630
  660 E=E-F:GOSUB1550:IFD(8)<0F=RND(F)
  670 R=640:FORI=1TO3:IFK(I,3)<0THEN690
  680 H=F/K:J=.98:GOSUB1440:K(I,3)=K(I,3)-H:PRINT" KLINGON - "+W$;:IFK(I,3)<0X=K(I,1):Y=K(I,2):GOSUB1700ELSEPRINTLLIST"AT SECTOR"+CO$+" (### LEFT)";K(I,1);K(I,2);K(I,3):GOSUB1470
  690 NEXT:GOSUB870:GOTO240
  700 IFP>0THEN710ELSEPRINT"ALL PHOTON TORPEDOES EXPENDED.":GOTO240
  710 IFCL<>0GOSUB1770:GOTO240
  720 PRINT@640,B$(10);:INPUT" COURSE (1-9)";C:IFC=0THEN240ELSEIFC<1ORC>9THEN720ELSEIFC=9C=1
  730 Z7=1:GOSUB1670:GOSUB510:X=U-X1:Y=V-Y1:GOTO760
  740 PRINT@Q,"V";:GOTO760
  750 PRINT@Q," ";
  760 GOSUB520:IFZ=3THEN810ELSEIFY=INT(Y)ANDO=1THENGOSUB1740:PRINT@Q,".";:ONS(C,D)+1GOTO750,770,750,740,790,800ELSEONS(C,D)+1GOTO760,770,760,760,790,800
  770 FORI=1TO3:IFC=K(I,1)ANDD=K(I,2)K(I,3)=-1:X=C:Y=D:R=640:GOSUB1700
  780 NEXT:GOTO820
  790 PRINT@640,LLISTB$(10)+" CAPTURED CY STAR'S GRAVITY AT SECTOR "+CO$;X;Y:GOTO820
  800 GOSUB1720:PRINT@640,"***  STAR BASE DESTROYED *** ... CONGRADULATIONS!!":B=B-1:BT=BT-1:M2=1:X=C:Y=D:GOSUB1690:PRINT@704,"RESULTING EXPLOSION HAS BLOWN YOU OFF COURSE":C=RND(8):W=RND(8)/2:GOTO420
  810 PRINT@660," - ";B$(10);" MISSED."
  820 GOSUB870:GOTO210
  830 IFST=0PRINTC$(0);" - ";:GOTO280
  840 PRINT@640,;:INPUT"TOTAL UNIT ON SHIELDS";X:IFX<0ORX>E+GTHEN840ELSEE=E+G-X:G=X:GOSUB1550:GOSUB1560:PRINT@704,"ENERGY CONSUMPTION IS NOW";5*(G/100+1);"UNITS PER SECTOR";W$;:GOTO240
  850 R=0:PRINT@576," NEXT...HIT '['  ";
  860 A$=INKEY$:IFA$=""THEN860ELSEIFASC(A$)=13THEN240ELSEIFA$<>"["THEN860ELSER=R+1:IFR>8THEN240ELSEGOSUB1650:GOTO860
  870 IFK=0RETURNELSEIFST=0Z7=0:PRINT@768,"STAR-BASE SHIELDS PROTECT THE ";V$;:RETURNELSER=640:FORI=1TO3:H=K(I,3):IFH<1NEXTELSEJ=1:GOSUB1440:PRINTLLISTV$+" FROM SECTOR"+CO$+W$;K(I,1);K(I,2):G=G-H:GOSUB1480:NEXT
  880 GOTO1560
  890 PRINT"THE ";V$;" IS DEAD IN SPACE. YOU ARE AT THE KLINGONS' MERCY":FORZ=1TO6:GOSUB1470:NEXT
  900 IFK=0THEN930ELSEGOSUB870:GOTO900
  910 PRINT"IT IS STARDATE ";T;W$:GOTO930
  920 PRINT@768,"THE "+V$+" WAS DESTROYED, THE ";U$;" WILL BE CONQUERED"
  930 PRINT"THERE ARE STILL";KT;"KLINGON BATTLE-CRUISERS SURVIVING.":END
  940 PRINT"THE LAST KLINGON BATTLE-CRUISER IN THE GALAXY IS DESTROYED !!<ERROR>THE ";U$;" IS SAVED !! YOUR EFFICIENCY RATING =";K7/(T-T0)*1000:END
  950 CD=0
  960 A=0:GOSUB290:PRINT@580,X$+CHR$(29)+"OPTION?";
  970 A$=INKEY$:IFA$=""THEN970ELSEIFASC(A$)=13PRINT@576,:ONA+1GOTO240,1130,990,1000,1010,1120,980ELSEGOSUB290:A=VAL(A$):PRINT@590,A;:IFA>6A=0:GOTO970ELSEF=A*2+17:PRINT@494,B$(F);:PRINT@558,B$(F+1);:GOTO970
  980 O=0:A=84:FORJ=1TO8:PRINT@A,;:FORI=1TO8:PRINTLLIST"###";Z(I,J);:NEXT:A=A+64:NEXT:GOTO960
  990 O=0:FORA=84TO532STEP64:PRINT@A,Y$;:NEXT:PRINT@84,"     STATUS REPORT:";:PRINT@212,"  KLINGONS  LEFT=";KT;:PRINT@276,"  STARDATES LEFT=";T0+TT-T;:PRINT@340,"  STARBASES LEFT=";BT;:GOTO960
 1000 IFK=0GOSUB1760:GOTO960ELSECC=U:A=V:FORF=1TO3:IFK(F,3)<0THEN1110ELSEW=K(F,1):X=K(F,2):GOTO1020
 1010 INPUT"START AND END CO-ORDINATES ARE (X,Y,X,Y)";CC,A,W,X
 1020 PRINT@704,;:X=X-A:A=CC-W:IFX<0THEN1060ELSEIFA<0THEN1080ELSEIFX>0THEN1030ELSEIFA=0THEN1070
 1030 CC=5
 1040 IFABS(A)<=ABS(X)THEN1050ELSECC=CC+(((ABS(A)-ABS(X))+ABS(A))/ABS(A)):GOTO1100
 1050 CC=CC+ABS(A)/ABS(X):GOTO1100
 1060 IFA>0CC=7:GOTO1090ELSEIFX=0THEN1080
 1070 CC=1:GOTO1040
 1080 CC=3
 1090 IFABS(A)>=ABS(X)CC=CC+ABS(X)/ABS(A)ELSECC=CC+(((ABS(X)-ABS(A))+ABS(X))/ABS(X))
 1100 PRINT@704,"COURSE =";CC;:CD=INT(SQR(X^2+A^2)):PRINT", DISTANCE =";CD:GOTO960
 1110 NEXT:GOTO960
 1120 IFD(5)<0THEN280ELSEIFP<1ORCL=1THEN700ELSEIFCD<>0THENC=CC:GOTO730ELSE1140
 1130 IFCD<>0C=CC:W=CD:GOTO340
 1140 PRINT"NO DATA AVAILABLE FOR GUIDANCE SYSTEM":GOTO960
 1150 X=RND(8):Y=RND(8):IFS(X,Y)<>0THEN1150ELSERETURN
 1160 PRINT"<ERROR>YOU ARE THE COMMANDER OF THE STARSHIP 'ENTERPRISE'- YOUR MISSIONTO DESTROY KLINGON BATTLE-CRUISERS THREATENING THE FEDERATION - <ERROR>        'TO BOLDLY GO WHERE NO MAN HAS GONE BEFORE'<ERROR>";
 1170 PRINT"<ERROR>YOU MUST DO THIS WITHIN 32 STARDATES.";
 1180 PRINT"<ERROR><ERROR>THE GALAXY IS REPRESENTED AS A 64 BY 64 MATRIX MADE UP FROM 8<ERROR>8 BY 8 QUADRANTS - EACH CONTAINING 8  8 BY 8 SECTORS.<ERROR><ERROR>THE FOLLOWING OBJECTS ARE GRAPHICALLY REPRESENTED";
 1190 PRINT"<ERROR>";CHR$(34);"V";CHR$(34);" = THE ENTERPRISE.<ERROR><*> = KLINGON BATTLE CRUISER.<ERROR>>!< = STARBASE.<ERROR> .  = STAR."
 1200 GOSUB1420
 1210 PRINT"<ERROR>STARS ( . ) ... THESE ARE OBSTACLES. KLINGONS CAN HIDE BEHIND<ERROR>THEM. IF YOU BUMP INTO THEM, YOU MAY DAMAGE YOUR SHIP.";
 1220 PRINT"<ERROR><ERROR>STARBASES ( >!< ) ... REFUGE AND REFUELING POINTS. TO DOCK WITH A BASE, YOU MERELY NAVIGATE TO EITHER SIDE OF IT. REFUELING IS<ERROR>DONE AUTOMATICALLY - YOU MAY USE A BASE ANY NUMBER OF TIMES.";
 1230 PRINT"<ERROR><ERROR>KLINGONS ( <*> ) ... THE ENEMY. THEY OFTEN SHOOT FIRST AND ASK<ERROR>QUESTIONS NEXT. THEY ARE ARMED WITH PHASERS AND DEFLECTOR";
 1240 PRINT"<ERROR>SHIELDS, BUT SOME ARE ARMED WITH CLOAKING DEVICES WHICH MAKE<ERROR>THEM INVISIBLE AND IMMUNE TO PHOTON TORPEDO ATTACK.";
 1250 PRINT"<ERROR><ERROR>THE ENTERPRISE ( ";CHR$(34);"V";CHR$(34);" ) ... THAT'S YOU. A MODERN POWERFUL WARP-<ERROR>DRIVE SHIP, WITH ALL THE LATEST DEVICES, SUCH AS; SCANNERS,<ERROR>PHASERS, PHOTON TORPEDOES, DEFLECTOR SHIELDS, AND ON-BOARD COMPUTER. THESE ARE DESCRIBED NEXT.";
 1260 GOSUB1420
 1270 PRINT"<ERROR>COMMAND 1 .... WARP ENGINE CONTROL. IT IS IMPORTANT TO KNOW THE<ERROR>CIRCULAR VECTOR ARRANGEMENT AS SHOWN. INTEGER AND REAL VALUES<ERROR>MAY BE USED. E.G. 1.5 IS HALFWAY BETWEEN 1 AND 2.";
 1280 PRINT"<ERROR><ERROR>1 WARP FACTOR       8     1     2		     VECTOR OF 9 IS UNDEFINED<ERROR>MOVES EXACTLY         .   .   .	       BUT VALUES MAY APPROACH 9<ERROR>1 QUADRANT,       7. .   ...   . .3<ERROR>.1 WARP FACTOR        .   .   .<ERROR>MOVES 1 SECTOR      6     5     4";
 1290 PRINT"<ERROR><ERROR>TO MOVE FROM QUADRANT 5,5 TO 6,5 YOU WOULD USE COURSE 3,<ERROR>WARP FACTOR 1. USE WARPS LESS THAN 1 TO MOVE SECTOR TO SECTOR.";
 1300 PRINT"<ERROR><ERROR>COMMAND 2 .. SHORT RANGE SENSOR SCAN. DISPLAYS ON THE ENTERPRISESCREEN THE IMMEDIATE QUADRANT, SHOWING POSITIONS OF ANY OBJECTS<ERROR>IN THAT GALACTIC QUADRANT.";
 1310 GOSUB1420
 1320 PRINT"<ERROR>COMMAND 3 .. LONG RANGE SENSOR SCAN. SHOWS CONDITIONS IN SPACE<ERROR>FOR 1 QUADRANT EACH SIDE OF THE ONE YOU ARE IN, WHICH IS DISPLAYED IN THE CENTER. THE SCAN IS IN THE FORM XXX , WHERE THE UNITS<ERROR>DIGIT IS THE NUMBER OF STARS, THE TENS DIGIT IS";
 1330 PRINT" THE NUMBER OF<ERROR>STARBASES, THE HUNDREDS DIGIT IS THE NUMBER OF KLINGONS.<ERROR>";
 1340 PRINT"<ERROR>COMMAND 4 .. PHASER CONTROL. THIS ALLOWS YOU TO AIM PURE ENERGY<ERROR>AT ANY KLINGONS IN THE VICINITY. EACH PHASER BURST WILL DEPLETE<ERROR>HIS SHIELDS AND REDUCE HIS PHASER CAPABILITY - AND YOUR ENERGY."
 1350 PRINT"<ERROR>COMMAND 5 .. PHOTON TORPEDO CONTROL. ENABLES YOU TO COMPLETELY<ERROR>DESTROY A KLINGON WITH A SINGLE HIT. TORPEDO COURSE IS THE SAME<ERROR>VECTOR ARRANGEMENT AS ALREADY DESCRIBED.<ERROR><ERROR>":GOSUB1420
 1360 PRINT"<ERROR>COMMAND 6 .. SHIELD CONTROL. ALLOWS PROTECTION OF THE ENTERPRISEBY PLACING SHIP'S ENERGY ONTO THE DEFLECTORS - INCREASES FUEL<ERROR>CONSUMPTION THOUGH.";
 1370 PRINT"<ERROR>COMMAND 7 .. DAMAGE CONTROL REPORT. SHOWS STATE OF REPAIR OF ALLDEVICES. A STATE OF LESS THAN ZERO MEANS THAT DEVICE IS<ERROR>TEMPORARILY DAMAGED.";
 1380 PRINT"<ERROR><ERROR>COMMAND 8 .. ON BOARD COMPUTER - CONTAINS THE FOLLOWING OPTIONS:  OPTION 0. FINISHED WITH COMPUTER, RETURN CONTROL TO CONSOLE.<ERROR>  OPTION 1. COMPUTER GUIDES YOU ON COURSE FROM OPTION 4.<ERROR>  OPTION 2. STATUS REPORT - SHOWS HOW FAR THE MISSION HAS GONE.
 1390 PRINT"  OPTION 3. GIVES BEARING OF ANY KLINGONS IN QUADRANT<ERROR>  OPTION 4. SHOWS VECTOR NEEDED TO TRAVEL BETWEEN INPUT CO-ORDS.  OPTION 5. GUIDED PHOTON TORPEDO ON COURSE FROM OPTION 3.";
 1400 PRINT"<ERROR>  OPTION 6. CUMULATIVE RECORD OF ALL LONG RANGE SENSOR SCANS."
 1410 GOSUB1420:RETURN
 1420 PRINT@999,"PRESS ENTER TO CONTINUE:";
 1430 A$=INKEY$:IFA$<>""THENRETURNELSE1430
 1440 H=(H*2/SQR((K(I,1)-U)^2+(K(I,2)-V)^2))*(J*RND(0)+.2):R=R+64:PRINT@R,LLISTW$+"### UNIT HIT ON ";H;:RETURN
 1450 IFK<>3IFRND(10)>7CL=1
 1460 FORI=1TO3:K(I,3)=-1:NEXT:FORI=1TOK:GOSUB1150:S(X,Y)=CL+1:K(I,1)=X:K(I,2)=Y:K(I,3)=200:NEXT:RETURN
 1470 FORZZ=1E3TO1.8E3:NEXT:RETURN
 1480 FORZZ=0TOH*.25:OUT255,8:ZZ=ZZ+.1:OUT255,0:ZZ=ZZ-.1:NEXT:RETURN
 1490 CLS:FORA=1TO28STEP27:Z=3:FORX=40TO87:SET(X,A):Z=Z+1:IFZ=6THENZ=0:SET(X,A-1):SET(X,A+1):NEXTELSENEXTX,A
 1500 FORA=38TO89STEP51:Z=2:FORX=1TO28:SET(A,X):Z=Z+1:IFZ<>3NEXTELSEZ=0:SET(A+1,X):SET(A-1,X):NEXTX,A
 1510 X=1:Z=25:GOSUB1520:X=88:Z=19:GOSUB1520:FORX=88TO126:SET(X,28):NEXT:GOTO1530
 1520 FORX=XTOX+38:FORY=1TOZSTEP6:SET(X,Y):NEXTY,X:RETURN
 1530 PRINT@66,"STARDATE";:PRINT@194,"QUADRANT";:PRINT@245,"ENERGY";:PRINT@322,"SECTOR";:PRINT@373,"SHIELDS";:PRINT@450,"PHOTON T.";:GOTO1640
 1540 E=E-((N*5)*(G/100+1))
 1550 PRINT@238,LLIST"####";E;:GOSUB1570
 1560 PRINT@366,LLIST"####";G;:GOSUB1640:IFG<0THEN920ELSERETURN
 1570 FORZ=U-1TOU+1:IFZ<1ORZ>8NEXTELSEIFS(Z,V)=5THENZ=U+1:GOSUB1750:NEXT:GOTO1620ELSENEXT
 1580 IFK=0THEN1600
 1590 IFST<>3ST=3:GOTO1630ELSE1620
 1600 IFE>300ST=1:GOTO1620ELSEIFE>5*(G/100+1)IFST<>2ST=2:GOTO1630ELSE1620
 1610 PRINT@640,;:IFG=0THEN890ELSEPRINT"YOU HAVE";E;"UNITS OF ENERGY. SHIELDS ARE TAKING";G;"UNITS":GOSUB1470:IFD(6)<0PRINT"BUT, ";D$(6);" IS OUT.SITUATION IRRECOVERABLE.":GOTO890ELSE1590
 1620 PRINT@110,C$(ST);:GOTO1640
 1630 FORFL=1TO4:PRINT@110,C$(ST);:FORZZ=1TO50:NEXT:PRINT@110,"      ";:FORZZ=1TO50:NEXTZZ,FL:GOTO1620
 1640 PRINT@640,;:RETURN
 1650 PRINT@576,X$;:PRINT@576,D$(R);:PRINT@590,D(R);:GOTO1640
 1660 T=T+1:PRINT@77,T;:GOSUB1640:IFT>T0+TTTHEN910ELSERETURN
 1670 IFST=0P=10ELSEP=P-1
 1680 PRINT@462,P;:GOTO1640
 1690 GOSUB1720:S(X,Y)=0:G(L,M)=K*100+B*10+S:RETURN
 1700 K=K-1:GOSUB1690:GOSUB1570:PRINT@R+28,LLIST"KLINGON AT"+CO$+" DESTROYED"+W$;X;Y:KT=KT-1:IFKT=0THEN940ELSEGOSUB1470:IFK=0CL=0:RETURNELSERETURN
 1710 ST=0:FORZ=1TO8:D(Z)=0:NEXT:E=5000:PRINT@237,E;:GOSUB1670:G=0:GOTO1560
 1720 IFO<>1RETURNELSEGOSUB1740:FORZ=1TO30:PRINT@Q+RND(3)-2,CHR$(128+RND(62));:NEXT
 1730 PRINT@Q-1,"   ";:GOTO1640
 1740 Q=18.5+X*3+64*Y:RETURN
 1750 IFST=0RETURNELSEPRINT@640,"SHIELDS DROPPED FOR DOCKING PURPOSES";W$:GOSUB1710:GOTO1630
 1760 PRINT"SENSORS DETECT NO KLINGONS IN THIS QUADRANT":RETURN
 1770 PRINTD$(5);" WILL BE OF NO USE - ";B$(8);W$;:RETURN
 2310 GOTO5110

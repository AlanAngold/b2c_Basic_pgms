    1 REM NOTE: Basic language type forced to be:
    2 REM       trs2 - TRS-80 Level II BASIC tokenized file
    5 REM == STARTREK 4.0 --AUG 1981 PAGE 86 -- 80 MICROCOMPUTING
   10 CLEAR150:DEFINTA,D-H,K-T:DIMS(8,8),G(8,8),Z(8,8),C(9,2),K(3,3),D$(8),B$(30),C$(3)
   35 Z$=STRING$(24," "):Y$="  ...................   ":X$=STRING$(14," "):W$=CHR$(30):V$="ENTERPRISE":U$="FEDERATION":CO$="## ,##"
  120 CLS:PRINTTAB(25)"STAR TREK 4.0<ERROR>"TAB(23)"BY JAKE COMMANDER<ERROR><ERROR>":INPUT"DO YOU WANT INSTRUCTIONS ";A$:IFA$="YES"GOSUB3460
  160 FORX=0TO3:READC$(X):NEXT:FORY=1TO2:FORX=1TO9:READC(X,Y):NEXTX,Y:FORX=0TO5:READA$(X):NEXT:FORX=1TO8:READD$(X):NEXT:FORX=1TO30:READB$(X):NEXT
  180 GOSUB5030:GOSUB5200:T=(RND(20)+19)*100+RND(100):T0=T+1:TT=32:GOSUB5170:L=RND(8):M=RND(8):U=RND(8):V=RND(8):PRINT@640,"AWAIT FURTHER ORDERS."
  260 DATADOCKED,"GREEN ",YELLOW,"RED   ",,1,1,1,,-1,-1,-1,,-1,-1,,1,1,1,,-1,-1,"   ",+++,"   ",<+>," . ",>!<,WARP ENGINES,S. R. SCANNER,L. R. SENSORS,PHASER CONTROL,PHOTON TUBES,SHIELD CONTROL,DAMAGE CONTROL,COMPUTER,,SET COURSE,SHORT-RANGE,VISUAL SCAN
  270 DATALONG-RANGE,SENSOR SCAN,,FIRE PHASERS,FIRE PHOTON,TORPEDO,,SHIELD CONTROL,DAMAGE CONTROL,REPORT,CALL ON-BOARD,COMPUTER,,FINISHED,COMPUTER,GUIDANCE,STATUS,REPORT,PHOTON TORP-,EDO DATA,COURSE,CALCULATOR,GUIDED-PHOTON,TORPEDO,CUMULATIVE GA-,LACTIC RECORD
  290 FORJ=1TO8:FORI=1TO8:R=RND(100):IFR>98K=3ELSEIFR>95K=2ELSEIFR>80K=1ELSEK=0
  370 KT=KT+K:R=RND(100):IFR<97THENB=0ELSEB=1:BT=BT+1
  380 S=RND(8):G(I,J)=K*100+B*10+S:Z(I,J)=0:NEXTI,J
  420 K7=KT:IFBT=0ORKT=0THEN290ELSEPRINT@640,"YOU MUST DESTROY";KT;"KLINGONS WITHIN";TT;"STARDATES,<ERROR>THERE ARE";BT;U$;" STARBASES IN THIS GALAXY.
  450 CL=0:K=0:B=0:S=0:S(U,V)=3:IFL<1ORL>8ORM<1ORM>8THEN760
  480 X=G(L,M):K=INT(X/100):X=X-K*100:B=INT(X/10):S=X-B*10
  490 IFK=0THEN700ELSEIFG>200THEN660ELSEIFZ9=1ORZ7=1THEN550
  500 PRINT"YOU HAVE ENTERED A COMBAT AREA WITH YOUR SHIELDS LOW.";W$;"<ERROR>THIS TIME THEY DIDN'T SHOOT FIRST. YOU HAVE BEEN WARNED....":Z9=1:GOTO660
  550 PRINT"COMBAT AREA  .. CONDITION RED - SHIELDS ARE DANGEROUSLY LOW.
  660 GOSUB4900
  700 IFB<>0FORI=1TOB:GOSUB3350:S(X,Y)=5:NEXT
  710 IFS<>0FORI=1TOS:GOSUB3350:S(X,Y)=4:NEXT
  720 ST=4:GOSUB5120
  760 PRINT@204,LLISTCO$;L;M;:PRINT@332,LLISTCO$;U;V;:PRINT@640,;:IFCL=1PRINT"SENSORS DETECT KLINGONS CLOAKING - PHASERS NECESSARY";W$
  770 IFD(2)<0O=0:A=2:GOTO850ELSEO=1:Z=81:FORY=1TO8:FORX=1TO8:PRINT@X*3+Z,A$(S(X,Y));:NEXTX:Z=Z+64:NEXTY
  780 IFK<>0IFZ7=1IFRND(2)>1GOSUB2230ELSEELSEZ7=1
  830 A=0:GOSUB860:PRINT@580,X$+CHR$(29)+"COMMAND?";:M2=0
  835 H=0
  840 H=H+1:IFH=350THEN870ELSEA$=INKEY$:IFA$=""THEN840ELSEH=0:IFASC(A$)=13THENPRINT@640,CHR$(31)ELSEGOSUB860:A=VAL(A$):PRINT@590,A;:IFA=0ORA>8THEN840ELSEPRINT@494,B$(A*2-1);:PRINT@558,B$(A*2);:GOTO840
  845 IFA<3ORD(A)>=0PRINT@576,"#################";:PRINT@640,;:ONA+1GOTO830,960,760,1460,1560,1740,2030,2090,2770,830
  850 PRINTD$(A);" - INOPERATIVE";W$:IFA=4ANDCL=1PRINT"ILLOGICAL TO REMAIN HERE, KLINGONS CLOAKING":GOTO830ELSE830{0x01}
  860 PRINT@591," ";:PRINT@494,X$;:PRINT@558,X$;:RETURN
  870 GOSUB5170:PRINT@640,;:GOSUB1100:IFK<>0IFRND(2)>1GOSUB2230:GOTO835ELSE835ELSEIFRND(10)<9THEN835ELSEGOSUB5170:IFL<1ORL>8ORM<1ORM>8THEN835ELSEFORN=1TO8:FORQ=1TO8:X=INT(G(N,Q)/100):IFX=0NEXTQ,N
  890 G(N,Q)=G(N,Q)-X*100:G(L,M)=G(L,M)+X*100:K=X:PRINT"KLINGONS HAVE JUST ENTERED THIS QUADRANT";W$:GOSUB4900:GOSUB5120:GOTO760
  960 PRINT@640,;:INPUT"COURSE(1-9) ";C:IFC=0THEN830ELSEIFC<1ORC>9THEN960ELSEPRINT@569,LLIST"#.#";C;:IFC=9C=1
  980 PRINT@640,;:INPUT"WARP FACTOR (0-8)";W:IFW=0THEN830ELSEIFW<0ORW>8THEN980
 1020 IFD(1)<0ANDW>.2PRINTD$(1);" DAMAGED, MAX. SPEED IS WARP 0.2":W=.25ELSEIFW<.9W=W*1.25
 1040 GOSUB1100:GOTO1200
 1100 IFST=0RETURNELSER=0:FORI=1TO8:IFD(I)>=0NEXTELSED(I)=D(I)+1:IFD(I)=0R=I:I=8:NEXTELSENEXT
 1110 IFD(7)<0RETURNELSEPRINT@640,;:IFR<>0PRINTD$(R);" NOW FUNCTIONING CORRECTLY";:GOTO1190
 1130 IFRND(10)<9RETURNELSER=RND(8):ONRND(2)GOTO1150,1180
 1150 D(R)=D(R)-RND(5):IFD(R)<0PRINTD$(7);" REPORT - ";D$(R);" OUT";:GOTO1190ELSERETURN
 1180 D(R)=D(R)+RND(5):PRINTD$(7);" REPORT - ";D$(R);" - REINFORCED";
 1190 PRINTW$;:GOSUB5000:GOTO5150
 1200 GOSUB2230:N=W*8:F=E/(5*(G/100+1)):IFN<=FTHENF=0ELSEN=F:F=1
 1210 X=U:Y=V:S(X,Y)=0
 1230 GOSUB1320:FORH=1TON:GOSUB1330:ONZGOTO1270,1275,1340
 1270 NEXT:IFF=0THEN1310ELSEH=H-1:GOTO1290
 1275 IFM2=1PRINT"SERIOUS DAMAGE HAS OCCURRED - CHECK ";D$(6):FORI=1TO8:D(I)=D(I)-RND(5)+1:NEXT
 1280 PRINT"NAVIGATIONAL ERROR - ";:GOTO1300
 1290 GOSUB5128:PRINT"ENERGY DEPLETED - ";
 1300 X=X-X1:Y=Y-Y1:N=H-1:PRINTLLISTD$(1)+" SHUT DOWN AT SECTOR"+CO$+W$;X;Y
 1310 U=INT(X+.5):V=INT(Y+.5):S(U,V)=3:GOSUB5095:IFW<1THEN760ELSEGOSUB5170:GOTO760
 1320 D=C:X1=C(D,1)+(C(D+1,1)-C(D,1))*(C-D):Y1=C(D,2)+(C(D+1,2)-C(D,2))*(C-D):RETURN
 1330 X=X+X1:Y=Y+Y1:C=INT(X+.5):D=INT(Y+.5):IFC<1ORC>8ORD<1ORD>8Z=3:RETURNELSEIFS(C,D)<>0Z=2:RETURNELSEZ=1:RETURN
 1340 FORJ=1TO8:FORI=1TO8:S(I,J)=0:NEXTI,J:U=L*8+U+X1*N:V=M*8+V+Y1*N:L=U/8:M=V/8:U=INT(U-L*8+.5):V=INT(V-M*8+.5):IFU=0L=L-1:U=8
 1350 IFV=0M=M-1:V=8
 1360 GOSUB5170:GOSUB5095:GOTO450
 1460 O=0:A=84:PRINT@A,Y$;:FORJ=M-1TOM+1:FORZ=1TO3:N(Z)=0:NEXT
 1480 FORI=L-1TOL+1:IFI<1ORI>8ORJ<1ORJ>8THEN1510
 1490 N(I-L+2)=G(I,J):IFD(8)<0THEN1510
 1500 Z(I,J)=G(I,J)
 1510 NEXT
 1520 A=A+64:PRINT@A,LLIST"  : ### : ### : ### :   ";N(1);N(2);N(3);:A=A+64:PRINT@A,Y$;:NEXT:A=A+64:PRINT@A,Z$;:GOTO830
 1560 IFST=0PRINTC$(0);" - ";:GOTO850ELSEIFK=0GOSUB5250:GOTO830
 1590 GOSUB5150:Z7=1:IFD(8)<0PRINTD$(8);" FAILURE. MANUALLY ";
 1610 PRINT"LOCKED ON. ENERGY=";E;"... ";
 1620 INPUT"UNITS TO FIRE";F:IFF<=0THEN830ELSEIFF>ETHEN1590
 1640 E=E-F:GOSUB5100:IFD(8)<0F=RND(F)
 1650 R=640:FORI=1TO3:IFK(I,3)<0THEN1710
 1670 H=F/K:J=.98:GOSUB4800:K(I,3)=K(I,3)-H:PRINT" KLINGON - "+W$;:IFK(I,3)<0X=K(I,1):Y=K(I,2):GOSUB5195ELSEPRINTLLIST"AT SECTOR"+CO$+" (### LEFT)";K(I,1);K(I,2);K(I,3):GOSUB5000
 1710 NEXT:GOSUB2230:GOTO830
 1740 IFP>0THEN1760ELSEPRINT"ALL PHOTON TORPEDOES EXPENDED.":GOTO830
 1760 IFCL<>0GOSUB5260:GOTO830
 1780 PRINT@640,B$(10);:INPUT" COURSE (1-9)";C:IFC=0THEN830ELSEIFC<1ORC>9THEN1780ELSEIFC=9C=1
 1800 Z7=1:GOSUB5180:GOSUB1320:X=U-X1:Y=V-Y1:GOTO1830
 1810 PRINT@Q,"+";:GOTO1830
 1820 PRINT@Q," ";
 1830 GOSUB1330:IFZ=3THEN2020ELSEIFY=INT(Y)ANDO=1THENGOSUB5230:PRINT@Q,".";:ONS(C,D)+1GOTO1820,1900,1820,1810,1970,1990ELSEONS(C,D)+1GOTO1830,1900,1830,1830,1970,1990
 1900 FORI=1TO3:IFC=K(I,1)ANDD=K(I,2)K(I,3)=-1:X=C:Y=D:R=640:GOSUB5195
 1920 NEXT:GOTO2025
 1970 PRINT@640,LLISTB$(10)+" CAPTURED BY STAR'S GRAVITY AT SECTOR "+CO$;X;Y:GOTO2025
 1990 GOSUB5210:PRINT@640,"***  STAR BASE DESTROYED  *** ... CONGRATULATIONS!!":B=B-1:BT=BT-1:M2=1:X=C:Y=D:GOSUB5190:PRINT@704,"RESULTING EXPLOSION HAS BLOWN YOU OFF COURSE":C=RND(8):W=RND(8)/2:GOTO1200
 2020 PRINT@660," - ";B$(10);" MISSED."
 2025 GOSUB2230:GOTO760
 2030 IFST=0PRINTC$(0);" - ";:GOTO850
 2040 PRINT@640,;:INPUT"TOTAL UNITS ON SHIELDS";X:IFX<0ORX>E+GTHEN2040ELSEE=E+G-X:G=X:GOSUB5100:GOSUB5110:PRINT@704,"ENERGY CONSUMPTION IS NOW";5*(G/100+1);" UNITS PER SECTOR";W$;:GOTO830
 2090 R=0:PRINT@576," NEXT...HIT '['  ";
 2100 A$=INKEY$:IFA$=""THEN2100ELSEIFASC(A$)=13THEN830ELSEIFA$<>"["THEN2100ELSER=R+1:IFR>8THEN830ELSEGOSUB5160:GOTO2100
 2230 IFK=0RETURNELSEIFST=0Z7=0:PRINT@768,"STAR-BASE SHIELDS PROTECT THE ";V$;:RETURNELSER=640:FORI=1TO3:H=K(I,3):IFH<1NEXTELSEJ=1:GOSUB4800:PRINTLLISTV$+" FROM SECTOR"+CO$+W$;K(I,1);K(I,2):G=G-H:GOSUB5010:NEXT
 2310 GOTO5110
 2330 PRINT"THE "V$;" IS DEAD IN SPACE. YOU ARE AT THE KLINGONS' MERCY":FORZ=1TO6:GOSUB5000:NEXT
 2350 IFK=0THEN2390ELSEGOSUB2230:GOTO2350
 2360 PRINT"IT IS STARDATE ";T;W$:GOTO2390
 2380 PRINT@768,"THE "+V$+" WAS DESTROYED, THE ";U$;" WILL BE CONQUERED
 2390 PRINT"THERE ARE STILL";KT;"KLINGON BATTLE-CRUISERS SURVIVING.":END
 2410 PRINT"THE LAST KLINGON BATTLE-CRUISER IN THE GALAXY IS DESTROYED !!<ERROR>THE ";U$;" IS SAVED !! YOUR EFFICIENCY RATING =";K7/(T-T0)*1000:END
 2770 CD=0
 2780 A=0:GOSUB860:PRINT@580,X$+CHR$(29)+"OPTION?";
 2790 A$=INKEY$:IFA$=""THEN2790ELSEIFASC(A$)=13PRINT@576,:ONA+1GOTO830,3320,2960,3060,3080,3300,2890ELSEGOSUB860:A=VAL(A$):PRINT@590,A;:IFA>6A=0:GOTO2790ELSEF=A*2+17:PRINT@494,B$(F);:PRINT@558,B$(F+1);:GOTO2790
 2890 O=0:A=84:FORJ=1TO8:PRINT@A,;:FORI=1TO8:PRINTLLIST"###";Z(I,J);:NEXT:A=A+64:NEXT:GOTO2780
 2960 O=0:FORA=84TO532STEP64:PRINT@A,Y$;:NEXT:PRINT@84,"     STATUS REPORT:";:PRINT@212,"  KLINGONS  LEFT=";KT;:PRINT@276,"  STARDATES LEFT=";T0+TT-T;:PRINT@340,"  STARBASES LEFT=";BT;:GOTO2780
 3060 IFK=0GOSUB5250:GOTO2780ELSECC=U:A=V:FORF=1TO3:IFK(F,3)<0THEN3290ELSEW=K(F,1):X=K(F,2):GOTO3110
 3080 INPUT"START AND END CO-ORDINATES ARE (X,Y,X,Y)";CC,A,W,X
 3110 PRINT@704,;:X=X-A:A=CC-W:IFX<0THEN3200ELSEIFA<0THEN3230ELSEIFX>0THEN3140ELSEIFA=0THEN3210
 3140 CC=5
 3150 IFABS(A)<=ABS(X)THEN3180ELSECC=CC+(((ABS(A)-ABS(X))+ABS(A))/ABS(A)):GOTO3280
 3180 CC=CC+ABS(A)/ABS(X):GOTO3280
 3200 IFA>0CC=7:GOTO3240ELSEIFX=0THEN3230
 3210 CC=1:GOTO3150
 3230 CC=3
 3240 IFABS(A)>=ABS(X)CC=CC+ABS(X)/ABS(A)ELSECC=CC+(((ABS(X)-ABS(A))+ABS(X))/ABS(X))
 3280 PRINT@704,"COURSE =";CC;:CD=INT(SQR(X^2+A^2)):PRINT", DISTANCE =";CD:GOTO2780
 3290 NEXT:GOTO2780
 3300 IFD(5)<0THEN850ELSEIFP<1ORCL=1THEN1740ELSEIFCD<>0THENC=CC:GOTO1800ELSE3330
 3320 IFCD<>0C=CC:W=CD:GOTO1020
 3330 PRINT"NO DATA AVAILABLE FOR GUIDANCE SYSTEM":GOTO2780
 3350 X=RND(8):Y=RND(8):IFS(X,Y)<>0THEN3350ELSERETURN
 3460 PRINT"<ERROR>YOU ARE THE COMMANDER OF THE STARSHIP 'ENTERPRISE'- YOUR MISSIONTO DESTROY KLINGON BATTLE-CRUISERS THREATENING THE FEDERATION -<ERROR><ERROR>         'TO BOLDLY GO WHERE NO MAN HAS GONE BEFORE'<ERROR>";
 3465 PRINT"<ERROR>YOU MUST DO THIS WITHIN 32 STARDATES.";
 3470 PRINT"<ERROR><ERROR>THE GALAXY IS REPRESENTED AS A 64 BY 64 MATRIX MADE UP FROM 8<ERROR>8 BY 8 QUADRANTS - EACH CONTAINING 8  8 BY 8 SECTORS.<ERROR><ERROR>THE FOLLOWING OBJECTS ARE GRAPHICALLY REPRESENTED";
 3475 PRINT"<ERROR><+> = THE ENTERPRISE.<ERROR>+++ = KLINGON BATTLE CRUISER.<ERROR>>!< = STARBASE.<ERROR> .  = STAR.
 3480 GOSUB4790
 3485 PRINT"<ERROR>STARS ( . ) ... THESE ARE OBSTACLES. KLINGONS CAN HIDE BEHIND<ERROR>THEM. IF YOU BUMP INTO THEM, YOU MAY DAMAGE YOUR SHIP.";
 3495 PRINT"<ERROR><ERROR>STARBASES ( >!< ) ... REFUGE AND REFUELLING POINTS. TO DOCK WITHA BASE, YOU MERELY NAVIGATE TO EITHER SIDE OF IT. REFUELLING IS<ERROR>DONE AUTOMATICALLY - YOU MAY USE A BASE ANY NUMBER OF TIMES.";
 3505 PRINT"<ERROR><ERROR>KLINGONS ( +++ ) ... THE ENEMY. THEY OFTEN SHOOT FIRST AND ASK<ERROR>QUESTIONS NEXT. THEY ARE ARMED WITH PHASERS AND DEFLECTOR";
 3515 PRINT"<ERROR>SHIELDS, BUT SOME ARE ARMED WITH CLOAKING DEVICES WHICH MAKE<ERROR>THEM INVISIBLE AND IMMUNE TO PHOTON TORPEDO ATTACK.";
 3520 PRINT"<ERROR><ERROR>THE ENTERPRISE ( <+> ) ... THAT'S YOU. A MODERN POWERFUL WARP-<ERROR>DRIVE SHIP, WITH ALL THE LATEST DEVICES, SUCH AS; SCANNERS,<ERROR>PHASERS, PHOTON TORPEDOES, DEFLECTOR SHIELDS, AND AN ON-BOARD<ERROR>COMPUTER. THESE ARE DESCRIBED NEXT.";
 3525 GOSUB4790
 3530 PRINT"<ERROR>COMMAND 1 .... WARP ENGINE CONTROL. IT IS IMPORTANT TO KNOW THE<ERROR>CIRCULAR VECTOR ARRANGEMENT AS SHOWN. INTEGER AND REAL VALUES<ERROR>MAY BE USED. E.G. 1.5 IS HALFWAY BETWEEN 1 AND 2.";
 3540 PRINT"<ERROR><ERROR>1 WARP FACTOR        8    1    2       VECTOR OF 9 IS UNDEFINED<ERROR>MOVES EXACTLY          .  .  .         BUT VALUES MAY APPROACH 91 QUADRANT,        7.0.  ...  . .3<ERROR>.1 WARP FACTOR         .  .  .<ERROR>MOVES 1 SECTOR       6    5    4";
 3545 PRINT"<ERROR><ERROR>TO MOVE FROM QUADRANT 5,5 TO 6,5 YOU WOULD USE COURSE 3,<ERROR>WARP FACTOR 1. USE WARPS LESS THAN 1 TO MOVE SECTOR TO SECTOR.";
 3550 PRINT"<ERROR><ERROR>COMMAND 2 .. SHORT RANGE SENSOR SCAN. DISPLAYS ON THE ENTERPRISESCREEN THE IMMEDIATE QUADRANT, SHOWING POSITIONS OF ANY OBJECTS<ERROR>IN THAT GALACTIC QUADRANT.";
 3555 GOSUB4790
 3560 PRINT"<ERROR>COMMAND 3 .. LONG RANGE SENSOR SCAN. SHOWS CONDITIONS IN SPACE<ERROR>FOR 1 QUADRANT EACH SIDE OF THE ONE YOU ARE IN, WHICH IS DISPLAYED IN THE CENTRE. THE SCAN IS IN THE FORM XXX , WHERE THE UNITS<ERROR>DIGIT IS THE NUMBER OF STARS, THE TENS DIGIT IS";
 3570 PRINT" THE NUMBER OF<ERROR>STARBASES, THE HUNDREDS DIGIT IS THE NUMBER OF KLINGONS.";
 3575 PRINT"<ERROR><ERROR>COMMAND 4 .. PHASER CONTROL. THIS ALLOWS YOU TO AIM PURE ENERGY<ERROR>AT ANY KLINGONS IN THE VICINITY. EACH PHASER BURST WILL DEPLETE<ERROR>HIS SHIELDS AND REDUCE HIS PHASER CAPABILITY - AND YOUR ENERGY."
 3580 PRINT"<ERROR>COMMAND 5 .. PHOTON TORPEDO CONTROL. ENABLES YOU TO COMPLETELY<ERROR>DESTROY A KLINGON WITH A SINGLE HIT. TORPEDO COURSE IS THE SAME<ERROR>VECTOR ARRANGEMENT AS ALREADY DESCRIBED.<ERROR><ERROR>":GOSUB4790
 3585 PRINT"<ERROR>COMMAND 6 .. SHIELD CONTROL. ALLOWS PROTECTION OF THE ENTERPRISEBY PLACING SHIP'S ENERGY ONTO THE DEFLECTORS - INCREASES FUEL<ERROR>CONSUMPTION THOUGH.";
 3595 PRINT"<ERROR>COMMAND 7 .. DAMAGE CONTROL REPORT. SHOWS STATE OF REPAIR OF ALLDEVICES. A STATE OF LESS THAN ZERO MEANS THAT DEVICE IS<ERROR>TEMPORARILY DAMAGED.";
 3605 PRINT"<ERROR><ERROR>COMMAND 8 .. ON-BOARD COMPUTER - CONTAINS FOLLOWING OPTIONS:<ERROR>  OPTION 0. FINISHED WITH COMPUTER, RETURN CONTROL TO CONSOLE.<ERROR>  OPTION 1. COMPUTER GUIDES YOU ON THE COURSE FROM OPTION 4<ERROR>  OPTION 2. STATUS REPORT - SHOWS HOW FAR THE MISSION HAS GONE
 3610 PRINT"  OPTION 3. GIVES BEARING OF ANY KLINGONS IN THE QUADRANT<ERROR>  OPTION 4. SHOWS VECTOR NEEDED TO TRAVEL BETWEEN INPUT CO-ORDS.  OPTION 5. GUIDED PHOTON TORPEDO ON COURSE FROM OPTION 3.";
 3615 PRINT"<ERROR>  OPTION 6. CUMULATIVE RECORD OF ALL LONG RANGE SENSOR SCANS.
 3620 GOSUB4790:RETURN
 4790 PRINT@999,"PRESS ENTER TO CONTINUE:";
 4795 A$=INKEY$:IFA$<>""THENRETURNELSE4795
 4800 H=(H*2/SQR((K(I,1)-U)^2+(K(I,2)-V)^2))*(J*RND(0)+.2):R=R+64:PRINT@R,LLISTW$+"### UNIT HIT ON ";H;:RETURN
 4900 IFK<>3IFRND(10)>7CL=1
 4910 FORI=1TO3:K(I,3)=-1:NEXT:FORI=1TOK:GOSUB3350:S(X,Y)=CL+1:K(I,1)=X:K(I,2)=Y:K(I,3)=200:NEXT:RETURN
 5000 FORZZ=1E3TO1.8E3:NEXT:RETURN
 5010 FORZZ=0TOH*.25:OUT255,8:ZZ=ZZ+.1:OUT255,0:ZZ=ZZ-.1:NEXT:RETURN
 5030 CLS:FORA=1TO28STEP27:Z=3:FORX=40TO87:SET(X,A):Z=Z+1:IFZ=6THENZ=0:SET(X,A-1):SET(X,A+1):NEXTELSENEXTX,A
 5040 FORA=38TO89STEP51:Z=2:FORX=1TO28:SET(A,X):Z=Z+1:IFZ<>3NEXTELSEZ=0:SET(A+1,X):SET(A-1,X):NEXTX,A
 5045 X=1:Z=25:GOSUB5050:X=88:Z=19:GOSUB5050:FORX=88TO126:SET(X,28):NEXT:GOTO5090
 5050 FORX=XTOX+38:FORY=1TOZSTEP6:SET(X,Y):NEXTY,X:RETURN
 5090 PRINT@66,"STARDATE";:PRINT@194,"QUADRANT";:PRINT@245,"ENERGY";:PRINT@322,"SECTOR";:PRINT@373,"SHIELDS";:PRINT@450,"PHOTON T.";:GOTO5150
 5095 E=E-((N*5)*(G/100+1))
 5100 PRINT@238,LLIST"####";E;:GOSUB5120
 5110 PRINT@366,LLIST"####";G;:GOSUB5150:IFG<0THEN2380ELSERETURN
 5120 FORZ=U-1TOU+1:IFZ<1ORZ>8NEXTELSEIFS(Z,V)=5THENZ=U+1:GOSUB5240:NEXT:GOTO5130ELSENEXT
 5122 IFK=0THEN5126
 5124 IFST<>3ST=3:GOTO5140ELSE5130
 5126 IFE>300ST=1:GOTO5130ELSEIFE>5*(G/100+1)IFST<>2ST=2:GOTO5140ELSE5130
 5128 PRINT@640,;:IFG=0THEN2330ELSEPRINT"YOU HAVE";E;"UNITS OF ENERGY. SHIELDS ARE TAKING";G;"UNITS":GOSUB5000:IFD(6)<0PRINT"BUT, ";D$(6);" IS OUT.SITUATION IRRECOVERABLE.":GOTO2330ELSE5124
 5130 PRINT@110,C$(ST);:GOTO5150
 5140 FORFL=1TO4:PRINT@110,C$(ST);:FORZZ=1TO50:NEXT:PRINT@110,"      ";:FORZZ=1TO50:NEXTZZ,FL:GOTO5130
 5150 PRINT@640,;:RETURN
 5160 PRINT@576,X$;:PRINT@576,D$(R);:PRINT@590,D(R);:GOTO5150
 5170 T=T+1:PRINT@77,T;:GOSUB5150:IFT>T0+TTTHEN2360ELSERETURN
 5180 IFST=0P=10ELSEP=P-1
 5185 PRINT@462,P;:GOTO5150
 5190 GOSUB5210:S(X,Y)=0:G(L,M)=K*100+B*10+S:RETURN
 5195 K=K-1:GOSUB5190:GOSUB5120:PRINT@R+28,LLIST"KLINGON AT"+CO$+" DESTROYED"+W$;X;Y:KT=KT-1:IFKT=0THEN2410ELSEGOSUB5000:IFK=0CL=0:RETURNELSERETURN
 5200 ST=0:FORZ=1TO8:D(Z)=0:NEXT:E=5000:PRINT@237,E;:GOSUB5180:G=0:GOTO5110
 5210 IFO<>1RETURNELSEGOSUB5230:FORZ=1TO30:PRINT@Q+RND(3)-2,CHR$(128+RND(62));:NEXT
 5220 PRINT@Q-1,"   ";:GOTO5150
 5230 Q=18.5+X*3+64*Y:RETURN
 5240 IFST=0RETURNELSEPRINT@640,"SHIELDS DROPPED FOR DOCKING PURPOSES";W$:GOSUB5200:GOTO5140
 5250 PRINT"SENSORS DETECT NO KLINGONS IN THIS QUADRANT":RETURN
 5260 PRINTD$(5);" WILL BE OF NO USE - ";B$(8);W$;:RETURN

    1 REM NOTE: Basic language type forced to be:
    2 REM       trs2 - TRS-80 Level II BASIC tokenized file
    1 '......DRAWART/BAS   aus Creative Computing  Jan/83 S. 268
    5 CMD"t
    6 DEFAUTO1=&HE000:DEFAUTO2=&HE010:FORAA=0TO27:READZZ:POKE&HE000+AA,ZZ:NEXT
   10 CLS:CLEAR:DIMX(255),Y(255),Q(40),W(40)
   20 Q=64:W=24:SET(Q,W):X(32)=-1:X(64)=1
   25 Y(8)=-1:Y(16)=1:R=1
   30 GOSUB1000:IFFK=1THENR=-R
   40 A$=INKEY$:IFA$=""THEN30
   50 IFA$="l"ORA$="L"THEN2000
   80 IFA$="c"ORA$="C"THEN5000
   90 IFA$="p"ORA$="P"THEN6000
  100 GOTO30
 1000 FK=0:A=PEEK(14400):IFA=0THENRETURN
 1010 IFR=-1THENRESET(Q,W)
 1020 Q1=Q:W1=W:Q=Q+X(A):W=W+Y(A)
 1025 IFQ<0THENQ=Q+128ELSEIFQ>127THENQ=Q-128
 1026 IFW<0THENW=W+48ELSEIFW>47THENW=W-48
 1030 FK=0:IFA=128THENFORZA=1TO30:NEXT:FK=1
 1040 SET(Q,W):RETURN
 2000 R=-1:T=0
 2010 GOSUB1000:IFINKEY$="g"THEN2040
 2015 IFR=1AND (Q(T)<>QORW(T)<>W)THENR=-1
 2020 IFFK=0THEN2010
 2030 R=1:IFQ=Q(T)ANDW=W(T)THEN2010
 2035 T=T+1:Q(T)=Q:W(T)=W:IFT<40THEN2010
 2040 IFT<2THEN30
 2050 FORGT=1TOT-1:X=Q(GT):Y=W(GT)
 2055 X1=Q(GT+1):Y1=W(GT+1)
 2060 GOSUB3000:NEXT:GOTO30
 3000 IFABS(X1-X)<ABS(Y1-Y)THEN3070
 3010 FORX2=XTOX1STEP2*(X1<X)+1
 3020 SET(X2,(X2-X)*(Y1-Y)/(X1-X)+Y+.5)
 3030 NEXT:RETURN
 3070 FORY2=YTOY1STEP2*(Y1<Y)+1
 3080 SET(.5+(Y2-Y)*(X1-X)/(Y1-Y)+X,Y2)
 3090 NEXT:RETURN
 5000 R=-1:T=0
 5010 GOSUB1000
 5015 IFR=1AND (Q(T)<>QORW(T)<>W)THENR=-1
 5020 IFFK=0THEN5010
 5030 R=1:IFQ=Q(T)ANDW=W(T)THEN5010
 5035 T=T+1:Q(T)=Q:W(T)=W:IFT=1THEN5010
 5040 X=ABS(Q(1)-Q(2)):Y=X*3/7
 5045 KX=Q(1):KY=W(2)
 5050 T=Y*7/3:IFX>TTHENT=X
 5060 FORHJ=0TO2*3.1415STEP1/T
 5070 Z1=COS(HJ)*X+KX:Z2=SIN(HJ)*Y+KY
 5075 IFZ1<0ORZ1>127ORZ2<0ORZ2>47THEN5090
 5080 SET(Z1,Z2)
 5090 NEXT:GOTO30
 6000 P=AUTO1(0)
 6010 CLS:P=AUTO2(0):GOTO30
10000 DATA 33,0,60,17,0,236,1,0,4,237,176,201,255,0,255,0,33,0,236,17,0,60,1,0,4,237,176,201

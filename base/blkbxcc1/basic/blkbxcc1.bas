    1 REM NOTE: Basic language type forced to be:
    2 REM       trs2 - TRS-80 Level II BASIC tokenized file
   10 CLS:PRINT@411,"BLACK BOX"
   20 PRINT:PRINTTAB(7) "COPYRIGHT 1979 CREATIVE COMPUTING MORRISTOWN, NJ"
   30 PRINT @960, "";: INPUT "HIT ENTER TO START";I$
   40 CLS :PRINT "NUMBER OF ATOMS";:INPUT N:CLS:GOSUB 560
   50 FOR J=0 TO 9:FORI=0TO9:B(I,J)=0:NEXTI,J
   60 FOR I=1TON
   70 X=RND(8):Y=RND(8):IFB(X,Y)<>0THEN70
   80 B(X,Y)=1:NEXTI
   90 S=0:C=0
  100 PO=PO+8:IFPO=960THENPO=11*64
  110 PRINT@PO,"RAY";CHR$(30);:PO=PO+8:INPUTR:IFR<1THEN380
  120 ON(R-1)/8+1GOTO140,150,160,170
  130 PRINT "ERROR":GOTO100
  140 X=0:Y=R:U=1:V=0:GOTO180
  150 X=R-8:Y=9:U=0:V=-1:GOTO180
  160 X=9:Y=25-R:U=-1:V=0:GOTO180
  170 X=33-R:Y=0:U=0:V=1
  180 X1=X+U:Y1=Y+V
  190 IFU=0THENX2=X1-1:X3=X1+1:Y2=Y1:Y3=Y1:GOTO210
  200 Y2=Y1-1:Y3=Y1+1:X2=X1:X3=X1
  210 GOSUB640:ON8*B(X1,Y1)+B(X2,Y2)+2*B(X3,Y3)+1GOTO230,240,250,240
  220 PRINT@PO,"ABSRBD.":S=S+1:GOTO100
  230 X=X1:Y=Y1:GOTO280
  240 Z=1:GOTO260
  250 Z=-1
  260 IFU=0THENU=Z:V=0:GOTO280
  270 U=0:V=Z
  280 ON(X+15)/8GOTO320,300,330
  290 STOP
  300 ON(Y+15)/8GOTO340,180,350
  310 STOP
  320 Z=Y:GOTO360
  330 Z=25-Y:GOTO360
  340 Z=33-X:GOTO360
  350 Z=8+X
  360 IFZ=R THEN PRINT @PO,"RFLCTD.":S=S+1:GOTO100
  370 PRINT@PO,"TO";Z:S=S+2:GOTO100
  380 CLS:PRINT"NOW TELL ME WHERE YOU THINK THE ATOMS ARE?"
  390 PRINT"(IN ROW, COLUMN FORMAT PLEASE)"
  400 FOR Q=1TON
  410 PRINT"ATOM#";Q;
  420 INPUT I,J
  430 IF B(I,J)=0 THEN S=S+5:GOTO 450
  440 C=C+1
  450 NEXT Q
  460 CLS:GOSUB560:FORJ=1TO8:FORI=1TO8:FL=-1
  470 IF B(I,J)=0 THEN 490
  480 X1=I:Y1=J:GOSUB 640
  490 NEXT I:NEXT J
  500 PRINT@11*64,"YOU GUESSED";C;"OUT OF";N;"ATOMS CORRECTLY!!"
  510 PRINT"YOUR SCORE FOR THIS ROUND WAS";S;"POINTS."
  520 PRINT
  530 INPUT"CARE TO TRY AGAIN";A$
  540 IF LEFT$(A$,1)="Y" THEN CLEAR:GOTO40
  550 END
  560 PRINT:A$="01240223032204210520061907180817"
  570 FOR LO=0 TO 7:FR$=MID$(A$,LO*4+1,2):LN$=MID$(A$,LO*4+3,2)
  580 PRINTFR$;" ";    CHR$(191);STRING$(23,32);CHR$(191);" ";LN$:NEXT
  590 PRINT@580, CHR$(27);STRING$(23,176)
  600 PRINT "   09 10 11 12 13 14 15 16";
  610 PRINT@68,STRING$(23,131);
  620 PRINT@0,"   32 31 30 29 28 27 26 25";
  630 PRINT@292,CHR$(93);"----THE BLACK BOX";:PO=11*64-8:RETURN
  640 IF X1=0 OR X1=9 OR Y1=0 OR Y1=9 THEN RETURN
  650 PR=PEEK(Y1*64+X1*3+1+15360):IFPR<>32 THENCR=12+PR ELSE CR=140
  660 PRINT@Y1*64+X1*3+1,CHR$(CR);:IF FL THEN RETURN
  670 PRINT@Y1*64+X1*3+1, CHR$(PR);: RETURN

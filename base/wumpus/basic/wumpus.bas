1000	RANDOMIZE
1010	REM *******WUMPUS VERSION II
1020	PRINT "INSTRUCTIONS (Y,N)";
1030	INPUT I$
1040	PRINT
1050	IF MID$(I$,1,1) <> "Y" THEN 1090
1060	GOSUB 1670
1070	REM *******CHOOSE & SET UP A CAVE
1080	DIM S(20,3)
1090	GOSUB 3600
1100	DEF FNA(X)=INT(20*RND(0))+1
1110	DEF FNB(X)=INT(3*RND(0))+1
1120	DEF FNC(X)=INT(4*RND(0))+1
1130	REM *******LOCATE L ARRAY ITEMS
1140	REM *******1-YOU, 2-WUMPUS, 3&4-PITS, 5&6-BATS
1150	DIM L(6)
1160	DIM M(6)
1170	FOR J = 1 TO 6
1180	    L(J) = FNA(0)
1190	    M(J) = L(J)
1200	NEXT J
1210	REM *******CHECK FOR CROSSOVERS (I.E. L(1) = L(2), ETC.)
1220	FOR J = 1 TO 6
1230	    FOR K = J TO 6
1240		IF J = K THEN 1270
1250		IF L(J) = L(K) THEN 1170
1260	    NEXT K
1270	NEXT J
1280	REM *******SET # ARROWS
1290	A = 5
1300	L = L(1)
1310	REM *******RUN THE GAME
1320	PRINT"HUNT THE WUMPUS"
1330	REM *******HAZARD WARNINGS & LOCATION
1340	GOSUB 2260
1350	REM *******MOVE OR SHOOT
1360	GOSUB 2430
1370	ON O GOTO 1390,1420
1380	REM *******SHOOT
1390	GOSUB 2560
1400	IF F = 0 THEN 1360
1410	GOTO 1490
1420	REM *******MOVE
1430	GOSUB 3180
1440	IF F = 0 THEN 1340
1450	GOTO 1490
1460	REM *******MOVE
1470	GOSUB 3180
1480	IF F = 0 THEN 1340
1490	IF F > 0 THEN 1540
1500	REM *******LOSE
1510	PRINT"HA HA HA - YOU LOSE"
1520	GOTO 1550
1530	REM *******WIN
1540	PRINT"HEE HEE HEE - THE WUMPUS'LL GET YOU NEXT TIME!!"
1550	FOR J = 1 TO 6
1560	    L(J) = M(J)
1570	NEXT J
1580	PRINT"PLAY AGAIN ";
1590	INPUT I$
1600	PRINT
1610	IF MID$(I$,1,1) <> "Y" THEN 5280
1620	PRINT"SAME SETUP ";
1630	INPUT I$
1640	PRINT
1650	IF MID$(I$,1,1) <> "Y" THEN 1090
1660	GOTO 1290
1670	REM *******INSTRUCTIONS
1680	PRINT"WELCOME TO WUMPUS II"
1690	PRINT"THIS VERSION HAS THE SAME RULES AS 'HUNT THE WUMPUS'"
1700	PRINT"HOWEVER, YOU HAVE A CHOICE OF CAVES TO PLAY IN"
1710	PRINT"SOME CAVES ARE EASIER THAN OTHERS.  ALL CAVES HAVE 20 ROOMS"
1720	PRINT"AND 3 TUNNELS LEADING FROM ONE ROOM TO OTHER ROOMS"
1730	PRINT"THE CAVES ARE:"
1740	PRINT
1750	PRINT"	0  -  DODECAHEDRON	THE ROOMS OF THIS CAVE ARE A"
1760	PRINT"		12-SIDED OBJECT, EACH SIDE FORMING A PENTAGON"
1770	PRINT"		THE ROOMS ARE AT THE CORNERS OF THE PENTAGONS,"
1780	PRINT"		EACH ROOM HAVING TUNNELS LEADING TO 3 OTHER ROOMS"
1790	PRINT
1800	PRINT"	1  -  MOBIUS STRIP	THIS CAVE IS TWO ROOMS"
1810	PRINT"		WIDE AND TEN ROOMS AROUND (LIKE A BELT)"
1820	PRINT"		YOU WILL NOTICE THERE IS A HALF-TWIST"
1830	PRINT"		SOMEWHERE."
1840	PRINT
1850	PRINT"	2  -  STRING OF BEADS		FIVE BEADS ON A CIRCLE"
1860	PRINT"		EACH BEAD IS A DIAMOND WITH A VERTICAL"
1870	PRINT"		CROSS-BAR.  THE RIGHT & LEFT CORNERS LEAD"
1880	PRINT"		TO NEIBOURING BEADS.  (THIS ONE IS DIFFICULT"
1890	PRINT"		TO PLAY.)"
1900	PRINT
1910	PRINT"	3  -  HEX NETWORK	IMAGINE A HEX TILE FLOOR.  TAKE"
1920	PRINT"		A RECTANGLE WITH 20 POINTS (INTERSECTIONS)"
1930	PRINT"		INSIDE (4X4).  JOIN RIGHT & LEFT SIDES TO MAKE A"
1940	PRINT"		CYLINDER.  THEN JOIN TOP & BOTTOM TO FORM A"
1950	PRINT"		TORUS (DOUGHNUT)."
1960	PRINT"		HAVE FUN IMAGINING THIS ONE!"
1970	PRINT
1980	PRINT"	CAVES 1-3 ARE REGULAR IN THE SENSE THAT EACH ROOM"
1990	PRINT"	GOES TO THREE OTHER ROOMS & TUNNELS ALLOW TWO"
2000	PRINT"	WAY TRAFFIC.  HERE ARE SOME 'IRREGULAR' CAVES."
2010	PRINT
2020	PRINT"	4  -  DENDRITE WITH DEGENERACIES	PULL A PLANT FROM"
2030	PRINT"		THE GROUND.  THE ROOTS & BRANCHES FORM A"
2040	PRINT"		DENDRITE - I.E. THERE ARE NO LOOPING PATHS"
2050	PRINT"		DEGENERACY MEANS:  A)SOME ROOMS CONNENCT TO"
2060	PRINT"		THEMSELVES AND B) SOME ROOMS HAVE MORE THAN"
2070	PRINT"		ONE TUNNEL TO THE SAME OTHER ROOM, I.E. 12 HAS"
2080	PRINT"		TWO TUNNELS TO 13"
2090	PRINT
2100	PRINT"	5  -  ONE WAY LATTICE		HERE ALL TUNNELS GO ONE"
2110	PRINT"		WAY ONLY.  TO RETURN, YOU MUST GO AROUND THE"
2120	PRINT"		CAVE (ABOUT 5 MOVES)."
2130	PRINT
2140	PRINT"	6  -  ENTER YOUR OWN CAVE	THE COMPUTER WILL ASK"
2150	PRINT"		YOU THE ROOMS NEXT TO EACH ROOM IN THE CAVE."
2160	PRINT"		FOR EXAMPLE:"
2170	PRINT"		  ROOM # 1	?2,3,4		YOUR REPLY OF 2,3,4"
2180	PRINT"		MEANS ROOM 1 HAS TUNNELS GOING TO ROOMS:"
2190	PRINT"		2, 3 & 4."
2200	PRINT
2210	PRINT"	HAPPY HUNTING!"
2220	PRINT
2230	PRINT"********************************************"
2240	PRINT
2250	RETURN
2260	REM *******PRINT LOCATIONS AND HAZARD WARNINGS
2270	PRINT
2280	FOR J = 2 TO 6
2290	    FOR K = 1 TO 3
2300		IF S(L(1),K) <> L(J) THEN 2370
2310		ON J-1 GOTO 2320,2340,2340,2360,2360
2320		PRINT"I SMELL A WUMPUS!"
2330		GOTO 2370
2340		PRINT"I FEEL A DRAFT!"
2350		GOTO 2370
2360		PRINT"BATS NEARBY!"
2370	    NEXT K
2380	NEXT J
2390	PRINT"YOU ARE IN ROOM ";L(1);
2400	PRINT"  TUNNELS LEAD TO ";S(L,1);S(L,2);S(L,3)
2410	PRINT
2420	RETURN
2430	REM *******CHOOSE OPTION
2440	GOTO 2470
2450	PRINT"ERROR   "
2460	PRINT""
2470	PRINT"SHOOT OR MOVE  ";
2480	INPUT I$
2490	PRINT
2500	IF MID$(I$,1,1) <> "S" THEN 2530
2510	O=1
2520	RETURN
2530	IF MID$(I$,1,1) <> "M" THEN 2450
2540	O=2
2550	RETURN
2560	REM *******ARROW ROUTINE
2570	F=0
2580	REM *******PATH OF ARROW
2590	DIM P(5)
2600	GOTO 2630
2610	PRINT"ERROR   "
2620	PRINT""
2630	PRINT"NO. OF ROOMS (1-5) ";
2640	INPUT J9
2650	PRINT
2660	IF J9 < 1 THEN 2610
2670	IF J9 > 5 THEN 2610
2680	IF INT(J9) <> ABS(J9) THEN 2610
2690	FOR K = 1 TO J9
2700	    PRINT"ROOM #";
2710	    INPUT P(K)
2720	    PRINT
2730	    IF P(K) > 0 THEN 2750
2740	    GOTO 2780
2750	    IF P(K) < 21 THEN 2770
2760	    GOTO 2780
2770 	    IF INT(P(K)) = ABS(P(K)) THEN 2810
2780	    PRINT"ERROR   "
2790	    PRINT""
2800	    GOTO 2700
2810	NEXT K
2820	PRINT
2830	REM *******SHOOT ARROW
2840	A = A-1
2850	A9 = L(1)
2860	FOR K = 1 TO J9
2870	    FOR K1 = 1 TO 3
2880		IF S(A9,K1) = P(K) THEN 3020
2890	    NEXT K1
2900	    REM *******NO TUNNEL FOR THE ARROW
2910	    A9 = S(A9,FNB(1))
2920	    GOTO 3030
2930	NEXT K
2940	PRINT"MISSED"
2950	REM *******MOVE WUMPUS
2960	GOSUB 3100
2970	REM *******AMMO CHECK
2980	IF A > 0 THEN 3000
2990	F = -1
3000	RETURN
3010	REM *******SEE IF ARROW IS AT L(1) OR L(2)
3020	A9 = P(K)
3030	IF A9 <> L(2) THEN 3070
3040	PRINT"AHA! YOU GOT THE WUMPUS!  HE WAS IN ROOM";L(2)
3050	F = 1
3060	RETURN
3070	IF A9 = L(1) THEN 2930
3080	PRINT"OUCH!  ARROW GOT YOU!"
3090	GOTO 2990
3100	REM *******MOVE WUMPUS ROUTINE
3110	K = FNC(0)
3120	IF K = 4 THEN 3170
3130	L(2) = S(L(2),K)
3140	IF L(2) <> L THEN 3170
3150	PRINT"TSK TSK TSK - WUMPUS GOT YOU"
3160	F = -1
3170	RETURN
3180	REM *******MOVE ROUTINE
3190	F = 0
3200	GOTO 3230
3210	PRINT"ERROR   "
3220	PRINT""
3230	PRINT"WHERE TO ";
3240	INPUT L
3250	PRINT
3260	IF L < 1 THEN 3210
3270	IF L > 25 THEN 3190
3280 	IF INT(L) <> ABS(L) THEN 3210
3290	FOR K = 1 TO 3
3300	    REM *******CHECK IF LEGAL MOVE
3310	    IF S(L(1),K) = L THEN 3380
3320	NEXT K
3330	IF L = L(1) THEN 3380
3340	PRINT"NOT POSSIBLE - "
3350	PRINT""
3360	GOTO 3230
3370	REM *******CHECK FOR HAZARDS
3380	L(1) = L
3390	REM *******WUMPUS
3400	IF L <> L(2) THEN 3460
3410	PRINT"...OOPS!  BUMPED A WUMPUS!"
3420	REM *******MOVE WUMPUS
3430	GOSUB 3110
3440	IF F = 0 THEN 3460
3450	REM *******PIT
3460	IF L <> L(3) THEN 3480
3470	GOTO 3490
3480	IF L <> L(4) THEN 3530
3490	PRINT"YYYIIIIEEEE . . . FELL IN A PIT"
3500	F = -1
3510	RETURN
3520	REM *******BATS
3530	IF L <> L(5) THEN 3550
3540	GOTO 3560
3550	IF L <> L(6) THEN 3590
3560	PRINT"ZAP--SUPER BAT SNATCH!  ELSEWHEREVILLE FOR YOU!"
3570	L = FNA(1)
3580	GOTO 3380
3590	RETURN
3600	REM *******SELECT CAVE
3610	GOTO 3640
3620	PRINT"ERROR   "
3630	PRINT""
3640	PRINT"CAVE # (0-6) ";
3650	INPUT N
3660	PRINT
3670	IF N < 0 THEN 3620
3680	IF N > 6 THEN 3620
3690	IF INT(N) <> ABS(N) THEN 3620
3700	ON N+1 GOTO 3720,3740,3760,3780,3800,3820,3840
3710	GOTO 3850
3720	GOSUB 3870
3730	GOTO 3850
3740	GOSUB 3940
3750	GOTO 3850
3760	GOSUB 4020
3770	GOTO 3850
3780	GOSUB 4100
3790	GOTO 3850
3800	GOSUB 4180
3810	GOTO 3850
3820	GOSUB 4260
3830	GOTO 3850
3840	GOSUB 4340
3850	RETURN
3860	REM *******DODECAHEDRON
3870	RESTORE 3880
3880	DATA 2,5,8,1,3,10,2,4,12,3,5,14,1,4,6
3890	DATA 5,7,15,6,8,17,1,7,9,8,10,18,2,9,11
3900	DATA 10,12,19,3,11,13,12,14,20,4,13,15,6,14,16
3910	DATA 15,17,20,7,16,18,9,17,19,11,18,20,13,16,19
3920	GOSUB 4550
3930	RETURN
3940	REM *******MOBIUS STRIP
3950	RESTORE 3960
3960	DATA 20,2,3,19,1,4,1,4,5,2,3,6,3,6,7
3970	DATA 4,5,8,5,8,9,6,7,10,7,10,11,8,9,12
3980	DATA 9,12,13,10,11,14,11,14,15,12,13,16,12,16,17
3990	DATA 14,15,18,15,18,19,16,17,20,2,17,20,1,18,19
4000	GOSUB 4550
4010	RETURN
4020	REM *******STRING OF BEADS
4030	RESTORE 4040
4040	DATA 2,3,20,1,3,4,1,2,4,2,3,5,4,6,7
4050	DATA 5,7,8,5,6,8,6,7,9,8,10,11,9,11,12
4060	DATA 9,10,12,10,11,13,12,14,15,13,15,16,13,14,16
4070	DATA 14,15,17,16,18,19,17,19,20,17,18,20,1,18,19
4080	GOSUB 4550
4090	RETURN
4100	REM *******HEX NET ON TORUS
4110	RESTORE 4120
4120	DATA 6,10,16,6,7,17,7,8,18,8,9,19,9,10,20
4130	DATA 1,2,15,2,3,11,3,4,12,4,5,13,5,6,14
4140	DATA 7,16,20,8,16,17,9,17,18,10,18,19,6,19,20
4150	DATA 1,11,12,2,12,13,3,13,14,4,14,15,5,11,15
4160	GOSUB 4550
4170	RETURN
4180	REM *******DENDRITE W/ DEGENERACIES
4190	RESTORE 4200
4200	DATA 1,1,5,2,2,5,3,3,6,4,4,6,1,2,7
4210	DATA 3,4,7,5,6,10,8,9,9,8,8,10,7,9,11
4220	DATA 10,13,14,12,13,13,11,12,12,11,15,16,14,17,18
4230	DATA 14,19,20,15,17,17,15,18,18,16,19,19,16,20,20
4240	GOSUB 4550
4250	RETURN
4260	REM *******ONE WAY LATTICE
4270	RESTORE 4280
4280	DATA 5,4,8,1,5,6,2,6,7,3,7,8,8,9,12
4290	DATA 5,9,10,6,10,11,7,11,12,12,13,16,9,13,14
4300	DATA 10,14,15,11,15,16,16,17,20,13,17,18,14,18,19
4310	DATA 15,19,20,1,4,20,1,2,17,2,3,18,3,4,19
4320	GOSUB 4550
4330	RETURN
4340	REM *******INPUT OWN CAVE
4350	PRINT "(M)MAKE OR (R)READ A CAVE ";
4360	INPUT Y9$
4370	IF Y9$="M" GOTO 4400
4380	GOSUB 4800
4390	GO TO 4540
4400	FOR J = 1 TO 20
4410	    PRINT"ROOM #";J;
4420	    INPUT S(J,1),S(J,2),S(J,3)
4430	    FOR K = 1 TO 3
4440		IF S(J,K) > 0 THEN 4460
4450		GOTO 4490
4460		IF S(J,K) < 21 THEN 4480
4470		GOTO 4490
4480		IF INT(S(J,K)) = ABS(S(J,K)) THEN 4510
4490		PRINT"***** ERROR !!!!!"
4500		GOTO 4410
4510	    NEXT K
4520	NEXT J
4530	GOSUB 4620
4540	RETURN
4550	REM *******INPUT CAVE
4560	FOR J = 1 TO 20
4570	    FOR K = 1 TO 3
4580		READ S(J,K)
4590	    NEXT K
4600	NEXT J
4610	RETURN
4620	REM ********* OUTPUT A USER DUNGEON
4630	PRINT "DO YOU WANT TO SAVE THIS DUNGEON (Y,N)";
4640	INPUT Y9$
4650	IF MID$(Y9$,1,1)="N" THEN 4790
4660	PRINT "WHAT NAME DO YOU WANT TO GIVE IT "
4670	PRINT "INPUT A 6 CHARATER FILENAME: ";
4680	INPUT Y9$
4690	IF Y9$="" THEN 4790
4700	GOSUB 5140
4710	PRINT "YOUR DUNGEON WILL BE IN ";Y9$;".DUN"
4720	Y9$=Y9$ + ".DUN"
4730	FILE #1,Y9$
4740	SCRATCH #1
4750	FOR J=1 TO 20
4760	    PRINT #1,S(J,1),S(J,2),S(J,3)
4770	NEXT J
4780	CLOSE #1
4790	RETURN
4800	REM **************READ IN A USER CAVE
4810	PRINT "WHAT DUNGEON DO YOU WANT(NAME) ";
4820	INPUT Y9$
4830	GOSUB 5140
4840	Y9$=Y9$ + ".DUN"
4850	FILE #1, Y9$
4870	RESTORE  #1
4880	FOR J=1 TO 20
4890	    INPUT #1, S(J,1),S(J,2),S(J,3)
4900	    FOR K=1 TO 3
4910		IF S(J,K)=0 THEN 4950
4920	    NEXT K
4930	    Y8$="DATA OK"
4940	    GOTO 5060
4950	    PRINT "ALL ROOMS MUST HAVE 3 EXITS"
4960	    PRINT "ROOM ";J;" HAS EXITS TO:"
4985	    Y8$="RE-SAVE"
4970	    FOR L=1 TO 3
4980		IF S(J,L)=0 THEN 5000
4990		PRINT "    ROOM NUMBER: ";S(J,L)
5000	    NEXT L
5010	    FOR L=1 TO 3
5020		IF S(J,L)<>0 THEN 5050
5030		PRINT "    AND ROOM NUMBER ????";
5040		INPUT S(J,L)
5050	    NEXT L
5060	NEXT J
5070	CLOSE #1
5080	IF Y8$<>"RE-SAVE" THEN 5100
5090	GOSUB 4650
5100	RETURN
5110	REM ********** HELP USER INPUT A FILENAME
5120	PRINT "PLEASE INPUT A SIX(6) CHARACTER FILENAME";
5130	INPUT Y9$
5140	Y9(1) = INSTR(1,Y9$,".")
5150	Y9(2) = INSTR(1,Y9$,".")
5160	IF Y9(1)<>0 THEN 5200
5170	IF Y9(2)= 0 THEN 5240
5180	Y9$ = RIGHT$(Y9$,Y9(2)+1)
5190	GOTO 5240
5200	IF Y9(2) = 0 THEN 5230
5210	Y9$ = LEFT$(RIGHT$(Y9$,Y9(1)),Y9(2)+1)
5220	GOTO 5240
5230	Y9$ = LEFT$(Y9$,Y9(1))
5240	Y9(3) = LEN(Y9$)
5250	IF Y9(3)<1 THEN 5110
5260	IF Y9(3)>6 THEN 5110
5270	RETURN
5280	END

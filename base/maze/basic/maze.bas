1010 PRINT"BASIC LIBRARY--'AMAZES'--19-JUL-70"
1020 REM
1030 REM  DESCRIPTION--CONSTRUCTS A DIFFERENT MAZE EVERY TIME
1040 REM  IT IS RUN WITH ONLY ONE SOLUTION. THE USER CHOOSES THE 
1050 REM  DIMENSION OF THE MAZE.
1060 REM  *  *  *  *  *  *   MAIN PROGRAM   *  *  *  *  *  *  *  *  *  *  *
1070 REM 
1080 RANDOMIZE
1090 DIM W(25,103), V(25,103)
1100 PRINT "THIS PROGRAM WILL PRINT OUT A DIFFERENT MAZE EVERY TIME IT"
1110 PRINT "IS RUN AND GUARANTEES ONLY ONE PATH THROUGH.  YOU CAN CHOOSE"
1120 PRINT "THE DIMENSIONS OF THE MAZE. I.E. THE NUMBER OF SQUARES WIDE"
1130 PRINT "AND THE NUMBER OF SQUARES LONG.  A 23 BY 25 MAZE IS THE "
1140 PRINT "MAXIMUM, BUT ANY DIMENSIONS UP TO THESE LIMITS ARE OK."
1150 PRINT
1160 PRINT "WHAT ARE YOUR WIDTH AND LENGTH";
1170 INPUT H,V
1180 PRINT
1190 IF H<>1 THEN 1240
1200 IF V<>1 THEN 1240
1210 PRINT "MEANINGLESS DIMENSIONS, TRY AGAIN."
1220 PRINT
1230 GO TO 1160
1240 PRINT
1250 PRINT
1260 LET Q = 0
1270 LET Z = 0
1280 
1290 
1300 REM                           STEPS 1900 THRU 3200 PICK THE
1310 REM                           SQUARE IN WHICH TO START.
1320 
1330 
1340 LET X = INT(RND*H+1)
1350 FOR I = 1 TO H
1360  IF I = X THEN 1390
1370  PRINT ":--";
1380  GOTO 1400
1390  PRINT ":  ";
1400 NEXT I
1410 PRINT ":"
1420 LET C = 1
1430 LET W(X,1) = C
1440 LET C = C+1
1450 LET R = X
1460 LET S = 1
1470 GOTO 1750
1480 
1490 
1500 REM                           STEPS 4900 THRU 5700 LOOK FOR THE
1510 REM                           SQUARE IN WHICH TO START A NEW 
1520 REM                           PATH WHEN THE OLD ONE GETS BLOCKED.
1530 REM                           THE LINES ARE SCANNED FOR A SQUARE
1540 REM                           WHICH HAS ALREADY BEEN USED BUT IS
1550 REM                           ADJACENT TO AN OPEN SQUARE.
1560 
1570 
1580 IF R <> H THEN 1660
1590 IF S <> V THEN 1630
1600 LET R = 1
1610 LET S = 1
1620 GOTO 1740
1630 LET R = 1
1640 LET S = S+1
1650 GOTO 1740
1660 LET R = R+1
1670 
1680 
1690 REM                           STEPS 6500 THRU 13800 CHECK TO SEE
1700 REM                           WHICH ADJACENT SQUARES ARE OPEN FOR
1710 REM                           THE PATH TO FOLLOW.
1720 
1730 
1740 IF W(R,S) = 0 THEN 1580
1750 IF R-1 = 0 THEN 2180
1760 IF W(R-1,S) <> 0 THEN 2180
1770 IF S-1 = 0 THEN 1950
1780 IF W(R,S-1) <> 0 THEN 1950
1790 IF R = H THEN 1840
1800 IF W(R+1,S) <> 0 THEN 1840
1810 LET X = INT(RND*3+1)
1820 REM                          LEFT,UP,RIGHT
1830 ON X GOTO 2700,2770,2840
1840 IF S <> V THEN 1880
1850 IF Z = 1 THEN 1920
1860 LET Q = 1
1870 GOTO 1890
1880 IF W(R,S+1) <> 0 THEN 1920
1890 LET X = INT(RND*3+1)
1900 REM                          LEFT,UP,DOWN
1910 ON X GOTO 2700,2770,2940
1920 LET X = INT(RND*2+1)
1930 REM                          LEFT,UP
1940 ON X GOTO 2700,2770
1950 IF R = H THEN 2080
1960 IF W(R+1,S) <> 0 THEN 2080
1970 IF S<> V THEN 2010
1980 IF Z = 1 THEN 2050
1990 LET Q = 1
2000 GOTO 2020
2010 IF W(R,S+1) <> 0 THEN 2050
2020 LET X = INT(RND*3+1)
2030 REM                           LEFT,RIGHT,DOWN
2040 ON X GOTO 2700,2840,2940
2050 LET X = INT(RND*2+1)
2060 REM                          LEFT,RIGHT
2070 ON X GOTO 2700,2840
2080 IF S <> V THEN 2120
2090 IF Z = 1 THEN 2170
2100 LET Q = 1
2110 GOTO 2130
2120 IF W(R,S+1) <> 0 THEN 2170
2130 LET X = INT(RND*2+1)
2140 REM                          LEFT,DOWN
2150 ON X GOTO 2700,2940
2160 REM                          LEFT
2170 GOTO 2700
2180 IF S-1 = 0 THEN 2430
2190 IF W(R,S-1) <> 0 THEN 2430
2200 IF R=H THEN 2330
2210 IF W(R+1,S) <> 0 THEN 2330
2220 IF S<> V THEN 2260
2230 IF Z = 1 THEN 2300
2240 LET Q = 1
2250 GOTO 2270
2260 IF W(R,S+1) <> 0 THEN 2300
2270 LET X = INT(RND*3+1)
2280 REM                         UP,RIGHT,DOWN
2290 ON X GOTO 2770,2840,2940
2300 LET X = INT(RND*2+1)
2310 REM                         UP,RIGHT
2320 ON X GOTO 2770,2840
2330 IF S <> V THEN 2370
2340 IF Z = 1 THEN 2420
2350 LET Q = 1
2360 GOTO 2380
2370 IF W(R,S+1) <> 0 THEN 2420
2380 LET X = INT(RND*2+1)
2390 REM                         UP,DOWN
2400 ON X GOTO 2770,2940
2410 REM                         UP
2420 GOTO 2770
2430 IF R = H THEN 2550
2440 IF W(R+1,S) <> 0 THEN 2550
2450 IF S <> V THEN 2490
2460 IF Z = 1 THEN 2540
2470 LET Q = 1
2480 GOTO 2500
2490 IF W(R,S+1) <> 0 THEN 2540
2500 LET X = INT(RND*2+1)
2510 REM                         RIGHT,DOWN
2520 ON X GOTO 2840,2940
2530 REM                         RIGHT
2540 GOTO 2840
2550 IF S <> V THEN 2590
2560 IF Z = 1 THEN 2630
2570 LET Q = 1
2580 GOTO 2610
2590 IF W(R,S+1) <> 0 THEN 2630
2600 REM                         DOWN
2610 GOTO 2940
2620 REM                         BLOCKED
2630 GOTO 3140
2640 
2650 
2660 REM                          STEPS 13900 THRU 18100 MAKE A RANDOM
2670 REM                          CHOICE OF AVAILABLE PATHS.
2680 
2690 
2700 LET W(R-1,S) = C
2710 LET C = C+1
2720 LET V(R-1,S) = 2
2730 LET R = R-1
2740 IF C = H*V+1 THEN 3160
2750 LET Q = 0
2760 GOTO 1750
2770 LET W(R,S-1) = C
2780 LET C = C+1
2790 LET V(R,S-1) = 1
2800 LET S = S-1
2810 IF C = H*V+1 THEN 3160
2820 LET Q = 0
2830 GOTO 1750
2840 LET W(R+1,S) = C
2850 LET C = C+1
2860 IF V(R,S) = 0 THEN 2890
2870 LET V(R,S) = 3
2880 GOTO 2900
2890 LET V(R,S) = 2
2900 LET R = R+1
2910 IF C = H*V+1 THEN 3160
2920 LET Q = 0
2930 GOTO 2180
2940 IF Q = 1 THEN 3040
2950 LET W (R,S+1) = C
2960 LET C = C+1
2970 IF V(R,S) = 0 THEN 3000
2980 LET V(R,S) = 3
2990 GOTO 3010
3000 LET V(R,S) = 1
3010 LET S = S+1
3020 IF C = H*V+1 THEN 3160
3030 GOTO 1750
3040 LET Z = 1
3050 IF V(R,S) = 0 THEN 3090
3060 LET V(R,S) = 3
3070 LET Q = 0
3080 GOTO 3140
3090 LET V(R,S) = 1
3100 LET Q = 0
3110 LET R = 1
3120 LET S = 1
3130 GOTO 1740
3140 GOTO 1580
3150 REM                         PRINTS OUT THE MAZE FROM HERE ON.
3160 FOR J = 1 TO V
3170  PRINT "I";
3180  FOR I = 1 TO H
3190  IF V(I,J) < 2 THEN 3220
3200   PRINT "   ";
3210   GOTO 3230
3220   PRINT "  I";
3230  NEXT I
3240  PRINT
3250  FOR I = 1 TO H
3260   IF V(I,J) = 0 THEN 3300
3270   IF V(I,J) = 2 THEN 3300
3280   PRINT ":  ";
3290   GOTO 3310
3300   PRINT ":--";
3310  NEXT I
3320 PRINT ":"
3330 NEXT J
3340 END

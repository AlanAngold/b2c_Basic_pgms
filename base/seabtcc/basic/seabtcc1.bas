    1 REM NOTE: Basic language type forced to be:
    2 REM       trs2 - TRS-80 Level II BASIC tokenized file
   10 CLS
   20 PRINT@411,"SEA BATTLE"
   30 PRINTTAB(7)"COPYRIGHT 1979 CREATIVE COMPUTING MORRISTOWN, NJ"
   40 PRINT@968,"";:INPUT"WHAT IS YOUR NAME";N$:N$="CAPTAIN "+N$
   60 DD$="####":DIMA(15,20),D(9):CLS
   70 PRINT"SETTING UP BOARD...."
   80 FORI=1TO15:FORJ=1TO20:A(I,J)=0:NEXTJ,I
   90 RESTORE:FORJK=1TO25:READJK$:NEXTJK
  100 FORX=7TO13:FORY=5TO10:READA(X,Y):NEXTY,X
  110 S1=10:S2=10:A(S1,S2)=2:S=INT(RND(16))+7
  120 RESTORE:FORJK=1TO9:READJK$:NEXTJK
  130 FORX=1TO(INT(RND(0)*4)+1)*2-1
  140 READD8,D9
  150 NEXTX
  160 FORX=1TOS
  170 X1=INT(RND(0)*15)+1
  180 X2=INT(RND(0)*20)+1
  190 IFA(X1,X2)<>0THEN170
  200 A(X1,X2)=3
  210 NEXTX
  220 PRINT"YOU MUST DESTROY";S;"ENEMY SHIPS TO WIN, ";N$;"."
  230 S3=INT(RND(0)*15)+1
  240 S4=INT(RND(0)*20)+1
  250 IFA(S3,S4)<>0THEN230
  260 A(S3,S4)=4
  270 FORX=1TOINT(RND(0)*8)+8
  280 X1=INT(RND(0)*15)+1
  290 X2=INT(RND(0)*20)+1
  300 IFA(X1,X2)<>0THEN280
  310 A(X1,X2)=5
  320 NEXTX
  330 FORX=1TO4
  340 X1=INT(RND(0)*14)+2
  350 X2=INT(RND(0)*18)+2
  360 IFA(X1,X2)<>0THEN340
  370 A(X1,X2)=6
  380 RESTORE
  390 FORJK=1TO9
  400 READJK$
  410 NEXTJK
  420 FORY=1TOINT(RND(0)*8)+1
  430 READM1,M2
  440 NEXTY
  450 NEXTX
  460 FORI=1TO9
  470 D(I)=0
  480 NEXTI
  490 C=30
  500 P=6000
  510 F=2500
  520 T=10
  530 M=3
  540 D=100
  550 D2=2
  560 PRINT
  570 PRINT"WHAT ARE YOUR ORDERS, ";N$;
  580 INPUT O
  585 IFO=1ORO=0THEN600
  590 CLS
  600 ONINT(O+1)GOTO740,1350,1920,2390,3000,3150,3540,3710,4240,4470
  610 CLS
  620 PRINT"THE COMMANDS ARE:"
  630 PRINT"     #0: NAVIGATION"
  640 PRINT"     #1: SONAR"
  650 PRINT"     #2: TORPEDO CONTROL"
  660 PRINT"     #3: POLARIS MISSILE CONTROL"
  670 PRINT"     #4: MANOUVERING"
  680 PRINT"     #5: STATUS/DAMAGE REPORT"
  690 PRINT"     #6: HEADQUARTERS"
  700 PRINT"     #7: SABOTAGE"
  710 PRINT"     #8: POWER CONVERSION"
  720 PRINT"     #9: SURRENDER"
  730 GOTO560
  740 IFD(1)>=0THEN770
  750 PRINT"ENGINES ARE UNDER REPAIR, ";N$;"."
  760 GOTO560
  770 IFC>8THEN800
  780 PRINT"NOT ENOUGH CREW TO MAN THE ENGINES, ";N$;"."
  790 GOTO560
  800 D1=1-((.23+RND(0)/10)*(-(D<=50)))
  810 GOSUB5990
  820 PRINT"POWER AVAILABLE=";P; CHR$(8);". POWER TO USE";
  830 INPUTP1
  840 IFP1<0ORP1>PTHEN820
  850 IFP1<=1000THEN900
  860 IFRND(0)<.43THEN900
  870 PRINT"ATOMIC PILE GOES SUPERCRITICAL, ";N$;"!!! HEADQUARTERS"
  880 PRINT"WILL WARN ALL SUBS TO STAY FROM RADIOACTIVE AREA!!!!"
  890 GOTO6110
  900 X=S1
  910 Y=S2
  920 Q1=1
  930 FORX2=1TOINT(INT(P1/100+.5)*D1+.5)
  940 IFX+X1>0ANDX+X1<16ANDY+Y1>0ANDY+Y1<21THEN970
  950 PRINT"YOU CAN'T LEAVE THE AREA, ";N$;"!!!"
  960 GOTO1030
  970 ONA(X+X1,Y+Y1)+1GOTO980,1020,1300,1080,1130,1160,1180
  980 X=X+X1
  990 Y=Y+Y1
 1000 P=P-100
 1010 GOTO1200
 1020 PRINT"YOU ALMOST RAN AGROUND, ";N$;"!!"
 1030 A(X,Y)=2
 1040 A(S1,S2)=0
 1050 S1=X
 1060 S2=Y
 1070 GOTO4490
 1080 IFD>50THEN980
 1090 PRINT"YOU RAMMED A SHIP!!!YOU'RE BOTH SUNK, ";N$;"!!"
 1100 S=S-1
 1110 IFS=0THEN6180
 1120 GOTO6110
 1130 IFD>50THEN980
 1140 PRINT"YOU RAMMED YOUR HEADQUARTERS!! YOU'RE SUNK!!"
 1150 GOTO6110
 1160 PRINT"YOU'VE BEEN BLOWN UP BY A MINE, ";N$;"!!"
 1170 GOTO6110
 1180 IFRND(0)<.21THEN1300
 1190 GOTO6110
 1200 FORX3=X-2TOX+2
 1210 FORY3=Y-2TOY+2
 1220 IFX3<1ORX3>15ORY3<1ORY3>20THEN1280
 1230 IFA(X,Y)<>6THEN1280
 1240 IFRND(0)<.25THEN1270
 1250 IFQ1=0THEN1280
 1260 PRINT"YOU JUST HAD A NARROW ESCAPE WITH A SEA MONSTER, ";N$;"!!"
 1270 Q1=0
 1280 NEXTY3
 1290 NEXTX3
 1300 NEXTX2
 1310 PRINT"NAVIGATION COMPLETE. POWER LEFT=";P;CHR$(8);"."
 1320 IFP>0THEN1030
 1330 PRINT"ATOMIC PILE HAS GONE DEAD!!!SUB SINKS, CREW SUFFOCATES!"
 1340 GOTO6110
 1350 IFD(2)>=0THEN1380
 1360 PRINT"SONAR IS UNDER REPAIR, ";N$;"."
 1370 GOTO560
 1380 IFC>5THEN1410
 1390 PRINT"NOT ENOUGH CREW TO WORK SONAR, ";N$;"."
 1400 GOTO560
 1410 PRINT"OPTION #";
 1420 INPUTO
 1430 ONINT(O+1)GOTO1450,1660
 1440 GOTO1410
 1450 CLS
 1460 FORX=1TO15
 1470 FORY=1TO20
 1480 QW$="   ***(X)<S>!H! $ -#-"
 1490 IFA(X,Y)<>0THEN1530
 1500 IFX<>1ANDX<>15ANDY<>1ANDY<>20THEN1530
 1510 PRINT" . ";
 1520 GOTO1570
 1530 A$=MID$(QW$,A(X,Y)*3+1,3)
 1540 IFD<50ANDRND(1)<.23ANDA(X,Y)<>1ANDA(X,Y)<>2THEN1510
 1550 IFRND(0)<.15ANDA(X,Y)>2THEN1510
 1560 PRINTA$;
 1570 NEXTY
 1580 PRINT
 1590 NEXTX
 1600 P=P-50
 1610 PRINT@979,"PRESS ANY KEY TO CONTINUE";
 1620 IFINKEY$=""THEN1620
 1630 CLS
 1640 IFP>0THEN560
 1650 GOTO1330
 1660 FORI=1TO5
 1670 B(I)=0
 1680 NEXTI
 1690 PRINT"DIRECTION   # OF SHIPS   DISTANCES"
 1700 PRINT"---------   ----------   ---------"
 1710 RESTORE
 1720 FORJK=1TO9
 1730 READJK$
 1740 NEXTJK
 1750 FORX=1TO8
 1760 READX1,Y1
 1770 X3=0
 1780 FORX4=1TO20
 1790 IFS1+X1*X4<1ORS1+X1*X4>15ORS2+Y1*X4<1ORS2+Y1*X4>20THEN1840
 1800 IFA(S1+X1*X4,S2+Y1*X4)<>3THEN1830
 1810 X3=X3+1
 1820 B(X3)=X4
 1830 NEXTX4
 1840 IFX3=0THEN1900
 1850 PRINT"   ";X,X3,
 1860 FORX4=1TOX3
 1870 PRINTB(X4);
 1880 NEXTX4
 1890 PRINT
 1900 NEXTX
 1910 GOTO1600
 1920 IFD(3)>=0THEN1950
 1930 PRINT"TORPEDO TUBES ARE UNDER REPAIR, ";N$;"."
 1940 GOTO560
 1950 IFC>=10THEN1980
 1960 PRINT"NOT ENOUGH CREW TO FIRE TORPEDO, ";N$;"."
 1970 GOTO560
 1980 IFTTHEN2010
 1990 PRINT"NO TORPEDOS LEFT, ";N$;"."
 2000 GOTO560
 2010 IFD<2000THEN2050
 2020 IFRND(0)>.5THEN2050
 2030 PRINT"PRESSURE IMPLODES SUB UPON FIRING..YOU'RE CRUSHED!!"
 2040 GOTO6110
 2050 GOSUB5990
 2060 X=S1
 2070 Y=S2
 2080 FORX2=1TOINT(7+5*(-(D>50))-RND(0)*4+.5)
 2090 IFX+X1>0ANDX+X1<16ANDY+Y1>0ANDY+Y1<21THEN2150
 2100 PRINT"TORPEDO OUT OF SONAR RANGE...INEFFECTUAL, ";N$;"."
 2110 T=T-1
 2120 P=P-150
 2130 IFP>0THEN4490
 2140 GOTO1330
 2150 ONA(X+X1,Y+Y1)+1GOTO2160,2200,2360,2230,2270,2320,2340
 2160 X=X+X1
 2170 Y=Y+Y1
 2180 PRINT"..!..";
 2190 GOTO2360
 2200 PRINT"YOU TOOK OUT SOME ISLAND, ";N$;"!"
 2210 A(X+X1,Y+Y1)=0
 2220 GOTO2110
 2230 PRINT"OUCH!!!! YOU GOT ONE, ";N$;"!!"
 2240 S=S-1
 2250 IFS<>0THEN2210
 2260 GOTO6180
 2270 PRINT"YOU BLEW UP YOUR HEADQUARTERS, ";N$;"!!!"
 2280 S3=0
 2290 S4=0
 2300 D2=0
 2310 GOTO2110
 2320 PRINT"BLAM!! SHOT WASTED ON A MINE, ";N$;"!!"
 2330 GOTO2110
 2340 PRINT"A SEA MONSTER HAD A TORPEDO FOR LUNCH, ";N$;"!!"
 2350 GOTO2110
 2360 NEXTX2
 2370 PRINT"DUD."
 2380 GOTO2110
 2390 IFD(4)>=0THEN2420
 2400 PRINT"MISSILE SILOS ARE UNDER REPAIR ";N$;"."
 2410 GOTO560
 2420 IFC>23THEN2450
 2430 PRINT"NOT ENOUGH CREW TO LAUNCH A MISSILE, ";N$;"."
 2440 GOTO560
 2450 IFM<>0THEN2480
 2460 PRINT"NO MISSILES LEFT, ";N$;"."
 2470 GOTO560
 2480 IFD>50ANDD<2000THEN2550
 2490 PRINT"RECOMMENDED THAT YOU DO NOT FIRE AT THIS DEPTH...PROCEED";
 2500 INPUTA$
 2510 IFLEFT$(A$,1)="N"THEN560
 2520 IFRND(0)<.5THEN2550
 2530 PRINT"MISSILE EXPLODES UPON FIRING, ";N$;"!! YOU'RE DEAD!!"
 2540 GOTO6110
 2550 GOSUB5990
 2560 PRINT"FUEL (LBS.)";
 2570 INPUTF1
 2580 IFF1>0ANDF1<=FTHEN2610
 2590 PRINT"YOU HAVE";F;"LBS. LEFT, ";N$;"."
 2600 GOTO2560
 2610 F2=INT(F1/75+.5)
 2620 IFS1+X1*F2>0ANDS1+X1*F2<16ANDS2+Y1*F2>0ANDS2+Y1*F2<21THEN2680
 2630 PRINT"MISSILE OUT OF SONAR TRACKING, ";N$;". MISSILE LOST."
 2640 M=M-1
 2650 F=F-F1
 2660 P=P-300
 2670 GOTO2130
 2680 D3=0
 2690 D4=0
 2700 D5=0
 2710 D6=0
 2720 FORX=S1+X1*F2-1TOS1+X1*F2+1
 2730 FORY=S2+Y1*F2-1TOS2+Y1*F2+1
 2740 IFX<1ORX>15ORY<1ORY>20THEN2890
 2750 D3=D3-(A(X,Y)=3)
 2760 D4=D4-(A(X,Y)=6)
 2770 D5=D5-(A(X,Y)=5)
 2780 D6=D6-(A(X,Y)=1)
 2790 IFA(X,Y)<>4THEN2850
 2795 STOP
 2800 PRINT"YOU'VE DESTROYED YOUR HEADQUARTERS, ";N$;"!!!"
 2810 D3=0
 2820 S4=0
 2830 D2=0
 2840 GOTO2880
 2850 IFA(X,Y)<>2THEN2880
 2860 PRINT"YOU'VE JUST DESTROYED YOURSELF, ";N$;"!!! DUMMY!!"
 2870 GOTO6110
 2880 A(X,Y)=0
 2890 NEXTY
 2900 NEXTX
 2910 IFD6=0THEN2930
 2920 PRINT"YOU BLEW OUT SOME ISLAND, ";N$;"."
 2930 IFD5=0THEN2950
 2940 PRINT"YOU DESTROYED";D5;"MINES, ";N$;"."
 2950 IFD4=0THEN2970
 2960 PRINT"YOU GOT";D4;"SEA MONSTERS, ";N$;"!!! GOOD WORK!!"
 2970 PRINT"YOU DESTROYED";D3;"ENEMY SHIPS, ";N$;"!!!"
 2980 S=S-D3
 2985 IFS<=0THEN6180
 2990 GOTO2640
 3000 IFD(5)>=0THEN3030
 3010 PRINT"BALLAST CONTROLS ARE BEING REPAIRED, ";N$;"."
 3020 GOTO560
 3030 IFC>12THEN3060
 3040 PRINT"THERE ARE NOT ENOUGH CREW TO WORK THE CONTROLS, ";N$;"."
 3050 GOTO560
 3060 PRINT"NEW DEPTH";
 3070 INPUTD1
 3080 IFD1>=0ANDD1<3000THEN3110
 3090 PRINT"HULL CRUSHED BY PRESSURE, ";N$;"!!"
 3100 GOTO6110
 3110 P=P-INT(ABS((D-D1)/2+.5))
 3120 PRINT"MANOUVER COMPLETE. POWER LOSS=";INT(ABS((D-D1)/2+.5))
 3130 D=D1
 3140 GOTO4490
 3150 IFD(6)>=0THEN3180
 3160 PRINT"NO REPORTS ARE ABLE TO GET THROUGH, ";N$;"."
 3170 GOTO560
 3180 IFC>3THEN3210
 3190 PRINT"NO ONE LEFT TO GIVE THE REPORT, ";N$;"."
 3200 GOTO560
 3210 PRINT
 3220 PRINT
 3230 PRINT"# OF ENEMY SHIPS LEFT....";
 3240 PRINTLLISTDD$;S
 3250 PRINT"# OF POWER UNITS LEFT....";
 3260 PRINTLLIST"###,###";P
 3270 PRINT"# OF TORPEDOS LEFT.......";
 3280 PRINTLLISTDD$;T
 3290 PRINT"# OF MISSILES LEFT.......";
 3300 PRINTLLISTDD$;M
 3310 PRINT"# OF CREWMEN LEFT........";
 3320 PRINTLLISTDD$;C
 3330 PRINT"LBS. OF FUEL LEFT........";
 3340 PRINTLLIST"###,###";F
 3350 PRINT
 3360 PRINT"WANT DAMAGE REPORT";
 3370 INPUTA$
 3380 IFLEFT$(A$,1)="N"THEN3510
 3390 CLS
 3400 PRINT"   ITEM          DAMAGE  (+ GOOD, 0 NEUTRAL, - BAD)"
 3410 PRINT"   ----          ------"
 3420 DATA"ENGINES","SONAR","TORPEDOS","MISSILES","MANOUVERING"
 3430 DATA"STATUS","HEADQUARTERS","SABOTAGE","CONVERTER"
 3440 RESTORE
 3450 FORX=1TO9
 3460 READA$
 3470 PRINTA$;
 3480 PRINTLLIST"###.###";D(X)
 3490 NEXTX
 3500 PRINT
 3510 PRINT"YOU ARE AT LOCATION (";S1;",";S2;")."
 3520 PRINT
 3530 GOTO560
 3540 IFD(7)>=0THEN3570
 3550 PRINT"HEADQUARTERS IS DAMAGED. UNABLE TO HELP, ";N$;"."
 3560 GOTO560
 3570 IFD2<>0THEN3600
 3580 PRINT"HEADQUARTERS IS DESERTED, ";N$;"."
 3590 GOTO560
 3600 IFSQR((S1-S3)^2+(S2-S4)^2)<=2ANDD<51THEN3630
 3610 PRINT"UNABLE TO COMPLY WITH DOCKING ORDERS, ";N$;"."
 3620 GOTO560
 3630 PRINT"DIVERS FROM HEADQUARTERS BRING OUR SUPPLIES AND MEN."
 3640 P=4000
 3650 T=8
 3660 M=2
 3670 F=1500
 3680 C=25
 3690 D2=D2-1
 3700 GOTO4490
 3710 IFD(8)>=0THEN3740
 3720 PRINT"HATCHES INACCESSABLE, ";N$;". NO SABOTAGES POSSIBLE."
 3730 GOTO560
 3740 IFC>10THEN3770
 3750 PRINT"NOT ENOUGH CREW TO GO ON A MISSION, ";N$;"."
 3760 GOTO560
 3770 D3=0
 3780 D4=0
 3790 FORX=S1-2TOS1+2
 3800 FORY=S2-2TOS2+2
 3810 IFX<1ORX>15ORY<1ORY>20THEN3840
 3820 D3=D3-(A(X,Y)=3)
 3830 D4=D4-(A(X,Y)=6)
 3840 NEXTY
 3850 NEXTX
 3860 IFD3<>0THEN3890
 3870 PRINT"NO SHIPS IN RANGE, ";N$;"."
 3880 GOTO560
 3890 PRINT"THERE ARE";D3;"SHIPS IN RANGE, ";N$;"."
 3900 PRINT"HOW MANY MEN ARE GOING, ";N$;
 3910 INPUTQ1
 3920 IFC-Q1>=10THEN3950
 3930 PRINT"YOU MUST LEAVE AT LEAST 10 MEN ON BOARD, ";N$;"."
 3940 GOTO3900
 3950 D5=INT(D3/Q1+.5)
 3960 D6=0
 3970 FORX=S1-2TOS1+2
 3980 FORY=S2-2TOS2+2
 3990 IFD3/Q1>1-RND(0)ANDRND(0)+D3/Q1<.9THEN4050
 4000 IFA(X,Y)<>3THEN4050
 4010 D6=D6+1
 4020 A(X,Y)=0
 4030 S=S-1
 4040 IFS=0THENGOTO6180
 4050 NEXTY
 4060 NEXTX
 4070 PRINTD6;"SHIPS WERE DESTROYED, ";N$;"."
 4080 D6=0
 4090 D7=0
 4100 FORX=1TOQ1
 4110 D7=D7-(RND(0)>.6)
 4120 NEXTX
 4130 FORX=1TOQ1-D7
 4140 D6=D6-(RND(0)<.15)
 4150 NEXTX
 4160 IFD4=0THEN4200
 4170 PRINT"A SEA MONSTER SMELLS THE MEN ON THE WAY BACK!!!"
 4180 PRINTD7;"MEN WERE EATEN, ";N$;"!!"
 4190 C=C-D7
 4200 PRINTD6;"MEN WERE LOST THROUGH ACCIDENTS, ";N$;"."
 4210 C=C-D6
 4220 P=P-INT(10*Q1+RND(0)*10)
 4230 GOTO4490
 4240 IFD(9)>=0THEN4270
 4250 PRINT"POWER CONVERTER IS DAMAGED, ";N$;"."
 4260 GOTO560
 4270 IFC>5THEN4300
 4280 PRINT"NOT ENOUGH MEN TO WORK THE CONVERTER, ";N$;"."
 4290 GOTO560
 4300 PRINT"OPTION? (1=FUEL TO POWER, 2=POWER TO FUEL)";
 4310 INPUTO
 4320 ONOGOTO4340,4400
 4330 GOTO4300
 4340 PRINT"FUEL AVAILABLE=";F; CHR$(8);". CONVERT";
 4350 INPUTC1
 4360 IF(C1>F)OR(C1<0)THEN4340
 4370 F=F-C1
 4380 P=P+INT(C1/3)
 4390 GOTO4450
 4400 PRINT"POWER AVAILABLE=";P-1;CHR$(8);". CONVERT";
 4410 INPUTC1
 4420 IFC1>P-1ORC1<0THEN4400
 4430 P=P-C1
 4440 F=F+INT(C1*3)
 4450 PRINT"CONVERSION COMPLETE. POWER="P;CHR$(8);". FUEL=";F;CHR$(8);"."
 4460 GOTO4490
 4470 PRINT"COWARD!!YOU'RE NOT VERY PATRIOTIC, ";N$;"!!!"
 4480 GOTO6110
 4490 Q=0
 4500 FORX=S1-4TOS1+4
 4510 FORY=S2-4TOS2+4
 4520 IFX<1ORX>15ORY<1ORY>20THEN4550
 4530 IFA(X,Y)<>3THEN4550
 4540 Q=Q+(RND(0)/SQR((S1-X)^2+(S2-Y)^2))
 4550 NEXTY
 4560 NEXTX
 4570 IFQTHEN4600
 4580 PRINT"NO SHIPS IN RANGE TO DEPTH CHARGE YOU, ";N$;"!!"
 4590 GOTO5040
 4600 PRINT"DEPTH CHARGES OFF";
 4610 IFRND(0)>.5THEN4640
 4620 PRINT"PORT SIDE, ";N$;"!!!"
 4630 GOTO4650
 4640 PRINT"STARBOARD SIDE, ";N$;"!!!"
 4650 IFQ>.13ORRND(0)>.92THEN4680
 4660 PRINT"NO REAL DAMAGE SUSTAINED, ";N$;"."
 4670 GOTO5040
 4680 IFQ>.36ORRND(0)>.96THEN4730
 4690 PRINT"LIGHT, SUPERFICIAL DAMAGE, ";N$;"."
 4700 P=P-50
 4710 LETD(INT(RND(0)*9)+1)=RND(0)*2
 4720 GOTO5040
 4730 IFQ>.6ORRND(0)>.975THEN4810
 4740 PRINT"MODERATE DAMAGE. REPAIRS NEEDED."
 4750 P=P-75+INT(RND(0)*30)
 4760 FORY=1TO2
 4770 X=INT(RND(0)*9)+1
 4780 D(X)=D(X)-RND(0)*8
 4790 NEXTY
 4800 GOTO5040
 4810 IFQ>.9ORRND(0)>.983THEN4890
 4820 PRINT"HEAVY DAMAGE!! REPAIRS IMMEDIATE, ";N$;"!!!"
 4830 P=P-(200+INT(RND(0)*76))
 4840 FORX=1TO4+INT(RND(0)*2)
 4850 Y=INT(RND(0)*9)+1
 4860 D(Y)=D(Y)-RND(0)*11
 4870 NEXTX
 4880 GOTO5040
 4890 PRINT"DAMAGE CRITICAL!!! WE NEED HELP!!!"
 4900 A$="QWERVHTUEAVMAKTIRYGHVNATUALALTYABALGGUTMBMFQIQIEYURQWCVBMNVBCE"
 4910 X=INT(RND(0)*16)+1
 4920 PRINT"SEND 'HELP' IN CODE. HERE IS THE CODE:";MID$(A$,X,4);
 4930 '
 4940 FORI=1TO1500
 4950 NEXTI
 4960 PRINTSTRING$(4,8);STRING$(4,143)
 4970 INPUT"ENTER CODE";B$
 4980 PRINT
 4990 IFB$<>MID$(A$,X,4)THEN5020
 5000 PRINT"FAST WORK, ";N$;"!! HELP ARRIVES IN TIME TO SAVE YOU!!"
 5010 GOTO4830
 5020 PRINT"MESSAGE GARBLED, ";N$;"...NO HELP ARRIVES!!!"
 5030 GOTO6110
 5040 IFD(1)>=0ORD(3)>=0ORD(4)>=0ORD(5)>=0ORD(7)>=0THEN5080
 5050 IFD(8)>=0ORD(9)>=0THEN5080
 5060 PRINT"DAMAGE TOO MUCH, ";N$;"!!! YOU'RE SUNK!!"
 5070 GOTO6110
 5080 PRINT@979,"PRESS ANY KEY TO CONTINUE";
 5090 IF INKEY$=""THEN5090
 5100 CLS
 5110 PRINT"---*** RESULTS OF LAST ENEMY MANOUVER ***---"
 5120 FORX=1TO15
 5130 FORY=1TO20
 5140 IFA(X,Y)<>3THEN5580
 5150 W=D8
 5160 V=D9
 5170 IFX+W>0ANDX+W<16ANDY+V>0ANDY+V<21THEN5260
 5180 FORX0=19TO1STEP-1
 5190 IFA(X-W*X0*14/19,Y-V*X0)<>0THEN5240
 5200 LETA(X-W*X0*14/19,Y-V*X0)=3
 5210 '
 5220 A(X,Y)=0
 5230 GOTO5920
 5240 NEXTX0
 5250 GOTO570
 5260 ONA(X+W,Y+V)+1GOTO5270,5300,5390,5300,5420,5490,5540
 5270 A(X+W,Y+V)=3
 5280 A(X,Y)=0
 5290 GOTO5920
 5300 RESTORE
 5310 FORJK=1TO9
 5320 READJK$
 5330 NEXTJK
 5340 FORX0=1TOINT(RND(0)*8)+1
 5350 READW,V
 5360 NEXTX0
 5370 IFX+W<1ORX+W>15ORY+V<1ORY+V>20THEN5300
 5380 GOTO5260
 5390 IFD>50THEN5300
 5400 PRINT"*** YOU'VE BEEN RAMMED BY A SHIP, ";N$;"!!!"
 5410 GOTO6110
 5420 IFRND(0)<.15THEN5300
 5430 PRINT"*** YOUR HEADQUARTERS WAS RAMMED, ";N$;"!!!"
 5440 S3=0
 5450 S4=0
 5460 D2=0
 5470 A(X+W,Y+V)=0
 5480 GOTO5510
 5490 IFRND(0)<.7THEN5300
 5500 PRINT"*** SHIP DESTROYED BY A MINE, ";N$;"!!"
 5510 S=S-1
 5520 IFS<>0THEN5280
 5530 GOTO6180
 5540 IFRND(0)<.8THEN5300
 5550 PRINT"*** SHIP EATEN BY A SEA MONSTER, ";N$;"!!"
 5560 S=S-1
 5570 GOTO5520
 5580 IFA(X,Y)<>6THEN5920
 5590 IFX+M1<1ORX+M1>15ORY+M2<1ORY+M2>20THEN5640
 5600 ONA(X+M1,Y+M2)+1GOTO5610,5640,5730,5750,5800,5610,5850
 5610 A(X+M1,Y+M2)=6
 5620 A(X,Y)=0
 5630 GOTO5920
 5640 RESTORE
 5650 FORJK=1TO9
 5660 READJK$
 5670 NEXTJK
 5680 FORX0=1TOINT(RND(0)*8)+1
 5690 READM1,M2
 5700 NEXTX0
 5710 IFX+M1<1ORX+M1>15ORY+M2<1ORY+M2>20THEN5640
 5720 GOTO5600
 5730 PRINT"*** YOU'VE BEEN EATEN BY A SEA MONSTER, ";N$;"!!"
 5740 GOTO6110
 5750 IFRND(0)>.2THEN5640
 5760 PRINT"*** SHIP EATEN BY A SEA MONSTER, ";N$;"!!"
 5770 S=S-1
 5780 IFS<>0THEN5610
 5790 GOTO6180
 5800 PRINT"*** A SEA MONSTER ATE YOUR HEADQUARTERS, ";N$;"!!"
 5810 S3=0
 5820 S4=0
 5830 D2=0
 5840 GOTO5610
 5850 IFRND(0)<.75THEN5640
 5860 PRINT"*** A SEA MONSTER FIGHT, ";N$;"!!";
 5870 IFRND(0)<.8THEN5900
 5880 PRINT"AND ONE DIES!!"
 5890 GOTO5610
 5900 PRINT"IT'S A TIE!!"
 5910 GOTO5640
 5920 NEXTY
 5930 NEXTX
 5940 FORY=1TO9
 5950 X=INT(RND(0)*9)+1
 5960 D(X)=D(X)+(RND(1)*(2+RND(1)*2))*(1+(-(D<51)OR-(D>2000)))*(-(D(X)<3))
 5970 NEXTY
 5980 GOTO560
 5990 DATA-1,0,-1,1,0,1,1,1,1,0,1,-1,0,-1,-1,-1
 6000 PRINT"COURSE (1-8)";
 6010 INPUTC1
 6020 IFC1<1ORC1>8THEN6000
 6030 RESTORE
 6040 FORJK=1TO9
 6050 READJK$
 6060 NEXTJK
 6070 FORX9=1TOINT(C1+.5)
 6080 READX1,Y1
 6090 NEXTX9
 6100 RETURN
 6110 PRINT"THERE ARE STILL";S;"ENEMY SHIPS LEFT, ";N$;"."
 6120 PRINT"YOU WILL BE DEMOTED TO RANK OF DECK SCRUBBER!!!"
 6130 PRINT"WANT ANOTHER GAME";
 6140 INPUTA$
 6150 IFLEFT$(A$,1)<>"Y"THEN6170
 6160 CLS:GOTO70
 6170 END
 6180 PRINT"GOOD WORK, ";N$;"!!! YOU GOT THEM ALL!!!"
 6190 PRINT"PROMOTION AND COMMENDATIONS WILL BE GIVEN IMMEDIATELY!!!"
 6200 GOTO6130
 6210 DATA0,1,1,1,0,0,0,1,1,1,1,0,1,1,1,0,1,1,1,1,0,0,0,1
 6220 DATA1,1,0,0,1,1,0,1,1,0,1,0,0,0,1,0,0,0
 6230 END

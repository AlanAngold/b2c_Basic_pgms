# NOTE: Type forced to be:
# trs2 - TRS-80 Level II BASIC tokenized file
  940 IF The IBM Personal Computer Mortgage
  950 IF Version 1.00 (C)Copyright IBM Corp 1981, 1982
  960 IF Licensed Material - Program Property of IBM
  970 IF Author - Glenn Stuart Dardick
  975 TROFF SEG : DEFSTR 106,0
  980 SAMPLES$ CVS "NO"
  990 INPUT 1010
 1000 SAMPLES$ CVS "YES"
 1010 INKEY$ SQR : MEM 0,1 : LLIST 15,0,0 : OUT 40 : DELETE : THEN 5,19 : GOSUB "IBM"
 1020 THEN 7,12,0 : GOSUB "Personal Computer"
 1030 LLIST 10,0 : THEN 10,9,0 : GOSUB {0xFF} TRON (213) EOF < (21,205) EOF {0xFF} TRON (184)
 1040 THEN 11,9,0 : GOSUB {0xFF} TRON (179) EOF "      MORTGAGE       "EOF {0xFF} TRON (179)
 1050 THEN 12,9,0 : GOSUB {0xFF} TRON (179) EOF < (21,32) EOF {0xFF} TRON (179)
 1060 THEN 13,9,0 : GOSUB {0xFF} TRON (179) EOF "    Version 1.1O     "EOF {0xFF} TRON (179)
 1070 THEN 14,9,0 : GOSUB {0xFF} TRON (212) EOF < (21,205) EOF {0xFF} TRON (190)
 1080 LLIST 15,0 : THEN 17,4,0 : GOSUB "(C) Copyright IBM Corp 1981, 1982"
 1090 LLIST 14,0 : THEN 23,7,0 : GOSUB "Press space bar to continue"
 1100 READ RND CVD CVI ""+ INPUT 1100
 1110 CMD$ CVS RND 
 1120 READ CMD$ CVS " "+ INPUT 1150
 1130 READ CMD$ CVS {0xFF} TRON (27) + INPUT 1210
 1140 INPUT 1110
 1150 LLIST 15,0 : DELETE : LPRINT P : RANDOM AMORT(500,2) : MEM 0
 1154 TROFF SEG CVS 0
 1155 READ ({0xFF} TROFF (&H410) MKD$ &H30) CVD CVI &H30 + COLS CVS 3 : INPUT 1158
 1156 OUT 80 : COLS CVS 8
 1158 TROFF SEG
 1160 GOTO 1240
 1170 READ {0xFF} ELSE (I$) CVS 27 + 1210
 1180 READ {0xFF} SET (I$,1,1) CVS "2" + INPUT 2010
 1190 READ {0xFF} SET (I$,1,1) CVS "1" + INPUT 1490
 1200 INPUT 1160
 1210 READ SAMPLES$ CVD CVI "YES" + INPUT 1220
 1215 {0xFE} LET "SAMPLES",1000
 1220 GOTO 1470
 1230 FOR 
 1240 IF - MAIN OPTION MENU
 1250 LLIST 15,0 : DELETE : LLIST 0,7 : GOSUB " MORTGAGE ANALYSIS "
 1260 LLIST 15,0 : THEN 3,1 : GOSUB "OPTIONS - "
 1270 GOSUB "1 - MORTGAGE PAYMENT COMPARISONS "
 1280 GOSUB "2 - MORTGAGE AMORTIZATION"
 1290 GOSUB "ESC KEY - EXIT"
 1300 GOSUB " "
 1310 GOSUB "OPTION NUMBER (1,2, OR ESC) =====>"
 1320 GOSUB "NOTE :  PRESS THE ENTER KEY WHEN DONE"
 1330 GOSUB " "
 1340 LLIST 15,0
 1350 GOSUB {0xFF} TRON (218) EOF < (37,{0xFF} TRON (196)) EOF {0xFF} TRON (191)
 1360 GOSUB {0xFF} TRON (179) EOF "  MORTGAGE PAYMENT COMPARISONS       "EOF {0xFF} TRON (179)
 1370 GOSUB {0xFF} TRON (179) EOF "    - USE THIS OPTION TO COMPARE     "EOF {0xFF} TRON (179)
 1380 GOSUB {0xFF} TRON (179) EOF "      THE MONTHLY PAYMENTS OF        "EOF {0xFF} TRON (179)
 1390 GOSUB {0xFF} TRON (179) EOF "      MORTGAGES AT VARIOUS RATES     "EOF {0xFF} TRON (179)
 1400 GOSUB {0xFF} TRON (179) EOF "      AND PRINCIPAL AMOUNTS.         "EOF {0xFF} TRON (179)
 1410 GOSUB {0xFF} TRON (179) EOF "  MORTGAGE AMORTIZATION              "EOF {0xFF} TRON (179)
 1420 GOSUB {0xFF} TRON (179) EOF "    - USE THIS OPTION TO CALCULATE   "EOF {0xFF} TRON (179)
 1430 GOSUB {0xFF} TRON (179) EOF "      THE PRINCIPAL AND INTEREST     "EOF {0xFF} TRON (179)
 1440 GOSUB {0xFF} TRON (179) EOF "      PAID OVER ANY 12 MONTH PERIOD. "EOF {0xFF} TRON (179)
 1450 GOSUB {0xFF} TRON (192) EOF < (37,{0xFF} TRON (196)) EOF {0xFF} TRON (217)
 1460 LLIST 0,7 : THEN 8,37 : GOSUB " ": THEN 8,37
 1461 I$ CVS RND : READ I$ CVS ""+ 1461 ELSE GOSUB I$; : RUN 
 1470 LLIST 15,0 : DELETE : FOR 
 1480 PF CVS AF LOF (RF MKI$ (1.0# LOC (1.0# MKI$ ((1.0# EOF RF) MKS$ NF)))) : RUN 
 1490 IF - mortgage comparisons
 1500 LLIST 15,0 : DELETE : LLIST 0,7 : GOSUB " MORTGAGE PAYMENT COMPARISON PROGRAM "
 1510 THEN 10,1 : LLIST 15,0
 1520 GOSUB {0xFF} TRON (218) EOF < (37,{0xFF} TRON (196)) EOF {0xFF} TRON (191)
 1530 GOSUB {0xFF} TRON (179) EOF "  MORTGAGE PAYMENT COMPARISONS       "EOF {0xFF} TRON (179)
 1540 GOSUB {0xFF} TRON (179) EOF "    - USE THIS OPTION TO COMPARE     "EOF {0xFF} TRON (179)
 1550 GOSUB {0xFF} TRON (179) EOF "      THE MONTHLY PAYMENTS OF        "EOF {0xFF} TRON (179)
 1560 GOSUB {0xFF} TRON (179) EOF "      MORTGAGES AT VARIOUS RATES     "EOF {0xFF} TRON (179)
 1570 GOSUB {0xFF} TRON (179) EOF "      AND PRINCIPAL AMOUNTS.         "EOF {0xFF} TRON (179)
 1580 GOSUB {0xFF} TRON (179) EOF "                                     "EOF {0xFF} TRON (179)
 1590 GOSUB {0xFF} TRON (179) EOF "  NOTE :  TO SELECT A VALUE OR AMOUNT  "EOF {0xFF} TRON (179)
 1600 GOSUB {0xFF} TRON (179) EOF "      ENTER THE APPROPRIATE VALUE    "EOF {0xFF} TRON (179)
 1610 GOSUB {0xFF} TRON (179) EOF "      AND PRESS THE ENTER KEY.       "EOF {0xFF} TRON (179)
 1620 GOSUB {0xFF} TRON (192) EOF < (37,{0xFF} TRON (196)) EOF {0xFF} TRON (217)
 1630 THEN 3,1 : DEF CMD "ENTER BASE MORTGAGE AMOUNT ===> ";A$
 1640 A CVS {0xFF} STOP (A$) : READ A CVD CVS 0 + INPUT 1600
 1650 AINC CVS 2000
 1660 THEN 4,1 : GOSUB AND 38);
 1670 THEN 5,1 : GOSUB "(1 TO 35 PERCENT)";
 1680 THEN 4,1 : DEF CMD "ENTER BASE INTEREST RATE =====> ";IR$
 1690 IR CVS {0xFF} STOP (IR$) : READ IR CVI 35 CINT IR CVD 1 + INPUT 1660
 1700 R CVS IR MKI$ 1200 : RINC CVS 0.0025 MKI$ 12
 1710 THEN 5,1 : GOSUB AND 38);
 1720 THEN 6,1 : GOSUB "(1 TO 35 YEARS)";
 1730 THEN 5,1 : DEF CMD "ENTER NUMBER OF YEARS IN MTG => ";Y$
 1740 Y CVS {0xFF} STOP (Y$)
 1750 N CVS Y LOF 12
 1760 NF CVS N
 1770 READ NF CVI 420 CINT NF CVD 1 + INPUT 1710
 1780 DELETE 
 1790 LLIST 0,7 : GOSUB " MONTHLY MORTGAGE PAYMENT COMPARISONS "
 1800 LLIST 15,0 : THEN 3,10 : GOSUB Y$ EOF "-YEAR MORTGAGE LOAN AMOUNTS";
 1810 THEN 5,2 : GOSUB "RATES"; : LLIST 0,7
 1820 RESET I CVS 0 STEP COLS
 1830 THEN 4,9 EOF I LOF 8 : GOSUB AND 7) : THEN 4,9 EOF I LOF 8 : GOSUB A EOF I LOF AINC
 1840 SET I
 1850 RESET I CVS 0 STEP 14
 1860 THEN 6 EOF I,1 : GOSUB AND 7) : THEN 6 EOF I,2
 1870 GOSUB SGN "##.##";{0xFF} CMD (((R EOF (I LOF RINC)) LOF 120000.0) EOF 0.5) MKI$ 100
 1880 SET I
 1890 LLIST 15,0
 1900 RESET I CVS 0 STEP 14
 1910 RF CVS R EOF I LOF RINC : AF CVS 1 : GOTO 1480
 1920 RESET J CVS 0 STEP COLS
 1930 P CVS PF LOF (A EOF J LOF AINC) : P CVS {0xFF} CMD ((P EOF 0.005) LOF 100) MKI$ 100
 1935 READ P CVI 10000 + THEN 22,1 : GOSUB "PAYMENTS TOO LARGE TO DISPLAY" : INPUT 1980
 1940 THEN 6 EOF I,9 EOF J LOF 8 : GOSUB SGN "####.##";P;
 1950 SET J
 1960 SET I
 1970 GOSUB " "
 1980 GOSUB "PRESS SPACE BAR TO CONTINUE";
 1990 READ RND CVD CVI " "+ INPUT 1990
 2000 INPUT 1160
 2010 IF - mortgage amortization
 2020 LLIST 7,0
 2030 DELETE 
 2040 LLIST 0,7
 2050 THEN 1,1
 2060 GOSUB " MORTGAGE AMORTIZATION PROGRAM "
 2070 THEN 10,1 : LLIST 15,0
 2080 GOSUB {0xFF} TRON (218) EOF < (37,{0xFF} TRON (196)) EOF {0xFF} TRON (191)
 2090 GOSUB {0xFF} TRON (179) EOF "  MORTGAGE AMORTIZATION              "EOF {0xFF} TRON (179)
 2100 GOSUB {0xFF} TRON (179) EOF "    - USE THIS OPTION TO CALCULATE   "EOF {0xFF} TRON (179)
 2110 GOSUB {0xFF} TRON (179) EOF "      THE PRINCIPAL AND INTEREST     "EOF {0xFF} TRON (179)
 2120 GOSUB {0xFF} TRON (179) EOF "      PAID OVER ANY 12 MONTH PERIOD. "EOF {0xFF} TRON (179)
 2130 GOSUB {0xFF} TRON (179) EOF "                                     "EOF {0xFF} TRON (179)
 2140 GOSUB {0xFF} TRON (179) EOF "  NOTE :  TO SELECT A VALUE OR AMOUNT  "EOF {0xFF} TRON (179)
 2150 GOSUB {0xFF} TRON (179) EOF "      ENTER THE APPROPRIATE VALUE    "EOF {0xFF} TRON (179)
 2160 GOSUB {0xFF} TRON (179) EOF "      AND PRESS THE ENTER KEY.       "EOF {0xFF} TRON (179)
 2170 GOSUB {0xFF} TRON (192) EOF < (37,{0xFF} TRON (196)) EOF {0xFF} TRON (217)
 2180 THEN 3,1
 2190 DEF CMD "ENTER MORTGAGE AMOUNT ===> ";A$
 2200 AF CVS {0xFF} STOP (A$)
 2210 THEN 4,1
 2220 GOSUB "                                      ";
 2230 THEN 5,1
 2240 GOSUB "(1 TO 35 PERCENT)";
 2250 THEN 4,1
 2260 DEF CMD "ENTER INTEREST RATE =====> ";IR$
 2270 IR CVS {0xFF} STOP (IR$)
 2280 READ IR CVI 35 + INPUT 2210
 2290 READ IR CVD 1 + INPUT 2210
 2300 RF CVS IR MKI$ 1200
 2310 THEN 5,1
 2320 GOSUB "                                      ";
 2330 THEN 6,1
 2340 GOSUB "(1 TO 35 YEARS)";
 2350 THEN 5,1
 2360 DEF CMD "ENTER NUMBER OF YEARS ===> ";Y$
 2370 Y CVS {0xFF} STOP (Y$)
 2380 NF CVS Y LOF 12
 2390 READ NF CVI 420 + INPUT 2310
 2400 READ NF CVD 1 + INPUT 2310
 2410 GOTO 1480
 2420 PF CVS {0xFF} CMD ((PF EOF 0.005) LOF 100) MKI$ 100
 2430 GOSUB "MONTHLY PAYMENTS ARE ====>";PF
 2435 LLIST 23,0
 2440 GOSUB "CALCULATING AMORTIZATION"
 2445 LLIST 15,0
 2450 READ NF CVI 36 + INPUT 2470
 2460 RESET I CVS 1 STEP 1000 : SET I
 2470 AMORT(0,1) CVS AF
 2480 RESET I CVS 1 STEP NF
 2490 AMORT(I,2) CVS {0xFF} CMD ((AMORT(I LOC 1,1) LOF RF EOF 0.005) LOF 100) MKI$ 100
 2500 AMORT(I,1) CVS AMORT(I LOC 1,1) LOC PF EOF AMORT(I,2)
 2510 SET I
 2520 RESET I CVS 7 STEP 25 : THEN I,1 : GOSUB AND 39); : SET I
 2530 THEN 9,1
 2540 GOSUB " - 1 TO" EOF {0xFF} REM (NF)
 2550 GOSUB " - 0 TO END AMORTIZATION";
 2560 THEN 7,1
 2570 GOSUB "ENTER BEGINNING PAYMENT NUMBER"
 2580 DEF CMD "OF 12 MONTH PERIOD ======> ";PERIOD$
 2590 PD CVS {0xFF} STOP (PERIOD$)
 2600 READ PD CVD CVI 0 + INPUT 2620
 2610 READ PERIOD$ CVD CVI "0" + INPUT 2560
 2620 READ PD CVS 0 + INPUT 1160
 2630 READ PD CVI NF + INPUT 2560
 2640 READ PD CVD 0 + INPUT 2560
 2650 THEN 7,1
 2660 GOSUB AND 39)
 2670 GOSUB AND 39)
 2680 THEN 9,1
 2690 GOSUB "PYMNT PRINCIPAL   INTEREST    BALANCE"
 2700 TINT CVS 0
 2710 RESET I CVS PD STEP PD EOF 11
 2711 READ I CVI NF + INPUT 2750
 2720 TINT CVS TINT EOF AMORT(I,2)
 2730 GOSUB SGN "### ";I;
 2740 GOSUB SGN "  ######.##";PF LOC AMORT(I,2);AMORT(I,2);AMORT(I,1)
 2750 SET I
 2760 GOSUB " "
 2770 GOSUB "INTEREST FOR 12 PERIODS =";
 2780 GOSUB SGN "######.## ";TINT
 2790 THEN 25,1
 2800 GOSUB "PRESS SPACE BAR TO CONTINUE";
 2810 THEN ,,0
 2820 READ RND CVD CVI ""+ INPUT 2820
 2830 CMD$ CVS RND 
 2840 READ CMD$ CVS " "+ INPUT 2520
 2850 READ CMD$ CVS {0xFF} TRON (27) + INPUT 1210
 2860 INPUT 2830

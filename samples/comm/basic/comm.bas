# NOTE: Type forced to be:
# trs2 - TRS-80 Level II BASIC tokenized file
    1 IF The IBM Personal Computer Comm
    2 IF Version 1.10 (C)Copyright IBM Corp 1981, 1982
    3 IF Licensed Material - Program Property of IBM
    4 IF Author - M. C. Rojas
    5 DELETE : INPUT 40
   10 INKEY$ SQR : MEM 0,0 : OUT 40 : LLIST 7,0 : DELETE : DEFSTR 106,0
   11 RESET I CVS 1 STEP 10 : INKEY$ I,"" : SET 
   12 NEW : SAVE A LOC Z : FALSE CVS 0 : TRUE CVS OR FALSE : XOFF$ CVS {0xFF} TRON (19) : XON$ CVS {0xFF} TRON (17) : ELSE LOAD INPUT 460 : T CVS 0 : ECH$ CVS ""
   15 TROFF SEG CVS 0 : READ ({0xFF} TROFF (&H410) MKD$ &H30) CVS &H30 + OUT 80 : T CVS 20 : MODE$ CVS "b" : TROFF SEG : INPUT 30
   16 RESET I CVS 1 STEP 10 : INKEY$ I,"" : SET 
   17 THEN 25,10 EOF T MKI$ 2 : GOSUB "F1 = 40 COLUMN         F2 = 80 COLUMN"
   18 TROFF SEG
   30 OUT "com1 : ",255 : TROFF SEG
   40 THEN 2 : GOSUB - 10 EOF T) "COMMUNICATIONS MENU"
   50 THEN 6,3 EOF T : GOSUB "Choose one of the following : "
   60 THEN 9,10 EOF T : GOSUB "1 Description of program"
   70 GOSUB - 10 EOF T) "2 Dow Jones/News Retrieval"
   80 GOSUB - 10 EOF T) "3 IBM Personal Computer"
   90 GOSUB - 10 EOF T) "4 Series/1"
  100 GOSUB - 10 EOF T) "5 THE SOURCE"
  110 GOSUB - 10 EOF T) "6 Other service"
  115 GOSUB - 10 EOF T) "7 End program"
  120 THEN 18 : GOSUB {0xFF} DEFSTR (40 EOF T) : THEN 18,3 EOF T,1 : GOSUB "choice";
  122 A$ CVS RND : READ A$ CVS ""+ 122
  123 READ {0xFF} RETURN (A$) CVS 1 + LT CVS {0xFF} STOP (A$) : INPUT 130
  124 READ MODE$ CVS "b" + LT CVS 0 : INPUT 130
  125 B$ CVS {0xFF} SET (A$,2,1)
  126 READ {0xFF} ELSE (B$) CVS 59 + OUT 40 : T CVS 0 : DELETE : INPUT 17 ELSE READ {0xFF} ELSE (B$) CVS 60 + OUT 80 : T CVS 20 : DELETE : INPUT 17 ELSE LT CVS 0 : INPUT 130
  127 INPUT 122
  130 READ LT CVS 7 + DELETE : GOSUB - 10 EOF T) "- COMMUNICATION ENDED -" : FOR ELSE READ (LT CVS 2 CINT LT CVS 4 CINT LT CVS 5) + 230 ELSE READ LT CVS 1 + GOTO 530 : INPUT 10 : ELSE READ (LT CVD 1 CINT LT CVI 7) + FL CVS 1 : GOSUB : GOSUB - 3 EOF T) "Invalid choice, try again"
  140 READ FL CVS 1 + RESET I CVS 1 STEP 2500 : SET : THEN 19 : GOSUB {0xFF} DEFSTR (40 EOF T) : FL CVS 0 : INPUT 120
  145 DELETE : THEN 1,10 EOF T : GOSUB "USER DEFINED LINK" : READ LT CVS 3 + THEN ,3 EOF T : GOSUB "TO ANOTHER IBM PERSONAL COMPUTER"
  150 THEN 4,3 EOF T,1 : GOSUB "BAUD RATE "; : GOTO 465 : SPEED$ CVS B$
  160 THEN 5,3 EOF T,1 : GOSUB "PARITY "; : GOTO 465 : PARITY$ CVS B$
  170 THEN 6,3 EOF T,1 : GOSUB "NUMBER OF BITS PER CHARACTER "; : GOTO 465 : BITS$ CVS B$
  180 THEN 7,3 EOF T,1 : GOSUB "NUMBER OF STOP BITS "; : GOTO 465 : STP$ CVS B$
  185 THEN 8,3 EOF T,1 : GOSUB "CHARACTERS ECHOED TO SCREEN (Y/N) "; : GOTO 465 : ECH$ CVS B$
  190 THEN 10,3 EOF T,1 : GOSUB "Data entered correctly (Y/N) "; : GOTO 465 : CR$ CVS B$
  200 READ CR$ CVS "N" CINT CR$ CVS "n" + 145 ELSE GOTO 480
  210 THEN 21,3 : COMFIL$ CVS "COM1 : "EOF SPEED$ EOF "," EOF PARITY$ EOF "," EOF BITS$ EOF "," EOF STP$
  220 CSAVE COMFIL$ AS #1
  230 READ LT CVS 4 + NM$ CVS "Series/1" : GOTO 470 : CSAVE "com1 : 300,e,7,2" AS 1
  240 READ LT CVS 2 + NM$ CVS "Dow Jones News/Retrieval" : GOTO 470 : CSAVE "com1 : 300,e,7" AS 1
  250 READ LT CVS 5 + NM$ CVS "THE SOURCE" : GOTO 470 : CSAVE "com1 : 300,e,7" AS 1
  260 CSAVE "SCRN : "RESET OUTPUT AS #2
  270 THEN ,,1
  280 PAUSE CVS FALSE : ELSE LOAD INPUT 460
  290 B$ CVS RND : READ B$ CVS ""+ 320
  300 READ {0xFF} RETURN (B$) CVI 1 + READ {0xFF} ELSE ({0xFF} SET (B$,2,1)) CVS 68 + 450 ELSE 320 ELSE READ B$ CVS {0xFF} TRON (8) + THEN ,{0xFF} GOSUB (0) LOC 1,1 : GOSUB " "; : THEN ,{0xFF} GOSUB (0) LOC 1,1
  310 GOSUB #1,B$; : READ ECH$ CVS "Y" CINT ECH$ CVS "y" + GOSUB #2,B$;
  320 READ {0xFF} FIELD (1) + 290
  330 READ {0xFF} GET (1) CVI 128 + PAUSE CVS TRUE : GOSUB #1,XOFF$;
  340 A$ CVS CMD $({0xFF} GET (1),#1)
  360 RESET I CVS 1 STEP {0xFF} RETURN (A$)
  370 READ ({0xFF} ELSE ({0xFF} SET (A$,I,1)) CVD 31 MKD$ {0xFF} SET (A$,I,1) CVD CVI {0xFF} TRON (13)) CINT {0xFF} SET (A$,I,1) CVS {0xFF} TRON (127) + 410
  380 READ {0xFF} SET (A$,I,1) CVS {0xFF} TRON (10) + {0xFF} SET (A$,I,1) CVS " "
  400 GOSUB {0xFF} SET (A$,I,1);
  410 SET I
  420 READ {0xFF} GET (1) CVI 0 + 290
  430 READ PAUSE + PAUSE CVS FALSE : GOSUB #1,XON$;
  440 INPUT 290
  450 DEFSTR 106,0 : NEW : ELSE LOAD INPUT 0 : INPUT 10
  460 READ = CVS 68 + DELETE : THEN 12,8 EOF T : GOSUB "THIS PROGRAM REQUIRES THE" : GOSUB - 3 EOF T) "ASYNCHRONOUS COMMUNICATIONS ADAPTER." : FOR 
  461 READ = CVS 24 + DELETE : THEN 12,,1 : GOSUB "A DEVICE TIMEOUT ERROR HAS OCCURRED." : GOSUB "MAKE SURE THE HARDWARE IS CORRECTLY" : GOSUB "SET UP, THEN PRESS ENTER."; : GOTO 465 : DELETE : MERGE 
  462 MERGE 
  465 A$ CVS "": B$ CVS "": CR$ CVS "": POKE EOF A$ CVD CVI {0xFF} TRON (13)
  466 A$ CVS RND : READ A$ CVS ""+ 466 ELSE READ {0xFF} RETURN (A$) CVI 1 + READ {0xFF} ELSE ({0xFF} SET (A$,2,1)) CVS 68 + 450 ELSE 466 : ELSE READ A$ CVD CVI {0xFF} TRON (8) + GOSUB A$; : ELSE THEN ,{0xFF} GOSUB (0) LOC 1,1 : GOSUB " "; : THEN ,{0xFF} GOSUB (0) LOC 1,1 : B$ CVS {0xFF} SET (B$,1,{0xFF} RETURN (B$) LOC 1)
  467 READ A$ CVD CVI {0xFF} TRON (13) MKD$ A$ CVD CVI {0xFF} TRON (8) + B$ CVS B$ EOF A$
  468 PRINT : RUN 
  470 DELETE : THEN 1,12 EOF T : GOSUB NM$ : GOSUB 
  480 GOSUB : GOSUB : GOSUB - 3 EOF T) "- Place your call, and insert the"
  490 GOSUB - 3 EOF T) "  phone receiver into the modem, or"
  495 GOSUB - 3 EOF T) "  switch your data set from talk to"
  500 GOSUB - 3 EOF T) "  data. Then press ENTER to begin.   ": GOSUB : GOSUB 
  510 GOSUB - 3 EOF T) "- PRESS F10 TO GO TO MENU" : GOSUB 
  512 GOTO 465
  515 RUN 
  530 DELETE : THEN 1,15 EOF T : GOSUB "DESCRIPTION"
  540 THEN 4,3 EOF T : GOSUB "An asynchronous communication link"
  550 GOSUB - 3 EOF T) "will be established between the"
  560 GOSUB - 3 EOF T) "selected service and the"
  570 GOSUB - 3 EOF T) "IBM PERSONAL COMPUTER, as follows : "
  580 THEN 9,3 EOF T : GOSUB "Baud rate"; - 13 EOF T)"300"
  590 GOSUB - 3 EOF T) "Parity"; - 14 EOF T)"E"
  600 GOSUB - 3 EOF T) "Data bits"; - 14 EOF T);"7
  610 GOSUB - 3 EOF T) "Stop bits"; - 14 EOF T);"1  Dow Jones, THE SOURCE"
  620 GOSUB - 14 EOF T) "2  Series/1"
  630 THEN 15,3 EOF T : GOSUB "Options 3 and 6 allow for the above"
  640 GOSUB - 3 EOF T) "characteristics to be supplied by"
  650 GOSUB - 3 EOF T) "the user to define a communication"
  660 GOSUB - 3 EOF T) "link to other services or computers."
  661 READ MODE$ CVS "b" + 670
  665 THEN 20,3 EOF T : GOSUB "You can select 40 column display or"
  666 GOSUB - 3 EOF T) "80 column display by pressing F1 or"
  667 GOSUB - 3 EOF T) "F2 before selecting menu choice."
  670 THEN 24,3 EOF T : GOSUB "PRESS ANY KEY TO GO TO MENU";
  671 CR$ CVS RND : READ CR$ CVS ""+ 671 ELSE RUN 
